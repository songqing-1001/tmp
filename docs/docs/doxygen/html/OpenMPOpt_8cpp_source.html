<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/IPO/OpenMPOpt.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_13abb262e9c52ddea8d07639819afd6c.html">IPO</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">OpenMPOpt.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="OpenMPOpt_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- IPO/OpenMPOpt.cpp - Collection of OpenMP specific optimizations ---===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// OpenMP specific optimizations:</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// - Deduplication of runtime calls, e.g., omp_get_thread_num.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// - Replacing globalized device memory with stack memory.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// - Replacing globalized device memory with shared memory.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// - Parallel region merging.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// - Transforming generic-mode device kernels to SPMD mode.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// - Specializing the state machine for generic-mode device kernels.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OpenMPOpt_8h.html">llvm/Transforms/IPO/OpenMPOpt.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EnumeratedArray_8h.html">llvm/ADT/EnumeratedArray.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostOrderIterator_8h.html">llvm/ADT/PostOrderIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallGraph_8h.html">llvm/Analysis/CallGraph.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallGraphSCCPass_8h.html">llvm/Analysis/CallGraphSCCPass.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemoryLocation_8h.html">llvm/Analysis/MemoryLocation.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OMPConstants_8h.html">llvm/Frontend/OpenMP/OMPConstants.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OMPIRBuilder_8h.html">llvm/Frontend/OpenMP/OMPIRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Assumptions_8h.html">llvm/IR/Assumptions.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DiagnosticInfo_8h.html">llvm/IR/DiagnosticInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalValue_8h.html">llvm/IR/GlobalValue.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalVariable_8h.html">llvm/IR/GlobalVariable.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsAMDGPU.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsNVPTX.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Attributor_8h.html">llvm/Transforms/IPO/Attributor.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallGraphUpdater_8h.html">llvm/Transforms/Utils/CallGraphUpdater.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">using namespace </span>omp;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   61</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;openmp-opt&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a4f904e7a65d6dcf72478502e2394c467">DisableOpenMPOptimizations</a>(</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="stringliteral">&quot;openmp-opt-disable&quot;</span>, <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable OpenMP specific optimizations.&quot;</span>),</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#ac760bb314a61ad7d42edfcd3929ca4e0">EnableParallelRegionMerging</a>(</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="stringliteral">&quot;openmp-opt-enable-merging&quot;</span>,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable the OpenMP region merging optimization.&quot;</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="OpenMPOpt_8cpp.html#aaa7ffb579a72260b325fb2139c8a758a">DisableInternalization</a>(<span class="stringliteral">&quot;openmp-opt-disable-internalization&quot;</span>,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                           <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable function internalization.&quot;</span>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                           <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a122fb4045a202a92aa4aac18c7d8116d">DeduceICVValues</a>(<span class="stringliteral">&quot;openmp-deduce-icv-values&quot;</span>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                     <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a318fae1fc9f118809808f03a8fd0bfbc">PrintICVValues</a>(<span class="stringliteral">&quot;openmp-print-icv-values&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a70c2cf8dfecc65410186dea5577367fe">PrintOpenMPKernels</a>(<span class="stringliteral">&quot;openmp-print-gpu-kernels&quot;</span>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                        <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#ae0be78032e5e87dd0906a9a925b8555b">HideMemoryTransferLatency</a>(</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="stringliteral">&quot;openmp-hide-memory-transfer-latency&quot;</span>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;[WIP] Tries to hide the latency of host to device memory&quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;             <span class="stringliteral">&quot; transfers&quot;</span>),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a766797ec22d0c22f563a28e00f9865d6">DisableOpenMPOptDeglobalization</a>(</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="stringliteral">&quot;openmp-opt-disable-deglobalization&quot;</span>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable OpenMP optimizations involving deglobalization.&quot;</span>),</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#ad590786d9dc132a9f606d062c384c7cf">DisableOpenMPOptSPMDization</a>(</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="stringliteral">&quot;openmp-opt-disable-spmdization&quot;</span>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable OpenMP optimizations involving SPMD-ization.&quot;</span>),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a48fab4c5bc866fd3cbda51b75511da6b">DisableOpenMPOptFolding</a>(</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="stringliteral">&quot;openmp-opt-disable-folding&quot;</span>,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable OpenMP optimizations involving folding.&quot;</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#aa9760ec3616ef020c7356dfc24a5cd7f">DisableOpenMPOptStateMachineRewrite</a>(</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="stringliteral">&quot;openmp-opt-disable-state-machine-rewrite&quot;</span>,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable OpenMP optimizations that replace the state machine.&quot;</span>),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a3a6f2f61e22ec48ea9a7314c82412d69">DisableOpenMPOptBarrierElimination</a>(</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="stringliteral">&quot;openmp-opt-disable-barrier-elimination&quot;</span>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable OpenMP optimizations that eliminate barriers.&quot;</span>),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a4865e7077c266a648b5c2b5e3813c860">PrintModuleAfterOptimizations</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="stringliteral">&quot;openmp-opt-print-module-after&quot;</span>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Print the current module after OpenMP optimizations.&quot;</span>),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a82741d1f59899bd473969ef3b9311939">PrintModuleBeforeOptimizations</a>(</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="stringliteral">&quot;openmp-opt-print-module-before&quot;</span>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Print the current module before OpenMP optimizations.&quot;</span>),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="OpenMPOpt_8cpp.html#a8328e3a26ee4f202629864b9e7bb8c78">AlwaysInlineDeviceFunctions</a>(</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="stringliteral">&quot;openmp-opt-inline-device&quot;</span>,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Inline all applicible functions on the device.&quot;</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="OpenMPOpt_8cpp.html#af9b0823ab33b2950bb7afdddc6d043cb">EnableVerboseRemarks</a>(<span class="stringliteral">&quot;openmp-opt-verbose-remarks&quot;</span>,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                         <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enables more verbose remarks.&quot;</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                         <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="OpenMPOpt_8cpp.html#afe0e25c8ebed23a66842a952ed9b449f">SetFixpointIterations</a>(<span class="stringliteral">&quot;openmp-opt-max-iterations&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                          <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Maximal number of attributor iterations.&quot;</span>),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                          <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(256));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="OpenMPOpt_8cpp.html#a4cb2a061e2ceec7947d57a2c1db03918">SharedMemoryLimit</a>(<span class="stringliteral">&quot;openmp-opt-shared-limit&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                      <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Maximum amount of shared memory to use.&quot;</span>),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                      <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;unsigned&gt;::max</a>()));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPRuntimeCallsDeduplicated,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP runtime calls deduplicated&quot;</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPParallelRegionsDeleted,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP parallel regions deleted&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPRuntimeFunctionsIdentified,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP runtime functions identified&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPRuntimeFunctionUsesIdentified,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP runtime function uses identified&quot;</span>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPTargetRegionKernels,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP target region entry points (=kernels) identified&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPTargetRegionKernelsSPMD,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP target region entry points (=kernels) executed in &quot;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="stringliteral">&quot;SPMD-mode instead of generic-mode&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPTargetRegionKernelsWithoutStateMachine,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP target region entry points (=kernels) executed in &quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="stringliteral">&quot;generic-mode without a state machines&quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPTargetRegionKernelsCustomStateMachineWithFallback,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP target region entry points (=kernels) executed in &quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="stringliteral">&quot;generic-mode with customized state machines with fallback&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPTargetRegionKernelsCustomStateMachineWithoutFallback,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP target region entry points (=kernels) executed in &quot;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="stringliteral">&quot;generic-mode with customized state machines without fallback&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    NumOpenMPParallelRegionsReplacedInGPUStateMachine,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="stringliteral">&quot;Number of OpenMP parallel regions replaced with ID in GPU state machines&quot;</span>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOpenMPParallelRegionsMerged,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="stringliteral">&quot;Number of OpenMP parallel regions merged&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumBytesMovedToSharedMemory,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          <span class="stringliteral">&quot;Amount of memory pushed to shared memory&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumBarriersEliminated, <span class="stringliteral">&quot;Number of redundant barriers eliminated&quot;</span>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">  177</a></span>&#160;<span class="keyword">static</span> constexpr <span class="keyword">auto</span> <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> = <span class="stringliteral">&quot;[&quot;</span> <a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">struct </span>AAHeapToShared;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keyword">struct </span>AAICVTracker;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/// OpenMP specific information. For now, stores RFIs and ICVs also needed for</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/// Attributor runs.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span><span class="keyword">struct </span>OMPInformationCache : <span class="keyword">public</span> <a class="code" href="structllvm_1_1InformationCache.html">InformationCache</a> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  OMPInformationCache(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, <a class="code" href="structllvm_1_1AnalysisGetter.html">AnalysisGetter</a> &amp;AG,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                      <a class="code" href="classllvm_1_1BumpPtrAllocatorImpl.html">BumpPtrAllocator</a> &amp;<a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Function *&gt;</a> *<a class="code" href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aaa705a97e17b5651633fcbb938bb1f79f">CGSCC</a>,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                      <a class="code" href="classllvm_1_1SetVector.html">KernelSet</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>, <span class="keywordtype">bool</span> OpenMPPostLink)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      : <a class="code" href="structllvm_1_1InformationCache.html">InformationCache</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, AG, <a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, <a class="code" href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aaa705a97e17b5651633fcbb938bb1f79f">CGSCC</a>), OMPBuilder(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>), OpenMPPostLink(OpenMPPostLink) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    OMPBuilder.initialize();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    initializeRuntimeFunctions(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    initializeInternalControlVars();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  /// Generic information that describes an internal control variable.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>InternalControlVarInfo {<span class="comment"></span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    /// The kind, as described by InternalControlVar enum.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> Kind;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">    /// The name of the ICV.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Name;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">    /// Environment variable associated with this ICV.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> EnvVarName;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">    /// Initial value kind.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm_1_1omp.html#a58b53550e1be2a034095e3e31fc82d66">ICVInitValue</a> InitKind;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">    /// Initial value.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *InitValue;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">    /// Setter RTL function associated with this ICV.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> Setter;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">    /// Getter RTL function associated with this ICV.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> Getter;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">    /// RTL Function corresponding to the override clause of this ICV</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> <a class="code" href="classllvm_1_1Clause.html">Clause</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  };</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">  /// Generic information that describes a runtime function</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>RuntimeFunctionInfo {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">    /// The kind, as described by the RuntimeFunction enum.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> Kind;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">    /// The name of the function.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Name;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    /// Flag to indicate a variadic function.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> IsVarArg;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    /// The return type of the function.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="namespacellvm_1_1ARM_1_1WinEH.html#aeb1849a948db3f783d1598b797186c4a">ReturnType</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    /// The argument types of the function.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Type *, 8&gt;</a> ArgumentTypes;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">    /// The declaration if available.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Function.html">Function</a> *Declaration = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">    /// Uses of this runtime function per function containing the use.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span>    <span class="keyword">using</span> UseVector = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Use *, 16&gt;</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">    /// Clear UsesMap for runtime function.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> clearUsesMap() { UsesMap.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>(); }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">    /// Boolean conversion that is true if the runtime function was found.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"></span>    <span class="keyword">operator</span> bool()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Declaration; }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    /// Return the vector of uses in function \p F.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span>    UseVector &amp;getOrCreateUseVector(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      std::shared_ptr&lt;UseVector&gt; &amp;UV = UsesMap[<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">if</span> (!UV)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        UV = std::make_shared&lt;UseVector&gt;();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordflow">return</span> *UV;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">    /// Return the vector of uses in function \p F or `nullptr` if there are</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    /// none.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span>    <span class="keyword">const</span> UseVector *getUseVector(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = UsesMap.find(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != UsesMap.end())</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second.get();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">    /// Return how many functions contain uses of this runtime function.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span>    <span class="keywordtype">size_t</span> getNumFunctionsWithUses()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> UsesMap.size(); }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    /// Return the number of arguments (or the minimal number for variadic</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    /// functions).</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span>    <span class="keywordtype">size_t</span> getNumArgs()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ArgumentTypes.size(); }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">    /// Run the callback \p CB on each use and forget the use if the result is</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">    /// true. The callback will be fed the function in which the use was</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    /// encountered as second argument.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> foreachUse(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; CB) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        foreachUse(CB, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">    /// Run the callback \p CB on each use within the function \p F and forget</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    /// the use if the result is true.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> foreachUse(<a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; CB, <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 8&gt;</a> ToBeDeleted;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      ToBeDeleted.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordtype">unsigned</span> Idx = 0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      UseVector &amp;UV = getOrCreateUseVector(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> *U : UV) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> (CB(*U, *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          ToBeDeleted.push_back(Idx);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        ++Idx;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// Remove the to-be-deleted indices in reverse order as prior</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">// modifications will not modify the smaller indices.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">while</span> (!ToBeDeleted.empty()) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordtype">unsigned</span> Idx = ToBeDeleted.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        UV[Idx] = UV.back();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        UV.pop_back();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">    /// Map from functions to all uses of this runtime function contained in</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">    /// them.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Function *, std::shared_ptr&lt;UseVector&gt;</a>&gt; UsesMap;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">    /// Iterators for the uses of this runtime function.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span>    decltype(UsesMap)::iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>() { <span class="keywordflow">return</span> UsesMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a50d461a887e200e704e5157d3b21514d">begin</a>(); }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    decltype(UsesMap)::iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>() { <span class="keywordflow">return</span> UsesMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>(); }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  };</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">  /// An OpenMP-IR-Builder instance</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1OpenMPIRBuilder.html">OpenMPIRBuilder</a> OMPBuilder;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">  /// Map from runtime function kind to the runtime function description.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1EnumeratedArray.html">EnumeratedArray</a>&lt;RuntimeFunctionInfo, <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a>,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                  RuntimeFunction::OMPRTL___last&gt;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      RFIs;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">  /// Map from function declarations/definitions to their runtime enum type.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Function *, RuntimeFunction&gt;</a> RuntimeFunctionIDMap;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  /// Map from ICV kind to the ICV description.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1EnumeratedArray.html">EnumeratedArray</a>&lt;InternalControlVarInfo, <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a>,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                  InternalControlVar::ICV___last&gt;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      ICVs;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">  /// Helper to initialize all internal control variable information for those</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">  /// defined in OMPKinds.def.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> initializeInternalControlVars() {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#define ICV_RT_SET(_Name, RTL)                                                 \</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">  {                                                                            \</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">    auto &amp;ICV = ICVs[_Name];                                                   \</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">    ICV.Setter = RTL;                                                          \</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">  }</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#define ICV_RT_GET(Name, RTL)                                                  \</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">  {                                                                            \</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">    auto &amp;ICV = ICVs[Name];                                                    \</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">    ICV.Getter = RTL;                                                          \</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">  }</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor">#define ICV_DATA_ENV(Enum, _Name, _EnvVarName, Init)                           \</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">  {                                                                            \</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">    auto &amp;ICV = ICVs[Enum];                                                    \</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">    ICV.Name = _Name;                                                          \</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">    ICV.Kind = Enum;                                                           \</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">    ICV.InitKind = Init;                                                       \</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">    ICV.EnvVarName = _EnvVarName;                                              \</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">    switch (ICV.InitKind) {                                                    \</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">    case ICV_IMPLEMENTATION_DEFINED:                                           \</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">      ICV.InitValue = nullptr;                                                 \</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">      break;                                                                   \</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">    case ICV_ZERO:                                                             \</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">      ICV.InitValue = ConstantInt::get(                                        \</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">          Type::getInt32Ty(OMPBuilder.Int32-&gt;getContext()), 0);                \</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">      break;                                                                   \</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">    case ICV_FALSE:                                                            \</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">      ICV.InitValue = ConstantInt::getFalse(OMPBuilder.Int1-&gt;getContext());    \</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">      break;                                                                   \</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">    case ICV_LAST:                                                             \</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">      break;                                                                   \</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">    }                                                                          \</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">  }</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">  /// Returns true if the function declaration \p F matches the runtime</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  /// function types, that is, return type \p RTFRetType, and argument types</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">  /// \p RTFArgTypes.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> declMatchesRTFTypes(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *RTFRetType,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Type *, 8&gt;</a> &amp;RTFArgTypes) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// TODO: We should output information to the user (under debug output</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//       and via remarks).</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getReturnType() != RTFRetType)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;arg_size() != RTFArgTypes.size())</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keyword">auto</span> *RTFTyIt = RTFArgTypes.begin();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;args()) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.getType() != *RTFTyIt)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      ++RTFTyIt;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Helper to collect all uses of the declaration in the UsesMap.</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">unsigned</span> collectUses(RuntimeFunctionInfo &amp;RFI, <span class="keywordtype">bool</span> CollectStats = <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">unsigned</span> NumUses = 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (!RFI.Declaration)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">return</span> NumUses;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    OMPBuilder.<a class="code" href="classllvm_1_1OpenMPIRBuilder.html#a50c6490cf353f064946c4e32673ac098">addAttributes</a>(RFI.Kind, *RFI.Declaration);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (CollectStats) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      NumOpenMPRuntimeFunctionsIdentified += 1;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      NumOpenMPRuntimeFunctionUsesIdentified += RFI.Declaration-&gt;getNumUses();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// TODO: We directly convert uses into proper calls and unknown uses.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : RFI.Declaration-&gt;uses()) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UserI = dyn_cast&lt;Instruction&gt;(U.getUser())) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">if</span> (ModuleSlice.empty() || ModuleSlice.count(UserI-&gt;getFunction())) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          RFI.getOrCreateUseVector(UserI-&gt;getFunction()).push_back(&amp;U);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          ++NumUses;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        RFI.getOrCreateUseVector(<span class="keyword">nullptr</span>).push_back(&amp;U);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        ++NumUses;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> NumUses;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// Helper function to recollect uses of a runtime function.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">void</span> recollectUsesForFunction(<a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RTF) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">auto</span> &amp;RFI = RFIs[RTF];</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    RFI.clearUsesMap();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    collectUses(RFI, <span class="comment">/*CollectStats*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// Helper function to recollect uses of all runtime functions.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">void</span> recollectUses() {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Idx = 0; Idx &lt; RFIs.size(); ++Idx)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      recollectUsesForFunction(<span class="keyword">static_cast&lt;</span><a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a><span class="keyword">&gt;</span>(Idx));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// Helper function to inherit the calling convention of the function callee.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordtype">void</span> setCallingConvention(<a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *Fn = dyn_cast&lt;Function&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>.<a class="code" href="classllvm_1_1FunctionCallee.html#a0055cd5464b935f571b36979a86bd7fc">getCallee</a>()))</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a0851b4de29686e9c3918449b054cfada">setCallingConv</a>(Fn-&gt;getCallingConv());</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// Helper function to determine if it&#39;s legal to create a call to the runtime</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// functions.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordtype">bool</span> runtimeFnsAvailable(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;RuntimeFunction&gt;</a> Fns) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// We can always emit calls if we haven&#39;t yet linked in the runtime.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span> (!OpenMPPostLink)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// Once the runtime has been already been linked in we cannot emit calls to</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// any undefined functions.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> Fn : Fns) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      RuntimeFunctionInfo &amp;RFI = RFIs[Fn];</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordflow">if</span> (RFI.Declaration &amp;&amp; RFI.Declaration-&gt;isDeclaration())</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">  /// Helper to initialize all runtime function information for those defined</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">  /// in OpenMPKinds.def.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> initializeRuntimeFunctions(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// Helper macros for handling __VA_ARGS__ in OMP_RTL</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#define OMP_TYPE(VarName, ...)                                                 \</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">  Type *VarName = OMPBuilder.VarName;                                          \</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">  (void)VarName;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#define OMP_ARRAY_TYPE(VarName, ...)                                           \</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">  ArrayType *VarName##Ty = OMPBuilder.VarName##Ty;                             \</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">  (void)VarName##Ty;                                                           \</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">  PointerType *VarName##PtrTy = OMPBuilder.VarName##PtrTy;                     \</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">  (void)VarName##PtrTy;</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#define OMP_FUNCTION_TYPE(VarName, ...)                                        \</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">  FunctionType *VarName = OMPBuilder.VarName;                                  \</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">  (void)VarName;                                                               \</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">  PointerType *VarName##Ptr = OMPBuilder.VarName##Ptr;                         \</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">  (void)VarName##Ptr;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">#define OMP_STRUCT_TYPE(VarName, ...)                                          \</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">  StructType *VarName = OMPBuilder.VarName;                                    \</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">  (void)VarName;                                                               \</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">  PointerType *VarName##Ptr = OMPBuilder.VarName##Ptr;                         \</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">  (void)VarName##Ptr;</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#define OMP_RTL(_Enum, _Name, _IsVarArg, _ReturnType, ...)                     \</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">  {                                                                            \</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">    SmallVector&lt;Type *, 8&gt; ArgsTypes({__VA_ARGS__});                           \</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">    Function *F = M.getFunction(_Name);                                        \</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">    RTLFunctions.insert(F);                                                    \</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">    if (declMatchesRTFTypes(F, OMPBuilder._ReturnType, ArgsTypes)) {           \</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">      RuntimeFunctionIDMap[F] = _Enum;                                         \</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">      auto &amp;RFI = RFIs[_Enum];                                                 \</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">      RFI.Kind = _Enum;                                                        \</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">      RFI.Name = _Name;                                                        \</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">      RFI.IsVarArg = _IsVarArg;                                                \</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">      RFI.ReturnType = OMPBuilder._ReturnType;                                 \</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">      RFI.ArgumentTypes = std::move(ArgsTypes);                                \</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">      RFI.Declaration = F;                                                     \</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor">      unsigned NumUses = collectUses(RFI);                                     \</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">      (void)NumUses;                                                           \</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">      LLVM_DEBUG({                                                             \</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">        dbgs() &lt;&lt; TAG &lt;&lt; RFI.Name &lt;&lt; (RFI.Declaration ? &quot;&quot; : &quot; not&quot;)           \</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">               &lt;&lt; &quot; found\n&quot;;                                                  \</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">        if (RFI.Declaration)                                                   \</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">          dbgs() &lt;&lt; TAG &lt;&lt; &quot;-&gt; got &quot; &lt;&lt; NumUses &lt;&lt; &quot; uses in &quot;                 \</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">                 &lt;&lt; RFI.getNumFunctionsWithUses()                              \</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">                 &lt;&lt; &quot; different functions.\n&quot;;                                 \</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">      });                                                                      \</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">    }                                                                          \</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">  }</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// Remove the `noinline` attribute from `__kmpc`, `ompx::` and `omp_`</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// functions, except if `optnone` is present.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">isOpenMPDevice</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a> : {<span class="stringliteral">&quot;__kmpc&quot;</span>, <span class="stringliteral">&quot;_ZN4ompx&quot;</span>, <span class="stringliteral">&quot;omp_&quot;</span>})</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(Attribute::NoInline) &amp;&amp;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;              <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName().startswith(<a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>) &amp;&amp;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              !<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(Attribute::OptimizeNone))</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeFnAttr(Attribute::NoInline);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// TODO: We should attach the attributes defined in OMPKinds.def.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  /// Collection of known kernels (\see Kernel) in the module.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SetVector.html">KernelSet</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">  /// Collection of known OpenMP runtime functions..</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;const Function *&gt;</a> RTLFunctions;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  /// Indicates if we have already linked in the OpenMP device library.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> OpenMPPostLink = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;};</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Ty, <span class="keywordtype">bool</span> InsertInval<span class="keywordtype">id</span>ates = true&gt;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keyword">struct </span>BooleanStateWithSetVector : <span class="keyword">public</span> <a class="code" href="structllvm_1_1BooleanState.html">BooleanState</a> {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a1112b818386ec01ddfdf3a5d0024eb17">contains</a>(<span class="keyword">const</span> Ty &amp;Elem)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Set.contains(Elem); }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">bool</span> insert(<span class="keyword">const</span> Ty &amp;Elem) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (InsertInvalidates)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <a class="code" href="structllvm_1_1IntegerStateBase.html#aa3d9223692390a32c796d8160c6f058c">BooleanState::indicatePessimisticFixpoint</a>();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">return</span> Set.insert(Elem);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keyword">const</span> Ty &amp;operator[](<span class="keywordtype">int</span> Idx)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Set[Idx]; }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a4d812a2dd18aa186c164447e20e348e7">operator==</a>(<span class="keyword">const</span> BooleanStateWithSetVector &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1IntegerStateBase.html#ad0867ce36e300e45599fab369cd25853">BooleanState::operator==</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) &amp;&amp; Set == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Set;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a2f883c895f4d244f4ed56ed8a8c160c1">operator!=</a>(<span class="keyword">const</span> BooleanStateWithSetVector &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordtype">bool</span> empty()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Set.empty(); }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Set.size(); }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  /// &quot;Clamp&quot; this state with \p RHS.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"></span>  BooleanStateWithSetVector &amp;<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a8b653cb4535ffcdc32d19861bbef30ae">operator^=</a>(<span class="keyword">const</span> BooleanStateWithSetVector &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="structllvm_1_1IntegerStateBase.html#a593c298c76a3d5747f091eae16eba55f">BooleanState::operator^=</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    Set.insert(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Set.begin(), <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Set.end());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">  /// A set to keep track of elements.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Ty&gt;</a> Set;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keyword">typename</span> decltype(Set)::iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>() { <span class="keywordflow">return</span> Set.<a class="code" href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">begin</a>(); }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keyword">typename</span> decltype(Set)::iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>() { <span class="keywordflow">return</span> Set.<a class="code" href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">end</a>(); }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keyword">typename</span> decltype(Set)::const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Set.<a class="code" href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">begin</a>(); }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keyword">typename</span> decltype(Set)::const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Set.<a class="code" href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">end</a>(); }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;};</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Ty, <span class="keywordtype">bool</span> InsertInval<span class="keywordtype">id</span>ates = true&gt;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keyword">using</span> BooleanStateWithPtrSetVector =</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    BooleanStateWithSetVector&lt;Ty *, InsertInvalidates&gt;;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keyword">struct </span>KernelInfoState : <a class="code" href="structllvm_1_1AbstractState.html">AbstractState</a> {<span class="comment"></span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">  /// Flag to track if we reached a fixpoint.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> IsAtFixpoint = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  /// The parallel regions (identified by the outlined parallel functions) that</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  /// can be reached from the associated function.</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"></span>  BooleanStateWithPtrSetVector&lt;<a class="code" href="classllvm_1_1Function.html">Function</a>, <span class="comment">/* InsertInvalidates */</span> <span class="keyword">false</span>&gt;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      ReachedKnownParallelRegions;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">  /// State to track what parallel region we might reach.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"></span>  BooleanStateWithPtrSetVector&lt;CallBase&gt; ReachedUnknownParallelRegions;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">  /// State to track if we are in SPMD-mode, assumed or know, and why we decided</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">  /// we cannot be. If it is assumed, then RequiresFullRuntime should also be</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">  /// false.</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span>  BooleanStateWithPtrSetVector&lt;Instruction, false&gt; SPMDCompatibilityTracker;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">  /// The __kmpc_target_init call in this kernel, if any. If we find more than</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">  /// one we abort as the kernel is malformed.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *KernelInitCB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">  /// The __kmpc_target_deinit call in this kernel, if any. If we find more than</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">  /// one we abort as the kernel is malformed.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *KernelDeinitCB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">  /// Flag to indicate if the associated function is a kernel entry.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> IsKernelEntry = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">  /// State to track what kernel entries can reach the associated function.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"></span>  BooleanStateWithPtrSetVector&lt;Function, false&gt; ReachingKernelEntries;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">  /// State to indicate if we can track parallel level of the associated</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">  /// function. We will give up tracking if we encounter unknown caller or the</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">  /// caller is __kmpc_parallel_51.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"></span>  BooleanStateWithSetVector&lt;uint8_t&gt; ParallelLevels;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">  /// Flag that indicates if the kernel has nested Parallelism</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> NestedParallelism = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">  /// Abstract State interface</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">  ///{</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  KernelInfoState() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  KernelInfoState(<span class="keywordtype">bool</span> BestState) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">if</span> (!BestState)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      indicatePessimisticFixpoint();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">  /// See AbstractState::isValidState(...)</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isValidState()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">  /// See AbstractState::isAtFixpoint(...)</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isAtFixpoint()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> IsAtFixpoint; }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">  /// See AbstractState::indicatePessimisticFixpoint(...)</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> indicatePessimisticFixpoint()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    IsAtFixpoint = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    ParallelLevels.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    ReachingKernelEntries.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    ReachedKnownParallelRegions.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    ReachedUnknownParallelRegions.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">  /// See AbstractState::indicateOptimisticFixpoint(...)</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> indicateOptimisticFixpoint()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    IsAtFixpoint = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    ParallelLevels.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    ReachingKernelEntries.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    SPMDCompatibilityTracker.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    ReachedKnownParallelRegions.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    ReachedUnknownParallelRegions.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">  /// Return the assumed state</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span>  KernelInfoState &amp;getAssumed() { <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keyword">const</span> KernelInfoState &amp;getAssumed()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a4d812a2dd18aa186c164447e20e348e7">operator==</a>(<span class="keyword">const</span> KernelInfoState &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> (SPMDCompatibilityTracker != <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.SPMDCompatibilityTracker)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (ReachedKnownParallelRegions != <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.ReachedKnownParallelRegions)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (ReachedUnknownParallelRegions != <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.ReachedUnknownParallelRegions)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (ReachingKernelEntries != <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.ReachingKernelEntries)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (ParallelLevels != <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.ParallelLevels)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">  /// Returns true if this kernel contains any OpenMP parallel regions.</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> mayContainParallelRegion() {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> !ReachedKnownParallelRegions.empty() ||</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;           !ReachedUnknownParallelRegions.empty();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">  /// Return empty set as the best state of potential values.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> KernelInfoState getBestState() { <span class="keywordflow">return</span> KernelInfoState(<span class="keyword">true</span>); }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keyword">static</span> KernelInfoState getBestState(KernelInfoState &amp;KIS) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">return</span> getBestState();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">  /// Return full set as the worst state of potential values.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> KernelInfoState getWorstState() { <span class="keywordflow">return</span> KernelInfoState(<span class="keyword">false</span>); }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">  /// &quot;Clamp&quot; this state with \p KIS.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span>  KernelInfoState <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a8b653cb4535ffcdc32d19861bbef30ae">operator^=</a>(<span class="keyword">const</span> KernelInfoState &amp;KIS) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// Do not merge two different _init and _deinit call sites.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (KIS.KernelInitCB) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keywordflow">if</span> (KernelInitCB &amp;&amp; KernelInitCB != KIS.KernelInitCB)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Kernel that calls another kernel violates OpenMP-Opt &quot;</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                         <span class="stringliteral">&quot;assumptions.&quot;</span>);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      KernelInitCB = KIS.KernelInitCB;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> (KIS.KernelDeinitCB) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">if</span> (KernelDeinitCB &amp;&amp; KernelDeinitCB != KIS.KernelDeinitCB)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Kernel that calls another kernel violates OpenMP-Opt &quot;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                         <span class="stringliteral">&quot;assumptions.&quot;</span>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      KernelDeinitCB = KIS.KernelDeinitCB;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    SPMDCompatibilityTracker ^= KIS.SPMDCompatibilityTracker;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    ReachedKnownParallelRegions ^= KIS.ReachedKnownParallelRegions;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    ReachedUnknownParallelRegions ^= KIS.ReachedUnknownParallelRegions;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    NestedParallelism |= KIS.NestedParallelism;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  KernelInfoState <a class="code" href="namespacellvm.html#aa99f18c3597f0eea20753e9865d51b60">operator&amp;=</a>(<span class="keyword">const</span> KernelInfoState &amp;KIS) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">return</span> (*<span class="keyword">this</span> ^= KIS);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">  ///}</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"></span>};</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">/// Used to map the values physically (in the IR) stored in an offload</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">/// array, to a vector in memory.</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"></span><span class="keyword">struct </span>OffloadArray {<span class="comment"></span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">  /// Physical array (in the IR).</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Array = <span class="keyword">nullptr</span>;<span class="comment"></span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">  /// Mapped values.</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> StoredValues;<span class="comment"></span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">  /// Last stores made in the offload array.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StoreInst *, 8&gt;</a> LastAccesses;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  OffloadArray() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">  /// Initializes the OffloadArray with the values stored in \p Array before</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">  /// instruction \p Before is reached. Returns false if the initialization</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">  /// fails.</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">  /// This MUST be used immediately after the construction of the object.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;Array, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Before) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (!Array.getAllocatedType()-&gt;isArrayTy())</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (!getValues(Array, Before))</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    this-&gt;Array = &amp;Array;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DeviceIDArgNum = 1;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> BasePtrsArgNum = 3;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> PtrsArgNum = 4;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> SizesArgNum = 5;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">  /// Traverses the BasicBlock where \p Array is, collecting the stores made to</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">  /// \p Array, leaving StoredValues with the values stored before the</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">  /// instruction \p Before is reached.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> getValues(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;Array, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Before) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// Initialize container.</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumValues = Array.getAllocatedType()-&gt;getArrayNumElements();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    StoredValues.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a38c50aa8e3e9588f4f968c2e03a0cee0">assign</a>(NumValues, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    LastAccesses.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a38c50aa8e3e9588f4f968c2e03a0cee0">assign</a>(NumValues, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// TODO: This assumes the instruction \p Before is in the same</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">//  BasicBlock as Array. Make it general, for any control flow graph.</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = Array.getParent();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != Before.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>())</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = Array.getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">PointerSize</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSize();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keywordflow">if</span> (&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == &amp;Before)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      int64_t Offset = -1;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keyword">auto</span> *Dst =</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          <a class="code" href="namespacellvm.html#afc6337ef6e00f6bebd44d81b685d655f">GetPointerBaseWithConstantOffset</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getPointerOperand(), Offset, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">if</span> (Dst == &amp;Array) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        int64_t Idx = Offset / <a class="code" href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">PointerSize</a>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        StoredValues[Idx] = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        LastAccesses[Idx] = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">return</span> isFilled();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">  /// Returns true if all values in StoredValues and</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">  /// LastAccesses are not nullptrs.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isFilled() {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NumValues = StoredValues.size();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumValues; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (!StoredValues[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] || !LastAccesses[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>])</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;};</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="keyword">struct </span>OpenMPOpt {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keyword">using</span> OptimizationRemarkGetter =</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> *)&gt;;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  OpenMPOpt(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, <a class="code" href="classllvm_1_1CallGraphUpdater.html">CallGraphUpdater</a> &amp;CGUpdater,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            OptimizationRemarkGetter OREGetter,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            OMPInformationCache &amp;OMPInfoCache, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>(*(*<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.begin())-&gt;getParent()), <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>), CGUpdater(CGUpdater),</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        OREGetter(OREGetter), OMPInfoCache(OMPInfoCache), A(A) {}</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">  /// Check if any remarks are enabled for openmp-opt</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> remarksEnabled() {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keyword">auto</span> &amp;Ctx = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">return</span> Ctx.getDiagHandlerPtr()-&gt;isAnyRemarkEnabled(<a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">  /// Run all OpenMP optimizations on the underlying SCC/ModuleSlice.</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">run</a>(<span class="keywordtype">bool</span> IsModulePass) {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.empty())</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Run on SCC with &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.size()</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; functions in a slice with &quot;</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                      &lt;&lt; OMPInfoCache.ModuleSlice.size() &lt;&lt; <span class="stringliteral">&quot; functions\n&quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (IsModulePass) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      Changed |= runAttributor(IsModulePass);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">// Recollect uses, in case Attributor deleted any.</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      OMPInfoCache.recollectUses();</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="comment">// TODO: This should be folded into buildCustomStateMachine.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      Changed |= rewriteDeviceCodeStateMachine();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">if</span> (remarksEnabled())</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        analysisGlobalization();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a318fae1fc9f118809808f03a8fd0bfbc">PrintICVValues</a>)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        printICVs();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a70c2cf8dfecc65410186dea5577367fe">PrintOpenMPKernels</a>)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        printKernels();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      Changed |= runAttributor(IsModulePass);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="comment">// Recollect uses, in case Attributor deleted any.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      OMPInfoCache.recollectUses();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      Changed |= deleteParallelRegions();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#ae0be78032e5e87dd0906a9a925b8555b">HideMemoryTransferLatency</a>)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        Changed |= hideMemTransfersLatency();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      Changed |= deduplicateRuntimeCalls();</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#ac760bb314a61ad7d42edfcd3929ca4e0">EnableParallelRegionMerging</a>) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">if</span> (mergeParallelRegions()) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          deduplicateRuntimeCalls();</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">  /// Print initial ICV values for testing.</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">  /// FIXME: This should be done from the Attributor once it is added.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> printICVs()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICVs[] = {ICV_nthreads, ICV_active_levels, ICV_cancel,</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                 ICV_proc_bind};</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> ICV : ICVs) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keyword">auto</span> ICVInfo = OMPInfoCache.ICVs[ICV];</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;          <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;OpenMP ICV &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;OpenMPICV&quot;</span>, ICVInfo.Name)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; Value: &quot;</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                     &lt;&lt; (ICVInfo.InitValue</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                             ? <a class="code" href="namespacellvm.html#a63540526d092e2f4bbc70590b6034f4e">toString</a>(ICVInfo.InitValue-&gt;getValue(), 10, <span class="keyword">true</span>)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                             : <span class="stringliteral">&quot;IMPLEMENTATION_DEFINED&quot;</span>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        };</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        emitRemark&lt;OptimizationRemarkAnalysis&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;OpenMPICVTracker&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">  /// Print OpenMP GPU kernels for testing.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> printKernels()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keywordflow">if</span> (!OMPInfoCache.Kernels.count(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;OpenMP GPU kernel &quot;</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                   &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;OpenMPGPUKernel&quot;</span>, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName()) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      };</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      emitRemark&lt;OptimizationRemarkAnalysis&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;OpenMPGPU&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">  /// Return the call if \p U is a callee use in a regular call. If \p RFI is</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">  /// given it has to be the callee or a nullptr is returned.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *getCallIfRegularCall(</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, OMPInformationCache::RuntimeFunctionInfo *RFI = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>());</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">if</span> (CI &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a754b47054852401f87e52805d15bdf05">isCallee</a>(&amp;U) &amp;&amp; !CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#aecc0c27ae96638bc9d8fa4caffa92c31">hasOperandBundles</a>() &amp;&amp;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        (!RFI ||</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;         (RFI-&gt;Declaration &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>() == RFI-&gt;Declaration)))</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">return</span> CI;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">  /// Return the call if \p V is a regular call. If \p RFI is given it has to be</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">  /// the callee or a nullptr is returned.</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *getCallIfRegularCall(</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> &amp;V, OMPInformationCache::RuntimeFunctionInfo *RFI = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(&amp;V);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (CI &amp;&amp; !CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#aecc0c27ae96638bc9d8fa4caffa92c31">hasOperandBundles</a>() &amp;&amp;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        (!RFI ||</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;         (RFI-&gt;Declaration &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>() == RFI-&gt;Declaration)))</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">return</span> CI;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">  /// Merge parallel regions when it is safe.</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> mergeParallelRegions() {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> CallbackCalleeOperand = 2;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> CallbackFirstArgOperand = 3;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keyword">using</span> InsertPointTy = <a class="code" href="classllvm_1_1OpenMPIRBuilder.html#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// Check if there are any __kmpc_fork_call calls to merge.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;RFI =</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_fork_call];</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (!RFI.Declaration)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="comment">// Unmergable calls that prevent merging a parallel region.</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    OMPInformationCache::RuntimeFunctionInfo UnmergableCallsInfo[] = {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_push_proc_bind],</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_push_num_threads],</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    };</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;BasicBlock *, SmallPtrSet&lt;Instruction *, 4&gt;</a>&gt; BB2PRMap;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StartBB = <span class="keyword">nullptr</span>, *EndBB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">auto</span> BodyGenCB = [&amp;](InsertPointTy AllocaIP, InsertPointTy CodeGenIP) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CGStartBB = CodeGenIP.getBlock();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CGEndBB =</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(CGStartBB, &amp;*CodeGenIP.getPoint(), DT, LI);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StartBB != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;StartBB should not be null&quot;</span>);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      CGStartBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae959364e4640ac025bbc046d3d7c7e61">setSuccessor</a>(0, StartBB);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndBB != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;EndBB should not be null&quot;</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      EndBB-&gt;getTerminator()-&gt;setSuccessor(0, CGEndBB);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    };</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keyword">auto</span> PrivCB = [&amp;](InsertPointTy AllocaIP, InsertPointTy CodeGenIP, <a class="code" href="classllvm_1_1Value.html">Value</a> &amp;,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                      <a class="code" href="classllvm_1_1Value.html">Value</a> &amp;Inner, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;ReplacementValue) -&gt; InsertPointTy {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      ReplacementValue = &amp;Inner;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">return</span> CodeGenIP;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    };</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keyword">auto</span> FiniCB = [&amp;](InsertPointTy CodeGenIP) {};</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">    /// Create a sequential execution region within a merged parallel region,</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">    /// encapsulated in a master construct with a barrier for synchronization.</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment"></span>    <span class="keyword">auto</span> CreateSequentialRegion = [&amp;](<a class="code" href="classllvm_1_1Function.html">Function</a> *OuterFn,</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterPredBB,</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SeqStartI,</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SeqEndI) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="comment">// Isolate the instructions of the sequential region to a separate</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      <span class="comment">// block.</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ParentBB = SeqStartI-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SeqEndBB =</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(ParentBB, SeqEndI-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>(), DT, LI);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SeqAfterBB =</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(SeqEndBB, &amp;*SeqEndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>(), DT, LI);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SeqStartBB =</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(ParentBB, SeqStartI, DT, LI, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;seq.par.merged&quot;</span>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">getUniqueSuccessor</a>() == SeqStartBB &amp;&amp;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;             <span class="stringliteral">&quot;Expected a different CFG&quot;</span>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>();</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keyword">auto</span> BodyGenCB = [&amp;](InsertPointTy AllocaIP, InsertPointTy CodeGenIP) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CGStartBB = CodeGenIP.getBlock();</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CGEndBB =</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(CGStartBB, &amp;*CodeGenIP.getPoint(), DT, LI);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SeqStartBB != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;SeqStartBB should not be null&quot;</span>);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        CGStartBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae959364e4640ac025bbc046d3d7c7e61">setSuccessor</a>(0, SeqStartBB);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SeqEndBB != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;SeqEndBB should not be null&quot;</span>);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        SeqEndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae959364e4640ac025bbc046d3d7c7e61">setSuccessor</a>(0, CGEndBB);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      };</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keyword">auto</span> FiniCB = [&amp;](InsertPointTy CodeGenIP) {};</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="comment">// Find outputs from the sequential region to outside users and</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="comment">// broadcast their values to them.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *SeqStartBB) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> OutsideUsers;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *Usr : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users()) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;UsrI = *cast&lt;Instruction&gt;(Usr);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <span class="comment">// Ignore outputs to LT intrinsics, code extraction for the merged</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          <span class="comment">// parallel region will fix them.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          <span class="keywordflow">if</span> (UsrI.<a class="code" href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">isLifetimeStartOrEnd</a>())</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          <span class="keywordflow">if</span> (UsrI.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != SeqStartBB)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            OutsideUsers.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;UsrI);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keywordflow">if</span> (OutsideUsers.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">empty</a>())</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="comment">// Emit an alloca in the outer region to store the broadcasted</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="comment">// value.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getDataLayout();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AllocaI = <span class="keyword">new</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>(</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getAllocaAddrSpace(), <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getName() + <span class="stringliteral">&quot;.seq.output.alloc&quot;</span>, &amp;OuterFn-&gt;<a class="code" href="classllvm_1_1Function.html#a79fd2bece62d2060209f319c45450c0c">front</a>().<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">// Emit a store instruction in the sequential BB to update the</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">// value.</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keyword">new</span> <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, AllocaI, SeqStartBB-&gt;getTerminator());</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="comment">// Emit a load instruction and replace the use of the output value</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="comment">// with it.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UsrI : OutsideUsers) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LoadI = <span class="keyword">new</span> <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>(</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;              <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType(), AllocaI, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getName() + <span class="stringliteral">&quot;.seq.output.load&quot;</span>, UsrI);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          UsrI-&gt;replaceUsesOfWith(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, LoadI);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="structllvm_1_1OpenMPIRBuilder_1_1LocationDescription.html">OpenMPIRBuilder::LocationDescription</a> Loc(</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          InsertPointTy(ParentBB, ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      InsertPointTy SeqAfterIP =</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          OMPInfoCache.OMPBuilder.createMaster(Loc, BodyGenCB, FiniCB);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      OMPInfoCache.OMPBuilder.createBarrier(SeqAfterIP, OMPD_parallel);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(SeqAfterBB, SeqAfterIP.getBlock());</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;After sequential inlining &quot;</span> &lt;&lt; *OuterFn</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    };</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// Helper to merge the __kmpc_fork_call calls in MergableCIs. They are all</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// contained in BB and only separated by instructions that can be</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// redundantly executed in parallel. The block BB is split before the first</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">// call (in MergableCIs) and after the last so the entire region we merge</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// into a single parallel region is contained in a single basic block</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">// without any other instructions. We use the OpenMPIRBuilder to outline</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">// that block and call the resulting function via __kmpc_fork_call.</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keyword">auto</span> <a class="code" href="R600ClauseMergePass_8cpp.html#aba99928790de45fa7aa12b47fbd828ff">Merge</a> = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CallInst *&gt;</a> &amp;MergableCIs,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                     <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="comment">// TODO: Change the interface to allow single CIs expanded, e.g, to</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="comment">// include an outer loop.</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MergableCIs.size() &gt; 1 &amp;&amp; <span class="stringliteral">&quot;Assumed multiple mergable CIs&quot;</span>);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Parallel region merged with parallel region&quot;</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;           &lt;&lt; (MergableCIs.size() &gt; 2 ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; at &quot;</span>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CI : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a>(MergableCIs)) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;          <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;OpenMPParallelMerge&quot;</span>, CI-&gt;getDebugLoc());</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;          <span class="keywordflow">if</span> (CI != MergableCIs.back())</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      };</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      emitRemark&lt;OptimizationRemark&gt;(MergableCIs.front(), <span class="stringliteral">&quot;OMP150&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *OriginalFn = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getParent();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Merge &quot;</span> &lt;&lt; MergableCIs.size()</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; parallel regions in &quot;</span> &lt;&lt; OriginalFn-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="comment">// Isolate the calls to merge in a separate block.</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      EndBB = <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, MergableCIs.back()-&gt;getNextNode(), DT, LI);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *AfterBB =</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(EndBB, &amp;*EndBB-&gt;getFirstInsertionPt(), DT, LI);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      StartBB = <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, MergableCIs.front(), DT, LI, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                           <span class="stringliteral">&quot;omp.par.merged&quot;</span>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getUniqueSuccessor() == StartBB &amp;&amp; <span class="stringliteral">&quot;Expected a different CFG&quot;</span>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator()-&gt;getDebugLoc();</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="comment">// Create sequential regions for sequential instructions that are</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="comment">// in-between mergable parallel regions.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *It = MergableCIs.begin(), *End = MergableCIs.end() - 1;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;           It != End; ++It) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ForkCI = *It;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NextForkCI = *(It + 1);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="comment">// Continue if there are not in-between instructions.</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span> (ForkCI-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>() == NextForkCI)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        CreateSequentialRegion(OriginalFn, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, ForkCI-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>(),</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                               NextForkCI-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#ae451867ac0034a201153b54cc466386d">getPrevNode</a>());</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <a class="code" href="structllvm_1_1OpenMPIRBuilder_1_1LocationDescription.html">OpenMPIRBuilder::LocationDescription</a> Loc(InsertPointTy(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end()),</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                               <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;::InsertPoint</a> AllocaIP(</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          &amp;OriginalFn-&gt;<a class="code" href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">getEntryBlock</a>(),</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          OriginalFn-&gt;<a class="code" href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">getEntryBlock</a>().<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="comment">// Create the merged parallel region with default proc binding, to</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="comment">// avoid overriding binding settings, and without explicit cancellation.</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      InsertPointTy AfterIP = OMPInfoCache.OMPBuilder.createParallel(</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          Loc, AllocaIP, BodyGenCB, PrivCB, FiniCB, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;          OMP_PROC_BIND_default, <span class="comment">/* IsCancellable */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(AfterBB, AfterIP.getBlock());</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="comment">// Perform the actual outlining.</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      OMPInfoCache.OMPBuilder.finalize(OriginalFn);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *OutlinedFn = MergableCIs.front()-&gt;getCaller();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="comment">// Replace the __kmpc_fork_call calls with direct calls to the outlined</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="comment">// callbacks.</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CI : MergableCIs) {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;getArgOperand(CallbackCalleeOperand);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *FT = OMPInfoCache.OMPBuilder.ParallelTask;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.clear();</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(OutlinedFn-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(0));</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(OutlinedFn-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(1));</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> U = CallbackFirstArgOperand, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = CI-&gt;arg_size(); U &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;             ++U)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(CI-&gt;getArgOperand(U));</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(FT, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>, <span class="stringliteral">&quot;&quot;</span>, CI);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">if</span> (CI-&gt;getDebugLoc())</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          NewCI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(CI-&gt;getDebugLoc());</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="comment">// Forward parameter attributes from the callback to the callee.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> U = CallbackFirstArgOperand, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = CI-&gt;arg_size(); U &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;             ++U)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Attribute.html">Attribute</a> &amp;A : CI-&gt;getAttributes().getParamAttrs(U))</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            NewCI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                U - (CallbackFirstArgOperand - CallbackCalleeOperand), A);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="comment">// Emit an explicit barrier to replace the implicit fork-join barrier.</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="keywordflow">if</span> (CI != MergableCIs.back()) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          <span class="comment">// TODO: Remove barrier if the merged parallel region includes the</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          <span class="comment">// &#39;nowait&#39; clause.</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          OMPInfoCache.OMPBuilder.createBarrier(</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;              InsertPointTy(NewCI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(),</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                            NewCI-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>()-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>()),</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;              OMPD_parallel);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        CI-&gt;eraseFromParent();</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn != OriginalFn &amp;&amp; <span class="stringliteral">&quot;Outlining failed&quot;</span>);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      CGUpdater.<a class="code" href="classllvm_1_1CallGraphUpdater.html#a08fe25aef5a7fa6ebb858ee29125ce9a">registerOutlinedFunction</a>(*OriginalFn, *OutlinedFn);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      CGUpdater.<a class="code" href="classllvm_1_1CallGraphUpdater.html#a7bf8126709349339746d58096776d4f3">reanalyzeFunction</a>(*OriginalFn);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      NumOpenMPParallelRegionsMerged += MergableCIs.size();</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    };</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// Helper function that identifes sequences of</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">// __kmpc_fork_call uses in a basic block.</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keyword">auto</span> DetectPRsCB = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U, &amp;RFI);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      BB2PRMap[CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()].<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(CI);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    };</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    BB2PRMap.<a class="code" href="classllvm_1_1DenseMapBase.html#adf4e7878fc0b3b8dcde545178564190d">clear</a>();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, DetectPRsCB);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SmallVector&lt;CallInst *, 4&gt;</a>, 4&gt; MergableCIsVector;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">// Find mergable parallel regions within a basic block that are</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">// safe to merge, that is any in-between instructions can safely</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">// execute in parallel after merging.</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">// TODO: support merging across basic-blocks.</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;It : BB2PRMap) {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keyword">auto</span> &amp;CIs = It.getSecond();</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">if</span> (CIs.size() &lt; 2)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = It.getFirst();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallInst *, 4&gt;</a> MergableCIs;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">      /// Returns true if the instruction is mergable, false otherwise.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">      /// A terminator instruction is unmergable by definition since merging</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">      /// works within a BB. Instructions before the mergable region are</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">      /// mergable if they are not calls to OpenMP runtime functions that may</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">      /// set different execution parameters for subsequent parallel regions.</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">      /// Instructions in-between parallel regions are mergable if they are not</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">      /// calls to any non-intrinsic function since that may call a non-mergable</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">      /// OpenMP runtime function.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"></span>      <span class="keyword">auto</span> IsMergable = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">bool</span> IsBeforeMergableRegion) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="comment">// We do not merge across BBs, hence return false (unmergable) if the</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="comment">// instruction is a terminator.</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isTerminator())</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = cast&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">if</span> (IsBeforeMergableRegion) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          <a class="code" href="classllvm_1_1Function.html">Function</a> *CalledFunction = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          <span class="keywordflow">if</span> (!CalledFunction)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          <span class="comment">// Return false (unmergable) if the call before the parallel</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;          <span class="comment">// region calls an explicit affinity (proc_bind) or number of</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          <span class="comment">// threads (num_threads) compiler-generated function. Those settings</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          <span class="comment">// may be incompatible with following parallel regions.</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;          <span class="comment">// TODO: ICV tracking to detect compatibility.</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;RFI : UnmergableCallsInfo) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            <span class="keywordflow">if</span> (CalledFunction == RFI.Declaration)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;          }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          <span class="comment">// Return false (unmergable) if there is a call instruction</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          <span class="comment">// in-between parallel regions when it is not an intrinsic. It</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;          <span class="comment">// may call an unmergable OpenMP runtime function in its callpath.</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          <span class="comment">// TODO: Keep track of possible OpenMP calls in the callpath.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          <span class="keywordflow">if</span> (!isa&lt;IntrinsicInst&gt;(CI))</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      };</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="comment">// Find maximal number of parallel region CIs that are safe to merge.</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> It = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), End = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); It != End;) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = *It;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        ++It;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">if</span> (CIs.count(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          MergableCIs.push_back(cast&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="comment">// Continue expanding if the instruction is mergable.</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">if</span> (IsMergable(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, MergableCIs.empty()))</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="comment">// Forward the instruction iterator to skip the next parallel region</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="comment">// since there is an unmergable instruction which can affect it.</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">for</span> (; It != End; ++It) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;SkipI = *It;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          <span class="keywordflow">if</span> (CIs.count(&amp;SkipI)) {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Skip parallel region &quot;</span> &lt;&lt; SkipI</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; due to &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            ++It;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="comment">// Store mergable regions found.</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">if</span> (MergableCIs.size() &gt; 1) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          MergableCIsVector.push_back(MergableCIs);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; MergableCIs.size()</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; parallel regions in block &quot;</span> &lt;&lt; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getName()</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; of function &quot;</span> &lt;&lt; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getParent()-&gt;getName()</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        MergableCIs.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordflow">if</span> (!MergableCIsVector.empty()) {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;MergableCIs : MergableCIsVector)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          <a class="code" href="R600ClauseMergePass_8cpp.html#aba99928790de45fa7aa12b47fbd828ff">Merge</a>(MergableCIs, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        MergableCIsVector.clear();</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordflow">if</span> (Changed) {<span class="comment"></span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">      /// Re-collect use for fork calls, emitted barrier calls, and</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">      /// any emitted master/end_master calls.</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment"></span>      OMPInfoCache.recollectUsesForFunction(OMPRTL___kmpc_fork_call);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      OMPInfoCache.recollectUsesForFunction(OMPRTL___kmpc_barrier);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      OMPInfoCache.recollectUsesForFunction(OMPRTL___kmpc_master);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      OMPInfoCache.recollectUsesForFunction(OMPRTL___kmpc_end_master);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">  /// Try to delete parallel regions if possible.</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> deleteParallelRegions() {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> CallbackCalleeOperand = 2;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;RFI =</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_fork_call];</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span> (!RFI.Declaration)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keyword">auto</span> DeleteCallCB = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordflow">if</span> (!CI)</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keyword">auto</span> *Fn = dyn_cast&lt;Function&gt;(</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(CallbackCalleeOperand)-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>());</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keywordflow">if</span> (!Fn)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordflow">if</span> (!Fn-&gt;onlyReadsMemory())</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="keywordflow">if</span> (!Fn-&gt;hasFnAttribute(Attribute::WillReturn))</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Delete read-only parallel region in &quot;</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                        &lt;&lt; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Removing parallel region with no side-effects.&quot;</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      };</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      emitRemark&lt;OptimizationRemark&gt;(CI, <span class="stringliteral">&quot;OMP160&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      CGUpdater.<a class="code" href="classllvm_1_1CallGraphUpdater.html#a30a1e8841e6804516ec420786dbbc398">removeCallSite</a>(*CI);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      ++NumOpenMPParallelRegionsDeleted;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    };</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, DeleteCallCB);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">  /// Try to eliminate runtime calls by reusing existing ones.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> deduplicateRuntimeCalls() {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> DeduplicableRuntimeCallIDs[] = {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        OMPRTL_omp_get_num_threads,</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        OMPRTL_omp_in_parallel,</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        OMPRTL_omp_get_cancellation,</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        OMPRTL_omp_get_thread_limit,</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        OMPRTL_omp_get_supported_active_levels,</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        OMPRTL_omp_get_level,</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        OMPRTL_omp_get_ancestor_thread_num,</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        OMPRTL_omp_get_team_size,</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        OMPRTL_omp_get_active_level,</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        OMPRTL_omp_in_final,</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        OMPRTL_omp_get_proc_bind,</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        OMPRTL_omp_get_num_places,</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        OMPRTL_omp_get_num_procs,</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        OMPRTL_omp_get_place_num,</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        OMPRTL_omp_get_partition_num_places,</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        OMPRTL_omp_get_partition_place_nums};</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// Global-tid is handled separately.</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;Value *, 16&gt;</a> GTIdArgs;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    collectGlobalThreadIdArguments(GTIdArgs);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; GTIdArgs.<a class="code" href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">size</a>()</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; global thread ID arguments\n&quot;</span>);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> DeduplicableRuntimeCallID : DeduplicableRuntimeCallIDs)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        Changed |= deduplicateRuntimeCalls(</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, OMPInfoCache.RFIs[DeduplicableRuntimeCallID]);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="comment">// __kmpc_global_thread_num is special as we can replace it with an</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="comment">// argument in enough cases to make it worth trying.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *GTIdArg = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;args())</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <span class="keywordflow">if</span> (GTIdArgs.<a class="code" href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">count</a>(&amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          GTIdArg = &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      Changed |= deduplicateRuntimeCalls(</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;          *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, OMPInfoCache.RFIs[OMPRTL___kmpc_global_thread_num], GTIdArg);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    }</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">  /// Tries to hide the latency of runtime calls that involve host to</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">  /// device memory transfers by splitting them into their &quot;issue&quot; and &quot;wait&quot;</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">  /// versions. The &quot;issue&quot; is moved upwards as much as possible. The &quot;wait&quot; is</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">  /// moved downards as much as possible. The &quot;issue&quot; issues the memory transfer</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">  /// asynchronously, returning a handle. The &quot;wait&quot; waits in the returned</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">  /// handle for the memory transfer to finish.</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> hideMemTransfersLatency() {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keyword">auto</span> &amp;RFI = OMPInfoCache.RFIs[OMPRTL___tgt_target_data_begin_mapper];</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keyword">auto</span> SplitMemTransfers = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Decl) {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keyword">auto</span> *RTCall = getCallIfRegularCall(U, &amp;RFI);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">if</span> (!RTCall)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      OffloadArray OffloadArrays[3];</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keywordflow">if</span> (!getValuesInOffloadArrays(*RTCall, OffloadArrays))</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(dumpValuesInOffloadArrays(OffloadArrays));</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="comment">// TODO: Check if can be moved upwards.</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keywordtype">bool</span> WasSplit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WaitMovementPoint = canBeMovedDownwards(*RTCall);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordflow">if</span> (WaitMovementPoint)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        WasSplit = splitTargetDataBeginRTC(*RTCall, *WaitMovementPoint);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      Changed |= WasSplit;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keywordflow">return</span> WasSplit;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    };</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">if</span> (OMPInfoCache.runtimeFnsAvailable(</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            {OMPRTL___tgt_target_data_begin_mapper_issue,</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;             OMPRTL___tgt_target_data_begin_mapper_wait}))</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, SplitMemTransfers);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="keywordtype">void</span> analysisGlobalization() {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keyword">auto</span> &amp;RFI = OMPInfoCache.RFIs[OMPRTL___kmpc_alloc_shared];</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keyword">auto</span> CheckGlobalization = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Decl) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U, &amp;RFI)) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> ORM) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          <span class="keywordflow">return</span> ORM</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Found thread data sharing on the GPU. &quot;</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Expect degraded performance due to data globalization.&quot;</span>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        };</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        emitRemark&lt;OptimizationRemarkMissed&gt;(CI, <span class="stringliteral">&quot;OMP112&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    };</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, CheckGlobalization);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">  /// Maps the values stored in the offload arrays passed as arguments to</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">  /// \p RuntimeCall into the offload arrays in \p OAs.</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> getValuesInOffloadArrays(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;RuntimeCall,</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                <a class="code" href="classllvm_1_1MutableArrayRef.html">MutableArrayRef&lt;OffloadArray&gt;</a> OAs) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OAs.size() == 3 &amp;&amp; <span class="stringliteral">&quot;Need space for three offload arrays!&quot;</span>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// A runtime call that involves memory offloading looks something like:</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// call void @__tgt_target_data_begin_mapper(arg0, arg1,</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">//   i8** %offload_baseptrs, i8** %offload_ptrs, i64* %offload_sizes,</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">// ...)</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">// So, the idea is to access the allocas that allocate space for these</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="comment">// offload arrays, offload_baseptrs, offload_ptrs, offload_sizes.</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">// Therefore:</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="comment">// i8** %offload_baseptrs.</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtrsArg =</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        RuntimeCall.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(OffloadArray::BasePtrsArgNum);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// i8** %offload_ptrs.</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrsArg = RuntimeCall.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(OffloadArray::PtrsArgNum);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// i8** %offload_sizes.</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SizesArg = RuntimeCall.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(OffloadArray::SizesArgNum);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// Get values stored in **offload_baseptrs.</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keyword">auto</span> *V = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(BasePtrsArg);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;AllocaInst&gt;(V))</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keyword">auto</span> *BasePtrsArray = cast&lt;AllocaInst&gt;(V);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (!OAs[0].<a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(*BasePtrsArray, RuntimeCall))</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">// Get values stored in **offload_baseptrs.</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    V = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(PtrsArg);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;AllocaInst&gt;(V))</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keyword">auto</span> *PtrsArray = cast&lt;AllocaInst&gt;(V);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">if</span> (!OAs[1].<a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(*PtrsArray, RuntimeCall))</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">// Get values stored in **offload_sizes.</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    V = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(SizesArg);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">// If it&#39;s a [constant] global array don&#39;t analyze it.</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span> (isa&lt;GlobalValue&gt;(V))</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">return</span> isa&lt;Constant&gt;(V);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;AllocaInst&gt;(V))</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keyword">auto</span> *SizesArray = cast&lt;AllocaInst&gt;(V);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span> (!OAs[2].<a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(*SizesArray, RuntimeCall))</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">  /// Prints the values in the OffloadArrays \p OAs using LLVM_DEBUG.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">  /// For now this is a way to test that the function getValuesInOffloadArrays</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">  /// is working properly.</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">  /// TODO: Move this to a unittest when unittests are available for OpenMPOpt.</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> dumpValuesInOffloadArrays(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;OffloadArray&gt;</a> OAs) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OAs.<a class="code" href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>() == 3 &amp;&amp; <span class="stringliteral">&quot;There are three offload arrays to debug!&quot;</span>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot; Successfully got offload values:\n&quot;</span>);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    std::string ValuesStr;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <a class="code" href="classllvm_1_1raw__string__ostream.html">raw_string_ostream</a> <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>(ValuesStr);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    std::string Separator = <span class="stringliteral">&quot; --- &quot;</span>;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *BP : OAs[0].StoredValues) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      BP-&gt;print(<a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a> &lt;&lt; Separator;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\t\toffload_baseptrs: &quot;</span> &lt;&lt; <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>.str() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    ValuesStr.clear();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : OAs[1].StoredValues) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>-&gt;print(<a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a> &lt;&lt; Separator;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\t\toffload_ptrs: &quot;</span> &lt;&lt; <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>.str() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    ValuesStr.clear();</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : OAs[2].StoredValues) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;print(<a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a> &lt;&lt; Separator;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\t\toffload_sizes: &quot;</span> &lt;&lt; <a class="code" href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a>.str() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">  /// Returns the instruction where the &quot;wait&quot; counterpart \p RuntimeCall can be</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">  /// moved. Returns nullptr if the movement is not possible, or not worth it.</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *canBeMovedDownwards(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;RuntimeCall) {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// FIXME: This traverses only the BasicBlock where RuntimeCall is.</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">//  Make it traverse the CFG.</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurrentI = &amp;RuntimeCall;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordtype">bool</span> IsWorthIt = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordflow">while</span> ((CurrentI = CurrentI-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>())) {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="comment">// TODO: Once we detect the regions to be offloaded we should use the</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="comment">//  alias analysis manager to check if CurrentI may modify one of</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="comment">//  the offloaded regions.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">if</span> (CurrentI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">mayHaveSideEffects</a>() || CurrentI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9149819221d66953ac6c2938b87f0136">mayReadFromMemory</a>()) {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">if</span> (IsWorthIt)</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;          <span class="keywordflow">return</span> CurrentI;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="comment">// FIXME: For now if we move it over anything without side effect</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="comment">//  is worth it.</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      IsWorthIt = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// Return end of BasicBlock.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">return</span> RuntimeCall.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">  /// Splits \p RuntimeCall into its &quot;issue&quot; and &quot;wait&quot; counterparts.</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> splitTargetDataBeginRTC(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;RuntimeCall,</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                               <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;WaitMovementPoint) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">// Create stack allocated handle (__tgt_async_info) at the beginning of the</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">// function. Used for storing information of the async transfer, allowing to</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">// wait on it later.</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a> = OMPInfoCache.OMPBuilder;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = RuntimeCall.<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>();</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;Entry = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock();</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(&amp;Entry,</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                                     Entry.getFirstNonPHIOrDbgOrAlloca());</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Handle = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#afbe24f9e57cab99bd5bf3960c76bcc94">CreateAlloca</a>(</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.AsyncInfo, <span class="comment">/*ArraySize=*/</span><span class="keyword">nullptr</span>, <span class="stringliteral">&quot;handle&quot;</span>);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    Handle =</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.Builder.<a class="code" href="classllvm_1_1IRBuilderBase.html#ae81c68608606dfb25edd3103a78d138a">CreateAddrSpaceCast</a>(Handle, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.AsyncInfoPtr);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">// Add &quot;issue&quot; runtime call declaration:</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="comment">// declare %struct.tgt_async_info @__tgt_target_data_begin_issue(i64, i32,</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="comment">//   i8**, i8**, i64*, i64*)</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> IssueDecl = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, OMPRTL___tgt_target_data_begin_mapper_issue);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// Change RuntimeCall call site for its asynchronous version.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 16&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : RuntimeCall.<a class="code" href="classllvm_1_1CallBase.html#ac63dbb4994494c46f025715272cdb81e">args</a>())</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.get());</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(Handle);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *IssueCallsite =</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(IssueDecl, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>, <span class="comment">/*NameStr=*/</span><span class="stringliteral">&quot;&quot;</span>, &amp;RuntimeCall);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    OMPInfoCache.setCallingConvention(IssueDecl, IssueCallsite);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    RuntimeCall.<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">// Add &quot;wait&quot; runtime call declaration:</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// declare void @__tgt_target_data_begin_wait(i64, %struct.__tgt_async_info)</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> WaitDecl = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, OMPRTL___tgt_target_data_begin_mapper_wait);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *WaitParams[2] = {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        IssueCallsite-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            OffloadArray::DeviceIDArgNum), <span class="comment">// device_id.</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        Handle                             <span class="comment">// handle to wait on.</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    };</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *WaitCallsite = <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        WaitDecl, WaitParams, <span class="comment">/*NameStr=*/</span><span class="stringliteral">&quot;&quot;</span>, &amp;WaitMovementPoint);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    OMPInfoCache.setCallingConvention(WaitDecl, WaitCallsite);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *combinedIdentStruct(<a class="code" href="classllvm_1_1Value.html">Value</a> *CurrentIdent, <a class="code" href="classllvm_1_1Value.html">Value</a> *NextIdent,</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                                    <span class="keywordtype">bool</span> GlobalOnly, <span class="keywordtype">bool</span> &amp;SingleChoice) {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">if</span> (CurrentIdent == NextIdent)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="keywordflow">return</span> CurrentIdent;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">// TODO: Figure out how to actually combine multiple debug locations. For</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">//       now we just keep an existing one if there is a single choice.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">if</span> (!GlobalOnly || isa&lt;GlobalValue&gt;(NextIdent)) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      SingleChoice = !CurrentIdent;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">return</span> NextIdent;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">  /// Return an `struct ident_t*` value that represents the ones used in the</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">  /// calls of \p RFI inside of \p F. If \p GlobalOnly is true, we will not</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">  /// return a local `struct ident_t*`. For now, if we cannot find a suitable</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">  /// return value we create one from scratch. We also do not yet combine</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">  /// information, e.g., the source locations, see combinedIdentStruct.</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  getCombinedIdentFromCallUsesIn(OMPInformationCache::RuntimeFunctionInfo &amp;RFI,</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                                 <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keywordtype">bool</span> GlobalOnly) {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordtype">bool</span> SingleChoice = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ident = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keyword">auto</span> CombineIdentStruct = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Caller) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U, &amp;RFI);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="keywordflow">if</span> (!CI || &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> != &amp;Caller)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      Ident = combinedIdentStruct(Ident, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0),</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                                  <span class="comment">/* GlobalOnly */</span> <span class="keyword">true</span>, SingleChoice);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    };</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, CombineIdentStruct);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">if</span> (!Ident || !SingleChoice) {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="comment">// The IRBuilder uses the insertion block to get to the module, this is</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="comment">// unfortunate but we work around it for now.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <span class="keywordflow">if</span> (!OMPInfoCache.OMPBuilder.getInsertionPoint().getBlock())</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        OMPInfoCache.OMPBuilder.updateToLocation(<a class="code" href="classllvm_1_1OpenMPIRBuilder.html#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a>(</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock(), <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().begin()));</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="comment">// Create a fallback location if non was found.</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="comment">// TODO: Use the debug locations of the calls instead.</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> SrcLocStrSize;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Loc =</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;          OMPInfoCache.OMPBuilder.getOrCreateDefaultSrcLocStr(SrcLocStrSize);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      Ident = OMPInfoCache.OMPBuilder.getOrCreateIdent(Loc, SrcLocStrSize);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">return</span> Ident;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">  /// Try to eliminate calls of \p RFI in \p F by reusing an existing one or</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">  /// \p ReplVal if given.</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> deduplicateRuntimeCalls(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                               OMPInformationCache::RuntimeFunctionInfo &amp;RFI,</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                               <a class="code" href="classllvm_1_1Value.html">Value</a> *ReplVal = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keyword">auto</span> *UV = RFI.getUseVector(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (!UV || UV-&gt;size() + (ReplVal != <span class="keyword">nullptr</span>) &lt; 2)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Deduplicate &quot;</span> &lt;&lt; UV-&gt;size() &lt;&lt; <span class="stringliteral">&quot; uses of &quot;</span> &lt;&lt; RFI.Name</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;               &lt;&lt; (ReplVal ? <span class="stringliteral">&quot; with an existing value\n&quot;</span> : <span class="stringliteral">&quot;\n&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!ReplVal || (isa&lt;Argument&gt;(ReplVal) &amp;&amp;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                         cast&lt;Argument&gt;(ReplVal)-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>() == &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &amp;&amp;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;           <span class="stringliteral">&quot;Unexpected replacement value!&quot;</span>);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// TODO: Use dominance to find a good position instead.</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keyword">auto</span> CanBeMoved = [<span class="keyword">this</span>](<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="keywordtype">unsigned</span> NumArgs = CB.arg_size();</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordflow">if</span> (NumArgs == 0)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordflow">if</span> (CB.getArgOperand(0)-&gt;getType() != OMPInfoCache.OMPBuilder.IdentPtr)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> U = 1; U &lt; NumArgs; ++U)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keywordflow">if</span> (isa&lt;Instruction&gt;(CB.getArgOperand(U)))</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    };</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">if</span> (!ReplVal) {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> *U : *UV)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(*U, &amp;RFI)) {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;          <span class="keywordflow">if</span> (!CanBeMoved(*CI))</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          <span class="comment">// If the function is a kernel, dedup will move</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;          <span class="comment">// the runtime call right after the kernel init callsite. Otherwise,</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          <span class="comment">// it will move it to the beginning of the caller function.</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU.html#a3cc437d6699fb55c69e78b5d0cad641d">isKernel</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <span class="keyword">auto</span> &amp;KernelInitRFI = OMPInfoCache.RFIs[OMPRTL___kmpc_target_init];</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            <span class="keyword">auto</span> *KernelInitUV = KernelInitRFI.getUseVector(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            <span class="keywordflow">if</span> (KernelInitUV-&gt;empty())</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; </div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KernelInitUV-&gt;size() == 1 &amp;&amp;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                   <span class="stringliteral">&quot;Expected a single __kmpc_target_init in kernel\n&quot;</span>);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *KernelInitCI =</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                getCallIfRegularCall(*KernelInitUV-&gt;front(), &amp;KernelInitRFI);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KernelInitCI &amp;&amp;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                   <span class="stringliteral">&quot;Expected a call to __kmpc_target_init in kernel\n&quot;</span>);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            CI-&gt;moveAfter(KernelInitCI);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;          } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            CI-&gt;moveBefore(&amp;*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().getFirstInsertionPt());</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          ReplVal = CI;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      <span class="keywordflow">if</span> (!ReplVal)</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">// If we use a call as a replacement value we need to make sure the ident is</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// valid at the new location. For now we just pick a global one, either</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// existing and used by one of the calls, or created from scratch.</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CI = dyn_cast&lt;CallBase&gt;(ReplVal)) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordflow">if</span> (!CI-&gt;arg_empty() &amp;&amp;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          CI-&gt;getArgOperand(0)-&gt;getType() == OMPInfoCache.OMPBuilder.IdentPtr) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Ident = getCombinedIdentFromCallUsesIn(RFI, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                                      <span class="comment">/* GlobalOnly */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        CI-&gt;setArgOperand(0, Ident);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keyword">auto</span> ReplaceAndDeleteCB = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Caller) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U, &amp;RFI);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordflow">if</span> (!CI || CI == ReplVal || &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> != &amp;Caller)</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>() == &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; <span class="stringliteral">&quot;Unexpected call!&quot;</span>);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;OpenMP runtime call &quot;</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                  &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;OpenMPOptRuntime&quot;</span>, RFI.Name) &lt;&lt; <span class="stringliteral">&quot; deduplicated.&quot;</span>;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      };</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>())</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        emitRemark&lt;OptimizationRemark&gt;(CI, <span class="stringliteral">&quot;OMP170&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        emitRemark&lt;OptimizationRemark&gt;(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;OMP170&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      CGUpdater.<a class="code" href="classllvm_1_1CallGraphUpdater.html#a30a1e8841e6804516ec420786dbbc398">removeCallSite</a>(*CI);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(ReplVal);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      ++NumOpenMPRuntimeCallsDeduplicated;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    };</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, ReplaceAndDeleteCB);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">  /// Collect arguments that represent the global thread id in \p GTIdArgs.</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> collectGlobalThreadIdArguments(<a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;Value *, 16&gt;</a> &amp;GTIdArgs) {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">// TODO: Below we basically perform a fixpoint iteration with a pessimistic</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="comment">//       initialization. We could define an AbstractAttribute instead and</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">//       run the Attributor here once it can be run as an SCC pass.</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; </div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="comment">// Helper to check the argument \p ArgNo at all call sites of \p F for</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">// a GTId.</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keyword">auto</span> CallArgOpIsGTId = [&amp;](<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keywordtype">unsigned</span> ArgNo, <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;RefCI) {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasLocalLinkage())</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.uses()) {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U)) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *ArgOp = CI-&gt;getArgOperand(ArgNo);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;          <span class="keywordflow">if</span> (CI == &amp;RefCI || GTIdArgs.<a class="code" href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">count</a>(ArgOp) ||</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;              getCallIfRegularCall(</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                  *ArgOp, &amp;OMPInfoCache.RFIs[OMPRTL___kmpc_global_thread_num]))</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    };</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">// Helper to identify uses of a GTId as GTId arguments.</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keyword">auto</span> AddUserArgs = [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> &amp;GTId) {</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : GTId.uses())</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>()))</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;          <span class="keywordflow">if</span> (CI-&gt;isArgOperand(&amp;U))</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;getCalledFunction())</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;              <span class="keywordflow">if</span> (CallArgOpIsGTId(*<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, U.<a class="code" href="classllvm_1_1Use.html#a541187eb976df2189b40b3f62ed2cee0">getOperandNo</a>(), *CI))</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                GTIdArgs.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getArg(U.<a class="code" href="classllvm_1_1Use.html#a541187eb976df2189b40b3f62ed2cee0">getOperandNo</a>()));</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    };</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">// The argument users of __kmpc_global_thread_num calls are GTIds.</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;GlobThreadNumRFI =</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_global_thread_num];</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    GlobThreadNumRFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = getCallIfRegularCall(U, &amp;GlobThreadNumRFI))</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        AddUserArgs(*CI);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    });</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">// Transitively search for more arguments by looking at the users of the</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// ones we know already. During the search the GTIdArgs vector is extended</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// so we cannot cache the size nor can we use a range based for.</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> U = 0; U &lt; GTIdArgs.<a class="code" href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">size</a>(); ++U)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      AddUserArgs(*GTIdArgs[U]);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">  /// Kernel (=GPU) optimizations and utility functions</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">  ///{{</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">  /// Check if \p F is a kernel, hence entry point for target offloading.</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1AMDGPU.html#a3cc437d6699fb55c69e78b5d0cad641d">isKernel</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) { <span class="keywordflow">return</span> OMPInfoCache.Kernels.count(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>); }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">  /// Cache to remember the unique kernel for a function.</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Function *, std::optional&lt;Kernel&gt;</a>&gt; UniqueKernelMap;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment">  /// Find the unique kernel that will execute \p F, if any.</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Function.html">Kernel</a> getUniqueKernelFor(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">  /// Find the unique kernel that will execute \p I, if any.</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Function.html">Kernel</a> getUniqueKernelFor(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">return</span> getUniqueKernelFor(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getFunction());</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment">  /// Rewrite the device (=GPU) code state machine create in non-SPMD mode in</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">  /// the cases we can avoid taking the address of a function.</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> rewriteDeviceCodeStateMachine();</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">  ///}}</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">  /// Emit a remark generically</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">  /// This template function can be used to generically emit a remark. The</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">  /// RemarkKind should be one of the following:</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment">  ///   - OptimizationRemark to indicate a successful optimization attempt</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">  ///   - OptimizationRemarkMissed to report a failed optimization attempt</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">  ///   - OptimizationRemarkAnalysis to provide additional information about an</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">  ///     optimization attempt</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">  /// The remark is built using a callback function provided by the caller that</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">  /// takes a RemarkKind as input and returns a RemarkKind.</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment"></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> RemarkKind, <span class="keyword">typename</span> RemarkCallBack&gt;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="keywordtype">void</span> emitRemark(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> RemarkName,</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                  RemarkCallBack &amp;&amp;RemarkCB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;getParent();</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keyword">auto</span> &amp;ORE = OREGetter(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="keywordflow">if</span> (RemarkName.<a class="code" href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">startswith</a>(<span class="stringliteral">&quot;OMP&quot;</span>))</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordflow">return</span> RemarkCB(RemarkKind(<a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, RemarkName, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; RemarkName &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      });</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      ORE.emit(</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;          [&amp;]() { <span class="keywordflow">return</span> RemarkCB(RemarkKind(<a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, RemarkName, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)); });</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">  /// Emit a remark on a function.</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment"></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> RemarkKind, <span class="keyword">typename</span> RemarkCallBack&gt;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="keywordtype">void</span> emitRemark(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> RemarkName,</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                  RemarkCallBack &amp;&amp;RemarkCB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keyword">auto</span> &amp;ORE = OREGetter(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordflow">if</span> (RemarkName.<a class="code" href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">startswith</a>(<span class="stringliteral">&quot;OMP&quot;</span>))</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <span class="keywordflow">return</span> RemarkCB(RemarkKind(<a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, RemarkName, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; RemarkName &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      });</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      ORE.emit(</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;          [&amp;]() { <span class="keywordflow">return</span> RemarkCB(RemarkKind(<a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, RemarkName, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)); });</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  }</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">  /// The underlying module.</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">  /// The SCC we are operating on.</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">  /// Callback to update the call graph, the first argument is a removed call,</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">  /// the second an optional replacement call.</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1CallGraphUpdater.html">CallGraphUpdater</a> &amp;CGUpdater;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">  /// Callback to get an OptimizationRemarkEmitter from a Function *</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment"></span>  OptimizationRemarkGetter OREGetter;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">  /// OpenMP-specific information cache. Also Used for Attributor runs.</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment"></span>  OMPInformationCache &amp;OMPInfoCache;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment">  /// Attributor instance.</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment"></span>  <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">  /// Helper function to run Attributor on SCC.</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> runAttributor(<span class="keywordtype">bool</span> IsModulePass) {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.empty())</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    registerAAs(IsModulePass);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = A.run();</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; </div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;[Attributor] Done with &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.size()</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; functions, result: &quot;</span> &lt;&lt; Changed &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordflow">return</span> Changed == <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="keywordtype">void</span> registerFoldRuntimeCall(<a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RF);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment">  /// Populate the Attributor with abstract attribute opportunities in the</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">  /// functions.</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> registerAAs(<span class="keywordtype">bool</span> IsModulePass);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">  /// Callback to register AAs for live functions, including internal functions</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">  /// marked live during the traversal.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">void</span> registerAAsForFunction(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;};</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<a class="code" href="classllvm_1_1Function.html">Kernel</a> OpenMPOpt::getUniqueKernelFor(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordflow">if</span> (!OMPInfoCache.ModuleSlice.empty() &amp;&amp; !OMPInfoCache.ModuleSlice.count(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="comment">// Use a scope to keep the lifetime of the CachedKernel short.</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    std::optional&lt;Kernel&gt; &amp;CachedKernel = UniqueKernelMap[&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>];</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">if</span> (CachedKernel)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keywordflow">return</span> *CachedKernel;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">// TODO: We should use an AA to create an (optimistic and callback</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">//       call-aware) call graph. For now we stick to simple patterns that</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">//       are less powerful, basically the worst fixpoint.</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU.html#a3cc437d6699fb55c69e78b5d0cad641d">isKernel</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      CachedKernel = <a class="code" href="namespacellvm_1_1omp.html#a9ecb71ea2b9e2a17b205ca3c03fb5a9d">Kernel</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">return</span> *CachedKernel;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    CachedKernel = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasLocalLinkage()) {</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="comment">// See https://openmp.llvm.org/remarks/OptimizationRemarks.html</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;Potentially unknown OpenMP target region caller.&quot;</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      };</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      emitRemark&lt;OptimizationRemarkAnalysis&gt;(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;OMP100&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; </div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  }</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keyword">auto</span> GetUniqueKernelForUse = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) -&gt; <a class="code" href="classllvm_1_1Function.html">Kernel</a> {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Cmp = dyn_cast&lt;ICmpInst&gt;(U.getUser())) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <span class="comment">// Allow use in equality comparisons.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keywordflow">if</span> (Cmp-&gt;isEquality())</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">return</span> getUniqueKernelFor(*Cmp);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(U.getUser())) {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="comment">// Allow direct calls.</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordflow">if</span> (CB-&gt;isCallee(&amp;U))</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="keywordflow">return</span> getUniqueKernelFor(*CB);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      OMPInformationCache::RuntimeFunctionInfo &amp;KernelParallelRFI =</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;          OMPInfoCache.RFIs[OMPRTL___kmpc_parallel_51];</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="comment">// Allow the use in __kmpc_parallel_51 calls.</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keywordflow">if</span> (OpenMPOpt::getCallIfRegularCall(*U.getUser(), &amp;KernelParallelRFI))</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">return</span> getUniqueKernelFor(*CB);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// Disallow every other use.</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  };</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="comment">// TODO: In the future we want to track more than just a unique kernel.</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Kernel, 2&gt;</a> PotentialKernels;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  OMPInformationCache::foreachUse(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    PotentialKernels.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(GetUniqueKernelForUse(U));</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  });</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Kernel</a> K = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keywordflow">if</span> (PotentialKernels.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() == 1)</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    K = *PotentialKernels.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>();</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="comment">// Cache the result.</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  UniqueKernelMap[&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>] = K;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">return</span> K;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;}</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="keywordtype">bool</span> OpenMPOpt::rewriteDeviceCodeStateMachine() {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  OMPInformationCache::RuntimeFunctionInfo &amp;KernelParallelRFI =</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      OMPInfoCache.RFIs[OMPRTL___kmpc_parallel_51];</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordflow">if</span> (!KernelParallelRFI)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="comment">// If we have disabled state machine changes, exit</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#aa9760ec3616ef020c7356dfc24a5cd7f">DisableOpenMPOptStateMachineRewrite</a>)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>) {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">// Check if the function is a use in a __kmpc_parallel_51 call at</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="comment">// all.</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordtype">bool</span> UnknownUse = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordtype">bool</span> KernelParallelUse = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordtype">unsigned</span> NumDirectCalls = 0;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Use *, 2&gt;</a> ToBeReplacedStateMachineUses;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    OMPInformationCache::foreachUse(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>()))</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a> (CB-&gt;isCallee(&amp;U)) {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;          ++NumDirectCalls;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;          return;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a> (isa&lt;ICmpInst&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>())) {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        ToBeReplacedStateMachineUses.push_back(&amp;U);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        return;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      <span class="comment">// Find wrapper functions that represent parallel kernels.</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI =</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;          OpenMPOpt::getCallIfRegularCall(*U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>(), &amp;KernelParallelRFI);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> WrapperFunctionArgNo = 6;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a> (!KernelParallelUse &amp;&amp; CI &amp;&amp;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;          CI-&gt;getArgOperandNo(&amp;U) == WrapperFunctionArgNo) {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        KernelParallelUse = true;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        ToBeReplacedStateMachineUses.push_back(&amp;U);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        return;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      UnknownUse = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    });</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// Do not emit a remark if we haven&#39;t seen a __kmpc_parallel_51</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">// use.</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">if</span> (!KernelParallelUse)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="comment">// If this ever hits, we should investigate.</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="comment">// TODO: Checking the number of uses is not a necessary restriction and</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="comment">// should be lifted.</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">if</span> (UnknownUse || NumDirectCalls != 1 ||</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        ToBeReplacedStateMachineUses.size() &gt; 2) {</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;Parallel region is used in &quot;</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                   &lt;&lt; (UnknownUse ? <span class="stringliteral">&quot;unknown&quot;</span> : <span class="stringliteral">&quot;unexpected&quot;</span>)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; ways. Will not attempt to rewrite the state machine.&quot;</span>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      };</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      emitRemark&lt;OptimizationRemarkAnalysis&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;OMP101&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="comment">// Even if we have __kmpc_parallel_51 calls, we (for now) give</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="comment">// up if the function is not called from a unique kernel.</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Kernel</a> K = getUniqueKernelFor(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">if</span> (!K) {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;Parallel region is not called from a unique kernel. &quot;</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                      <span class="stringliteral">&quot;Will not attempt to rewrite the state machine.&quot;</span>;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      };</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      emitRemark&lt;OptimizationRemarkAnalysis&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;OMP102&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">// We now know F is a parallel body function called only from the kernel K.</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">// We also identified the state machine uses in which we replace the</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">// function pointer by a new global symbol for identification purposes. This</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="comment">// ensures only direct calls to the function are left.</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getParent();</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8Ty = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext());</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Int8Ty, <span class="comment">/* isConstant */</span> <span class="keyword">true</span>, <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">GlobalValue::PrivateLinkage</a>,</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Int8Ty), <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName() + <span class="stringliteral">&quot;.ID&quot;</span>);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> *U : ToBeReplacedStateMachineUses)</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      U-&gt;set(<a class="code" href="classllvm_1_1ConstantExpr.html#a28bf8984fbfb08fd27df435e631e6832">ConstantExpr::getPointerBitCastOrAddrSpaceCast</a>(</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;          <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>, U-&gt;get()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    ++NumOpenMPParallelRegionsReplacedInGPUStateMachine;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160; </div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;}</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">/// Abstract Attribute for tracking ICV values.</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment"></span><span class="keyword">struct </span>AAICVTracker : <span class="keyword">public</span> <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper</a>&lt;BooleanState, AbstractAttribute&gt; {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper&lt;BooleanState, AbstractAttribute&gt;</a>;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  AAICVTracker(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) : <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>(IRP) {}</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> || !A.isFunctionIPOAmendable(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">  /// Returns true if value is assumed to be tracked.</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isAssumedTracked()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> getAssumed(); }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">  /// Returns true if value is known to be tracked.</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isKnownTracked()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> getAssumed(); }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">  /// Create an abstract attribute biew for the position \p IRP.</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> AAICVTracker &amp;createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">  /// Return the value with which \p I can be replaced for specific \p ICV.</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> std::optional&lt;Value *&gt; getReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV,</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                                     <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">  /// Return an assumed unique ICV value if a single candidate is found. If</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">  /// there cannot be one, return a nullptr. If it is not clear yet, return</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">  /// std::nullopt.</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> std::optional&lt;Value *&gt;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  getUniqueReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="comment">// Currently only nthreads is being tracked.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="comment">// this array will only grow with time.</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> TrackableICVs[1] = {ICV_nthreads};</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">  /// See AbstractAttribute::getName()</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> std::string <a class="code" href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;AAICVTracker&quot;</span>; }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">  /// See AbstractAttribute::getIdAddr()</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *getIdAddr()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment">  /// This function should return true if the type of the \p AA is AAICVTracker</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA) {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">return</span> (AA-&gt;<a class="code" href="structllvm_1_1AbstractAttribute.html#af34bd448298e7021ee074394446795f2">getIdAddr</a>() == &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;};</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="keyword">struct </span>AAICVTrackerFunction : <span class="keyword">public</span> AAICVTracker {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  AAICVTrackerFunction(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      : AAICVTracker(IRP, A) {}</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="comment">// FIXME: come up with better string.</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;ICVTrackerFunction&quot;</span>; }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="comment">// FIXME: come up with some stats.</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">  /// We don&#39;t manifest anything for this AA.</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="comment">// Map of ICV to their values at specific program point.</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <a class="code" href="classllvm_1_1EnumeratedArray.html">EnumeratedArray&lt;DenseMap&lt;Instruction *, Value *&gt;</a>, <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a>,</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                  InternalControlVar::ICV___last&gt;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      ICVReplacementValuesMap;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> HasChanged = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(A.getInfoCache());</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV : TrackableICVs) {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      <span class="keyword">auto</span> &amp;SetterRFI = OMPInfoCache.RFIs[OMPInfoCache.ICVs[ICV].Setter];</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      <span class="keyword">auto</span> &amp;ValuesMap = ICVReplacementValuesMap[ICV];</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      <span class="keyword">auto</span> TrackValues = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;) {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = OpenMPOpt::getCallIfRegularCall(U);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <span class="keywordflow">if</span> (!CI)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="comment">// FIXME: handle setters with more that 1 arguments.</span><span class="comment"></span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">        /// Track new value.</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment"></span>        <span class="keywordflow">if</span> (ValuesMap.insert(std::make_pair(CI, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0))).second)</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;          HasChanged = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      };</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      <span class="keyword">auto</span> CallCheck = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        std::optional&lt;Value *&gt; ReplVal = getValueForCall(A, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ICV);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keywordflow">if</span> (ReplVal &amp;&amp; ValuesMap.insert(std::make_pair(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *ReplVal)).second)</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;          HasChanged = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      };</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="comment">// Track all changes of an ICV.</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      SetterRFI.foreachUse(TrackValues, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordtype">bool</span> UsedAssumedInformation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      A.checkForAllInstructions(CallCheck, *<span class="keyword">this</span>, {<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Instruction::Call</a>},</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                                UsedAssumedInformation,</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                                <span class="comment">/* CheckBBLivenessOnly */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">      /// TODO: Figure out a way to avoid adding entry in</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">      /// ICVReplacementValuesMap</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment"></span>      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Entry = &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock().front();</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keywordflow">if</span> (HasChanged == <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a> &amp;&amp; !ValuesMap.count(Entry))</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        ValuesMap.insert(std::make_pair(Entry, <span class="keyword">nullptr</span>));</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordflow">return</span> HasChanged;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">  /// Helper to check if \p I is a call and get the value for it if it is</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">  /// unique.</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment"></span>  std::optional&lt;Value *&gt; getValueForCall(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                         <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> &amp;ICV)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keywordflow">if</span> (!CB || CB-&gt;hasFnAttr(<span class="stringliteral">&quot;no_openmp&quot;</span>) ||</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        CB-&gt;hasFnAttr(<span class="stringliteral">&quot;no_openmp_routines&quot;</span>))</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(A.getInfoCache());</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keyword">auto</span> &amp;GetterRFI = OMPInfoCache.RFIs[OMPInfoCache.ICVs[ICV].Getter];</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keyword">auto</span> &amp;SetterRFI = OMPInfoCache.RFIs[OMPInfoCache.ICVs[ICV].Setter];</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *CalledFunction = CB-&gt;getCalledFunction();</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">// Indirect call, assume ICV changes.</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">if</span> (CalledFunction == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">if</span> (CalledFunction == GetterRFI.Declaration)</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordflow">if</span> (CalledFunction == SetterRFI.Declaration) {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keywordflow">if</span> (ICVReplacementValuesMap[ICV].<a class="code" href="namespacellvm.html#ab1772fd431decccb7926d484ea223db7">count</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">return</span> ICVReplacementValuesMap[ICV].<a class="code" href="InlineInfo_8cpp.html#a5db99f4b7f8744e0b1c8b50dba8ec5a2">lookup</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    }</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="comment">// Since we don&#39;t know, assume it changes the ICV.</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordflow">if</span> (CalledFunction-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">isDeclaration</a>())</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ICVTrackingAA = A.getAAFor&lt;AAICVTracker&gt;(</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a22b55f73ab4057a8c3da9f32bd582f4b">IRPosition::callsite_returned</a>(*CB), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">if</span> (ICVTrackingAA.isAssumedTracked()) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      std::optional&lt;Value *&gt; URV = ICVTrackingAA.getUniqueReplacementValue(ICV);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      <span class="keywordflow">if</span> (!URV || (*URV &amp;&amp; <a class="code" href="namespacellvm_1_1AA.html#a1ec1a38ef077070bf9d3760ddbbcfe24">AA::isValidAtPosition</a>(<a class="code" href="structllvm_1_1AA_1_1ValueAndContext.html">AA::ValueAndContext</a>(**URV, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>),</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                                                 OMPInfoCache)))</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        <span class="keywordflow">return</span> URV;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    }</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="comment">// If we don&#39;t know, assume it changes.</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  }</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="comment">// We don&#39;t check unique value for a function, so return std::nullopt.</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  std::optional&lt;Value *&gt;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  getUniqueReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">  /// Return the value with which \p I can be replaced for specific \p ICV.</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="comment"></span>  std::optional&lt;Value *&gt; getReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV,</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                                             <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ValuesMap = ICVReplacementValuesMap[ICV];</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keywordflow">if</span> (ValuesMap.count(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="keywordflow">return</span> ValuesMap.lookup(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const Instruction *, 16&gt;</a> Worklist;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Instruction *, 16&gt;</a> Visited;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    Worklist.push_back(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    std::optional&lt;Value *&gt; ReplVal;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurrInst = Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(CurrInst).second)</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurrBB = CurrInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="comment">// Go up and look for all potential setters/calls that might change the</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="comment">// ICV.</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="keywordflow">while</span> ((CurrInst = CurrInst-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#ae451867ac0034a201153b54cc466386d">getPrevNode</a>())) {</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordflow">if</span> (ValuesMap.count(CurrInst)) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;          std::optional&lt;Value *&gt; NewReplVal = ValuesMap.lookup(CurrInst);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;          <span class="comment">// Unknown value, track new.</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;          <span class="keywordflow">if</span> (!ReplVal) {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            ReplVal = NewReplVal;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;          }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160; </div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;          <span class="comment">// If we found a new value, we can&#39;t know the icv value anymore.</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;          <span class="keywordflow">if</span> (NewReplVal)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="keywordflow">if</span> (ReplVal != NewReplVal)</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; </div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; </div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        std::optional&lt;Value *&gt; NewReplVal = getValueForCall(A, *CurrInst, ICV);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <span class="keywordflow">if</span> (!NewReplVal)</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="comment">// Unknown value, track new.</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">if</span> (!ReplVal) {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;          ReplVal = NewReplVal;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160; </div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="comment">// if (NewReplVal.hasValue())</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="comment">// We found a new value, we can&#39;t know the icv value anymore.</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        <span class="keywordflow">if</span> (ReplVal != NewReplVal)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <span class="comment">// If we are in the same BB and we have a value, we are done.</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <span class="keywordflow">if</span> (CurrBB == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent() &amp;&amp; ReplVal)</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="keywordflow">return</span> ReplVal;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <span class="comment">// Go through all predecessors and add terminators for analysis.</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(CurrBB))</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023af121d798d2c14b32e81d537a1f0cff8d">Terminator</a> = Pred-&gt;getTerminator())</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;          Worklist.push_back(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023af121d798d2c14b32e81d537a1f0cff8d">Terminator</a>);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordflow">return</span> ReplVal;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;};</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="keyword">struct </span>AAICVTrackerFunctionReturned : AAICVTracker {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  AAICVTrackerFunctionReturned(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      : AAICVTracker(IRP, A) {}</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="comment">// FIXME: come up with better string.</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;ICVTrackerFunctionReturned&quot;</span>;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  }</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; </div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  <span class="comment">// FIXME: come up with some stats.</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">  /// We don&#39;t manifest anything for this AA.</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="comment">// Map of ICV to their values at specific program point.</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <a class="code" href="classllvm_1_1EnumeratedArray.html">EnumeratedArray&lt;std::optional&lt;Value *&gt;</a>, <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a>,</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                  InternalControlVar::ICV___last&gt;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      ICVReplacementValuesMap;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">  /// Return the value with which \p I can be replaced for specific \p ICV.</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment"></span>  std::optional&lt;Value *&gt;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  getUniqueReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="keywordflow">return</span> ICVReplacementValuesMap[ICV];</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  }</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ICVTrackingAA = A.getAAFor&lt;AAICVTracker&gt;(</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*getAnchorScope()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="keywordflow">if</span> (!ICVTrackingAA.isAssumedTracked())</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV : TrackableICVs) {</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      std::optional&lt;Value *&gt; &amp;ReplVal = ICVReplacementValuesMap[ICV];</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      std::optional&lt;Value *&gt; UniqueICVValue;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      <span class="keyword">auto</span> CheckReturnInst = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        std::optional&lt;Value *&gt; NewReplVal =</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;            ICVTrackingAA.getReplacementValue(ICV, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, A);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <span class="comment">// If we found a second ICV value there is no unique returned value.</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <span class="keywordflow">if</span> (UniqueICVValue &amp;&amp; UniqueICVValue != NewReplVal)</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; </div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        UniqueICVValue = NewReplVal;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      };</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <span class="keywordtype">bool</span> UsedAssumedInformation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <span class="keywordflow">if</span> (!A.checkForAllInstructions(CheckReturnInst, *<span class="keyword">this</span>, {<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Instruction::Ret</a>},</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                                     UsedAssumedInformation,</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                                     <span class="comment">/* CheckBBLivenessOnly */</span> <span class="keyword">true</span>))</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        UniqueICVValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <span class="keywordflow">if</span> (UniqueICVValue == ReplVal)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      ReplVal = UniqueICVValue;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  }</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;};</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="keyword">struct </span>AAICVTrackerCallSite : AAICVTracker {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  AAICVTrackerCallSite(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      : AAICVTracker(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> || !<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.isFunctionIPOAmendable(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; </div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="comment">// We only initialize this AA for getters, so we need to know which ICV it</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="comment">// gets.</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV : TrackableICVs) {</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keyword">auto</span> ICVInfo = OMPInfoCache.ICVs[ICV];</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <span class="keyword">auto</span> &amp;Getter = OMPInfoCache.RFIs[ICVInfo.Getter];</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="keywordflow">if</span> (Getter.Declaration == getAssociatedFunction()) {</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        AssociatedICV = ICVInfo.Kind;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">    /// Unknown ICV.</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment"></span>    indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (!ReplVal || !*ReplVal)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeAfterManifest(<a class="code" href="structllvm_1_1IRPosition.html#a4a67bf6ab49ae2630d14e3159ef51cf4">IRPosition::inst</a>(*getCtxI()), **ReplVal);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(*getCtxI());</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  }</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="comment">// FIXME: come up with better string.</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;ICVTrackerCallSite&quot;</span>; }</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  <span class="comment">// FIXME: come up with some stats.</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> AssociatedICV;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  std::optional&lt;Value *&gt; ReplVal;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ICVTrackingAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAICVTracker&gt;(</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*getAnchorScope()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="comment">// We don&#39;t have any information, so we assume it changes the ICV.</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keywordflow">if</span> (!ICVTrackingAA.isAssumedTracked())</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160; </div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    std::optional&lt;Value *&gt; NewReplVal =</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        ICVTrackingAA.getReplacementValue(AssociatedICV, getCtxI(), <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">if</span> (ReplVal == NewReplVal)</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    ReplVal = NewReplVal;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  }</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160; </div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="comment">// Return the value with which associated value can be replaced for specific</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  <span class="comment">// \p ICV.</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  std::optional&lt;Value *&gt;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  getUniqueReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keywordflow">return</span> ReplVal;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;};</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160; </div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="keyword">struct </span>AAICVTrackerCallSiteReturned : AAICVTracker {</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  AAICVTrackerCallSiteReturned(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      : AAICVTracker(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="comment">// FIXME: come up with better string.</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;ICVTrackerCallSiteReturned&quot;</span>;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  }</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  <span class="comment">// FIXME: come up with some stats.</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">  /// We don&#39;t manifest anything for this AA.</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  }</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <span class="comment">// Map of ICV to their values at specific program point.</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  <a class="code" href="classllvm_1_1EnumeratedArray.html">EnumeratedArray&lt;std::optional&lt;Value *&gt;</a>, <a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a>,</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                  InternalControlVar::ICV___last&gt;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      ICVReplacementValuesMap;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">  /// Return the value with which associated value can be replaced for specific</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">  /// \p ICV.</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment"></span>  std::optional&lt;Value *&gt;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  getUniqueReplacementValue(<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="keywordflow">return</span> ICVReplacementValuesMap[ICV];</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ICVTrackingAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAICVTracker&gt;(</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a2422bd05c002b7bb1686feaa13f08acd">IRPosition::returned</a>(*getAssociatedFunction()),</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="comment">// We don&#39;t have any information, so we assume it changes the ICV.</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="keywordflow">if</span> (!ICVTrackingAA.isAssumedTracked())</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a> ICV : TrackableICVs) {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      std::optional&lt;Value *&gt; &amp;ReplVal = ICVReplacementValuesMap[ICV];</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      std::optional&lt;Value *&gt; NewReplVal =</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;          ICVTrackingAA.getUniqueReplacementValue(ICV);</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      <span class="keywordflow">if</span> (ReplVal == NewReplVal)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      ReplVal = NewReplVal;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  }</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;};</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160; </div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="keyword">struct </span>AAExecutionDomainFunction : <span class="keyword">public</span> <a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a> {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  AAExecutionDomainFunction(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      : <a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a>(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160; </div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;  ~AAExecutionDomainFunction() { <span class="keyword">delete</span> RPOT; }</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; </div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="keywordflow">if</span> (getAnchorScope()-&gt;isDeclaration()) {</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;      indicatePessimisticFixpoint();</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    }</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    RPOT = <span class="keyword">new</span> <a class="code" href="classllvm_1_1ReversePostOrderTraversal.html">ReversePostOrderTraversal&lt;Function *&gt;</a>(getAnchorScope());</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  }</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; </div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keywordtype">unsigned</span> TotalBlocks = 0, InitialThreadBlocks = 0;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;It : BEDMap) {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      TotalBlocks++;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      InitialThreadBlocks += It.getSecond().IsExecutedByInitialThreadOnly;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    }</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;[AAExecutionDomain] &quot;</span> + <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(InitialThreadBlocks) + <span class="stringliteral">&quot;/&quot;</span> +</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;           <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(TotalBlocks) + <span class="stringliteral">&quot; executed by initial thread only&quot;</span>;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment">  /// See AbstractAttribute::trackStatistics().</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : *getAnchorScope()) {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        <span class="keywordflow">if</span> (!isExecutedByInitialThreadOnly(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot; Basic block @&quot;</span> &lt;&lt; getAnchorScope()-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;               &lt;&lt; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getName() &lt;&lt; <span class="stringliteral">&quot; is executed by a single thread.\n&quot;</span>;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      }</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    });</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a3a6f2f61e22ec48ea9a7314c82412d69">DisableOpenMPOptBarrierElimination</a>)</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;CallBase *, 16&gt;</a> DeletedBarriers;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keyword">auto</span> HandleAlignedBarrier = [&amp;](<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB) {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <span class="keyword">const</span> ExecutionDomainTy &amp;ED = CEDMap[CB];</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="keywordflow">if</span> (!ED.IsReachedFromAlignedBarrierOnly ||</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;          ED.EncounteredNonLocalSideEffect)</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;      <span class="comment">// We can remove this barrier, if it is one, or all aligned barriers</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      <span class="comment">// reaching the kernel end. In the latter case we can transitively work</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      <span class="comment">// our way back until we find a barrier that guards a side-effect if we</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="comment">// are dealing with the kernel end here.</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keywordflow">if</span> (CB) {</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        DeletedBarriers.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(CB);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(*CB);</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        ++NumBarriersEliminated;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ED.AlignedBarriers.empty()) {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        NumBarriersEliminated += ED.AlignedBarriers.size();</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallBase *&gt;</a> Worklist(ED.AlignedBarriers.begin(),</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                                         ED.AlignedBarriers.end());</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;CallBase *, 16&gt;</a> Visited;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;          <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *LastCB = Worklist.pop_back_val();</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;          <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(LastCB))</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;          <span class="keywordflow">if</span> (!DeletedBarriers.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(LastCB)) {</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;            <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(*LastCB);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;          }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;          <span class="comment">// The final aligned barrier (LastCB) reaching the kernel end was</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;          <span class="comment">// removed already. This means we can go one step further and remove</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;          <span class="comment">// the barriers encoutered last before (LastCB).</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;          <span class="keyword">const</span> ExecutionDomainTy &amp;LastED = CEDMap[LastCB];</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;          Worklist.append(LastED.AlignedBarriers.begin(),</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                          LastED.AlignedBarriers.end());</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      <span class="comment">// If we actually eliminated a barrier we need to eliminate the associated</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      <span class="comment">// llvm.assumes as well to avoid creating UB.</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <span class="keywordflow">if</span> (!ED.EncounteredAssumes.empty() &amp;&amp; (CB || !ED.AlignedBarriers.empty()))</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *AssumeCB : ED.EncounteredAssumes)</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;          <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(*AssumeCB);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    };</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CB : AlignedBarriers)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      HandleAlignedBarrier(CB);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="comment">// Handle the &quot;kernel end barrier&quot; for kernels too.</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keywordflow">if</span> (OMPInfoCache.Kernels.count(getAnchorScope()))</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      HandleAlignedBarrier(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  }</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="comment">  /// Merge barrier and assumption information from \p PredED into the successor</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="comment">  /// \p ED.</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  mergeInPredecessorBarriersAndAssumptions(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, ExecutionDomainTy &amp;ED,</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                                           <span class="keyword">const</span> ExecutionDomainTy &amp;PredED);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">  /// Merge all information from \p PredED into the successor \p ED. If</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">  /// \p InitialEdgeOnly is set, only the initial edge will enter the block</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment">  /// represented by \p ED from this predecessor.</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> mergeInPredecessor(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, ExecutionDomainTy &amp;ED,</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                          <span class="keyword">const</span> ExecutionDomainTy &amp;PredED,</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                          <span class="keywordtype">bool</span> InitialEdgeOnly = <span class="keyword">false</span>);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">  /// Accumulate information for the entry block in \p EntryBBED.</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> handleEntryBB(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, ExecutionDomainTy &amp;EntryBBED);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">  /// See AbstractAttribute::updateImpl.</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) <span class="keyword">override</span>;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">  /// Query interface, see AAExecutionDomain</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">  ///{</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isExecutedByInitialThreadOnly(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="keywordflow">if</span> (!isValidState())</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="keywordflow">return</span> BEDMap.lookup(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>).IsExecutedByInitialThreadOnly;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  }</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="keywordtype">bool</span> isExecutedInAlignedRegion(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A,</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getFunction() == getAnchorScope() &amp;&amp;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;           <span class="stringliteral">&quot;Instruction is out of scope!&quot;</span>);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    <span class="keywordflow">if</span> (!isValidState())</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurI;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; </div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">// Check forward until a call or the block end is reached.</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    CurI = &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(CurI);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="keywordflow">if</span> (CB != &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &amp;&amp; AlignedBarriers.contains(<span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *<span class="keyword">&gt;</span>(CB))) {</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      }</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;It = CEDMap.find(CB);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keywordflow">if</span> (It == CEDMap.end())</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      <span class="keywordflow">if</span> (!It-&gt;getSecond().IsReachingAlignedBarrierOnly)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    } <span class="keywordflow">while</span> ((CurI = CurI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a91bd28adea418a08cec78b72413d9d45">getNextNonDebugInstruction</a>()));</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="keywordflow">if</span> (!CurI &amp;&amp; !BEDMap.lookup(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()).IsReachingAlignedBarrierOnly)</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="comment">// Check backward until a call or the block beginning is reached.</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    CurI = &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(CurI);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <span class="keywordflow">if</span> (CB != &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &amp;&amp; AlignedBarriers.contains(<span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *<span class="keyword">&gt;</span>(CB))) {</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      }</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;It = CEDMap.find(CB);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      <span class="keywordflow">if</span> (It == CEDMap.end())</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1AA.html#add4df090e923f2fe0dceeb0c60e5f74b">AA::isNoSyncInst</a>(A, *CB, *<span class="keyword">this</span>)) {</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        <span class="keywordflow">if</span> (It-&gt;getSecond().IsReachedFromAlignedBarrierOnly) {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        }</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CB-&gt;getCalledFunction();</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <span class="keywordflow">if</span> (!Callee || <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isDeclaration())</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;EDAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a>&gt;(</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;          *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*Callee), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      <span class="keywordflow">if</span> (!EDAA.getState().isValidState())</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <span class="keywordflow">if</span> (!EDAA.getFunctionExecutionDomain().IsReachedFromAlignedBarrierOnly)</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    } <span class="keywordflow">while</span> ((CurI = CurI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a512494b857b0644c1f722531e3ee5495">getPrevNonDebugInstruction</a>()));</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160; </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="keywordflow">if</span> (!CurI &amp;&amp;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        !<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a>(</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()), [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PredBB) {</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;              return BEDMap.lookup(PredBB).IsReachedFromAlignedBarrierOnly;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            })) {</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    }</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="comment">// On neither traversal we found a anything but aligned barriers.</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  }</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160; </div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  ExecutionDomainTy getExecutionDomain(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isValidState() &amp;&amp;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;           <span class="stringliteral">&quot;No request should be made against an invalid state!&quot;</span>);</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <span class="keywordflow">return</span> BEDMap.lookup(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;  }</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  ExecutionDomainTy getExecutionDomain(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isValidState() &amp;&amp;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;           <span class="stringliteral">&quot;No request should be made against an invalid state!&quot;</span>);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="keywordflow">return</span> CEDMap.lookup(&amp;CB);</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  ExecutionDomainTy getFunctionExecutionDomain()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isValidState() &amp;&amp;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;           <span class="stringliteral">&quot;No request should be made against an invalid state!&quot;</span>);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="keywordflow">return</span> BEDMap.lookup(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  }<span class="comment"></span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">  ///}</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <span class="comment">// Check if the edge into the successor block contains a condition that only</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <span class="comment">// lets the main thread execute it.</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> isInitialThreadOnlyEdge(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *Edge,</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;SuccessorBB) {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="keywordflow">if</span> (!Edge || !Edge-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>())</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keywordflow">if</span> (Edge-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0) != &amp;SuccessorBB)</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = dyn_cast&lt;CmpInst&gt;(Edge-&gt;<a class="code" href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">getCondition</a>());</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordflow">if</span> (!Cmp || !<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;isTrueWhenEqual() || !<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;isEquality())</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160; </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(1));</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="comment">// Match: -1 == __kmpc_target_init (for non-SPMD kernels only!)</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isAllOnesValue()) {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(0));</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <span class="keyword">auto</span> &amp;RFI = OMPInfoCache.RFIs[OMPRTL___kmpc_target_init];</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      CB = CB ? OpenMPOpt::getCallIfRegularCall(*CB, &amp;RFI) : nullptr;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> InitModeArgNo = 1;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keyword">auto</span> *ModeCI = dyn_cast&lt;ConstantInt&gt;(CB-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(InitModeArgNo));</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <span class="keywordflow">return</span> ModeCI &amp;&amp; (ModeCI-&gt;getSExtValue() &amp; <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430afa583a38ff705195c9bce9dec0c5eff8">OMP_TGT_EXEC_MODE_GENERIC</a>);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    }</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160; </div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isZero()) {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      <span class="comment">// Match: 0 == llvm.nvvm.read.ptx.sreg.tid.x()</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(0)))</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == Intrinsic::nvvm_read_ptx_sreg_tid_x)</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      <span class="comment">// Match: 0 == llvm.amdgcn.workitem.id.x()</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(0)))</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == Intrinsic::amdgcn_workitem_id_x)</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    }</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  };</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment">  /// Mapping containing information per block.</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const BasicBlock *, ExecutionDomainTy&gt;</a> BEDMap;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const CallBase *, ExecutionDomainTy&gt;</a> CEDMap;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;CallBase *, 16&gt;</a> AlignedBarriers;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <a class="code" href="classllvm_1_1ReversePostOrderTraversal.html">ReversePostOrderTraversal&lt;Function *&gt;</a> *RPOT = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;};</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="keywordtype">void</span> AAExecutionDomainFunction::mergeInPredecessorBarriersAndAssumptions(</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, ExecutionDomainTy &amp;ED, <span class="keyword">const</span> ExecutionDomainTy &amp;PredED) {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *EA : PredED.EncounteredAssumes)</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    ED.addAssumeInst(A, *EA);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *AB : PredED.AlignedBarriers)</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    ED.addAlignedBarrier(A, *AB);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;}</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="keywordtype">void</span> AAExecutionDomainFunction::mergeInPredecessor(</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, ExecutionDomainTy &amp;ED, <span class="keyword">const</span> ExecutionDomainTy &amp;PredED,</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="keywordtype">bool</span> InitialEdgeOnly) {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  ED.IsExecutedByInitialThreadOnly =</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      InitialEdgeOnly || (PredED.IsExecutedByInitialThreadOnly &amp;&amp;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                          ED.IsExecutedByInitialThreadOnly);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160; </div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;  ED.IsReachedFromAlignedBarrierOnly = ED.IsReachedFromAlignedBarrierOnly &amp;&amp;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                                       PredED.IsReachedFromAlignedBarrierOnly;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  ED.EncounteredNonLocalSideEffect =</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      ED.EncounteredNonLocalSideEffect | PredED.EncounteredNonLocalSideEffect;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keywordflow">if</span> (ED.IsReachedFromAlignedBarrierOnly)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    mergeInPredecessorBarriersAndAssumptions(A, ED, PredED);</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    ED.clearAssumeInstAndAlignedBarriers();</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;}</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="keywordtype">void</span> AAExecutionDomainFunction::handleEntryBB(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A,</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                                              ExecutionDomainTy &amp;EntryBBED) {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ExecutionDomainTy&gt;</a> PredExecDomains;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <span class="keyword">auto</span> PredForCallSite = [&amp;](<a class="code" href="classllvm_1_1AbstractCallSite.html">AbstractCallSite</a> ACS) {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;EDAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a>&gt;(</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*ACS.getInstruction()-&gt;getFunction()),</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordflow">if</span> (!EDAA.getState().isValidState())</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    PredExecDomains.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        EDAA.getExecutionDomain(*cast&lt;CallBase&gt;(ACS.getInstruction())));</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  };</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160; </div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="keywordtype">bool</span> AllCallSitesKnown;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.checkForAllCallSites(PredForCallSite, *<span class="keyword">this</span>,</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;                             <span class="comment">/* RequiresAllCallSites */</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                             AllCallSitesKnown)) {</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;PredED : PredExecDomains)</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      mergeInPredecessor(A, EntryBBED, PredED);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="comment">// We could not find all predecessors, so this is either a kernel or a</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="comment">// function with external linkage (or with some other weird uses).</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keywordflow">if</span> (OMPInfoCache.Kernels.count(getAnchorScope())) {</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      EntryBBED.IsExecutedByInitialThreadOnly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      EntryBBED.IsReachedFromAlignedBarrierOnly = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      EntryBBED.EncounteredNonLocalSideEffect = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      EntryBBED.IsExecutedByInitialThreadOnly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      EntryBBED.IsReachedFromAlignedBarrierOnly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      EntryBBED.EncounteredNonLocalSideEffect = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    }</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  }</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="keyword">auto</span> &amp;FnED = BEDMap[<span class="keyword">nullptr</span>];</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  FnED.IsReachingAlignedBarrierOnly &amp;=</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      EntryBBED.IsReachedFromAlignedBarrierOnly;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;}</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> AAExecutionDomainFunction::updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; </div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160; </div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  <span class="comment">// Helper to deal with an aligned barrier encountered during the forward</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  <span class="comment">// traversal. \p CB is the aligned barrier, \p ED is the execution domain when</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  <span class="comment">// it was encountered.</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keyword">auto</span> HandleAlignedBarrier = [&amp;](<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB, ExecutionDomainTy &amp;ED) {</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="keywordflow">if</span> (CB)</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      Changed |= AlignedBarriers.insert(CB);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="comment">// First, update the barrier ED kept in the separate CEDMap.</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keyword">auto</span> &amp;CallED = CEDMap[CB];</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    mergeInPredecessor(A, CallED, ED);</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <span class="comment">// Next adjust the ED we use for the traversal.</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    ED.EncounteredNonLocalSideEffect = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    ED.IsReachedFromAlignedBarrierOnly = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="comment">// Aligned barrier collection has to come last.</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    ED.clearAssumeInstAndAlignedBarriers();</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="keywordflow">if</span> (CB)</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      ED.addAlignedBarrier(A, *CB);</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  };</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;  <span class="keyword">auto</span> &amp;LivenessAA =</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAIsDead.html">AAIsDead</a>&gt;(*<span class="keyword">this</span>, getIRPosition(), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="comment">// Set \p R to \V and report true if that changed \p R.</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="keyword">auto</span> SetAndRecord = [&amp;](<span class="keywordtype">bool</span> &amp;<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, <span class="keywordtype">bool</span> V) {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="keywordtype">bool</span> Eq = (<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> == V);</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = V;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    <span class="keywordflow">return</span> !Eq;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  };</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160; </div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;EntryBB = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock();</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="keywordtype">bool</span> IsKernel = OMPInfoCache.Kernels.count(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *&gt;</a> SyncInstWorklist;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;RIt : *RPOT) {</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = *RIt;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160; </div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    <span class="keywordtype">bool</span> IsEntryBB = &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> == &amp;EntryBB;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="comment">// TODO: We use local reasoning since we don&#39;t have a divergence analysis</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="comment">//       running as well. We could basically allow uniform branches here.</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    <span class="keywordtype">bool</span> AlignedBarrierLastInBlock = IsEntryBB &amp;&amp; IsKernel;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    ExecutionDomainTy ED;</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="comment">// Propagate &quot;incoming edges&quot; into information about this block.</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <span class="keywordflow">if</span> (IsEntryBB) {</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      handleEntryBB(A, ED);</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="comment">// For live non-entry blocks we only propagate</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="comment">// information via live edges.</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <span class="keywordflow">if</span> (LivenessAA.isAssumedDead(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; </div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PredBB : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) {</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        <span class="keywordflow">if</span> (LivenessAA.isEdgeDead(PredBB, &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        <span class="keywordtype">bool</span> InitialEdgeOnly = isInitialThreadOnlyEdge(</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;            A, dyn_cast&lt;BranchInst&gt;(PredBB-&gt;getTerminator()), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        mergeInPredecessor(A, ED, BEDMap[PredBB], InitialEdgeOnly);</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      }</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    }</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160; </div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="comment">// Now we traverse the block, accumulate effects in ED and attach</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="comment">// information to calls.</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordtype">bool</span> UsedAssumedInformation;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.isAssumedDead(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *<span class="keyword">this</span>, &amp;LivenessAA, UsedAssumedInformation,</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                          <span class="comment">/* CheckBBLivenessOnly */</span> <span class="keyword">false</span>, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>,</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                          <span class="comment">/* CheckForDeadStore */</span> <span class="keyword">true</span>))</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160; </div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      <span class="comment">// Asummes and &quot;assume-like&quot; (dbg, lifetime, ...) are handled first, the</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      <span class="comment">// former is collected the latter is ignored.</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AI = dyn_cast_or_null&lt;AssumeInst&gt;(II)) {</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;          ED.addAssumeInst(A, *AI);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        }</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <span class="comment">// TODO: Should we also collect and delete lifetime markers?</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="keywordflow">if</span> (II-&gt;isAssumeLikeIntrinsic())</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; </div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      <span class="keywordtype">bool</span> IsNoSync = <a class="code" href="namespacellvm_1_1AA.html#add4df090e923f2fe0dceeb0c60e5f74b">AA::isNoSyncInst</a>(A, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      <span class="keywordtype">bool</span> IsAlignedBarrier =</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;          !IsNoSync &amp;&amp; CB &amp;&amp;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;          <a class="code" href="structllvm_1_1AANoSync.html#a79dea56e8e62d80d48cddd4319a55380">AANoSync::isAlignedBarrier</a>(*CB, AlignedBarrierLastInBlock);</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;      AlignedBarrierLastInBlock &amp;= IsNoSync;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160; </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      <span class="comment">// Next we check for calls. Aligned barriers are handled</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      <span class="comment">// explicitly, everything else is kept for the backward traversal and will</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <span class="comment">// also affect our state.</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      <span class="keywordflow">if</span> (CB) {</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <span class="keywordflow">if</span> (IsAlignedBarrier) {</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;          HandleAlignedBarrier(CB, ED);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;          AlignedBarrierLastInBlock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        }</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160; </div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        <span class="comment">// Check the pointer(s) of a memory intrinsic explicitly.</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <span class="keywordflow">if</span> (isa&lt;MemIntrinsic&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          <span class="keywordflow">if</span> (!ED.EncounteredNonLocalSideEffect &amp;&amp;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;              <a class="code" href="namespacellvm_1_1AA.html#a9b9d4b530f90e36eede3c575ad1948ee">AA::isPotentiallyAffectedByBarrier</a>(A, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *<span class="keyword">this</span>))</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;            ED.EncounteredNonLocalSideEffect = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;          <span class="keywordflow">if</span> (!IsNoSync) {</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;            ED.IsReachedFromAlignedBarrierOnly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;            SyncInstWorklist.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;          }</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        }</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160; </div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <span class="comment">// Record how we entered the call, then accumulate the effect of the</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="comment">// call in ED for potential use by the callee.</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <span class="keyword">auto</span> &amp;CallED = CEDMap[CB];</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        mergeInPredecessor(A, CallED, ED);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160; </div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="comment">// If we have a sync-definition we can check if it starts/ends in an</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <span class="comment">// aligned barrier. If we are unsure we assume any sync breaks</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        <span class="comment">// alignment.</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        <span class="keywordflow">if</span> (!IsNoSync &amp;&amp; Callee &amp;&amp; !<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isDeclaration()) {</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp;EDAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a>&gt;(</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;              *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*Callee), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;          <span class="keywordflow">if</span> (EDAA.getState().isValidState()) {</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> &amp;CalleeED = EDAA.<a class="code" href="structllvm_1_1AAExecutionDomain.html#aab1e417c2b00db90ff3c20bdd29401c6">getFunctionExecutionDomain</a>();</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            ED.<a class="code" href="structllvm_1_1AAExecutionDomain_1_1ExecutionDomainTy.html#a67e0a6ee379bd5b1b474c11641de68c4">IsReachedFromAlignedBarrierOnly</a> =</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                CallED.IsReachedFromAlignedBarrierOnly =</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                    CalleeED.IsReachedFromAlignedBarrierOnly;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            AlignedBarrierLastInBlock = ED.IsReachedFromAlignedBarrierOnly;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="keywordflow">if</span> (IsNoSync || !CalleeED.IsReachedFromAlignedBarrierOnly)</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;              ED.EncounteredNonLocalSideEffect |=</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                  CalleeED.EncounteredNonLocalSideEffect;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;              ED.EncounteredNonLocalSideEffect =</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                  CalleeED.EncounteredNonLocalSideEffect;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            <span class="keywordflow">if</span> (!CalleeED.IsReachingAlignedBarrierOnly)</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;              SyncInstWorklist.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;            <span class="keywordflow">if</span> (CalleeED.IsReachedFromAlignedBarrierOnly)</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;              mergeInPredecessorBarriersAndAssumptions(A, ED, CalleeED);</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;          }</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="keywordflow">if</span> (!IsNoSync)</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;          ED.IsReachedFromAlignedBarrierOnly =</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;              CallED.IsReachedFromAlignedBarrierOnly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        AlignedBarrierLastInBlock &amp;= ED.IsReachedFromAlignedBarrierOnly;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        ED.EncounteredNonLocalSideEffect |= !CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>();</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        <span class="keywordflow">if</span> (!IsNoSync)</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;          SyncInstWorklist.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      }</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayHaveSideEffects() &amp;&amp; !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayReadFromMemory())</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      <span class="comment">// If we have a callee we try to use fine-grained information to</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;      <span class="comment">// determine local side-effects.</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;      <span class="keywordflow">if</span> (CB) {</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;MemAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAMemoryLocation.html">AAMemoryLocation</a>&gt;(</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;            *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#aeef35bb007616add7418161b0313b56b">IRPosition::callsite_function</a>(*CB), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keyword">auto</span> AccessPred = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                              <a class="code" href="structllvm_1_1AAMemoryLocation.html#ace2d4d5ab8dffea597c39bc129d90f7f">AAMemoryLocation::AccessKind</a>,</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                              <a class="code" href="structllvm_1_1AAMemoryLocation.html#acffe374fb52ac7da0511285fdf18db3f">AAMemoryLocation::MemoryLocationsKind</a>) {</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;          <span class="keywordflow">return</span> !<a class="code" href="namespacellvm_1_1AA.html#a9b9d4b530f90e36eede3c575ad1948ee">AA::isPotentiallyAffectedByBarrier</a>(A, {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>}, *<span class="keyword">this</span>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        };</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <span class="keywordflow">if</span> (MemAA.getState().isValidState() &amp;&amp;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            MemAA.checkForAllAccessesToMemoryKind(</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                AccessPred, <a class="code" href="structllvm_1_1AAMemoryLocation.html#abf48d6a7d79173d89799bc4361d26515a0e7b3ae5911d61bd79225d9bda18f625">AAMemoryLocation::ALL_LOCATIONS</a>))</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;      }</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayHaveSideEffects() &amp;&amp; OMPInfoCache.isOnlyUsedByAssume(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160; </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        <span class="keywordflow">if</span> (LI-&gt;hasMetadata(LLVMContext::MD_invariant_load))</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      <span class="keywordflow">if</span> (!ED.EncounteredNonLocalSideEffect &amp;&amp;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          <a class="code" href="namespacellvm_1_1AA.html#a9b9d4b530f90e36eede3c575ad1948ee">AA::isPotentiallyAffectedByBarrier</a>(A, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *<span class="keyword">this</span>))</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        ED.EncounteredNonLocalSideEffect = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    }</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;UnreachableInst&gt;(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getTerminator()) &amp;&amp;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        !<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getTerminator()-&gt;getNumSuccessors()) {</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <span class="keyword">auto</span> &amp;FnED = BEDMap[<span class="keyword">nullptr</span>];</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      mergeInPredecessor(A, FnED, ED);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      <span class="keywordflow">if</span> (IsKernel)</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        HandleAlignedBarrier(<span class="keyword">nullptr</span>, ED);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    }</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; </div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    ExecutionDomainTy &amp;StoredED = BEDMap[&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>];</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    ED.IsReachingAlignedBarrierOnly = StoredED.IsReachingAlignedBarrierOnly;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="comment">// Check if we computed anything different as part of the forward</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="comment">// traversal. We do not take assumptions and aligned barriers into account</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="comment">// as they do not influence the state we iterate. Backward traversal values</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <span class="comment">// are handled later on.</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="keywordflow">if</span> (ED.IsExecutedByInitialThreadOnly !=</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;            StoredED.IsExecutedByInitialThreadOnly ||</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;        ED.IsReachedFromAlignedBarrierOnly !=</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;            StoredED.IsReachedFromAlignedBarrierOnly ||</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        ED.EncounteredNonLocalSideEffect !=</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;            StoredED.EncounteredNonLocalSideEffect)</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160; </div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="comment">// Update the state with the new value.</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    StoredED = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(ED);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  }</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160; </div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <span class="comment">// Propagate (non-aligned) sync instruction effects backwards until the</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <span class="comment">// entry is hit or an aligned barrier.</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;BasicBlock *, 16&gt;</a> Visited;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;  <span class="keywordflow">while</span> (!SyncInstWorklist.empty()) {</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SyncInst = SyncInstWorklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurInst = SyncInst;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="keywordtype">bool</span> HitAlignedBarrier = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <span class="keywordflow">while</span> ((CurInst = CurInst-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#ae451867ac0034a201153b54cc466386d">getPrevNode</a>())) {</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      <span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(CurInst);</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <span class="keyword">auto</span> &amp;CallED = CEDMap[CB];</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;      <span class="keywordflow">if</span> (SetAndRecord(CallED.IsReachingAlignedBarrierOnly, <span class="keyword">false</span>))</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      HitAlignedBarrier = AlignedBarriers.count(CB);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      <span class="keywordflow">if</span> (HitAlignedBarrier)</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    }</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <span class="keywordflow">if</span> (HitAlignedBarrier)</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SyncBB = SyncInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PredBB : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(SyncBB)) {</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      <span class="keywordflow">if</span> (LivenessAA.isEdgeDead(PredBB, SyncBB))</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(PredBB))</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      SyncInstWorklist.push_back(PredBB-&gt;getTerminator());</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      <span class="keyword">auto</span> &amp;PredED = BEDMap[PredBB];</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      <span class="keywordflow">if</span> (SetAndRecord(PredED.IsReachingAlignedBarrierOnly, <span class="keyword">false</span>))</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    <span class="keywordflow">if</span> (SyncBB != &amp;EntryBB)</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <span class="keyword">auto</span> &amp;FnED = BEDMap[<span class="keyword">nullptr</span>];</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="keywordflow">if</span> (SetAndRecord(FnED.IsReachingAlignedBarrierOnly, <span class="keyword">false</span>))</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  }</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160; </div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  <span class="keywordflow">return</span> Changed ? <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a> : <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;}</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="comment">/// Try to replace memory allocation calls called by a single thread with a</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="comment">/// static buffer of shared memory.</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="comment"></span><span class="keyword">struct </span>AAHeapToShared : <span class="keyword">public</span> <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper</a>&lt;BooleanState, AbstractAttribute&gt; {</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper&lt;BooleanState, AbstractAttribute&gt;</a>;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  AAHeapToShared(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) : <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>(IRP) {}</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment">  /// Create an abstract attribute view for the position \p IRP.</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> AAHeapToShared &amp;createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                                           <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A);</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="comment">  /// Returns true if HeapToShared conversion is assumed to be possible.</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isAssumedHeapToShared(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">  /// Returns true if HeapToShared conversion is assumed and the CB is a</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">  /// callsite to a free operation to be removed.</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isAssumedHeapToSharedRemovedFree(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="comment">  /// See AbstractAttribute::getName().</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> std::string <a class="code" href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;AAHeapToShared&quot;</span>; }</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">  /// See AbstractAttribute::getIdAddr().</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *getIdAddr()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; }</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="comment">  /// This function should return true if the type of the \p AA is</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">  /// AAHeapToShared.</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA) {</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="keywordflow">return</span> (AA-&gt;<a class="code" href="structllvm_1_1AbstractAttribute.html#af34bd448298e7021ee074394446795f2">getIdAddr</a>() == &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>);</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment">  /// Unique ID (due to the unique address)</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;};</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160; </div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="keyword">struct </span>AAHeapToSharedFunction : <span class="keyword">public</span> AAHeapToShared {</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  AAHeapToSharedFunction(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      : AAHeapToShared(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;[AAHeapToShared] &quot;</span> + <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(MallocCalls.size()) +</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;           <span class="stringliteral">&quot; malloc calls eligible.&quot;</span>;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;  }</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">  /// See AbstractAttribute::trackStatistics().</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment">  /// This functions finds free calls that will be removed by the</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">  /// HeapToShared transformation.</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> findPotentialRemovedFreeCalls(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <span class="keyword">auto</span> &amp;FreeRFI = OMPInfoCache.RFIs[OMPRTL___kmpc_free_shared];</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160; </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    PotentialRemovedFreeCalls.clear();</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="comment">// Update free call users of found malloc calls.</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB : MallocCalls) {</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallBase *, 4&gt;</a> FreeCalls;</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : CB-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;CallBase&gt;(U);</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getCalledFunction() == FreeRFI.Declaration)</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;          FreeCalls.push_back(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      }</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160; </div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      <span class="keywordflow">if</span> (FreeCalls.size() != 1)</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160; </div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      PotentialRemovedFreeCalls.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a94d23373106467003722f7d6c17b1528">insert</a>(FreeCalls.front());</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    }</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  }</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160; </div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a766797ec22d0c22f563a28e00f9865d6">DisableOpenMPOptDeglobalization</a>) {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;      indicatePessimisticFixpoint();</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    }</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; </div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keyword">auto</span> &amp;RFI = OMPInfoCache.RFIs[OMPRTL___kmpc_alloc_shared];</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">if</span> (!RFI.Declaration)</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160; </div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#afc978039286fb06b8edb5dd4b0cdb0d3">Attributor::SimplifictionCallbackTy</a> SCB =</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        [](<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *,</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;           <span class="keywordtype">bool</span> &amp;) -&gt; std::optional&lt;Value *&gt; { <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; };</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160; </div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : RFI.Declaration-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB = dyn_cast&lt;CallBase&gt;(U)) {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        <span class="keywordflow">if</span> (CB-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>() != <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        MallocCalls.insert(CB);</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerSimplificationCallback(<a class="code" href="structllvm_1_1IRPosition.html#a22b55f73ab4057a8c3da9f32bd582f4b">IRPosition::callsite_returned</a>(*CB),</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                                         SCB);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      }</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    findPotentialRemovedFreeCalls(A);</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  }</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keywordtype">bool</span> isAssumedHeapToShared(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;    <span class="keywordflow">return</span> isValidState() &amp;&amp; MallocCalls.count(&amp;CB);</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  }</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160; </div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <span class="keywordtype">bool</span> isAssumedHeapToSharedRemovedFree(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <span class="keywordflow">return</span> isValidState() &amp;&amp; PotentialRemovedFreeCalls.count(&amp;CB);</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  }</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160; </div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <span class="keywordflow">if</span> (MallocCalls.empty())</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160; </div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;    <span class="keyword">auto</span> &amp;FreeCall = OMPInfoCache.RFIs[OMPRTL___kmpc_free_shared];</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160; </div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">HS</a> = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.lookupAAFor&lt;<a class="code" href="structllvm_1_1AAHeapToStack.html">AAHeapToStack</a>&gt;(<a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>), <span class="keyword">this</span>,</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                                            <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; </div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB : MallocCalls) {</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      <span class="comment">// Skip replacing this if HeapToStack has already claimed it.</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">HS</a> &amp;&amp; <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">HS</a>-&gt;isAssumedHeapToStack(*CB))</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160; </div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;      <span class="comment">// Find the unique free call to remove it.</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallBase *, 4&gt;</a> FreeCalls;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : CB-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;CallBase&gt;(U);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getCalledFunction() == FreeCall.Declaration)</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;          FreeCalls.push_back(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      }</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="keywordflow">if</span> (FreeCalls.size() != 1)</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160; </div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keyword">auto</span> *AllocSize = cast&lt;ConstantInt&gt;(CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; </div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      <span class="keywordflow">if</span> (AllocSize-&gt;getZExtValue() + SharedMemoryUsed &gt; <a class="code" href="OpenMPOpt_8cpp.html#a4cb2a061e2ceec7947d57a2c1db03918">SharedMemoryLimit</a>) {</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Cannot replace call &quot;</span> &lt;&lt; *CB</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; with shared memory.&quot;</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; Shared memory usage is limited to &quot;</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                          &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a4cb2a061e2ceec7947d57a2c1db03918">SharedMemoryLimit</a> &lt;&lt; <span class="stringliteral">&quot; bytes\n&quot;</span>);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      }</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160; </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Replace globalization call &quot;</span> &lt;&lt; *CB</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; AllocSize-&gt;getZExtValue()</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; bytes of shared memory\n&quot;</span>);</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160; </div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      <span class="comment">// Create a new shared memory buffer of the same size as the allocation</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <span class="comment">// and replace all the uses of the original allocation with it.</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CB-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8Ty = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getContext());</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8ArrTy = <a class="code" href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">ArrayType::get</a>(Int8Ty, AllocSize-&gt;getZExtValue());</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;      <span class="keyword">auto</span> *SharedMem = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;          *M, Int8ArrTy, <span class="comment">/* IsConstant */</span> <span class="keyword">false</span>, <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>,</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;          <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Int8ArrTy), CB-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;_shared&quot;</span>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;          <a class="code" href="classllvm_1_1GlobalValue.html#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalValue::NotThreadLocal</a>,</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;          <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1omp.html#a8c6f525466cc262e00c409c31f9a4272aa6156ea9d66fef24e87e841fbabf7cca">AddressSpace::Shared</a>));</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      <span class="keyword">auto</span> *NewBuffer =</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;          <a class="code" href="classllvm_1_1ConstantExpr.html#a1f469b1f703519ae25ce564c8704310f">ConstantExpr::getPointerCast</a>(SharedMem, Int8Ty-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>());</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160; </div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Replaced globalized variable with &quot;</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;                  &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;SharedMemory&quot;</span>, AllocSize-&gt;getZExtValue())</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                  &lt;&lt; ((AllocSize-&gt;getZExtValue() != 1) ? <span class="stringliteral">&quot; bytes &quot;</span> : <span class="stringliteral">&quot; byte &quot;</span>)</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;of shared memory.&quot;</span>;</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      };</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>&gt;(CB, <span class="stringliteral">&quot;OMP111&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160; </div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> Alignment = CB-&gt;getRetAlign();</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Alignment &amp;&amp;</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;             <span class="stringliteral">&quot;HeapToShared on allocation without alignment attribute&quot;</span>);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      SharedMem-&gt;setAlignment(*Alignment);</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeAfterManifest(<a class="code" href="structllvm_1_1IRPosition.html#a22b55f73ab4057a8c3da9f32bd582f4b">IRPosition::callsite_returned</a>(*CB), *NewBuffer);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(*CB);</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(*FreeCalls.front());</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160; </div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      SharedMemoryUsed += AllocSize-&gt;getZExtValue();</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      NumBytesMovedToSharedMemory = SharedMemoryUsed;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    }</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160; </div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;  }</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; </div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="keywordflow">if</span> (MallocCalls.empty())</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="keyword">auto</span> &amp;RFI = OMPInfoCache.RFIs[OMPRTL___kmpc_alloc_shared];</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="keywordflow">if</span> (!RFI.Declaration)</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160; </div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAnchorScope();</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160; </div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    <span class="keyword">auto</span> NumMallocCalls = MallocCalls.size();</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; </div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <span class="comment">// Only consider malloc calls executed by a single thread with a constant.</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : RFI.Declaration-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB = dyn_cast&lt;CallBase&gt;(U)) {</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        <span class="keywordflow">if</span> (CB-&gt;getCaller() != <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        <span class="keywordflow">if</span> (!MallocCalls.count(CB))</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;ConstantInt&gt;(CB-&gt;getArgOperand(0))) {</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;          MallocCalls.remove(CB);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        }</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ED = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a>&gt;(</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;            *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        <span class="keywordflow">if</span> (!ED.isExecutedByInitialThreadOnly(*CB))</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;          MallocCalls.remove(CB);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;      }</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    }</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160; </div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    findPotentialRemovedFreeCalls(A);</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160; </div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    <span class="keywordflow">if</span> (NumMallocCalls != MallocCalls.size())</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  }</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment">  /// Collection of all malloc calls in a function.</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;CallBase *, 4&gt;</a> MallocCalls;<span class="comment"></span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="comment">  /// Collection of potentially removed free calls in a function.</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;CallBase *, 4&gt;</a> PotentialRemovedFreeCalls;<span class="comment"></span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">  /// The total amount of shared memory that has been used for HeapToShared.</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> SharedMemoryUsed = 0;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;};</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160; </div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="keyword">struct </span>AAKernelInfo : <span class="keyword">public</span> <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper</a>&lt;KernelInfoState, AbstractAttribute&gt; {</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper&lt;KernelInfoState, AbstractAttribute&gt;</a>;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  AAKernelInfo(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) : <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>(IRP) {}</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">  /// Statistics are tracked as part of manifest for now.</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="comment">  /// See AbstractAttribute::getAsStr()</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="keywordflow">if</span> (!isValidState())</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;invalid&gt;&quot;</span>;</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <span class="keywordflow">return</span> std::string(SPMDCompatibilityTracker.isAssumed() ? <span class="stringliteral">&quot;SPMD&quot;</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                                                            : <span class="stringliteral">&quot;generic&quot;</span>) +</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;           std::string(SPMDCompatibilityTracker.isAtFixpoint() ? <span class="stringliteral">&quot; [FIX]&quot;</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                                                               : <span class="stringliteral">&quot;&quot;</span>) +</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;           std::string(<span class="stringliteral">&quot; #PRs: &quot;</span>) +</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;           (ReachedKnownParallelRegions.isValidState()</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                ? <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(ReachedKnownParallelRegions.size())</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                : <span class="stringliteral">&quot;&lt;invalid&gt;&quot;</span>) +</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;           <span class="stringliteral">&quot;, #Unknown PRs: &quot;</span> +</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;           (ReachedUnknownParallelRegions.isValidState()</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                ? <a class="code" href="namespacestd.html">std</a>::<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">to_string</a>(ReachedUnknownParallelRegions.<a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>())</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                : <span class="stringliteral">&quot;&lt;invalid&gt;&quot;</span>) +</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;           <span class="stringliteral">&quot;, #Reaching Kernels: &quot;</span> +</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;           (ReachingKernelEntries.isValidState()</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                ? <a class="code" href="namespacestd.html">std</a>::<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">to_string</a>(ReachingKernelEntries.<a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>())</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                : <span class="stringliteral">&quot;&lt;invalid&gt;&quot;</span>) +</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;           <span class="stringliteral">&quot;, #ParLevels: &quot;</span> +</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;           (ParallelLevels.isValidState()</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                ? <a class="code" href="namespacestd.html">std</a>::<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">to_string</a>(ParallelLevels.<a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>())</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                : <span class="stringliteral">&quot;&lt;invalid&gt;&quot;</span>);</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;  }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;<span class="comment">  /// Create an abstract attribute biew for the position \p IRP.</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> AAKernelInfo &amp;createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A);</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="comment">  /// See AbstractAttribute::getName()</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> std::string <a class="code" href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;AAKernelInfo&quot;</span>; }</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment">  /// See AbstractAttribute::getIdAddr()</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *getIdAddr()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; }</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="comment">  /// This function should return true if the type of the \p AA is AAKernelInfo</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA) {</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    <span class="keywordflow">return</span> (AA-&gt;<a class="code" href="structllvm_1_1AbstractAttribute.html#af34bd448298e7021ee074394446795f2">getIdAddr</a>() == &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>);</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;  }</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160; </div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;};</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="comment">/// The function kernel info abstract attribute, basically, what can we say</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="comment">/// about a function with regards to the KernelInfoState.</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="comment"></span><span class="keyword">struct </span>AAKernelInfoFunction : AAKernelInfo {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;  AAKernelInfoFunction(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      : AAKernelInfo(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160; </div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> GuardedInstructions;</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160; </div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;Instruction *&gt;</a> &amp;getGuardedInstructions() {</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    <span class="keywordflow">return</span> GuardedInstructions;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  }</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">  /// See AbstractAttribute::initialize(...).</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    <span class="comment">// This is a high-level transform that might change the constant arguments</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="comment">// of the init and dinit calls. We need to tell the Attributor about this</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    <span class="comment">// to avoid other parts using the current constant value for simpliication.</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160; </div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *Fn = getAnchorScope();</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160; </div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;InitRFI =</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_target_init];</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;DeinitRFI =</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_target_deinit];</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160; </div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    <span class="comment">// For kernels we perform more initialization work, first we find the init</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;    <span class="comment">// and deinit calls.</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;    <span class="keyword">auto</span> StoreCallBase = [](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U,</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                            OMPInformationCache::RuntimeFunctionInfo &amp;RFI,</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                            <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *&amp;Storage) {</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB = OpenMPOpt::getCallIfRegularCall(U, &amp;RFI);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CB &amp;&amp;</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;             <span class="stringliteral">&quot;Unexpected use of __kmpc_target_init or __kmpc_target_deinit!&quot;</span>);</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Storage &amp;&amp;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;             <span class="stringliteral">&quot;Multiple uses of __kmpc_target_init or __kmpc_target_deinit!&quot;</span>);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      Storage = CB;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    };</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    InitRFI.foreachUse(</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;) {</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;          StoreCallBase(U, InitRFI, KernelInitCB);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        },</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;        Fn);</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    DeinitRFI.foreachUse(</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;) {</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;          StoreCallBase(U, DeinitRFI, KernelDeinitCB);</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        },</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        Fn);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160; </div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <span class="comment">// Ignore kernels without initializers such as global constructors.</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="keywordflow">if</span> (!KernelInitCB || !KernelDeinitCB)</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160; </div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    <span class="comment">// Add itself to the reaching kernel and set IsKernelEntry.</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    ReachingKernelEntries.insert(Fn);</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    IsKernelEntry = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160; </div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    <span class="comment">// For kernels we might need to initialize/finalize the IsSPMD state and</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <span class="comment">// we need to register a simplification callback so that the Attributor</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="comment">// knows the constant arguments to __kmpc_target_init and</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <span class="comment">// __kmpc_target_deinit might actually change.</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160; </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#afc978039286fb06b8edb5dd4b0cdb0d3">Attributor::SimplifictionCallbackTy</a> StateMachineSimplifyCB =</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;        [&amp;](<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA,</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            <span class="keywordtype">bool</span> &amp;UsedAssumedInformation) -&gt; std::optional&lt;Value *&gt; {</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      <span class="comment">// IRP represents the &quot;use generic state machine&quot; argument of an</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      <span class="comment">// __kmpc_target_init call. We will answer this one with the internal</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      <span class="comment">// state. As long as we are not in an invalid state, we will create a</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      <span class="comment">// custom state machine so the value should be a `i1 false`. If we are</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;      <span class="comment">// in an invalid state, we won&#39;t change the value that is in the IR.</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      <span class="keywordflow">if</span> (!ReachedKnownParallelRegions.isValidState())</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;      <span class="comment">// If we have disabled state machine rewrites, don&#39;t make a custom one.</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#aa9760ec3616ef020c7356dfc24a5cd7f">DisableOpenMPOptStateMachineRewrite</a>)</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      <span class="keywordflow">if</span> (AA)</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.recordDependence(*<span class="keyword">this</span>, *AA, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      UsedAssumedInformation = !isAtFixpoint();</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a> =</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;          <a class="code" href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">ConstantInt::getBool</a>(IRP.<a class="code" href="structllvm_1_1IRPosition.html#af552a06c4a7b7060450f45b05632c0d9">getAnchorValue</a>().<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a>;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    };</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160; </div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#afc978039286fb06b8edb5dd4b0cdb0d3">Attributor::SimplifictionCallbackTy</a> ModeSimplifyCB =</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        [&amp;](<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA,</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;            <span class="keywordtype">bool</span> &amp;UsedAssumedInformation) -&gt; std::optional&lt;Value *&gt; {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      <span class="comment">// IRP represents the &quot;SPMDCompatibilityTracker&quot; argument of an</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      <span class="comment">// __kmpc_target_init or</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="comment">// __kmpc_target_deinit call. We will answer this one with the internal</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      <span class="comment">// state.</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isValidState())</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;      <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isAtFixpoint()) {</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;        <span class="keywordflow">if</span> (AA)</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;          <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.recordDependence(*<span class="keyword">this</span>, *AA, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        UsedAssumedInformation = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        UsedAssumedInformation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      }</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <span class="keyword">auto</span> *Val = <a class="code" href="classllvm_1_1ConstantInt.html#ad736fb9b585509388546c12617def38f">ConstantInt::getSigned</a>(</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;          <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">IntegerType::getInt8Ty</a>(IRP.<a class="code" href="structllvm_1_1IRPosition.html#af552a06c4a7b7060450f45b05632c0d9">getAnchorValue</a>().<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()),</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;          SPMDCompatibilityTracker.isAssumed() ? <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">OMP_TGT_EXEC_MODE_SPMD</a></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                                               : <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430afa583a38ff705195c9bce9dec0c5eff8">OMP_TGT_EXEC_MODE_GENERIC</a>);</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      <span class="keywordflow">return</span> Val;</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    };</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160; </div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    constexpr <span class="keyword">const</span> <span class="keywordtype">int</span> InitModeArgNo = 1;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    constexpr <span class="keyword">const</span> <span class="keywordtype">int</span> DeinitModeArgNo = 1;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    constexpr <span class="keyword">const</span> <span class="keywordtype">int</span> InitUseStateMachineArgNo = 2;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerSimplificationCallback(</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;        <a class="code" href="structllvm_1_1IRPosition.html#a4c17a71e75898bbc42578a1c0b94c6b6">IRPosition::callsite_argument</a>(*KernelInitCB, InitUseStateMachineArgNo),</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        StateMachineSimplifyCB);</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerSimplificationCallback(</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        <a class="code" href="structllvm_1_1IRPosition.html#a4c17a71e75898bbc42578a1c0b94c6b6">IRPosition::callsite_argument</a>(*KernelInitCB, InitModeArgNo),</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        ModeSimplifyCB);</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerSimplificationCallback(</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;        <a class="code" href="structllvm_1_1IRPosition.html#a4c17a71e75898bbc42578a1c0b94c6b6">IRPosition::callsite_argument</a>(*KernelDeinitCB, DeinitModeArgNo),</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        ModeSimplifyCB);</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    <span class="comment">// Check if we know we are in SPMD-mode already.</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ModeArg =</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        dyn_cast&lt;ConstantInt&gt;(KernelInitCB-&gt;getArgOperand(InitModeArgNo));</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    <span class="keywordflow">if</span> (ModeArg &amp;&amp; (ModeArg-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>() &amp; <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">OMP_TGT_EXEC_MODE_SPMD</a>))</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;      SPMDCompatibilityTracker.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <span class="comment">// This is a generic region but SPMDization is disabled so stop tracking.</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#ad590786d9dc132a9f606d062c384c7cf">DisableOpenMPOptSPMDization</a>)</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160; </div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    <span class="comment">// Register virtual uses of functions we might need to preserve.</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    <span class="keyword">auto</span> RegisterVirtualUse = [&amp;](<a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RFKind,</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                                  <a class="code" href="structllvm_1_1Attributor.html#aed892a6809e769b95c507a0b850dfe4d">Attributor::VirtualUseCallbackTy</a> &amp;CB) {</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      <span class="keywordflow">if</span> (!OMPInfoCache.RFIs[RFKind].Declaration)</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerVirtualUseCallback(*OMPInfoCache.RFIs[RFKind].Declaration, CB);</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    };</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; </div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="comment">// Add a dependence to ensure updates if the state changes.</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    <span class="keyword">auto</span> AddDependence = [](<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <span class="keyword">const</span> AAKernelInfo *KI,</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                            <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *QueryingAA) {</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      <span class="keywordflow">if</span> (QueryingAA) {</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.recordDependence(*KI, *QueryingAA, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      }</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    };</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160; </div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#aed892a6809e769b95c507a0b850dfe4d">Attributor::VirtualUseCallbackTy</a> CustomStateMachineUseCB =</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;        [&amp;](<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *QueryingAA) {</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;          <span class="comment">// Whenever we create a custom state machine we will insert calls to</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;          <span class="comment">// __kmpc_get_hardware_num_threads_in_block,</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;          <span class="comment">// __kmpc_get_warp_size,</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;          <span class="comment">// __kmpc_barrier_simple_generic,</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;          <span class="comment">// __kmpc_kernel_parallel, and</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;          <span class="comment">// __kmpc_kernel_end_parallel.</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;          <span class="comment">// Not needed if we are on track for SPMDzation.</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;          <span class="keywordflow">if</span> (SPMDCompatibilityTracker.isValidState())</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            <span class="keywordflow">return</span> AddDependence(A, <span class="keyword">this</span>, QueryingAA);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;          <span class="comment">// Not needed if we can&#39;t rewrite due to an invalid state.</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;          <span class="keywordflow">if</span> (!ReachedKnownParallelRegions.isValidState())</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;            <span class="keywordflow">return</span> AddDependence(A, <span class="keyword">this</span>, QueryingAA);</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;        };</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160; </div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="comment">// Not needed if we are pre-runtime merge.</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    <span class="keywordflow">if</span> (!KernelInitCB-&gt;getCalledFunction()-&gt;isDeclaration()) {</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      RegisterVirtualUse(OMPRTL___kmpc_get_hardware_num_threads_in_block,</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                         CustomStateMachineUseCB);</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;      RegisterVirtualUse(OMPRTL___kmpc_get_warp_size, CustomStateMachineUseCB);</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;      RegisterVirtualUse(OMPRTL___kmpc_barrier_simple_generic,</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                         CustomStateMachineUseCB);</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      RegisterVirtualUse(OMPRTL___kmpc_kernel_parallel,</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                         CustomStateMachineUseCB);</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      RegisterVirtualUse(OMPRTL___kmpc_kernel_end_parallel,</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;                         CustomStateMachineUseCB);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160; </div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="comment">// If we do not perform SPMDzation we do not need the virtual uses below.</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keywordflow">if</span> (SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160; </div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#aed892a6809e769b95c507a0b850dfe4d">Attributor::VirtualUseCallbackTy</a> HWThreadIdUseCB =</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        [&amp;](<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *QueryingAA) {</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;          <span class="comment">// Whenever we perform SPMDzation we will insert</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;          <span class="comment">// __kmpc_get_hardware_thread_id_in_block calls.</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;          <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isValidState())</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;            <span class="keywordflow">return</span> AddDependence(A, <span class="keyword">this</span>, QueryingAA);</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        };</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    RegisterVirtualUse(OMPRTL___kmpc_get_hardware_thread_id_in_block,</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                       HWThreadIdUseCB);</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160; </div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#aed892a6809e769b95c507a0b850dfe4d">Attributor::VirtualUseCallbackTy</a> SPMDBarrierUseCB =</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;        [&amp;](<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *QueryingAA) {</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;          <span class="comment">// Whenever we perform SPMDzation with guarding we will insert</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;          <span class="comment">// __kmpc_simple_barrier_spmd calls. If SPMDzation failed, there is</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;          <span class="comment">// nothing to guard, or there are no parallel regions, we don&#39;t need</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;          <span class="comment">// the calls.</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;          <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isValidState())</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;            <span class="keywordflow">return</span> AddDependence(A, <span class="keyword">this</span>, QueryingAA);</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;          <span class="keywordflow">if</span> (SPMDCompatibilityTracker.empty())</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;            <span class="keywordflow">return</span> AddDependence(A, <span class="keyword">this</span>, QueryingAA);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;          <span class="keywordflow">if</span> (!mayContainParallelRegion())</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;            <span class="keywordflow">return</span> AddDependence(A, <span class="keyword">this</span>, QueryingAA);</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;        };</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    RegisterVirtualUse(OMPRTL___kmpc_barrier_simple_spmd, SPMDBarrierUseCB);</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  }</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="comment">  /// Sanitize the string \p S such that it is a suitable global symbol name.</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> std::string sanitizeForGlobalName(std::string <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) {</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;    std::replace_if(</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.begin(), <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.end(),</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        [](<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;          return !((C &gt;= <span class="stringliteral">&#39;a&#39;</span> &amp;&amp; C &lt;= <span class="stringliteral">&#39;z&#39;</span>) || (C &gt;= <span class="stringliteral">&#39;A&#39;</span> &amp;&amp; C &lt;= <span class="stringliteral">&#39;Z&#39;</span>) ||</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                   (C &gt;= <span class="stringliteral">&#39;0&#39;</span> &amp;&amp; C &lt;= <span class="stringliteral">&#39;9&#39;</span>) || C == <span class="stringliteral">&#39;_&#39;</span>);</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;        },</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  }</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;<span class="comment">  /// Modify the IR based on the KernelInfoState as the fixpoint iteration is</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<span class="comment">  /// finished now.</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    <span class="comment">// If we are not looking at a kernel with __kmpc_target_init and</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <span class="comment">// __kmpc_target_deinit call we cannot actually manifest the information.</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <span class="keywordflow">if</span> (!KernelInitCB || !KernelDeinitCB)</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">    /// Insert nested Parallelism global variable</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="classllvm_1_1Function.html">Kernel</a> = getAnchorScope();</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8Ty = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext());</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(M, Int8Ty, <span class="comment">/* isConstant */</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                       <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalValue::WeakAnyLinkage</a>,</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                       <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Int8Ty, NestedParallelism ? 1 : 0),</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                       <a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;_nested_parallelism&quot;</span>);</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160; </div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    <span class="comment">// If we can we change the execution mode to SPMD-mode otherwise we build a</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    <span class="comment">// custom state machine.</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    <span class="keywordflow">if</span> (!changeToSPMDMode(A, Changed)) {</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      <span class="keywordflow">if</span> (!KernelInitCB-&gt;getCalledFunction()-&gt;isDeclaration())</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;        <span class="keywordflow">return</span> buildCustomStateMachine(A);</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    }</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160; </div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;  }</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160; </div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;  <span class="keywordtype">void</span> insertInstructionGuardsHelper(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160; </div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="keyword">auto</span> CreateGuardedRegion = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *RegionStartI,</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                                   <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *RegionEndI) {</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;      <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      <a class="code" href="classllvm_1_1MemorySSAUpdater.html">MemorySSAUpdater</a> *MSU = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;      <span class="keyword">using</span> InsertPointTy = <a class="code" href="classllvm_1_1OpenMPIRBuilder.html#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a>;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160; </div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ParentBB = RegionStartI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *Fn = ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;      <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *Fn-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160; </div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      <span class="comment">// Create all the blocks and logic.</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      <span class="comment">// ParentBB:</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;      <span class="comment">//    goto RegionCheckTidBB</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      <span class="comment">// RegionCheckTidBB:</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <span class="comment">//    Tid = __kmpc_hardware_thread_id()</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      <span class="comment">//    if (Tid != 0)</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;      <span class="comment">//        goto RegionBarrierBB</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;      <span class="comment">// RegionStartBB:</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <span class="comment">//    &lt;execute instructions guarded&gt;</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      <span class="comment">//    goto RegionEndBB</span></div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;      <span class="comment">// RegionEndBB:</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;      <span class="comment">//    &lt;store escaping values to shared mem&gt;</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <span class="comment">//    goto RegionBarrierBB</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;      <span class="comment">//  RegionBarrierBB:</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      <span class="comment">//    __kmpc_simple_barrier_spmd()</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      <span class="comment">//    // second barrier is omitted if lacking escaping values.</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      <span class="comment">//    &lt;load escaping values from shared mem&gt;</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      <span class="comment">//    __kmpc_simple_barrier_spmd()</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      <span class="comment">//    goto RegionExitBB</span></div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;      <span class="comment">// RegionExitBB:</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;      <span class="comment">//    &lt;execute rest of instructions&gt;</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160; </div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RegionEndBB = <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(ParentBB, RegionEndI-&gt;getNextNode(),</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;                                           DT, LI, MSU, <span class="stringliteral">&quot;region.guarded.end&quot;</span>);</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RegionBarrierBB =</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(RegionEndBB, &amp;*RegionEndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>(), DT, LI,</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;                     MSU, <span class="stringliteral">&quot;region.barrier&quot;</span>);</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RegionExitBB =</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(RegionBarrierBB, &amp;*RegionBarrierBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>(),</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                     DT, LI, MSU, <span class="stringliteral">&quot;region.exit&quot;</span>);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RegionStartBB =</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;          <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(ParentBB, RegionStartI, DT, LI, MSU, <span class="stringliteral">&quot;region.guarded&quot;</span>);</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160; </div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">getUniqueSuccessor</a>() == RegionStartBB &amp;&amp;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;             <span class="stringliteral">&quot;Expected a different CFG&quot;</span>);</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160; </div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RegionCheckTidBB = <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;          ParentBB, ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>(), DT, LI, MSU, <span class="stringliteral">&quot;region.check.tid&quot;</span>);</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160; </div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;      <span class="comment">// Register basic blocks with the Attributor.</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*RegionEndBB);</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*RegionBarrierBB);</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*RegionExitBB);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*RegionStartBB);</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*RegionCheckTidBB);</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160; </div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;      <span class="keywordtype">bool</span> HasBroadcastValues = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;      <span class="comment">// Find escaping outputs from the guarded region to outside users and</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;      <span class="comment">// broadcast their values to them.</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *RegionStartBB) {</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;        <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> OutsideUsers;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *Usr : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users()) {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;UsrI = *cast&lt;Instruction&gt;(Usr);</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;          <span class="keywordflow">if</span> (UsrI.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != RegionStartBB)</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;            OutsideUsers.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;UsrI);</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        }</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160; </div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        <span class="keywordflow">if</span> (OutsideUsers.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">empty</a>())</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160; </div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        HasBroadcastValues = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160; </div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        <span class="comment">// Emit a global variable in shared memory to store the broadcasted</span></div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;        <span class="comment">// value.</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        <span class="keyword">auto</span> *SharedMem = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;            M, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType(), <span class="comment">/* IsConstant */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;            <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>, <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()),</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;            sanitizeForGlobalName(</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getName() + <span class="stringliteral">&quot;.guarded.output.alloc&quot;</span>).str()),</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;            <span class="keyword">nullptr</span>, <a class="code" href="classllvm_1_1GlobalValue.html#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalValue::NotThreadLocal</a>,</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1omp.html#a8c6f525466cc262e00c409c31f9a4272aa6156ea9d66fef24e87e841fbabf7cca">AddressSpace::Shared</a>));</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160; </div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;        <span class="comment">// Emit a store instruction to update the value.</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        <span class="keyword">new</span> <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, SharedMem, RegionEndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160; </div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LoadI = <span class="keyword">new</span> <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType(), SharedMem,</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;                                       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getName() + <span class="stringliteral">&quot;.guarded.output.load&quot;</span>,</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                                       RegionBarrierBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160; </div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;        <span class="comment">// Emit a load instruction and replace uses of the output value.</span></div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UsrI : OutsideUsers)</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;          UsrI-&gt;<a class="code" href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">replaceUsesOfWith</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, LoadI);</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      }</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160; </div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160; </div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      <span class="comment">// Go to tid check BB in ParentBB.</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>();</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      <a class="code" href="structllvm_1_1OpenMPIRBuilder_1_1LocationDescription.html">OpenMPIRBuilder::LocationDescription</a> Loc(</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;          InsertPointTy(ParentBB, ParentBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      OMPInfoCache.OMPBuilder.updateToLocation(Loc);</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> SrcLocStrSize;</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      <span class="keyword">auto</span> *SrcLocStr =</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;          OMPInfoCache.OMPBuilder.getOrCreateSrcLocStr(Loc, SrcLocStrSize);</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Ident =</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;          OMPInfoCache.OMPBuilder.getOrCreateIdent(SrcLocStr, SrcLocStrSize);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(RegionCheckTidBB, ParentBB)-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160; </div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;      <span class="comment">// Add check for Tid in RegionCheckTidBB</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      RegionCheckTidBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      <a class="code" href="structllvm_1_1OpenMPIRBuilder_1_1LocationDescription.html">OpenMPIRBuilder::LocationDescription</a> LocRegionCheckTid(</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;          InsertPointTy(RegionCheckTidBB, RegionCheckTidBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      OMPInfoCache.OMPBuilder.updateToLocation(LocRegionCheckTid);</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> HardwareTidFn =</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;          OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;              M, OMPRTL___kmpc_get_hardware_thread_id_in_block);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Tid =</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;          OMPInfoCache.OMPBuilder.Builder.CreateCall(HardwareTidFn, {});</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      Tid-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;      OMPInfoCache.setCallingConvention(HardwareTidFn, Tid);</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *TidCheck = OMPInfoCache.OMPBuilder.Builder.CreateIsNull(Tid);</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      OMPInfoCache.OMPBuilder.Builder</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;          .CreateCondBr(TidCheck, RegionStartBB, RegionBarrierBB)</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;          -&gt;setDebugLoc(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160; </div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      <span class="comment">// First barrier for synchronization, ensures main thread has updated</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;      <span class="comment">// values.</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;      <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> BarrierFn =</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;          OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;              M, OMPRTL___kmpc_barrier_simple_spmd);</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      OMPInfoCache.OMPBuilder.updateToLocation(InsertPointTy(</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;          RegionBarrierBB, RegionBarrierBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>()));</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a> =</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;          OMPInfoCache.OMPBuilder.Builder.CreateCall(BarrierFn, {Ident, Tid});</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a>-&gt;setDebugLoc(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      OMPInfoCache.setCallingConvention(BarrierFn, <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a>);</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160; </div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      <span class="comment">// Second barrier ensures workers have read broadcast values.</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;      <span class="keywordflow">if</span> (HasBroadcastValues) {</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a> = <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(BarrierFn, {Ident, Tid}, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                                             RegionBarrierBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;        <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a>-&gt;setDebugLoc(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;        OMPInfoCache.setCallingConvention(BarrierFn, <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a>);</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      }</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    };</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160; </div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    <span class="keyword">auto</span> &amp;AllocSharedRFI = OMPInfoCache.RFIs[OMPRTL___kmpc_alloc_shared];</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 8&gt;</a> Visited;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *GuardedI : SPMDCompatibilityTracker) {</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = GuardedI-&gt;getParent();</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>).second)</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160; </div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;Instruction *, Instruction *&gt;</a>&gt; Reorders;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *LastEffect = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html#a6d3231fb84ed4182ec22e9442a87dbf8">BasicBlock::reverse_iterator</a> IP = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;rbegin(), IPEnd = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;rend();</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;      <span class="keywordflow">while</span> (++IP != IPEnd) {</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        <span class="keywordflow">if</span> (!IP-&gt;mayHaveSideEffects() &amp;&amp; !IP-&gt;mayReadFromMemory())</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = &amp;*IP;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;        <span class="keywordflow">if</span> (OpenMPOpt::getCallIfRegularCall(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, &amp;AllocSharedRFI))</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;user_empty() || !SPMDCompatibilityTracker.contains(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;          LastEffect = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;        }</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;        <span class="keywordflow">if</span> (LastEffect)</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;          Reorders.push_back({<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, LastEffect});</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;        LastEffect = &amp;*IP;</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;      }</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Reorder : Reorders)</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        Reorder.first-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(Reorder.second);</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;    }</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160; </div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;Instruction *, Instruction *&gt;</a>, 4&gt; GuardedRegions;</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160; </div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *GuardedI : SPMDCompatibilityTracker) {</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = GuardedI-&gt;getParent();</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <span class="keyword">auto</span> *CalleeAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.lookupAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;          <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*GuardedI-&gt;getFunction()), <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;          <a class="code" href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aab50339a10e1de285ac99d4c3990b8693">DepClassTy::NONE</a>);</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CalleeAA != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;Expected Callee AAKernelInfo&quot;</span>);</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      <span class="keyword">auto</span> &amp;CalleeAAFunction = *cast&lt;AAKernelInfoFunction&gt;(CalleeAA);</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      <span class="comment">// Continue if instruction is already guarded.</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <span class="keywordflow">if</span> (CalleeAAFunction.getGuardedInstructions().contains(GuardedI))</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160; </div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *GuardedRegionStart = <span class="keyword">nullptr</span>, *GuardedRegionEnd = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;        <span class="comment">// If instruction I needs to be guarded update the guarded region</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        <span class="comment">// bounds.</span></div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;        <span class="keywordflow">if</span> (SPMDCompatibilityTracker.contains(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;          CalleeAAFunction.getGuardedInstructions().insert(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;          <span class="keywordflow">if</span> (GuardedRegionStart)</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;            GuardedRegionEnd = &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;            GuardedRegionStart = GuardedRegionEnd = &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160; </div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        }</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160; </div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;        <span class="comment">// Instruction I does not need guarding, store</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;        <span class="comment">// any region found and reset bounds.</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;        <span class="keywordflow">if</span> (GuardedRegionStart) {</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;          GuardedRegions.push_back(</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;              std::make_pair(GuardedRegionStart, GuardedRegionEnd));</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;          GuardedRegionStart = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;          GuardedRegionEnd = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;        }</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      }</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    }</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160; </div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;GR : GuardedRegions)</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      CreateGuardedRegion(GR.first, GR.second);</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;  }</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160; </div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  <span class="keywordtype">void</span> forceSingleThreadPerWorkgroupHelper(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="comment">// Only allow 1 thread per workgroup to continue executing the user code.</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <span class="comment">//     InitCB = __kmpc_target_init(...)</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <span class="comment">//     ThreadIdInBlock = __kmpc_get_hardware_thread_id_in_block();</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    <span class="comment">//     if (ThreadIdInBlock != 0) return;</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="comment">// UserCode:</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    <span class="comment">//     // user code</span></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    <span class="keyword">auto</span> &amp;Ctx = getAnchorValue().getContext();</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="classllvm_1_1Function.html">Kernel</a> = getAssociatedFunction();</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Function.html">Kernel</a> &amp;&amp; <span class="stringliteral">&quot;Expected an associated function!&quot;</span>);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160; </div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    <span class="comment">// Create block for user code to branch to from initial block.</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InitBB = KernelInitCB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *UserCodeBB = InitBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        KernelInitCB-&gt;getNextNode(), <span class="stringliteral">&quot;main.thread.user_code&quot;</span>);</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ReturnBB =</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(Ctx, <span class="stringliteral">&quot;exit.threads&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeBB);</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160; </div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;    <span class="comment">// Register blocks with attributor:</span></div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*InitBB);</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*UserCodeBB);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*ReturnBB);</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160; </div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="comment">// Debug location:</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;DLoc = KernelInitCB-&gt;getDebugLoc();</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;    <a class="code" href="classllvm_1_1ReturnInst.html#a8c4c3b7c7daea37c75c50563654bf934">ReturnInst::Create</a>(Ctx, ReturnBB)-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;    InitBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160; </div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;    <span class="comment">// Prepare call to OMPRTL___kmpc_get_hardware_thread_id_in_block.</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> ThreadIdInBlockFn =</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            M, OMPRTL___kmpc_get_hardware_thread_id_in_block);</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160; </div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;    <span class="comment">// Get thread ID in block.</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *ThreadIdInBlock =</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(ThreadIdInBlockFn, <span class="stringliteral">&quot;thread_id.in.block&quot;</span>, InitBB);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    OMPInfoCache.setCallingConvention(ThreadIdInBlockFn, ThreadIdInBlock);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    ThreadIdInBlock-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    <span class="comment">// Eliminate all threads in the block with ID not equal to 0:</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IsMainThread =</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;        <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">ICmpInst::Create</a>(ICmpInst::ICmp, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a>, ThreadIdInBlock,</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                         <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(ThreadIdInBlock-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0),</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                         <span class="stringliteral">&quot;thread.is_main&quot;</span>, InitBB);</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    IsMainThread-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(ReturnBB, UserCodeBB, IsMainThread, InitBB);</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  }</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160; </div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;  <span class="keywordtype">bool</span> changeToSPMDMode(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> &amp;Changed) {</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160; </div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="comment">// We cannot change to SPMD mode if the runtime functions aren&#39;t availible.</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    <span class="keywordflow">if</span> (!OMPInfoCache.runtimeFnsAvailable(</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            {OMPRTL___kmpc_get_hardware_thread_id_in_block,</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;             OMPRTL___kmpc_barrier_simple_spmd}))</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160; </div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isAssumed()) {</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NonCompatibleI : SPMDCompatibilityTracker) {</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        <span class="keywordflow">if</span> (!NonCompatibleI)</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160; </div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;        <span class="comment">// Skip diagnostics on calls to known OpenMP runtime functions for now.</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(NonCompatibleI))</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;          <span class="keywordflow">if</span> (OMPInfoCache.RTLFunctions.contains(CB-&gt;getCalledFunction()))</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160; </div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;          ORA &lt;&lt; <span class="stringliteral">&quot;Value has potential side effects preventing SPMD-mode &quot;</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                 <span class="stringliteral">&quot;execution&quot;</span>;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;          <span class="keywordflow">if</span> (isa&lt;CallBase&gt;(NonCompatibleI)) {</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;            ORA &lt;&lt; <span class="stringliteral">&quot;. Add `__attribute__((assume(\&quot;ompx_spmd_amenable\&quot;)))` to &quot;</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;                   <span class="stringliteral">&quot;the called function to override&quot;</span>;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;          }</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;          <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        };</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>&gt;(NonCompatibleI, <span class="stringliteral">&quot;OMP121&quot;</span>,</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                                                 <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160; </div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;SPMD-incompatible side-effect: &quot;</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;                          &lt;&lt; *NonCompatibleI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;      }</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160; </div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;    }</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160; </div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    <span class="comment">// Get the actual kernel, could be the caller of the anchor scope if we have</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <span class="comment">// a debug wrapper.</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="classllvm_1_1Function.html">Kernel</a> = getAnchorScope();</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a3ba1af4b9d9faa4a33729bbbecee83d1">hasLocalLinkage</a>()) {</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() &amp;&amp; <span class="stringliteral">&quot;Unexpected use of debug kernel wrapper.&quot;</span>);</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      <span class="keyword">auto</span> *CB = cast&lt;CallBase&gt;(<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1Value.html#ac2e338e4c120fc3ea43099b54880f1f1">user_back</a>());</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Kernel</a> = CB-&gt;getCaller();</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    }</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OMPInfoCache.Kernels.count(<a class="code" href="classllvm_1_1Function.html">Kernel</a>) &amp;&amp; <span class="stringliteral">&quot;Expected kernel function!&quot;</span>);</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160; </div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="comment">// Check if the kernel is already in SPMD mode, if so, return success.</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a> *ExecMode = <a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#aeb548ad4e336f7f3d3cc91578b5de0a8">getGlobalVariable</a>(</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        (<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;_exec_mode&quot;</span>).str());</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ExecMode &amp;&amp; <span class="stringliteral">&quot;Kernel without exec mode?&quot;</span>);</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ExecMode-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">getInitializer</a>() &amp;&amp; <span class="stringliteral">&quot;ExecMode doesn&#39;t have initializer!&quot;</span>);</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160; </div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="comment">// Set the global exec mode flag to indicate SPMD-Generic mode.</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;ConstantInt&gt;(ExecMode-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">getInitializer</a>()) &amp;&amp;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;           <span class="stringliteral">&quot;ExecMode is not an integer!&quot;</span>);</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <span class="keyword">const</span> int8_t ExecModeVal =</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        cast&lt;ConstantInt&gt;(ExecMode-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">getInitializer</a>())-&gt;getSExtValue();</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    <span class="keywordflow">if</span> (ExecModeVal != <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430afa583a38ff705195c9bce9dec0c5eff8">OMP_TGT_EXEC_MODE_GENERIC</a>)</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160; </div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="comment">// We will now unconditionally modify the IR, indicate a change.</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160; </div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    <span class="comment">// Do not use instruction guards when no parallel is present inside</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    <span class="comment">// the target region.</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="keywordflow">if</span> (mayContainParallelRegion())</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      insertInstructionGuardsHelper(A);</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      forceSingleThreadPerWorkgroupHelper(A);</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160; </div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    <span class="comment">// Adjust the global exec mode flag that tells the runtime what mode this</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    <span class="comment">// kernel is executed in.</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ExecModeVal == <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430afa583a38ff705195c9bce9dec0c5eff8">OMP_TGT_EXEC_MODE_GENERIC</a> &amp;&amp;</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;           <span class="stringliteral">&quot;Initially non-SPMD kernel has SPMD exec mode!&quot;</span>);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    ExecMode-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a095f8f031d99ce3c0b25478713293dea">setInitializer</a>(</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(ExecMode-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">getInitializer</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                         ExecModeVal | <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a3a7132dd26b3986109b8fffccd140f41">OMP_TGT_EXEC_MODE_GENERIC_SPMD</a>));</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;    <span class="comment">// Next rewrite the init and deinit calls to indicate we use SPMD-mode now.</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> InitModeArgNo = 1;</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> DeinitModeArgNo = 1;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> InitUseStateMachineArgNo = 2;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160; </div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    <span class="keyword">auto</span> &amp;Ctx = getAnchorValue().getContext();</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeUseAfterManifest(</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        KernelInitCB-&gt;getArgOperandUse(InitModeArgNo),</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;        *<a class="code" href="classllvm_1_1ConstantInt.html#ad736fb9b585509388546c12617def38f">ConstantInt::getSigned</a>(<a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">IntegerType::getInt8Ty</a>(Ctx),</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;                                <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">OMP_TGT_EXEC_MODE_SPMD</a>));</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeUseAfterManifest(</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        KernelInitCB-&gt;getArgOperandUse(InitUseStateMachineArgNo),</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;        *<a class="code" href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">ConstantInt::getBool</a>(Ctx, <span class="keyword">false</span>));</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeUseAfterManifest(</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        KernelDeinitCB-&gt;getArgOperandUse(DeinitModeArgNo),</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;        *<a class="code" href="classllvm_1_1ConstantInt.html#ad736fb9b585509388546c12617def38f">ConstantInt::getSigned</a>(<a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">IntegerType::getInt8Ty</a>(Ctx),</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;                                <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">OMP_TGT_EXEC_MODE_SPMD</a>));</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160; </div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    ++NumOpenMPTargetRegionKernelsSPMD;</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160; </div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Transformed generic-mode kernel to SPMD-mode.&quot;</span>;</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    };</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>&gt;(KernelInitCB, <span class="stringliteral">&quot;OMP120&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;  };</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160; </div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> buildCustomStateMachine(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    <span class="comment">// If we have disabled state machine rewrites, don&#39;t make a custom one</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#aa9760ec3616ef020c7356dfc24a5cd7f">DisableOpenMPOptStateMachineRewrite</a>)</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160; </div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    <span class="comment">// Don&#39;t rewrite the state machine if we are not in a valid state.</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="keywordflow">if</span> (!ReachedKnownParallelRegions.isValidState())</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160; </div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <span class="keywordflow">if</span> (!OMPInfoCache.runtimeFnsAvailable(</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;            {OMPRTL___kmpc_get_hardware_num_threads_in_block,</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;             OMPRTL___kmpc_get_warp_size, OMPRTL___kmpc_barrier_simple_generic,</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;             OMPRTL___kmpc_kernel_parallel, OMPRTL___kmpc_kernel_end_parallel}))</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160; </div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> InitModeArgNo = 1;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> InitUseStateMachineArgNo = 2;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160; </div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    <span class="comment">// Check if the current configuration is non-SPMD and generic state machine.</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <span class="comment">// If we already have SPMD mode or a custom state machine we do not need to</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    <span class="comment">// go any further. If it is anything but a constant something is weird and</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <span class="comment">// we give up.</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *UseStateMachine = dyn_cast&lt;ConstantInt&gt;(</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;        KernelInitCB-&gt;getArgOperand(InitUseStateMachineArgNo));</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="SIWholeQuadMode_8cpp.html#a0c198437833c48138f49e3589bd08773">Mode</a> =</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;        dyn_cast&lt;ConstantInt&gt;(KernelInitCB-&gt;getArgOperand(InitModeArgNo));</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160; </div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    <span class="comment">// If we are stuck with generic mode, try to create a custom device (=GPU)</span></div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    <span class="comment">// state machine which is specialized for the parallel regions that are</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    <span class="comment">// reachable by the kernel.</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <span class="keywordflow">if</span> (!UseStateMachine || UseStateMachine-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>() || !<a class="code" href="SIWholeQuadMode_8cpp.html#a0c198437833c48138f49e3589bd08773">Mode</a> ||</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;        (<a class="code" href="SIWholeQuadMode_8cpp.html#a0c198437833c48138f49e3589bd08773">Mode</a>-&gt;getSExtValue() &amp; <a class="code" href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">OMP_TGT_EXEC_MODE_SPMD</a>))</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160; </div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    <span class="comment">// If not SPMD mode, indicate we use a custom state machine now.</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    <span class="keyword">auto</span> &amp;Ctx = getAnchorValue().getContext();</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a> = <a class="code" href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">ConstantInt::getBool</a>(Ctx, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeUseAfterManifest(</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;        KernelInitCB-&gt;getArgOperandUse(InitUseStateMachineArgNo), *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a>);</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160; </div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;    <span class="comment">// If we don&#39;t actually need a state machine we are done here. This can</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    <span class="comment">// happen if there simply are no parallel regions. In the resulting kernel</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    <span class="comment">// all worker threads will simply exit right away, leaving the main thread</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    <span class="comment">// to do the work alone.</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    <span class="keywordflow">if</span> (!mayContainParallelRegion()) {</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;      ++NumOpenMPTargetRegionKernelsWithoutStateMachine;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160; </div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Removing unused state machine from generic-mode kernel.&quot;</span>;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;      };</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>&gt;(KernelInitCB, <span class="stringliteral">&quot;OMP130&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160; </div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    }</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160; </div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    <span class="comment">// Keep track in the statistics of our new shiny custom state machine.</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;    <span class="keywordflow">if</span> (ReachedUnknownParallelRegions.empty()) {</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;      ++NumOpenMPTargetRegionKernelsCustomStateMachineWithoutFallback;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160; </div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Rewriting generic-mode kernel with a customized state &quot;</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;                     <span class="stringliteral">&quot;machine.&quot;</span>;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;      };</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>&gt;(KernelInitCB, <span class="stringliteral">&quot;OMP131&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      ++NumOpenMPTargetRegionKernelsCustomStateMachineWithFallback;</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160; </div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Generic-mode kernel is executed with a customized state &quot;</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                     <span class="stringliteral">&quot;machine that requires a fallback.&quot;</span>;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      };</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>&gt;(KernelInitCB, <span class="stringliteral">&quot;OMP132&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160; </div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      <span class="comment">// Tell the user why we ended up with a fallback.</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *UnknownParallelRegionCB : ReachedUnknownParallelRegions) {</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;        <span class="keywordflow">if</span> (!UnknownParallelRegionCB)</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;        <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA) {</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;          <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;Call may contain unknown parallel regions. Use &quot;</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;`__attribute__((assume(\&quot;omp_no_parallelism\&quot;)))` to &quot;</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                        <span class="stringliteral">&quot;override.&quot;</span>;</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        };</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>&gt;(UnknownParallelRegionCB,</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                                                 <span class="stringliteral">&quot;OMP133&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      }</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    }</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160; </div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    <span class="comment">// Create all the blocks:</span></div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    <span class="comment">//                       InitCB = __kmpc_target_init(...)</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    <span class="comment">//                       BlockHwSize =</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    <span class="comment">//                         __kmpc_get_hardware_num_threads_in_block();</span></div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;    <span class="comment">//                       WarpSize = __kmpc_get_warp_size();</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;    <span class="comment">//                       BlockSize = BlockHwSize - WarpSize;</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    <span class="comment">// IsWorkerCheckBB:      bool IsWorker = InitCB != -1;</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <span class="comment">//                       if (IsWorker) {</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    <span class="comment">//                         if (InitCB &gt;= BlockSize) return;</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="comment">// SMBeginBB:               __kmpc_barrier_simple_generic(...);</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="comment">//                         void *WorkFn;</span></div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    <span class="comment">//                         bool Active = __kmpc_kernel_parallel(&amp;WorkFn);</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;    <span class="comment">//                         if (!WorkFn) return;</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    <span class="comment">// SMIsActiveCheckBB:       if (Active) {</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    <span class="comment">// SMIfCascadeCurrentBB:      if      (WorkFn == &lt;ParFn0&gt;)</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    <span class="comment">//                              ParFn0(...);</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <span class="comment">// SMIfCascadeCurrentBB:      else if (WorkFn == &lt;ParFn1&gt;)</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <span class="comment">//                              ParFn1(...);</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    <span class="comment">//                            ...</span></div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    <span class="comment">// SMIfCascadeCurrentBB:      else</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;    <span class="comment">//                              ((WorkFnTy*)WorkFn)(...);</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    <span class="comment">// SMEndParallelBB:           __kmpc_kernel_end_parallel(...);</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <span class="comment">//                          }</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    <span class="comment">// SMDoneBB:                __kmpc_barrier_simple_generic(...);</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <span class="comment">//                          goto SMBeginBB;</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    <span class="comment">//                       }</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="comment">// UserCodeEntryBB:      // user code</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;    <span class="comment">//                       __kmpc_target_deinit(...)</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="classllvm_1_1Function.html">Kernel</a> = getAssociatedFunction();</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Function.html">Kernel</a> &amp;&amp; <span class="stringliteral">&quot;Expected an associated function!&quot;</span>);</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160; </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InitBB = KernelInitCB-&gt;getParent();</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *UserCodeEntryBB = InitBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        KernelInitCB-&gt;getNextNode(), <span class="stringliteral">&quot;thread.user_code.check&quot;</span>);</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IsWorkerCheckBB =</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(Ctx, <span class="stringliteral">&quot;is_worker_check&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StateMachineBeginBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        Ctx, <span class="stringliteral">&quot;worker_state_machine.begin&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StateMachineFinishedBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        Ctx, <span class="stringliteral">&quot;worker_state_machine.finished&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StateMachineIsActiveCheckBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        Ctx, <span class="stringliteral">&quot;worker_state_machine.is_active.check&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StateMachineIfCascadeCurrentBB =</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(Ctx, <span class="stringliteral">&quot;worker_state_machine.parallel_region.check&quot;</span>,</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;                           <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StateMachineEndParallelBB =</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(Ctx, <span class="stringliteral">&quot;worker_state_machine.parallel_region.end&quot;</span>,</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                           <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StateMachineDoneBarrierBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        Ctx, <span class="stringliteral">&quot;worker_state_machine.done.barrier&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>, UserCodeEntryBB);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*InitBB);</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*UserCodeEntryBB);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*IsWorkerCheckBB);</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*StateMachineBeginBB);</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*StateMachineFinishedBB);</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*StateMachineIsActiveCheckBB);</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*StateMachineIfCascadeCurrentBB);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*StateMachineEndParallelBB);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerManifestAddedBasicBlock(*StateMachineDoneBarrierBB);</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160; </div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;DLoc = KernelInitCB-&gt;getDebugLoc();</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    <a class="code" href="classllvm_1_1ReturnInst.html#a8c4c3b7c7daea37c75c50563654bf934">ReturnInst::Create</a>(Ctx, StateMachineFinishedBB)-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    InitBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160; </div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IsWorker =</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">ICmpInst::Create</a>(ICmpInst::ICmp, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a>, KernelInitCB,</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                         <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(KernelInitCB-&gt;getType(), -1),</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                         <span class="stringliteral">&quot;thread.is_worker&quot;</span>, InitBB);</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    IsWorker-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(IsWorkerCheckBB, UserCodeEntryBB, IsWorker, InitBB);</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160; </div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> BlockHwSizeFn =</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;        OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;            M, OMPRTL___kmpc_get_hardware_num_threads_in_block);</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> WarpSizeFn =</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;        OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;            M, OMPRTL___kmpc_get_warp_size);</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *BlockHwSize =</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(BlockHwSizeFn, <span class="stringliteral">&quot;block.hw_size&quot;</span>, IsWorkerCheckBB);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    OMPInfoCache.setCallingConvention(BlockHwSizeFn, BlockHwSize);</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    BlockHwSize-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *WarpSize =</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(WarpSizeFn, <span class="stringliteral">&quot;warp.size&quot;</span>, IsWorkerCheckBB);</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    OMPInfoCache.setCallingConvention(WarpSizeFn, WarpSize);</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    WarpSize-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="TarWriter_8cpp.html#aac035f4156e2604bfa42ba22c17b83ee">BlockSize</a> = BinaryOperator::CreateSub(</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        BlockHwSize, WarpSize, <span class="stringliteral">&quot;block.size&quot;</span>, IsWorkerCheckBB);</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    <a class="code" href="TarWriter_8cpp.html#aac035f4156e2604bfa42ba22c17b83ee">BlockSize</a>-&gt;setDebugLoc(DLoc);</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IsMainOrWorker = <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">ICmpInst::Create</a>(</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        ICmpInst::ICmp, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a>, KernelInitCB, <a class="code" href="TarWriter_8cpp.html#aac035f4156e2604bfa42ba22c17b83ee">BlockSize</a>,</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        <span class="stringliteral">&quot;thread.is_main_or_worker&quot;</span>, IsWorkerCheckBB);</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    IsMainOrWorker-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineBeginBB, StateMachineFinishedBB,</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;                       IsMainOrWorker, IsWorkerCheckBB);</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160; </div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;    <span class="comment">// Create local storage for the work function pointer.</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getDataLayout();</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *VoidPtrTy = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(Ctx);</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WorkFnAI =</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;        <span class="keyword">new</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>(VoidPtrTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getAllocaAddrSpace(), <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                       <span class="stringliteral">&quot;worker.work_fn.addr&quot;</span>, &amp;<a class="code" href="classllvm_1_1Function.html">Kernel</a>-&gt;<a class="code" href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">getEntryBlock</a>().<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    WorkFnAI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160; </div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;    OMPInfoCache.OMPBuilder.updateToLocation(</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;        <a class="code" href="structllvm_1_1OpenMPIRBuilder_1_1LocationDescription.html">OpenMPIRBuilder::LocationDescription</a>(</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;            <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;::InsertPoint</a>(StateMachineBeginBB,</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;                                     StateMachineBeginBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()),</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;            DLoc));</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160; </div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ident = KernelInitCB-&gt;getArgOperand(0);</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *GTid = KernelInitCB;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160; </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> BarrierFn =</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;            M, OMPRTL___kmpc_barrier_simple_generic);</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a> =</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(BarrierFn, {Ident, GTid}, <span class="stringliteral">&quot;&quot;</span>, StateMachineBeginBB);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    OMPInfoCache.setCallingConvention(BarrierFn, <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a>);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">Barrier</a>-&gt;setDebugLoc(DLoc);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160; </div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    <span class="keywordflow">if</span> (WorkFnAI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>() !=</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="namespacellvm_1_1omp.html#a8c6f525466cc262e00c409c31f9a4272a8045a0a6c688b0635e3caccc408a1446">AddressSpace::Generic</a>) {</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;      WorkFnAI = <span class="keyword">new</span> <a class="code" href="classllvm_1_1AddrSpaceCastInst.html">AddrSpaceCastInst</a>(</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;          WorkFnAI,</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;          <a class="code" href="classllvm_1_1PointerType.html#ac0f741735997264d3018e30ce2a6b2d3">PointerType::getWithSamePointeeType</a>(</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;              cast&lt;PointerType&gt;(WorkFnAI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()),</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;              (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)<a class="code" href="namespacellvm_1_1omp.html#a8c6f525466cc262e00c409c31f9a4272a8045a0a6c688b0635e3caccc408a1446">AddressSpace::Generic</a>),</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;          WorkFnAI-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.generic&quot;</span>, StateMachineBeginBB);</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      WorkFnAI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;    }</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160; </div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> KernelParallelFn =</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;            M, OMPRTL___kmpc_kernel_parallel);</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *IsActiveWorker = <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;        KernelParallelFn, {WorkFnAI}, <span class="stringliteral">&quot;worker.is_active&quot;</span>, StateMachineBeginBB);</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    OMPInfoCache.setCallingConvention(KernelParallelFn, IsActiveWorker);</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    IsActiveWorker-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WorkFn = <span class="keyword">new</span> <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>(VoidPtrTy, WorkFnAI, <span class="stringliteral">&quot;worker.work_fn&quot;</span>,</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;                                       StateMachineBeginBB);</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;    WorkFn-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160; </div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *ParallelRegionFnTy = <a class="code" href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">FunctionType::get</a>(</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        <a class="code" href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(Ctx), {<a class="code" href="classllvm_1_1Type.html#a87f56db834c58ca630624956ecf6972f">Type::getInt16Ty</a>(Ctx), <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx)},</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;        <span class="keyword">false</span>);</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *WorkFnCast = <a class="code" href="classllvm_1_1CastInst.html#aa1a58843d7d645d5cf0390a68c7fd852">BitCastInst::CreatePointerBitCastOrAddrSpaceCast</a>(</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;        WorkFn, ParallelRegionFnTy-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(), <span class="stringliteral">&quot;worker.work_fn.addr_cast&quot;</span>,</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;        StateMachineBeginBB);</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160; </div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IsDone =</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;        <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">ICmpInst::Create</a>(ICmpInst::ICmp, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a>, WorkFn,</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                         <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(VoidPtrTy), <span class="stringliteral">&quot;worker.is_done&quot;</span>,</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                         StateMachineBeginBB);</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    IsDone-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineFinishedBB, StateMachineIsActiveCheckBB,</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                       IsDone, StateMachineBeginBB)</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;        -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160; </div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineIfCascadeCurrentBB,</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                       StateMachineDoneBarrierBB, IsActiveWorker,</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;                       StateMachineIsActiveCheckBB)</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;        -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160; </div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ZeroArg =</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;        <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(ParallelRegionFnTy-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">getParamType</a>(0));</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160; </div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    <span class="comment">// Now that we have most of the CFG skeleton it is time for the if-cascade</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    <span class="comment">// that checks the function pointer we got from the runtime against the</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    <span class="comment">// parallel regions we expect, if there are any.</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = ReachedKnownParallelRegions.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;      <span class="keyword">auto</span> *ParallelRegion = ReachedKnownParallelRegions[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PRExecuteBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;          Ctx, <span class="stringliteral">&quot;worker_state_machine.parallel_region.execute&quot;</span>, <a class="code" href="classllvm_1_1Function.html">Kernel</a>,</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;          StateMachineEndParallelBB);</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(ParallelRegion, {ZeroArg, GTid}, <span class="stringliteral">&quot;&quot;</span>, PRExecuteBB)</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;          -&gt;setDebugLoc(DLoc);</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineEndParallelBB, PRExecuteBB)</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;          -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160; </div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PRNextBB =</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(Ctx, <span class="stringliteral">&quot;worker_state_machine.parallel_region.check&quot;</span>,</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;                             <a class="code" href="classllvm_1_1Function.html">Kernel</a>, StateMachineEndParallelBB);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160; </div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;      <span class="comment">// Check if we need to compare the pointer at all or if we can just</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;      <span class="comment">// call the parallel region function.</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *IsPR;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> + 1 &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> || !ReachedUnknownParallelRegions.empty()) {</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CmpI = <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">ICmpInst::Create</a>(</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;            ICmpInst::ICmp, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a>, WorkFnCast, ParallelRegion,</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;            <span class="stringliteral">&quot;worker.check_parallel_region&quot;</span>, StateMachineIfCascadeCurrentBB);</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;        CmpI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;        IsPR = CmpI;</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;        IsPR = <a class="code" href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(Ctx);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      }</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160; </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(PRExecuteBB, PRNextBB, IsPR,</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;                         StateMachineIfCascadeCurrentBB)</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;          -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      StateMachineIfCascadeCurrentBB = PRNextBB;</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    }</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160; </div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    <span class="comment">// At the end of the if-cascade we place the indirect function pointer call</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    <span class="comment">// in case we might need it, that is if there can be parallel regions we</span></div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    <span class="comment">// have not handled in the if-cascade above.</span></div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    <span class="keywordflow">if</span> (!ReachedUnknownParallelRegions.empty()) {</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      StateMachineIfCascadeCurrentBB-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;          <span class="stringliteral">&quot;worker_state_machine.parallel_region.fallback.execute&quot;</span>);</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(ParallelRegionFnTy, WorkFnCast, {ZeroArg, GTid}, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                       StateMachineIfCascadeCurrentBB)</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;          -&gt;setDebugLoc(DLoc);</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    }</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineEndParallelBB,</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;                       StateMachineIfCascadeCurrentBB)</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;        -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160; </div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> EndParallelFn =</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;        OMPInfoCache.OMPBuilder.getOrCreateRuntimeFunction(</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;            M, OMPRTL___kmpc_kernel_end_parallel);</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *EndParallel =</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(EndParallelFn, {}, <span class="stringliteral">&quot;&quot;</span>, StateMachineEndParallelBB);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    OMPInfoCache.setCallingConvention(EndParallelFn, EndParallel);</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    EndParallel-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineDoneBarrierBB, StateMachineEndParallelBB)</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;        -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160; </div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(BarrierFn, {Ident, GTid}, <span class="stringliteral">&quot;&quot;</span>, StateMachineDoneBarrierBB)</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;        -&gt;setDebugLoc(DLoc);</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(StateMachineBeginBB, StateMachineDoneBarrierBB)</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;        -&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(DLoc);</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160; </div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  }</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="comment">  /// Fixpoint iteration update function. Will be called every time a dependence</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="comment">  /// changed its state (and in the beginning).</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    KernelInfoState StateBefore = getState();</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160; </div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    <span class="comment">// Callback to check a read/write instruction.</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    <span class="keyword">auto</span> CheckRWInst = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;      <span class="comment">// We handle calls later.</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      <span class="keywordflow">if</span> (isa&lt;CallBase&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      <span class="comment">// We only care about write effects.</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayWriteToMemory())</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;UnderlyingObjsAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAUnderlyingObjects.html">AAUnderlyingObjects</a>&gt;(</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;            *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a3bee165465962ee97307066da4f0fb13">IRPosition::value</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand()),</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;            <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;        <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">HS</a> = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAHeapToStack.html">AAHeapToStack</a>&gt;(</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;            *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getFunction()),</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;            <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;        <span class="keywordflow">if</span> (UnderlyingObjsAA.forallUnderlyingObjects([&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> &amp;Obj) {</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;              if (AA::isAssumedThreadLocalObject(A, Obj, *this))</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;                return true;</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;              <span class="comment">// Check for AAHeapToStack moved objects which must not be</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;              <span class="comment">// guarded.</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;              auto *CB = dyn_cast&lt;CallBase&gt;(&amp;Obj);</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;              return CB &amp;&amp; HS.isAssumedHeapToStack(*CB);</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;            }))</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      }</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160; </div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      <span class="comment">// Insert instruction that needs guarding.</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      SPMDCompatibilityTracker.insert(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;    };</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160; </div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;    <span class="keywordtype">bool</span> UsedAssumedInformationInCheckRWInst = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.checkForAllReadWriteInstructions(</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;              CheckRWInst, *<span class="keyword">this</span>, UsedAssumedInformationInCheckRWInst))</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;        SPMDCompatibilityTracker.<a class="code" href="structllvm_1_1IntegerStateBase.html#aa3d9223692390a32c796d8160c6f058c">indicatePessimisticFixpoint</a>();</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160; </div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;    <span class="keywordtype">bool</span> UsedAssumedInformationFromReachingKernels = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    <span class="keywordflow">if</span> (!IsKernelEntry) {</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;      updateParallelLevels(A);</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160; </div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;      <span class="keywordtype">bool</span> AllReachingKernelsKnown = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;      updateReachingKernelEntries(A, AllReachingKernelsKnown);</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;      UsedAssumedInformationFromReachingKernels = !AllReachingKernelsKnown;</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160; </div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;      <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.empty()) {</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;        <span class="keywordflow">if</span> (!ParallelLevels.isValidState())</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;          SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ReachingKernelEntries.isValidState())</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;          SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;          <span class="comment">// Check if all reaching kernels agree on the mode as we can otherwise</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;          <span class="comment">// not guard instructions. We might not be sure about the mode so we</span></div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;          <span class="comment">// we cannot fix the internal spmd-zation state either.</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;          <span class="keywordtype">int</span> SPMD = 0, <a class="code" href="AArch64MCAsmInfo_8cpp.html#ad9974102ac4ab550bae0600eca728899a9683fc965be285edded4502f972f9d19">Generic</a> = 0;</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="classllvm_1_1Function.html">Kernel</a> : ReachingKernelEntries) {</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;            <span class="keyword">auto</span> &amp;CBAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*<a class="code" href="classllvm_1_1Function.html">Kernel</a>), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;            <span class="keywordflow">if</span> (CBAA.SPMDCompatibilityTracker.isValidState() &amp;&amp;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;                CBAA.SPMDCompatibilityTracker.isAssumed())</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;              ++SPMD;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;              ++<a class="code" href="AArch64MCAsmInfo_8cpp.html#ad9974102ac4ab550bae0600eca728899a9683fc965be285edded4502f972f9d19">Generic</a>;</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;            <span class="keywordflow">if</span> (!CBAA.SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;              UsedAssumedInformationFromReachingKernels = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;          }</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;          <span class="keywordflow">if</span> (SPMD != 0 &amp;&amp; Generic != 0)</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;            SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;        }</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;      }</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    }</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160; </div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    <span class="comment">// Callback to check a call instruction.</span></div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;    <span class="keywordtype">bool</span> AllParallelRegionStatesWereFixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    <span class="keywordtype">bool</span> AllSPMDStatesWereFixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;    <span class="keyword">auto</span> CheckCallInst = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      <span class="keyword">auto</span> &amp;CB = cast&lt;CallBase&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      <span class="keyword">auto</span> &amp;CBAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;          *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#aeef35bb007616add7418161b0313b56b">IRPosition::callsite_function</a>(CB), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      getState() ^= CBAA.getState();</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;      AllSPMDStatesWereFixed &amp;= CBAA.SPMDCompatibilityTracker.isAtFixpoint();</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      AllParallelRegionStatesWereFixed &amp;=</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;          CBAA.ReachedKnownParallelRegions.isAtFixpoint();</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;      AllParallelRegionStatesWereFixed &amp;=</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;          CBAA.ReachedUnknownParallelRegions.isAtFixpoint();</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;    };</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160; </div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;    <span class="keywordtype">bool</span> UsedAssumedInformationInCheckCallInst = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.checkForAllCallLikeInstructions(</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;            CheckCallInst, *<span class="keyword">this</span>, UsedAssumedInformationInCheckCallInst)) {</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;Failed to visit all call-like instructions!\n&quot;</span>;);</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160; </div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <span class="comment">// If we haven&#39;t used any assumed information for the reached parallel</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;    <span class="comment">// region states we can fix it.</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    <span class="keywordflow">if</span> (!UsedAssumedInformationInCheckCallInst &amp;&amp;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;        AllParallelRegionStatesWereFixed) {</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      ReachedKnownParallelRegions.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      ReachedUnknownParallelRegions.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    }</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160; </div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="comment">// If we haven&#39;t used any assumed information for the SPMD state we can fix</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="comment">// it.</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    <span class="keywordflow">if</span> (!UsedAssumedInformationInCheckRWInst &amp;&amp;</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;        !UsedAssumedInformationInCheckCallInst &amp;&amp;</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;        !UsedAssumedInformationFromReachingKernels &amp;&amp; AllSPMDStatesWereFixed)</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;      SPMDCompatibilityTracker.indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160; </div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    <span class="keywordflow">return</span> StateBefore == getState() ? <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                                     : <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;  }</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160; </div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;<span class="comment">  /// Update info regarding reaching kernels.</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> updateReachingKernelEntries(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A,</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                                   <span class="keywordtype">bool</span> &amp;AllReachingKernelsKnown) {</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;    <span class="keyword">auto</span> PredCallSite = [&amp;](<a class="code" href="classllvm_1_1AbstractCallSite.html">AbstractCallSite</a> ACS) {</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = ACS.getInstruction()-&gt;getFunction();</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160; </div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Caller &amp;&amp; <span class="stringliteral">&quot;Caller is nullptr&quot;</span>);</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160; </div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      <span class="keyword">auto</span> &amp;CAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;          <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*Caller), <span class="keyword">this</span>, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      <span class="keywordflow">if</span> (CAA.ReachingKernelEntries.isValidState()) {</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;        ReachingKernelEntries ^= CAA.ReachingKernelEntries;</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;      }</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160; </div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="comment">// We lost track of the caller of the associated function, any kernel</span></div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <span class="comment">// could reach now.</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;      ReachingKernelEntries.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160; </div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    };</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160; </div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.checkForAllCallSites(PredCallSite, *<span class="keyword">this</span>,</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                                <span class="keyword">true</span> <span class="comment">/* RequireAllCallSites */</span>,</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                                AllReachingKernelsKnown))</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;      ReachingKernelEntries.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  }</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;<span class="comment">  /// Update info regarding parallel levels.</span></div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> updateParallelLevels(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;Parallel51RFI =</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_parallel_51];</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160; </div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    <span class="keyword">auto</span> PredCallSite = [&amp;](<a class="code" href="classllvm_1_1AbstractCallSite.html">AbstractCallSite</a> ACS) {</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = ACS.getInstruction()-&gt;getFunction();</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160; </div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Caller &amp;&amp; <span class="stringliteral">&quot;Caller is nullptr&quot;</span>);</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160; </div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;      <span class="keyword">auto</span> &amp;CAA =</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;          <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;AAKernelInfo&gt;(<a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*Caller));</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;      <span class="keywordflow">if</span> (CAA.ParallelLevels.isValidState()) {</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;        <span class="comment">// Any function that is called by `__kmpc_parallel_51` will not be</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;        <span class="comment">// folded as the parallel level in the function is updated. In order to</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;        <span class="comment">// get it right, all the analysis would depend on the implentation. That</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;        <span class="comment">// said, if in the future any change to the implementation, the analysis</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;        <span class="comment">// could be wrong. As a consequence, we are just conservative here.</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;        <span class="keywordflow">if</span> (Caller == Parallel51RFI.Declaration) {</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;          ParallelLevels.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;        }</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160; </div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;        ParallelLevels ^= CAA.ParallelLevels;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160; </div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;      }</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160; </div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;      <span class="comment">// We lost track of the caller of the associated function, any kernel</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;      <span class="comment">// could reach now.</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;      ParallelLevels.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160; </div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    };</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160; </div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    <span class="keywordtype">bool</span> AllCallSitesKnown = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.checkForAllCallSites(PredCallSite, *<span class="keyword">this</span>,</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;                                <span class="keyword">true</span> <span class="comment">/* RequireAllCallSites */</span>,</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;                                AllCallSitesKnown))</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;      ParallelLevels.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;  }</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;};</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;<span class="comment">/// The call site kernel info abstract attribute, basically, what can we say</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;<span class="comment">/// about a call site with regards to the KernelInfoState. For now this simply</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;<span class="comment">/// forwards the information from the callee.</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;<span class="comment"></span><span class="keyword">struct </span>AAKernelInfoCallSite : AAKernelInfo {</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;  AAKernelInfoCallSite(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      : AAKernelInfo(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="comment">  /// See AbstractAttribute::initialize(...).</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">AAKernelInfo::initialize</a>(A);</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160; </div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB = cast&lt;CallBase&gt;(getAssociatedValue());</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = getAssociatedFunction();</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160; </div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <span class="keyword">auto</span> &amp;AssumptionAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAAssumptionInfo.html">AAAssumptionInfo</a>&gt;(</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#aeef35bb007616add7418161b0313b56b">IRPosition::callsite_function</a>(CB), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160; </div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;    <span class="comment">// Check for SPMD-mode assumptions.</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;    <span class="keywordflow">if</span> (AssumptionAA.hasAssumption(<span class="stringliteral">&quot;ompx_spmd_amenable&quot;</span>)) {</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      SPMDCompatibilityTracker.<a class="code" href="structllvm_1_1SetState.html#a9ff5a4bc95239fcf7ec442a9c1bf0cc9">indicateOptimisticFixpoint</a>();</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;      indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;    }</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160; </div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;    <span class="comment">// First weed out calls we do not care about, that is readonly/readnone</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;    <span class="comment">// calls, intrinsics, and &quot;no_openmp&quot; calls. Neither of these can reach a</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;    <span class="comment">// parallel region or anything else we are looking for.</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;    <span class="keywordflow">if</span> (!CB.<a class="code" href="classllvm_1_1Instruction.html#a383175f96316074965ad115706bd49d7">mayWriteToMemory</a>() || isa&lt;IntrinsicInst&gt;(CB)) {</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;      indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    }</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160; </div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;    <span class="comment">// Next we check if we know the callee. If it is a known OpenMP function</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;    <span class="comment">// we will handle them explicitly in the switch below. If it is not, we</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    <span class="comment">// will use an AAKernelInfo object on the callee to gather information and</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    <span class="comment">// merge that into the current state. The latter happens in the updateImpl.</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;It = OMPInfoCache.RuntimeFunctionIDMap.find(Callee);</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    <span class="keywordflow">if</span> (It == OMPInfoCache.RuntimeFunctionIDMap.end()) {</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      <span class="comment">// Unknown caller or declarations are not analyzable, we give up.</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      <span class="keywordflow">if</span> (!Callee || !<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.isFunctionIPOAmendable(*Callee)) {</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160; </div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;        <span class="comment">// Unknown callees might contain parallel regions, except if they have</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;        <span class="comment">// an appropriate assumption attached.</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;        <span class="keywordflow">if</span> (!(AssumptionAA.hasAssumption(<span class="stringliteral">&quot;omp_no_openmp&quot;</span>) ||</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;              AssumptionAA.hasAssumption(<span class="stringliteral">&quot;omp_no_parallelism&quot;</span>)))</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;          ReachedUnknownParallelRegions.insert(&amp;CB);</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160; </div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;        <span class="comment">// If SPMDCompatibilityTracker is not fixed, we need to give up on the</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        <span class="comment">// idea we can run something unknown in SPMD-mode.</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        <span class="keywordflow">if</span> (!SPMDCompatibilityTracker.isAtFixpoint()) {</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;          SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;          SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;        }</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160; </div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;        <span class="comment">// We have updated the state for this unknown call properly, there won&#39;t</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;        <span class="comment">// be any change so we indicate a fixpoint.</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;        indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      }</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;      <span class="comment">// If the callee is known and can be used in IPO, we will update the state</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      <span class="comment">// based on the callee state in updateImpl.</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;    }</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160; </div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> WrapperFunctionArgNo = 6;</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RF = It-&gt;getSecond();</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;    <span class="keywordflow">switch</span> (RF) {</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    <span class="comment">// All the functions we know are compatible with SPMD mode.</span></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_is_spmd_exec_mode:</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_distribute_static_fini:</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_for_static_fini:</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_global_thread_num:</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_get_hardware_num_threads_in_block:</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_get_hardware_num_blocks:</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_single:</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_end_single:</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_master:</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_end_master:</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_barrier:</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_nvptx_parallel_reduce_nowait_v2:</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_nvptx_teams_reduce_nowait_v2:</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_nvptx_end_reduce_nowait:</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_distribute_static_init_4:</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_distribute_static_init_4u:</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_distribute_static_init_8:</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_distribute_static_init_8u:</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_for_static_init_4:</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_for_static_init_4u:</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_for_static_init_8:</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_for_static_init_8u: {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;      <span class="comment">// Check the schedule and allow static schedule in SPMD mode.</span></div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;      <span class="keywordtype">unsigned</span> ScheduleArgOpNo = 2;</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;      <span class="keyword">auto</span> *ScheduleTypeCI =</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;          dyn_cast&lt;ConstantInt&gt;(CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ScheduleArgOpNo));</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;      <span class="keywordtype">unsigned</span> ScheduleTypeVal =</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;          ScheduleTypeCI ? ScheduleTypeCI-&gt;getZExtValue() : 0;</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a>(ScheduleTypeVal)) {</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7a5ced2def0c3f656428eb2144b4aaf6fb">OMPScheduleType::UnorderedStatic</a>:</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7adfd02d2fed222f2c28301f5ac837f2b2">OMPScheduleType::UnorderedStaticChunked</a>:</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7ac1d5528b6ced491ba685b8d29ce649c2">OMPScheduleType::OrderedDistribute</a>:</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7ab32d50fad87058c7739867aa6c7f05b0">OMPScheduleType::OrderedDistributeChunked</a>:</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;        SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;      };</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_target_init:</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;      KernelInitCB = &amp;CB;</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_target_deinit:</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;      KernelDeinitCB = &amp;CB;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_parallel_51:</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ParallelRegion = dyn_cast&lt;Function&gt;(</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;              CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(WrapperFunctionArgNo)-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>())) {</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;        ReachedKnownParallelRegions.insert(ParallelRegion);<span class="comment"></span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;<span class="comment">        /// Check nested parallelism</span></div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;<span class="comment"></span>        <span class="keyword">auto</span> &amp;FnAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;            *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*ParallelRegion), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;        NestedParallelism |= !FnAA.getState().isValidState() ||</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;                             !FnAA.ReachedKnownParallelRegions.empty() ||</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;                             !FnAA.ReachedUnknownParallelRegions.empty();</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;      }</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;      <span class="comment">// The condition above should usually get the parallel region function</span></div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;      <span class="comment">// pointer and record it. In the off chance it doesn&#39;t we assume the</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;      <span class="comment">// worst.</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      ReachedUnknownParallelRegions.insert(&amp;CB);</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_omp_task:</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      <span class="comment">// We do not look into tasks right now, just give up.</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      ReachedUnknownParallelRegions.insert(&amp;CB);</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_alloc_shared:</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_free_shared:</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;      <span class="comment">// Return without setting a fixpoint, to be resolved in updateImpl.</span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;      <span class="comment">// Unknown OpenMP runtime calls cannot be executed in SPMD-mode,</span></div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;      <span class="comment">// generally. However, they do not hide parallel regions.</span></div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;      SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;    }</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;    <span class="comment">// All other OpenMP runtime calls will not reach parallel regions so they</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;    <span class="comment">// can be safely ignored for now. Since it is a known OpenMP runtime call we</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    <span class="comment">// have now modeled all effects and there is no need for any update.</span></div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    indicateOptimisticFixpoint();</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;  }</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160; </div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;    <span class="comment">// TODO: Once we have call site specific value information we can provide</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    <span class="comment">//       call site specific liveness information and then it makes</span></div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;    <span class="comment">//       sense to specialize attributes for call sites arguments instead of</span></div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    <span class="comment">//       redirecting requests to the callee argument.</span></div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getAssociatedFunction();</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160; </div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;It = OMPInfoCache.RuntimeFunctionIDMap.find(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160; </div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;    <span class="comment">// If F is not a runtime function, propagate the AAKernelInfo of the callee.</span></div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    <span class="keywordflow">if</span> (It == OMPInfoCache.RuntimeFunctionIDMap.end()) {</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;FnPos = <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      <span class="keyword">auto</span> &amp;FnAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(*<span class="keyword">this</span>, FnPos, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <span class="keywordflow">if</span> (getState() == FnAA.getState())</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      getState() = FnAA.getState();</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;    }</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160; </div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;    <span class="comment">// F is a runtime function that allocates or frees memory, check</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    <span class="comment">// AAHeapToStack and AAHeapToShared.</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;    KernelInfoState StateBefore = getState();</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((It-&gt;getSecond() == OMPRTL___kmpc_alloc_shared ||</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;            It-&gt;getSecond() == OMPRTL___kmpc_free_shared) &amp;&amp;</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;           <span class="stringliteral">&quot;Expected a __kmpc_alloc_shared or __kmpc_free_shared runtime call&quot;</span>);</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160; </div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB = cast&lt;CallBase&gt;(getAssociatedValue());</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160; </div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;    <span class="keyword">auto</span> &amp;HeapToStackAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;<a class="code" href="structllvm_1_1AAHeapToStack.html">AAHeapToStack</a>&gt;(</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*CB.<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;    <span class="keyword">auto</span> &amp;HeapToSharedAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAHeapToShared&gt;(</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*CB.<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160; </div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;    <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RF = It-&gt;getSecond();</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160; </div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    <span class="keywordflow">switch</span> (RF) {</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;    <span class="comment">// If neither HeapToStack nor HeapToShared assume the call is removed,</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    <span class="comment">// assume SPMD incompatibility.</span></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_alloc_shared:</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;      <span class="keywordflow">if</span> (!HeapToStackAA.isAssumedHeapToStack(CB) &amp;&amp;</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;          !HeapToSharedAA.isAssumedHeapToShared(CB))</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;        SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_free_shared:</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;      <span class="keywordflow">if</span> (!HeapToStackAA.isAssumedHeapToStackRemovedFree(CB) &amp;&amp;</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;          !HeapToSharedAA.isAssumedHeapToSharedRemovedFree(CB))</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;        SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;      SPMDCompatibilityTracker.indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;      SPMDCompatibilityTracker.insert(&amp;CB);</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;    }</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160; </div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    <span class="keywordflow">return</span> StateBefore == getState() ? <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                                     : <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;  }</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;};</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160; </div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;<span class="keyword">struct </span>AAFoldRuntimeCall</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;    : <span class="keyword">public</span> <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper</a>&lt;BooleanState, AbstractAttribute&gt; {</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = <a class="code" href="structllvm_1_1StateWrapper.html">StateWrapper&lt;BooleanState, AbstractAttribute&gt;</a>;</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160; </div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;  AAFoldRuntimeCall(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) : <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>(IRP) {}</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;<span class="comment">  /// Statistics are tracked as part of manifest for now.</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> trackStatistics()<span class="keyword"> const override </span>{}</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment">  /// Create an abstract attribute biew for the position \p IRP.</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> AAFoldRuntimeCall &amp;createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                                              <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A);</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="comment">  /// See AbstractAttribute::getName()</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> std::string <a class="code" href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;AAFoldRuntimeCall&quot;</span>; }</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;<span class="comment">  /// See AbstractAttribute::getIdAddr()</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *getIdAddr()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; }</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="comment">  /// This function should return true if the type of the \p AA is</span></div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="comment">  /// AAFoldRuntimeCall</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA) {</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;    <span class="keywordflow">return</span> (AA-&gt;<a class="code" href="structllvm_1_1AbstractAttribute.html#af34bd448298e7021ee074394446795f2">getIdAddr</a>() == &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>);</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;  }</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160; </div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;};</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160; </div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;<span class="keyword">struct </span>AAFoldRuntimeCallCallSiteReturned : AAFoldRuntimeCall {</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;  AAFoldRuntimeCallCallSiteReturned(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      : AAFoldRuntimeCall(IRP, <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>) {}</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;<span class="comment">  /// See AbstractAttribute::getAsStr()</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> std::string getAsStr()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;    <span class="keywordflow">if</span> (!isValidState())</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;invalid&gt;&quot;</span>;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160; </div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;    std::string Str(<span class="stringliteral">&quot;simplified value: &quot;</span>);</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160; </div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;    <span class="keywordflow">if</span> (!SimplifiedValue)</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      <span class="keywordflow">return</span> Str + std::string(<span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160; </div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    <span class="keywordflow">if</span> (!*SimplifiedValue)</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;      <span class="keywordflow">return</span> Str + std::string(<span class="stringliteral">&quot;nullptr&quot;</span>);</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160; </div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(*SimplifiedValue))</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;      <span class="keywordflow">return</span> Str + <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(CI-&gt;getSExtValue());</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160; </div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;    <span class="keywordflow">return</span> Str + std::string(<span class="stringliteral">&quot;unknown&quot;</span>);</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;  }</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160; </div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a48fab4c5bc866fd3cbda51b75511da6b">DisableOpenMPOptFolding</a>)</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;      indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160; </div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = getAssociatedFunction();</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160; </div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    <span class="keyword">auto</span> &amp;OMPInfoCache = <span class="keyword">static_cast&lt;</span>OMPInformationCache &amp;<span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getInfoCache());</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;It = OMPInfoCache.RuntimeFunctionIDMap.find(Callee);</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != OMPInfoCache.RuntimeFunctionIDMap.end() &amp;&amp;</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;           <span class="stringliteral">&quot;Expected a known OpenMP runtime function&quot;</span>);</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160; </div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;    RFKind = It-&gt;getSecond();</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160; </div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB = cast&lt;CallBase&gt;(getAssociatedValue());</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.registerSimplificationCallback(</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;        <a class="code" href="structllvm_1_1IRPosition.html#a22b55f73ab4057a8c3da9f32bd582f4b">IRPosition::callsite_returned</a>(CB),</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;        [&amp;](<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP, <span class="keyword">const</span> <a class="code" href="structllvm_1_1AbstractAttribute.html">AbstractAttribute</a> *AA,</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;            <span class="keywordtype">bool</span> &amp;UsedAssumedInformation) -&gt; std::optional&lt;Value *&gt; {</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((isValidState() ||</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                  (SimplifiedValue &amp;&amp; *SimplifiedValue == <span class="keyword">nullptr</span>)) &amp;&amp;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                 <span class="stringliteral">&quot;Unexpected invalid state!&quot;</span>);</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160; </div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;          <span class="keywordflow">if</span> (!isAtFixpoint()) {</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;            UsedAssumedInformation = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;            <span class="keywordflow">if</span> (AA)</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;              <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.recordDependence(*<span class="keyword">this</span>, *AA, <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">DepClassTy::OPTIONAL</a>);</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;          }</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;          <span class="keywordflow">return</span> SimplifiedValue;</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;        });</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;  }</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160; </div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> updateImpl(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;    <span class="keywordflow">switch</span> (RFKind) {</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_is_spmd_exec_mode:</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;      Changed |= foldIsSPMDExecMode(A);</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_parallel_level:</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      Changed |= foldParallelLevel(A);</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_get_hardware_num_threads_in_block:</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;      Changed = Changed | foldKernelFnAttribute(A, <span class="stringliteral">&quot;omp_target_thread_limit&quot;</span>);</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;    <span class="keywordflow">case</span> OMPRTL___kmpc_get_hardware_num_blocks:</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      Changed = Changed | foldKernelFnAttribute(A, <span class="stringliteral">&quot;omp_target_num_teams&quot;</span>);</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unhandled OpenMP runtime function!&quot;</span>);</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;    }</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160; </div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;  }</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160; </div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> manifest(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;    <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160; </div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    <span class="keywordflow">if</span> (SimplifiedValue &amp;&amp; *SimplifiedValue) {</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = *getCtxI();</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.changeAfterManifest(<a class="code" href="structllvm_1_1IRPosition.html#a4a67bf6ab49ae2630d14e3159ef51cf4">IRPosition::inst</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), **SimplifiedValue);</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.deleteAfterManifest(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160; </div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;      <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB = dyn_cast&lt;CallBase&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> = [&amp;](<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>) {</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(*SimplifiedValue))</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Replacing OpenMP runtime call &quot;</span></div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;                    &lt;&lt; CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot; with &quot;</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;                    &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;FoldedValue&quot;</span>, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue()) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Replacing OpenMP runtime call &quot;</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;                  &lt;&lt; CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      };</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160; </div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      <span class="keywordflow">if</span> (CB &amp;&amp; <a class="code" href="OpenMPOpt_8cpp.html#af9b0823ab33b2950bb7afdddc6d043cb">EnableVerboseRemarks</a>)</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.emitRemark&lt;<a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>&gt;(CB, <span class="stringliteral">&quot;OMP180&quot;</span>, <a class="code" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>);</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160; </div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Replacing runtime call: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; with &quot;</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;                        &lt;&lt; **SimplifiedValue &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160; </div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;      Changed = <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;    }</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160; </div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;  }</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160; </div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> indicatePessimisticFixpoint()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;    SimplifiedValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;    <span class="keywordflow">return</span> AAFoldRuntimeCall::indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;  }</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160; </div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="comment">  /// Fold __kmpc_is_spmd_exec_mode into a constant if possible.</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> foldIsSPMDExecMode(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;    std::optional&lt;Value *&gt; SimplifiedValueBefore = SimplifiedValue;</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160; </div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;    <span class="keywordtype">unsigned</span> AssumedSPMDCount = 0, KnownSPMDCount = 0;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;    <span class="keywordtype">unsigned</span> AssumedNonSPMDCount = 0, KnownNonSPMDCount = 0;</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;    <span class="keyword">auto</span> &amp;CallerKernelInfoAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*getAnchorScope()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160; </div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;    <span class="keywordflow">if</span> (!CallerKernelInfoAA.ReachingKernelEntries.isValidState())</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160; </div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Kernel</a> K : CallerKernelInfoAA.ReachingKernelEntries) {</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;      <span class="keyword">auto</span> &amp;AA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(*<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*K),</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                                          <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160; </div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;      <span class="keywordflow">if</span> (!AA.isValidState()) {</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;        SimplifiedValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;        <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;      }</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160; </div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      <span class="keywordflow">if</span> (AA.SPMDCompatibilityTracker.isAssumed()) {</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;        <span class="keywordflow">if</span> (AA.SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;          ++KnownSPMDCount;</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;          ++AssumedSPMDCount;</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        <span class="keywordflow">if</span> (AA.SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;          ++KnownNonSPMDCount;</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;          ++AssumedNonSPMDCount;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;      }</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;    }</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160; </div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;    <span class="keywordflow">if</span> ((AssumedSPMDCount + KnownSPMDCount) &amp;&amp;</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;        (AssumedNonSPMDCount + KnownNonSPMDCount))</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160; </div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;    <span class="keyword">auto</span> &amp;Ctx = getAnchorValue().getContext();</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    <span class="keywordflow">if</span> (KnownSPMDCount || AssumedSPMDCount) {</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KnownNonSPMDCount == 0 &amp;&amp; AssumedNonSPMDCount == 0 &amp;&amp;</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;             <span class="stringliteral">&quot;Expected only SPMD kernels!&quot;</span>);</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      <span class="comment">// All reaching kernels are in SPMD mode. Update all function calls to</span></div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;      <span class="comment">// __kmpc_is_spmd_exec_mode to 1.</span></div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      SimplifiedValue = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(Ctx), <span class="keyword">true</span>);</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (KnownNonSPMDCount || AssumedNonSPMDCount) {</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KnownSPMDCount == 0 &amp;&amp; AssumedSPMDCount == 0 &amp;&amp;</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;             <span class="stringliteral">&quot;Expected only non-SPMD kernels!&quot;</span>);</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;      <span class="comment">// All reaching kernels are in non-SPMD mode. Update all function</span></div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;      <span class="comment">// calls to __kmpc_is_spmd_exec_mode to 0.</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;      SimplifiedValue = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(Ctx), <span class="keyword">false</span>);</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      <span class="comment">// We have empty reaching kernels, therefore we cannot tell if the</span></div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      <span class="comment">// associated call site can be folded. At this moment, SimplifiedValue</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;      <span class="comment">// must be none.</span></div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!SimplifiedValue &amp;&amp; <span class="stringliteral">&quot;SimplifiedValue should be none&quot;</span>);</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;    }</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160; </div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;    <span class="keywordflow">return</span> SimplifiedValue == SimplifiedValueBefore ? <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a></div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                                                    : <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;  }</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;<span class="comment">  /// Fold __kmpc_parallel_level into a constant if possible.</span></div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> foldParallelLevel(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;    std::optional&lt;Value *&gt; SimplifiedValueBefore = SimplifiedValue;</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160; </div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;    <span class="keyword">auto</span> &amp;CallerKernelInfoAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*getAnchorScope()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160; </div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;    <span class="keywordflow">if</span> (!CallerKernelInfoAA.ParallelLevels.isValidState())</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160; </div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    <span class="keywordflow">if</span> (!CallerKernelInfoAA.ReachingKernelEntries.isValidState())</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160; </div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    <span class="keywordflow">if</span> (CallerKernelInfoAA.ReachingKernelEntries.empty()) {</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!SimplifiedValue &amp;&amp;</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;             <span class="stringliteral">&quot;SimplifiedValue should keep none at this point&quot;</span>);</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a>;</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;    }</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160; </div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    <span class="keywordtype">unsigned</span> AssumedSPMDCount = 0, KnownSPMDCount = 0;</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;    <span class="keywordtype">unsigned</span> AssumedNonSPMDCount = 0, KnownNonSPMDCount = 0;</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Kernel</a> K : CallerKernelInfoAA.ReachingKernelEntries) {</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;      <span class="keyword">auto</span> &amp;AA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(*<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*K),</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;                                          <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;      <span class="keywordflow">if</span> (!AA.SPMDCompatibilityTracker.isValidState())</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;        <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160; </div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="keywordflow">if</span> (AA.SPMDCompatibilityTracker.isAssumed()) {</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;        <span class="keywordflow">if</span> (AA.SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;          ++KnownSPMDCount;</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;          ++AssumedSPMDCount;</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;        <span class="keywordflow">if</span> (AA.SPMDCompatibilityTracker.isAtFixpoint())</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;          ++KnownNonSPMDCount;</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;          ++AssumedNonSPMDCount;</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      }</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;    }</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160; </div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;    <span class="keywordflow">if</span> ((AssumedSPMDCount + KnownSPMDCount) &amp;&amp;</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;        (AssumedNonSPMDCount + KnownNonSPMDCount))</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160; </div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    <span class="keyword">auto</span> &amp;Ctx = getAnchorValue().getContext();</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    <span class="comment">// If the caller can only be reached by SPMD kernel entries, the parallel</span></div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    <span class="comment">// level is 1. Similarly, if the caller can only be reached by non-SPMD</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;    <span class="comment">// kernel entries, it is 0.</span></div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;    <span class="keywordflow">if</span> (AssumedSPMDCount || KnownSPMDCount) {</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KnownNonSPMDCount == 0 &amp;&amp; AssumedNonSPMDCount == 0 &amp;&amp;</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;             <span class="stringliteral">&quot;Expected only SPMD kernels!&quot;</span>);</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      SimplifiedValue = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(Ctx), 1);</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KnownSPMDCount == 0 &amp;&amp; AssumedSPMDCount == 0 &amp;&amp;</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;             <span class="stringliteral">&quot;Expected only non-SPMD kernels!&quot;</span>);</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      SimplifiedValue = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(Ctx), 0);</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;    }</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;    <span class="keywordflow">return</span> SimplifiedValue == SimplifiedValueBefore ? <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a></div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                                                    : <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;  }</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160; </div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;  <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">ChangeStatus</a> foldKernelFnAttribute(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, <a class="code" href="classllvm_1_1StringRef.html">llvm::StringRef</a> Attr) {</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;    <span class="comment">// Specialize only if all the calls agree with the attribute constant value</span></div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;    int32_t CurrentAttrValue = -1;</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;    std::optional&lt;Value *&gt; SimplifiedValueBefore = SimplifiedValue;</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160; </div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    <span class="keyword">auto</span> &amp;CallerKernelInfoAA = <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;        *<span class="keyword">this</span>, <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(*getAnchorScope()), <a class="code" href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">DepClassTy::REQUIRED</a>);</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160; </div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;    <span class="keywordflow">if</span> (!CallerKernelInfoAA.ReachingKernelEntries.isValidState())</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160; </div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;    <span class="comment">// Iterate over the kernels that reach this function</span></div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Kernel</a> K : CallerKernelInfoAA.ReachingKernelEntries) {</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;      int32_t NextAttrVal = K-&gt;<a class="code" href="classllvm_1_1Function.html#a4c866d3504a1e0717c8152a590bd6203">getFnAttributeAsParsedInteger</a>(Attr, -1);</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160; </div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;      <span class="keywordflow">if</span> (NextAttrVal == -1 ||</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;          (CurrentAttrValue != -1 &amp;&amp; CurrentAttrValue != NextAttrVal))</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;        <span class="keywordflow">return</span> indicatePessimisticFixpoint();</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;      CurrentAttrValue = NextAttrVal;</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;    }</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160; </div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;    <span class="keywordflow">if</span> (CurrentAttrValue != -1) {</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      <span class="keyword">auto</span> &amp;Ctx = getAnchorValue().getContext();</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;      SimplifiedValue =</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;          <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx), CurrentAttrValue);</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;    }</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;    <span class="keywordflow">return</span> SimplifiedValue == SimplifiedValueBefore ? <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">ChangeStatus::UNCHANGED</a></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;                                                    : <a class="code" href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">ChangeStatus::CHANGED</a>;</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;  }</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;<span class="comment">  /// An optional value the associated value is assumed to fold to. That is, we</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;<span class="comment">  /// assume the associated value (which is a call) can be replaced by this</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;<span class="comment">  /// simplified value.</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;<span class="comment"></span>  std::optional&lt;Value *&gt; SimplifiedValue;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;<span class="comment">  /// The runtime function kind of the callee of the associated call site.</span></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RFKind;</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;};</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160; </div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;<span class="comment">/// Register folding callsite</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> OpenMPOpt::registerFoldRuntimeCall(<a class="code" href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> RF) {</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;  <span class="keyword">auto</span> &amp;RFI = OMPInfoCache.RFIs[RF];</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;  RFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = OpenMPOpt::getCallIfRegularCall(U, &amp;RFI);</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    <span class="keywordflow">if</span> (!CI)</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;AAFoldRuntimeCall&gt;(</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;        <a class="code" href="structllvm_1_1IRPosition.html#a22b55f73ab4057a8c3da9f32bd582f4b">IRPosition::callsite_returned</a>(*CI), <span class="comment">/* QueryingAA */</span> <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;        <a class="code" href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aab50339a10e1de285ac99d4c3990b8693">DepClassTy::NONE</a>, <span class="comment">/* ForceUpdate */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        <span class="comment">/* UpdateAfterInit */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;  });</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;}</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160; </div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="keywordtype">void</span> OpenMPOpt::registerAAs(<span class="keywordtype">bool</span> IsModulePass) {</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.empty())</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160; </div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;  <span class="keywordflow">if</span> (IsModulePass) {</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;    <span class="comment">// Ensure we create the AAKernelInfo AAs first and without triggering an</span></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;    <span class="comment">// update. This will make sure we register all value simplification</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    <span class="comment">// callbacks before any other AA has the chance to create an AAValueSimplify</span></div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;    <span class="comment">// or similar.</span></div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    <span class="keyword">auto</span> CreateKernelInfoCB = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="namespacellvm_1_1omp.html#a9ecb71ea2b9e2a17b205ca3c03fb5a9d">Kernel</a>) {</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;AAKernelInfo&gt;(</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;          <a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(<a class="code" href="classllvm_1_1Function.html">Kernel</a>), <span class="comment">/* QueryingAA */</span> <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;          <a class="code" href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aab50339a10e1de285ac99d4c3990b8693">DepClassTy::NONE</a>, <span class="comment">/* ForceUpdate */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;          <span class="comment">/* UpdateAfterInit */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    };</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;    OMPInformationCache::RuntimeFunctionInfo &amp;InitRFI =</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;        OMPInfoCache.RFIs[OMPRTL___kmpc_target_init];</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;    InitRFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, CreateKernelInfoCB);</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160; </div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;    registerFoldRuntimeCall(OMPRTL___kmpc_is_spmd_exec_mode);</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;    registerFoldRuntimeCall(OMPRTL___kmpc_parallel_level);</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;    registerFoldRuntimeCall(OMPRTL___kmpc_get_hardware_num_threads_in_block);</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;    registerFoldRuntimeCall(OMPRTL___kmpc_get_hardware_num_blocks);</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;  }</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160; </div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;  <span class="comment">// Create CallSite AA for all Getters.</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a122fb4045a202a92aa4aac18c7d8116d">DeduceICVValues</a>) {</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Idx = 0; Idx &lt; OMPInfoCache.ICVs.size() - 1; ++Idx) {</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;      <span class="keyword">auto</span> ICVInfo = OMPInfoCache.ICVs[<span class="keyword">static_cast&lt;</span><a class="code" href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">InternalControlVar</a><span class="keyword">&gt;</span>(Idx)];</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160; </div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;      <span class="keyword">auto</span> &amp;GetterRFI = OMPInfoCache.RFIs[ICVInfo.Getter];</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160; </div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;      <span class="keyword">auto</span> CreateAA = [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>) {</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;        <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = OpenMPOpt::getCallIfRegularCall(U, &amp;GetterRFI);</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;        <span class="keywordflow">if</span> (!CI)</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160; </div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;        <span class="keyword">auto</span> &amp;CB = cast&lt;CallBase&gt;(*CI);</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160; </div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;        <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> CBPos = <a class="code" href="structllvm_1_1IRPosition.html#aeef35bb007616add7418161b0313b56b">IRPosition::callsite_function</a>(CB);</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;AAICVTracker&gt;(CBPos);</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      };</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160; </div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;      GetterRFI.foreachUse(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, CreateAA);</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;    }</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  }</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160; </div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <span class="comment">// Create an ExecutionDomain AA for every function and a HeapToStack AA for</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  <span class="comment">// every function if there is a device kernel.</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">isOpenMPDevice</a>(M))</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160; </div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>) {</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isDeclaration())</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160; </div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;    <span class="comment">// We look at internal functions only on-demand but if any use is not a</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    <span class="comment">// direct call or outside the current set of analyzed functions, we have</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    <span class="comment">// to do it eagerly.</span></div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasLocalLinkage()) {</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;uses(), [<span class="keyword">this</span>](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;            const auto *CB = dyn_cast&lt;CallBase&gt;(U.getUser());</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;            return CB &amp;&amp; CB-&gt;isCallee(&amp;U) &amp;&amp;</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                   A.isRunOn(const_cast&lt;Function *&gt;(CB-&gt;getCaller()));</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;          }))</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;    }</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;    registerAAsForFunction(A, *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;  }</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;}</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160; </div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="keywordtype">void</span> OpenMPOpt::registerAAsForFunction(<a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="OpenMPOpt_8cpp.html#a766797ec22d0c22f563a28e00f9865d6">DisableOpenMPOptDeglobalization</a>)</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;AAHeapToShared&gt;(<a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;  <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;<a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a>&gt;(<a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="OpenMPOpt_8cpp.html#a766797ec22d0c22f563a28e00f9865d6">DisableOpenMPOptDeglobalization</a>)</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;    <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;<a class="code" href="structllvm_1_1AAHeapToStack.html">AAHeapToStack</a>&gt;(<a class="code" href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">IRPosition::function</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160; </div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a7e3e687ddfdcbacd404bcf17b917dd88">instructions</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;      <span class="keywordtype">bool</span> UsedAssumedInformation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getAssumedSimplified(<a class="code" href="structllvm_1_1IRPosition.html#a3bee165465962ee97307066da4f0fb13">IRPosition::value</a>(*LI), <span class="comment">/* AA */</span> <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                             UsedAssumedInformation, <a class="code" href="namespacellvm_1_1AA.html#ac85851126814105f4a92b699293e4141ab563ef74be13fcdcf264798ed6af5666">AA::Interprocedural</a>);</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;    }</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;<a class="code" href="structllvm_1_1AAIsDead.html">AAIsDead</a>&gt;(<a class="code" href="structllvm_1_1IRPosition.html#a3bee165465962ee97307066da4f0fb13">IRPosition::value</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>));</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    }</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;      <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == Intrinsic::assume) {</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;        <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getOrCreateAAFor&lt;<a class="code" href="structllvm_1_1AAPotentialValues.html">AAPotentialValues</a>&gt;(</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;            <a class="code" href="structllvm_1_1IRPosition.html#a3bee165465962ee97307066da4f0fb13">IRPosition::value</a>(*II-&gt;getArgOperand(0)));</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;      }</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;    }</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;  }</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;}</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160; </div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">AAICVTracker::ID</a> = 0;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">AAKernelInfo::ID</a> = 0;</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="structllvm_1_1AAExecutionDomain.html#afaf9f39f57d67bb04a658b0adeee00be">AAExecutionDomain::ID</a> = 0;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">AAHeapToShared::ID</a> = 0;</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">AAFoldRuntimeCall::ID</a> = 0;</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160; </div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;AAICVTracker &amp;AAICVTracker::createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                                              <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;  AAICVTracker *AA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;  <span class="keywordflow">switch</span> (IRP.<a class="code" href="structllvm_1_1IRPosition.html#aea16db681aa18f4eded0015e284fdfe5">getPositionKind</a>()) {</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f">IRPosition::IRP_INVALID</a>:</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e">IRPosition::IRP_FLOAT</a>:</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f">IRPosition::IRP_ARGUMENT</a>:</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31">IRPosition::IRP_CALL_SITE_ARGUMENT</a>:</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;ICVTracker can only be created for function position!&quot;</span>);</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b">IRPosition::IRP_RETURNED</a>:</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAICVTrackerFunctionReturned(IRP, A);</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8">IRPosition::IRP_CALL_SITE_RETURNED</a>:</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAICVTrackerCallSiteReturned(IRP, A);</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b">IRPosition::IRP_CALL_SITE</a>:</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAICVTrackerCallSite(IRP, A);</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da">IRPosition::IRP_FUNCTION</a>:</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAICVTrackerFunction(IRP, A);</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;  }</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160; </div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;  <span class="keywordflow">return</span> *AA;</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;}</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160; </div>
<div class="line"><a name="l05238"></a><span class="lineno"><a class="line" href="structllvm_1_1AAExecutionDomain.html#a49479d09ce9ca5942db280559eab93c4"> 5238</a></span>&#160;<a class="code" href="structllvm_1_1AAExecutionDomain.html">AAExecutionDomain</a> &amp;<a class="code" href="structllvm_1_1AAExecutionDomain.html#a49479d09ce9ca5942db280559eab93c4">AAExecutionDomain::createForPosition</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                                                        <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;  AAExecutionDomainFunction *AA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;  <span class="keywordflow">switch</span> (IRP.<a class="code" href="structllvm_1_1IRPosition.html#aea16db681aa18f4eded0015e284fdfe5">getPositionKind</a>()) {</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f">IRPosition::IRP_INVALID</a>:</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e">IRPosition::IRP_FLOAT</a>:</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f">IRPosition::IRP_ARGUMENT</a>:</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31">IRPosition::IRP_CALL_SITE_ARGUMENT</a>:</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b">IRPosition::IRP_RETURNED</a>:</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8">IRPosition::IRP_CALL_SITE_RETURNED</a>:</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b">IRPosition::IRP_CALL_SITE</a>:</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;        <span class="stringliteral">&quot;AAExecutionDomain can only be created for function position!&quot;</span>);</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da">IRPosition::IRP_FUNCTION</a>:</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;    AA = <span class="keyword">new</span> (A.Allocator) AAExecutionDomainFunction(IRP, A);</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;  }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160; </div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;  <span class="keywordflow">return</span> *AA;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;}</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160; </div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;AAHeapToShared &amp;AAHeapToShared::createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;                                                  <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;  AAHeapToSharedFunction *AA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;  <span class="keywordflow">switch</span> (IRP.<a class="code" href="structllvm_1_1IRPosition.html#aea16db681aa18f4eded0015e284fdfe5">getPositionKind</a>()) {</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f">IRPosition::IRP_INVALID</a>:</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e">IRPosition::IRP_FLOAT</a>:</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f">IRPosition::IRP_ARGUMENT</a>:</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31">IRPosition::IRP_CALL_SITE_ARGUMENT</a>:</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b">IRPosition::IRP_RETURNED</a>:</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8">IRPosition::IRP_CALL_SITE_RETURNED</a>:</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b">IRPosition::IRP_CALL_SITE</a>:</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;        <span class="stringliteral">&quot;AAHeapToShared can only be created for function position!&quot;</span>);</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da">IRPosition::IRP_FUNCTION</a>:</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    AA = <span class="keyword">new</span> (A.Allocator) AAHeapToSharedFunction(IRP, A);</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;  }</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160; </div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;  <span class="keywordflow">return</span> *AA;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;}</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160; </div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;AAKernelInfo &amp;AAKernelInfo::createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                                              <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;  AAKernelInfo *AA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;  <span class="keywordflow">switch</span> (IRP.<a class="code" href="structllvm_1_1IRPosition.html#aea16db681aa18f4eded0015e284fdfe5">getPositionKind</a>()) {</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f">IRPosition::IRP_INVALID</a>:</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e">IRPosition::IRP_FLOAT</a>:</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f">IRPosition::IRP_ARGUMENT</a>:</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b">IRPosition::IRP_RETURNED</a>:</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8">IRPosition::IRP_CALL_SITE_RETURNED</a>:</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31">IRPosition::IRP_CALL_SITE_ARGUMENT</a>:</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;KernelInfo can only be created for function position!&quot;</span>);</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b">IRPosition::IRP_CALL_SITE</a>:</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAKernelInfoCallSite(IRP, A);</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da">IRPosition::IRP_FUNCTION</a>:</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAKernelInfoFunction(IRP, A);</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;  }</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160; </div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;  <span class="keywordflow">return</span> *AA;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;}</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160; </div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;AAFoldRuntimeCall &amp;AAFoldRuntimeCall::createForPosition(<span class="keyword">const</span> <a class="code" href="structllvm_1_1IRPosition.html">IRPosition</a> &amp;IRP,</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;                                                        <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> &amp;A) {</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;  AAFoldRuntimeCall *AA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;  <span class="keywordflow">switch</span> (IRP.<a class="code" href="structllvm_1_1IRPosition.html#aea16db681aa18f4eded0015e284fdfe5">getPositionKind</a>()) {</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f">IRPosition::IRP_INVALID</a>:</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e">IRPosition::IRP_FLOAT</a>:</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f">IRPosition::IRP_ARGUMENT</a>:</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b">IRPosition::IRP_RETURNED</a>:</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da">IRPosition::IRP_FUNCTION</a>:</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b">IRPosition::IRP_CALL_SITE</a>:</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31">IRPosition::IRP_CALL_SITE_ARGUMENT</a>:</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;KernelInfo can only be created for call site position!&quot;</span>);</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8">IRPosition::IRP_CALL_SITE_RETURNED</a>:</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;    AA = <span class="keyword">new</span> (<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.Allocator) AAFoldRuntimeCallCallSiteReturned(IRP, A);</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;  }</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160; </div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;  <span class="keywordflow">return</span> *AA;</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;}</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160; </div>
<div class="line"><a name="l05322"></a><span class="lineno"><a class="line" href="classllvm_1_1OpenMPOptPass.html#ad0812a5ba88f8645505134a108f639b2"> 5322</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1OpenMPOptPass.html#ad0812a5ba88f8645505134a108f639b2">OpenMPOptPass::run</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1omp.html#a1a039c806c0a203f470ea11b6932402c">containsOpenMP</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>))</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a4f904e7a65d6dcf72478502e2394c467">DisableOpenMPOptimizations</a>)</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160; </div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;  <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;      AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1InnerAnalysisManagerProxy.html">FunctionAnalysisManagerModuleProxy</a>&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>).getManager();</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">KernelSet</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a> = <a class="code" href="namespacellvm_1_1omp.html#a7f2eade374bf61ed94ab98b04803a079">getDeviceKernels</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160; </div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a82741d1f59899bd473969ef3b9311939">PrintModuleBeforeOptimizations</a>)</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Module before OpenMPOpt Module Pass:\n&quot;</span> &lt;&lt; <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160; </div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  <span class="keyword">auto</span> IsCalled = [&amp;](<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>.contains(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.users())</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;BlockAddress&gt;(U))</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;  };</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160; </div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;  <span class="keyword">auto</span> EmitRemark = [&amp;](<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;    <span class="keyword">auto</span> &amp;ORE = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    ORE.emit([&amp;]() {</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> ORA(<a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;OMP140&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;      <span class="keywordflow">return</span> ORA &lt;&lt; <span class="stringliteral">&quot;Could not internalize function. &quot;</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Some optimizations may not be possible. [OMP140]&quot;</span>;</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;    });</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;  };</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160; </div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;  <span class="comment">// Create internal copies of each function if this is a kernel Module. This</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;  <span class="comment">// allows iterprocedural passes to see every call edge.</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Function *, Function *&gt;</a> InternalizedMap;</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">isOpenMPDevice</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)) {</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Function *, 16&gt;</a> InternalizeFns;</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration() &amp;&amp; !<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>.contains(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp; IsCalled(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp;</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;          !<a class="code" href="OpenMPOpt_8cpp.html#aaa7ffb579a72260b325fb2139c8a758a">DisableInternalization</a>) {</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1Attributor.html#a312bc8ef3e9761ec87b3b6d05d6e2420">Attributor::isInternalizable</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;          InternalizeFns.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasLocalLinkage() &amp;&amp; !<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(<a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">Attribute::Cold</a>)) {</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;          EmitRemark(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;        }</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;      }</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160; </div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;    <a class="code" href="structllvm_1_1Attributor.html#af85fe4610a8ddd0d57149e73008f32fb">Attributor::internalizeFunctions</a>(InternalizeFns, InternalizedMap);</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  }</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160; </div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;  <span class="comment">// Look at every function in the Module unless it was internalized.</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Function *&gt;</a> Functions;</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Function *, 16&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>;</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration() &amp;&amp; !InternalizedMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;      <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.push_back(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;      Functions.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;    }</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160; </div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.empty())</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160; </div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;  <a class="code" href="structllvm_1_1AnalysisGetter.html">AnalysisGetter</a> AG(<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160; </div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;  <span class="keyword">auto</span> OREGetter = [&amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>](<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp; {</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(*F);</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;  };</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160; </div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;  <a class="code" href="classllvm_1_1BumpPtrAllocatorImpl.html">BumpPtrAllocator</a> <a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>;</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;  <a class="code" href="classllvm_1_1CallGraphUpdater.html">CallGraphUpdater</a> CGUpdater;</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160; </div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;  <span class="keywordtype">bool</span> PostLink = LTOPhase == <a class="code" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49a7757dfb07e9ac64f8c7076644e2deac1">ThinOrFullLTOPhase::FullLTOPostLink</a> ||</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;                  LTOPhase == <a class="code" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49ad94cc56b0a9155d607f2609b0f5c39d3">ThinOrFullLTOPhase::ThinLTOPreLink</a>;</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;  OMPInformationCache InfoCache(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, AG, <a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, <span class="comment">/*CGSCC*/</span> <span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>,</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;                                PostLink);</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160; </div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;  <span class="keywordtype">unsigned</span> MaxFixpointIterations =</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;      (<a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">isOpenMPDevice</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)) ? <a class="code" href="OpenMPOpt_8cpp.html#afe0e25c8ebed23a66842a952ed9b449f">SetFixpointIterations</a> : 32;</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160; </div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;  <a class="code" href="structllvm_1_1AttributorConfig.html">AttributorConfig</a> AC(CGUpdater);</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#af5d73bb34e01f98a095edeaff5338ecc">DefaultInitializeLiveInternals</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#af398ef0df0e0b9d6840d7d8c9ef0be53">IsModulePass</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a3df192ae0cdf572691dd5ff490278739">RewriteSignatures</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a068d18c1fc465f017895d6512d47467b">MaxFixpointIterations</a> = MaxFixpointIterations;</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a584c356b083da5f7ca5ece1765a7e206">OREGetter</a> = OREGetter;</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a3ffd7d836cc546feb2fb671fd3cf0b73">PassName</a> = <a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>;</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a04ea2fc0b7c81a7bb90ced540e3b075a">InitializationCallback</a> = OpenMPOpt::registerAAsForFunction;</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160; </div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;  <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> A(Functions, InfoCache, AC);</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160; </div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;  OpenMPOpt OMPOpt(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, CGUpdater, OREGetter, InfoCache, A);</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;  <span class="keywordtype">bool</span> Changed = OMPOpt.run(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160; </div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;  <span class="comment">// Optionally inline device functions for potentially better performance.</span></div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a8328e3a26ee4f202629864b9e7bb8c78">AlwaysInlineDeviceFunctions</a> &amp;&amp; <a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">isOpenMPDevice</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>))</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration() &amp;&amp; !<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>.contains(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp;</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;          !<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(Attribute::NoInline))</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;        <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.addFnAttr(Attribute::AlwaysInline);</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160; </div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a4865e7077c266a648b5c2b5e3813c860">PrintModuleAfterOptimizations</a>)</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Module after OpenMPOpt Module Pass:\n&quot;</span> &lt;&lt; <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160; </div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;  <span class="keywordflow">if</span> (Changed)</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160; </div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;}</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160; </div>
<div class="line"><a name="l05430"></a><span class="lineno"><a class="line" href="classllvm_1_1OpenMPOptCGSCCPass.html#a9d4366d9c2f6de53d6f2edce548577ab"> 5430</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1OpenMPOptCGSCCPass.html#a9d4366d9c2f6de53d6f2edce548577ab">OpenMPOptCGSCCPass::run</a>(<a class="code" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>,</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;                                          <a class="code" href="classllvm_1_1AnalysisManager.html">CGSCCAnalysisManager</a> &amp;AM,</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;                                          <a class="code" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;CG,</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;                                          <a class="code" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;UR) {</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1omp.html#a1a039c806c0a203f470ea11b6932402c">containsOpenMP</a>(*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.begin()-&gt;getFunction().getParent()))</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a4f904e7a65d6dcf72478502e2394c467">DisableOpenMPOptimizations</a>)</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160; </div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Function *, 16&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>;</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;  <span class="comment">// If there are kernels in the module, we have to run on all SCC&#39;s.</span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> : <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *Fn = &amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction();</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.push_back(Fn);</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;  }</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160; </div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.empty())</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160; </div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.begin()-&gt;getFunction().getParent();</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160; </div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a82741d1f59899bd473969ef3b9311939">PrintModuleBeforeOptimizations</a>)</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Module before OpenMPOpt CGSCC Pass:\n&quot;</span> &lt;&lt; <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160; </div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">KernelSet</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a> = <a class="code" href="namespacellvm_1_1omp.html#a7f2eade374bf61ed94ab98b04803a079">getDeviceKernels</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160; </div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;  <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1FunctionAnalysisManagerCGSCCProxy.html">FunctionAnalysisManagerCGSCCProxy</a>&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, CG).getManager();</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160; </div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;  <a class="code" href="structllvm_1_1AnalysisGetter.html">AnalysisGetter</a> AG(<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160; </div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;  <span class="keyword">auto</span> OREGetter = [&amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>](<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp; {</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(*F);</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;  };</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160; </div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;  <a class="code" href="classllvm_1_1BumpPtrAllocatorImpl.html">BumpPtrAllocator</a> <a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;  <a class="code" href="classllvm_1_1CallGraphUpdater.html">CallGraphUpdater</a> CGUpdater;</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;  CGUpdater.<a class="code" href="classllvm_1_1CallGraphUpdater.html#ad87000cd59cd61d387ff649d7f2774f1">initialize</a>(CG, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, AM, UR);</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160; </div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;  <span class="keywordtype">bool</span> PostLink = LTOPhase == <a class="code" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49a7757dfb07e9ac64f8c7076644e2deac1">ThinOrFullLTOPhase::FullLTOPostLink</a> ||</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;                  LTOPhase == <a class="code" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49ad94cc56b0a9155d607f2609b0f5c39d3">ThinOrFullLTOPhase::ThinLTOPreLink</a>;</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Function *&gt;</a> Functions(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.begin(), <a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>.end());</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;  OMPInformationCache InfoCache(*(Functions.<a class="code" href="classllvm_1_1SetVector.html#a422d1075ccfadded5ddc52f1ffe7d26f">back</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>()), AG, <a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>,</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;                                <span class="comment">/*CGSCC*/</span> &amp;Functions, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>, PostLink);</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160; </div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;  <span class="keywordtype">unsigned</span> MaxFixpointIterations =</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;      (<a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">isOpenMPDevice</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>)) ? <a class="code" href="OpenMPOpt_8cpp.html#afe0e25c8ebed23a66842a952ed9b449f">SetFixpointIterations</a> : 32;</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160; </div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;  <a class="code" href="structllvm_1_1AttributorConfig.html">AttributorConfig</a> AC(CGUpdater);</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#af5d73bb34e01f98a095edeaff5338ecc">DefaultInitializeLiveInternals</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#af398ef0df0e0b9d6840d7d8c9ef0be53">IsModulePass</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a3df192ae0cdf572691dd5ff490278739">RewriteSignatures</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a068d18c1fc465f017895d6512d47467b">MaxFixpointIterations</a> = MaxFixpointIterations;</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a584c356b083da5f7ca5ece1765a7e206">OREGetter</a> = OREGetter;</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a3ffd7d836cc546feb2fb671fd3cf0b73">PassName</a> = <a class="code" href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>;</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;  AC.<a class="code" href="structllvm_1_1AttributorConfig.html#a04ea2fc0b7c81a7bb90ced540e3b075a">InitializationCallback</a> = OpenMPOpt::registerAAsForFunction;</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160; </div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;  <a class="code" href="structllvm_1_1Attributor.html">Attributor</a> A(Functions, InfoCache, AC);</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160; </div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;  OpenMPOpt OMPOpt(<a class="code" href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">SCC</a>, CGUpdater, OREGetter, InfoCache, A);</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;  <span class="keywordtype">bool</span> Changed = OMPOpt.run(<span class="keyword">false</span>);</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160; </div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="OpenMPOpt_8cpp.html#a4865e7077c266a648b5c2b5e3813c860">PrintModuleAfterOptimizations</a>)</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a> &lt;&lt; <span class="stringliteral">&quot;Module after OpenMPOpt CGSCC Pass:\n&quot;</span> &lt;&lt; <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160; </div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;  <span class="keywordflow">if</span> (Changed)</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160; </div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;}</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160; </div>
<div class="line"><a name="l05501"></a><span class="lineno"><a class="line" href="namespacellvm_1_1omp.html#a7f2eade374bf61ed94ab98b04803a079"> 5501</a></span>&#160;<a class="code" href="classllvm_1_1SetVector.html">KernelSet</a> <a class="code" href="namespacellvm_1_1omp.html#a7f2eade374bf61ed94ab98b04803a079">llvm::omp::getDeviceKernels</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;  <span class="comment">// TODO: Create a more cross-platform way of determining device kernels.</span></div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;  <a class="code" href="classllvm_1_1NamedMDNode.html">NamedMDNode</a> *MD = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getNamedMetadata(<span class="stringliteral">&quot;nvvm.annotations&quot;</span>);</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">KernelSet</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>;</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160; </div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  <span class="keywordflow">if</span> (!MD)</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>;</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160; </div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : MD-&gt;<a class="code" href="classllvm_1_1NamedMDNode.html#acfe76fbea7879969fb26502ea5ffba97">operands</a>()) {</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getNumOperands() &lt; 2)</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;    <a class="code" href="classllvm_1_1MDString.html">MDString</a> *KindID = dyn_cast&lt;MDString&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getOperand(1));</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;    <span class="keywordflow">if</span> (!KindID || KindID-&gt;<a class="code" href="classllvm_1_1MDString.html#ae44259d9edd71181ea8b89d18f27a967">getString</a>() != <span class="stringliteral">&quot;kernel&quot;</span>)</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160; </div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *KernelFn =</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;        mdconst::dyn_extract_or_null&lt;Function&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getOperand(0));</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;    <span class="keywordflow">if</span> (!KernelFn)</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160; </div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;    ++NumOpenMPTargetRegionKernels;</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160; </div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>.insert(KernelFn);</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  }</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160; </div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">Kernels</a>;</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;}</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160; </div>
<div class="line"><a name="l05529"></a><span class="lineno"><a class="line" href="namespacellvm_1_1omp.html#a1a039c806c0a203f470ea11b6932402c"> 5529</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1omp.html#a1a039c806c0a203f470ea11b6932402c">llvm::omp::containsOpenMP</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  <a class="code" href="classllvm_1_1Metadata.html">Metadata</a> *MD = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getModuleFlag(<span class="stringliteral">&quot;openmp&quot;</span>);</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  <span class="keywordflow">if</span> (!MD)</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160; </div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;}</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160; </div>
<div class="line"><a name="l05537"></a><span class="lineno"><a class="line" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582"> 5537</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">llvm::omp::isOpenMPDevice</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <a class="code" href="classllvm_1_1Metadata.html">Metadata</a> *MD = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getModuleFlag(<span class="stringliteral">&quot;openmp-device&quot;</span>);</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;  <span class="keywordflow">if</span> (!MD)</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160; </div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1AA_html_a1ec1a38ef077070bf9d3760ddbbcfe24"><div class="ttname"><a href="namespacellvm_1_1AA.html#a1ec1a38ef077070bf9d3760ddbbcfe24">llvm::AA::isValidAtPosition</a></div><div class="ttdeci">bool isValidAtPosition(const ValueAndContext &amp;VAC, InformationCache &amp;InfoCache)</div><div class="ttdoc">Return true if the value of VAC is a valid at the position of VAC, that is a constant,...</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8cpp_source.html#l00259">Attributor.cpp:259</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a512494b857b0644c1f722531e3ee5495"><div class="ttname"><a href="classllvm_1_1Instruction.html#a512494b857b0644c1f722531e3ee5495">llvm::Instruction::getPrevNonDebugInstruction</a></div><div class="ttdeci">const Instruction * getPrevNonDebugInstruction(bool SkipPseudoOp=false) const</div><div class="ttdoc">Return a pointer to the previous non-debug instruction in the same basic block as 'this',...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00794">Instruction.cpp:794</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphUpdater_html"><div class="ttname"><a href="classllvm_1_1CallGraphUpdater.html">llvm::CallGraphUpdater</a></div><div class="ttdoc">Wrapper to unify &quot;old style&quot; CallGraph and &quot;new style&quot; LazyCallGraph.</div><div class="ttdef"><b>Definition:</b> <a href="CallGraphUpdater_8h_source.html#l00029">CallGraphUpdater.h:29</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_af9b0823ab33b2950bb7afdddc6d043cb"><div class="ttname"><a href="OpenMPOpt_8cpp.html#af9b0823ab33b2950bb7afdddc6d043cb">EnableVerboseRemarks</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableVerboseRemarks(&quot;openmp-opt-verbose-remarks&quot;, cl::desc(&quot;Enables more verbose remarks.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">This class represents an incoming formal argument to a Function.</div><div class="ttdef"><b>Definition:</b> <a href="Argument_8h_source.html#l00028">Argument.h:28</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AA_html_a9b9d4b530f90e36eede3c575ad1948ee"><div class="ttname"><a href="namespacellvm_1_1AA.html#a9b9d4b530f90e36eede3c575ad1948ee">llvm::AA::isPotentiallyAffectedByBarrier</a></div><div class="ttdeci">bool isPotentiallyAffectedByBarrier(Attributor &amp;A, const Instruction &amp;I, const AbstractAttribute &amp;QueryingAA)</div><div class="ttdoc">Return true if I is potentially affected by a barrier.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8cpp_source.html#l00801">Attributor.cpp:801</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_aa0c0d79dafb0d22308ce48808689f430afa583a38ff705195c9bce9dec0c5eff8"><div class="ttname"><a href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430afa583a38ff705195c9bce9dec0c5eff8">llvm::omp::OMP_TGT_EXEC_MODE_GENERIC</a></div><div class="ttdeci">@ OMP_TGT_EXEC_MODE_GENERIC</div><div class="ttdef"><b>Definition:</b> <a href="OMPDeviceConstants_8h_source.html#l00022">OMPDeviceConstants.h:22</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a8936a7eb7c9151c46513b192053afb2e"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a8936a7eb7c9151c46513b192053afb2e">llvm::IRPosition::function</a></div><div class="ttdeci">static const IRPosition function(const Function &amp;F, const CallBaseContext *CBContext=nullptr)</div><div class="ttdoc">Create a position describing the function scope of F.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00603">Attributor.h:603</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="astructllvm_1_1OpenMPIRBuilder_1_1LocationDescription_html"><div class="ttname"><a href="structllvm_1_1OpenMPIRBuilder_1_1LocationDescription.html">llvm::OpenMPIRBuilder::LocationDescription</a></div><div class="ttdoc">Description of a LLVM-IR insertion point (IP) and a debug/source location (filename,...</div><div class="ttdef"><b>Definition:</b> <a href="OMPIRBuilder_8h_source.html#l00305">OMPIRBuilder.h:305</a></div></div>
<div class="ttc" id="aProvenanceAnalysisEvaluator_8cpp_html_a2ee79648e8bce3ddbb26358ff10e3e82"><div class="ttname"><a href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a></div><div class="ttdeci">static StringRef getName(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="ProvenanceAnalysisEvaluator_8cpp_source.html#l00020">ProvenanceAnalysisEvaluator.cpp:20</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_afe0e25c8ebed23a66842a952ed9b449f"><div class="ttname"><a href="OpenMPOpt_8cpp.html#afe0e25c8ebed23a66842a952ed9b449f">SetFixpointIterations</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; SetFixpointIterations(&quot;openmp-opt-max-iterations&quot;, cl::Hidden, cl::desc(&quot;Maximal number of attributor iterations.&quot;), cl::init(256))</div></div>
<div class="ttc" id="aR600ClauseMergePass_8cpp_html_aba99928790de45fa7aa12b47fbd828ff"><div class="ttname"><a href="R600ClauseMergePass_8cpp.html#aba99928790de45fa7aa12b47fbd828ff">Merge</a></div><div class="ttdeci">R600 Clause Merge</div><div class="ttdef"><b>Definition:</b> <a href="R600ClauseMergePass_8cpp_source.html#l00070">R600ClauseMergePass.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ace45cae6925c65e9d6916e09dd5b17cc"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">llvm::IRBuilderBase::SetInsertPoint</a></div><div class="ttdeci">void SetInsertPoint(BasicBlock *TheBB)</div><div class="ttdoc">This specifies that created instructions should be appended to the end of the specified block.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00180">IRBuilder.h:180</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aTarWriter_8cpp_html_aac035f4156e2604bfa42ba22c17b83ee"><div class="ttname"><a href="TarWriter_8cpp.html#aac035f4156e2604bfa42ba22c17b83ee">BlockSize</a></div><div class="ttdeci">static const int BlockSize</div><div class="ttdef"><b>Definition:</b> <a href="TarWriter_8cpp_source.html#l00033">TarWriter.cpp:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_aa1a58843d7d645d5cf0390a68c7fd852"><div class="ttname"><a href="classllvm_1_1CastInst.html#aa1a58843d7d645d5cf0390a68c7fd852">llvm::CastInst::CreatePointerBitCastOrAddrSpaceCast</a></div><div class="ttdeci">static CastInst * CreatePointerBitCastOrAddrSpaceCast(Value *S, Type *Ty, const Twine &amp;Name, BasicBlock *InsertAtEnd)</div><div class="ttdoc">Create a BitCast or an AddrSpaceCast cast instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03483">Instructions.cpp:3483</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdeci">@ ICMP_EQ</div><div class="ttdoc">equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00739">InstrTypes.h:739</a></div></div>
<div class="ttc" id="aclassllvm_1_1NamedMDNode_html"><div class="ttname"><a href="classllvm_1_1NamedMDNode.html">llvm::NamedMDNode</a></div><div class="ttdoc">A tuple of MDNodes.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l01587">Metadata.h:1587</a></div></div>
<div class="ttc" id="anamespacellvm_html_a02981de53fb6ffd384d39addc4d25f37"><div class="ttname"><a href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a></div><div class="ttdeci">auto drop_begin(T &amp;&amp;RangeOrContainer, size_t N=1)</div><div class="ttdoc">Return a range covering RangeOrContainer with the first N elements excluded.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00386">STLExtras.h:386</a></div></div>
<div class="ttc" id="aOpenMPOpt_8h_html"><div class="ttname"><a href="OpenMPOpt_8h.html">OpenMPOpt.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">llvm::ISD::OR</a></div><div class="ttdeci">@ OR</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00667">ISDOpcodes.h:667</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00293">Type.cpp:293</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a4f904e7a65d6dcf72478502e2394c467"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a4f904e7a65d6dcf72478502e2394c467">DisableOpenMPOptimizations</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableOpenMPOptimizations(&quot;openmp-opt-disable&quot;, cl::desc(&quot;Disable OpenMP specific optimizations.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5"><div class="ttname"><a href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">llvm::cl::Prefix</a></div><div class="ttdeci">@ Prefix</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00159">CommandLine.h:159</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a91bd28adea418a08cec78b72413d9d45"><div class="ttname"><a href="classllvm_1_1Instruction.html#a91bd28adea418a08cec78b72413d9d45">llvm::Instruction::getNextNonDebugInstruction</a></div><div class="ttdeci">const Instruction * getNextNonDebugInstruction(bool SkipPseudoOp=false) const</div><div class="ttdoc">Return a pointer to the next non-debug instruction in the same basic block as 'this',...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00786">Instruction.cpp:786</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a766797ec22d0c22f563a28e00f9865d6"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a766797ec22d0c22f563a28e00f9865d6">DisableOpenMPOptDeglobalization</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableOpenMPOptDeglobalization(&quot;openmp-opt-disable-deglobalization&quot;, cl::desc(&quot;Disable OpenMP optimizations involving deglobalization.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html"><div class="ttname"><a href="classllvm_1_1Attribute.html">llvm::Attribute</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00067">Attributes.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0b2ca98dc28c61793ff5c90d23e5f14e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::lookup</a></div><div class="ttdeci">ValueT lookup(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">lookup - Return the entry for the specified key, or a default constructed value if no such entry exis...</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00197">DenseMap.h:197</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a01dcc1d7b3fe71c031ab52a3ee7e02f0"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a01dcc1d7b3fe71c031ab52a3ee7e02f0">TAG</a></div><div class="ttdeci">static constexpr auto TAG</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l00177">OpenMPOpt.cpp:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__string__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__string__ostream.html">llvm::raw_string_ostream</a></div><div class="ttdoc">A raw_ostream that writes to an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00642">raw_ostream.h:642</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a18b9d328d2490f447589ba60345eba6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">Determine the number of elements in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00077">SetVector.h:77</a></div></div>
<div class="ttc" id="aAArch64AdvSIMDScalarPass_8cpp_html_a1112b818386ec01ddfdf3a5d0024eb17"><div class="ttname"><a href="AArch64AdvSIMDScalarPass_8cpp.html#a1112b818386ec01ddfdf3a5d0024eb17">contains</a></div><div class="ttdeci">return AArch64::GPR64RegClass contains(Reg)</div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a4865e7077c266a648b5c2b5e3813c860"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a4865e7077c266a648b5c2b5e3813c860">PrintModuleAfterOptimizations</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; PrintModuleAfterOptimizations(&quot;openmp-opt-print-module-after&quot;, cl::desc(&quot;Print the current module after OpenMP optimizations.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">llvm::GlobalValue::NotThreadLocal</a></div><div class="ttdeci">@ NotThreadLocal</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00192">GlobalValue.h:192</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a26708685cc8b94fe3d7092ee080dbb34"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">llvm::ilist_node_with_parent::getNextNode</a></div><div class="ttdeci">NodeTy * getNextNode()</div><div class="ttdoc">Get the next node, or nullptr for the list tail.</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00289">ilist_node.h:289</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a3bee165465962ee97307066da4f0fb13"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a3bee165465962ee97307066da4f0fb13">llvm::IRPosition::value</a></div><div class="ttdeci">static const IRPosition value(const Value &amp;V, const CallBaseContext *CBContext=nullptr)</div><div class="ttdoc">Create a position describing the value of V.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00584">Attributor.h:584</a></div></div>
<div class="ttc" id="aclassllvm_1_1OpenMPOptCGSCCPass_html_a9d4366d9c2f6de53d6f2edce548577ab"><div class="ttname"><a href="classllvm_1_1OpenMPOptCGSCCPass.html#a9d4366d9c2f6de53d6f2edce548577ab">llvm::OpenMPOptCGSCCPass::run</a></div><div class="ttdeci">PreservedAnalyses run(LazyCallGraph::SCC &amp;C, CGSCCAnalysisManager &amp;AM, LazyCallGraph &amp;CG, CGSCCUpdateResult &amp;UR)</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l05430">OpenMPOpt.cpp:5430</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_ae6a4da5f41fc6a36735cc1704c01ce60"><div class="ttname"><a href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">llvm::Function::getEntryBlock</a></div><div class="ttdeci">const BasicBlock &amp; getEntryBlock() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00735">Function.h:735</a></div></div>
<div class="ttc" id="aclassllvm_1_1OpenMPIRBuilder_html_aafc1886793b898052f87edd7e9fdbaa3"><div class="ttname"><a href="classllvm_1_1OpenMPIRBuilder.html#aafc1886793b898052f87edd7e9fdbaa3">llvm::OpenMPIRBuilder::InsertPointTy</a></div><div class="ttdeci">IRBuilder&lt;&gt;::InsertPoint InsertPointTy</div><div class="ttdoc">Type used throughout for insertion points.</div><div class="ttdef"><b>Definition:</b> <a href="OMPIRBuilder_8h_source.html#l00189">OMPIRBuilder.h:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02550">IRBuilder.h:2550</a></div></div>
<div class="ttc" id="astructllvm_1_1StateWrapper_html"><div class="ttname"><a href="structllvm_1_1StateWrapper.html">llvm::StateWrapper</a></div><div class="ttdoc">Helper to tie a abstract state implementation to an abstract attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l03000">Attributor.h:3000</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00039">GlobalVariable.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00880">DenseMap.h:880</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdeci">@ ICMP_NE</div><div class="ttdoc">not equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00740">InstrTypes.h:740</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a7e89b55242c964ae61b7850e99cacef0"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">llvm::FunctionType::get</a></div><div class="ttdeci">static FunctionType * get(Type *Result, ArrayRef&lt; Type * &gt; Params, bool isVarArg)</div><div class="ttdoc">This static method is the primary way of constructing a FunctionType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00363">Type.cpp:363</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AA_html_ac85851126814105f4a92b699293e4141ab563ef74be13fcdcf264798ed6af5666"><div class="ttname"><a href="namespacellvm_1_1AA.html#ac85851126814105f4a92b699293e4141ab563ef74be13fcdcf264798ed6af5666">llvm::AA::Interprocedural</a></div><div class="ttdeci">@ Interprocedural</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00171">Attributor.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a50d461a887e200e704e5157d3b21514d"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a50d461a887e200e704e5157d3b21514d">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00075">DenseMap.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00235">Path.cpp:235</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a00a76a729b319dc47beffbe07325565f"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path, Style style=Style::native)</div><div class="ttdoc">Get begin iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00226">Path.cpp:226</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a754b47054852401f87e52805d15bdf05"><div class="ttname"><a href="classllvm_1_1CallBase.html#a754b47054852401f87e52805d15bdf05">llvm::CallBase::isCallee</a></div><div class="ttdeci">bool isCallee(Value::const_user_iterator UI) const</div><div class="ttdoc">Determine whether the passed iterator points to the callee operand's Use.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01417">InstrTypes.h:1417</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a541187eb976df2189b40b3f62ed2cee0"><div class="ttname"><a href="classllvm_1_1Use.html#a541187eb976df2189b40b3f62ed2cee0">llvm::Use::getOperandNo</a></div><div class="ttdeci">unsigned getOperandNo() const</div><div class="ttdoc">Return the operand # of this use in its User.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8cpp_source.html#l00031">Use.cpp:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a52c990590792c91dd20b6d45acebe359"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00401">BasicBlock.cpp:401</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f883c895f4d244f4ed56ed8a8c160c1"><div class="ttname"><a href="namespacellvm.html#a2f883c895f4d244f4ed56ed8a8c160c1">llvm::operator!=</a></div><div class="ttdeci">bool operator!=(uint64_t V1, const APInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l02040">APInt.h:2040</a></div></div>
<div class="ttc" id="astructllvm_1_1InformationCache_html"><div class="ttname"><a href="structllvm_1_1InformationCache.html">llvm::InformationCache</a></div><div class="ttdoc">Data structure to hold cached (LLVM-IR) information.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01154">Attributor.h:1154</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html">llvm::AttributorConfig</a></div><div class="ttdoc">Configuration for the Attributor.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01399">Attributor.h:1399</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a383175f96316074965ad115706bd49d7"><div class="ttname"><a href="classllvm_1_1Instruction.html#a383175f96316074965ad115706bd49d7">llvm::Instruction::mayWriteToMemory</a></div><div class="ttdeci">bool mayWriteToMemory() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction may modify memory.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00646">Instruction.cpp:646</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt; Instruction *, 4 &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">llvm::tgtok::FalseVal</a></div><div class="ttdeci">@ FalseVal</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00062">TGLexer.h:62</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5d737fb4258bb27586a1bffd557fbb49ad94cc56b0a9155d607f2609b0f5c39d3"><div class="ttname"><a href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49ad94cc56b0a9155d607f2609b0f5c39d3">llvm::ThinOrFullLTOPhase::ThinLTOPreLink</a></div><div class="ttdeci">@ ThinLTOPreLink</div><div class="ttdoc">ThinLTO prelink (summary) phase.</div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a212200718d90163dbf9fc504df5ff62f">llvm::IRPosition::IRP_ARGUMENT</a></div><div class="ttdeci">@ IRP_ARGUMENT</div><div class="ttdoc">An attribute for a function argument.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00574">Attributor.h:574</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a440e55ee67b08379ca74b24eb623789b">llvm::IRPosition::IRP_RETURNED</a></div><div class="ttdeci">@ IRP_RETURNED</div><div class="ttdoc">An attribute for the function return value.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00570">Attributor.h:570</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">llvm::MipsISD::Ret</a></div><div class="ttdeci">@ Ret</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00119">MipsISelLowering.h:119</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_a19d27915595e7f0a0ef271448bcdac6f"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a></div><div class="ttdeci">static void initialize(TargetLibraryInfoImpl &amp;TLI, const Triple &amp;T, ArrayRef&lt; StringLiteral &gt; StandardNames)</div><div class="ttdoc">Initialize the set of available library functions based on the specified target triple.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00152">TargetLibraryInfo.cpp:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1AbstractCallSite_html"><div class="ttname"><a href="classllvm_1_1AbstractCallSite.html">llvm::AbstractCallSite</a></div><div class="ttdoc">AbstractCallSite.</div><div class="ttdef"><b>Definition:</b> <a href="AbstractCallSite_8h_source.html#l00050">AbstractCallSite.h:50</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="astructllvm_1_1AAExecutionDomain_html_afaf9f39f57d67bb04a658b0adeee00be"><div class="ttname"><a href="structllvm_1_1AAExecutionDomain.html#afaf9f39f57d67bb04a658b0adeee00be">llvm::AAExecutionDomain::ID</a></div><div class="ttdeci">static const char ID</div><div class="ttdoc">Unique ID (due to the unique address)</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l05070">Attributor.h:5070</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ae5d05ec2b9a60806746addff3f2a71a9"><div class="ttname"><a href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">llvm::CallBase::addParamAttr</a></div><div class="ttdeci">void addParamAttr(unsigned ArgNo, Attribute::AttrKind Kind)</div><div class="ttdoc">Adds the attribute to the indicated argument.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01536">InstrTypes.h:1536</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a3a6f2f61e22ec48ea9a7314c82412d69"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a3a6f2f61e22ec48ea9a7314c82412d69">DisableOpenMPOptBarrierElimination</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableOpenMPOptBarrierElimination(&quot;openmp-opt-disable-barrier-elimination&quot;, cl::desc(&quot;Disable OpenMP optimizations that eliminate barriers.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7ba5de75f50bb4a4ba920698edf39b28"><div class="ttname"><a href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">llvm::Type::getInt8Ty</a></div><div class="ttdeci">static IntegerType * getInt8Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00239">Type.cpp:239</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0ae11f9a858d0a751bf2f9ea534be9457e">llvm::IRPosition::IRP_FLOAT</a></div><div class="ttdeci">@ IRP_FLOAT</div><div class="ttdoc">A position that is not associated with a spot suitable for attributes.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00568">Attributor.h:568</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_afbe24f9e57cab99bd5bf3960c76bcc94"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#afbe24f9e57cab99bd5bf3960c76bcc94">llvm::IRBuilderBase::CreateAlloca</a></div><div class="ttdeci">AllocaInst * CreateAlloca(Type *Ty, unsigned AddrSpace, Value *ArraySize=nullptr, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01688">IRBuilder.h:1688</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a30dd396c5b40cd86c1591872e574ccdf"><div class="ttname"><a href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a></div><div class="ttdeci">static IntegerType * getInt32Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00241">Type.cpp:241</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a318fae1fc9f118809808f03a8fd0bfbc"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a318fae1fc9f118809808f03a8fd0bfbc">PrintICVValues</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; PrintICVValues(&quot;openmp-print-icv-values&quot;, cl::init(false), cl::Hidden)</div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="astructllvm_1_1IntegerStateBase_html_a593c298c76a3d5747f091eae16eba55f"><div class="ttname"><a href="structllvm_1_1IntegerStateBase.html#a593c298c76a3d5747f091eae16eba55f">llvm::IntegerStateBase&lt; bool, true, false &gt;::operator^=</a></div><div class="ttdeci">void operator^=(const IntegerStateBase&lt; base_t, BestState, WorstState &gt; &amp;R)</div><div class="ttdoc">&quot;Clamp&quot; this state with R.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l02526">Attributor.h:2526</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a1f469b1f703519ae25ce564c8704310f"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a1f469b1f703519ae25ce564c8704310f">llvm::ConstantExpr::getPointerCast</a></div><div class="ttdeci">static Constant * getPointerCast(Constant *C, Type *Ty)</div><div class="ttdoc">Create a BitCast, AddrSpaceCast, or a PtrToInt cast constant expression.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02041">Constants.cpp:2041</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a57f1945911ca1e95d0f51d7c3516b529"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">llvm::BasicBlock::getUniqueSuccessor</a></div><div class="ttdeci">const BasicBlock * getUniqueSuccessor() const</div><div class="ttdoc">Return the successor of this block if it has a unique successor.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00322">BasicBlock.cpp:322</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_ad590786d9dc132a9f606d062c384c7cf"><div class="ttname"><a href="OpenMPOpt_8cpp.html#ad590786d9dc132a9f606d062c384c7cf">DisableOpenMPOptSPMDization</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableOpenMPOptSPMDization(&quot;openmp-opt-disable-spmdization&quot;, cl::desc(&quot;Disable OpenMP optimizations involving SPMD-ization.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_html_a3cc437d6699fb55c69e78b5d0cad641d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU.html#a3cc437d6699fb55c69e78b5d0cad641d">llvm::AMDGPU::isKernel</a></div><div class="ttdeci">LLVM_READNONE bool isKernel(CallingConv::ID CC)</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUBaseInfo_8h_source.html#l01106">AMDGPUBaseInfo.h:1106</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9149819221d66953ac6c2938b87f0136"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9149819221d66953ac6c2938b87f0136">llvm::Instruction::mayReadFromMemory</a></div><div class="ttdeci">bool mayReadFromMemory() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction may read memory.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00626">Instruction.cpp:626</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key_html_ab91336af7422ea27f4a04abd0ad5a445"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Key.html#ab91336af7422ea27f4a04abd0ad5a445">llvm::AMDGPU::HSAMD::Key::Kernels</a></div><div class="ttdeci">constexpr char Kernels[]</div><div class="ttdoc">Key for HSA::Metadata::mKernels.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00432">AMDGPUMetadata.h:432</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa99f18c3597f0eea20753e9865d51b60"><div class="ttname"><a href="namespacellvm.html#aa99f18c3597f0eea20753e9865d51b60">llvm::operator&amp;=</a></div><div class="ttdeci">bool operator&amp;=(SparseBitVector&lt; ElementSize &gt; *LHS, const SparseBitVector&lt; ElementSize &gt; &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="SparseBitVector_8h_source.html#l00835">SparseBitVector.h:835</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a185bafe1e8f07def76a3bac154a23e7a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">llvm::Instruction::isLifetimeStartOrEnd</a></div><div class="ttdeci">bool isLifetimeStartOrEnd() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction is a llvm.lifetime.start or llvm.lifetime.end marker.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00764">Instruction.cpp:764</a></div></div>
<div class="ttc" id="aGlobalValue_8h_html"><div class="ttname"><a href="GlobalValue_8h.html">GlobalValue.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a231ea6a9a0009e38969a20d4293119c7ac1d5528b6ced491ba685b8d29ce649c2"><div class="ttname"><a href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7ac1d5528b6ced491ba685b8d29ce649c2">llvm::omp::OMPScheduleType::OrderedDistribute</a></div><div class="ttdeci">@ OrderedDistribute</div></div>
<div class="ttc" id="aclassllvm_1_1AddrSpaceCastInst_html"><div class="ttname"><a href="classllvm_1_1AddrSpaceCastInst.html">llvm::AddrSpaceCastInst</a></div><div class="ttdoc">This class represents a conversion between pointers from one address space to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05298">Instructions.h:5298</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_adb13793b98ab59209a5309d26f831850"><div class="ttname"><a href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">llvm::SetVector::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Get an iterator to the beginning of the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00082">SetVector.h:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1SCC_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1SCC.html">llvm::LazyCallGraph::SCC</a></div><div class="ttdoc">An SCC of the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00419">LazyCallGraph.h:419</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a32e606ac4c88f71f14212e42b808e7f4"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">llvm::GlobalValue::isDeclaration</a></div><div class="ttdeci">bool isDeclaration() const</div><div class="ttdoc">Return true if the primary definition of this global value is outside of the current translation unit...</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00275">Globals.cpp:275</a></div></div>
<div class="ttc" id="aclassllvm_1_1MutableArrayRef_html"><div class="ttname"><a href="classllvm_1_1MutableArrayRef.html">llvm::MutableArrayRef</a></div><div class="ttdoc">MutableArrayRef - Represent a mutable reference to an array (0 or more elements consecutively in memo...</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00027">ArrayRef.h:27</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a84cd09ccc918883d51a387f0e0f374f3"><div class="ttname"><a href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">llvm::StringRef::startswith</a></div><div class="ttdeci">bool startswith(StringRef Prefix) const</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00261">StringRef.h:261</a></div></div>
<div class="ttc" id="aOMPIRBuilder_8h_html"><div class="ttname"><a href="OMPIRBuilder_8h.html">OMPIRBuilder.h</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd850975ae5042cacb64a9d0ea4715f3"><div class="ttname"><a href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3">llvm::ChangeStatus</a></div><div class="ttdeci">ChangeStatus</div><div class="ttdoc">{</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00466">Attributor.h:466</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphUpdater_html_a30a1e8841e6804516ec420786dbbc398"><div class="ttname"><a href="classllvm_1_1CallGraphUpdater.html#a30a1e8841e6804516ec420786dbbc398">llvm::CallGraphUpdater::removeCallSite</a></div><div class="ttdeci">void removeCallSite(CallBase &amp;CS)</div><div class="ttdoc">Remove the call site CS from the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="CallGraphUpdater_8cpp_source.html#l00162">CallGraphUpdater.cpp:162</a></div></div>
<div class="ttc" id="aclassllvm_1_1OpenMPIRBuilder_html"><div class="ttname"><a href="classllvm_1_1OpenMPIRBuilder.html">llvm::OpenMPIRBuilder</a></div><div class="ttdoc">An interface to create LLVM-IR for OpenMP directives.</div><div class="ttdef"><b>Definition:</b> <a href="OMPIRBuilder_8h_source.html#l00166">OMPIRBuilder.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a4c866d3504a1e0717c8152a590bd6203"><div class="ttname"><a href="classllvm_1_1Function.html#a4c866d3504a1e0717c8152a590bd6203">llvm::Function::getFnAttributeAsParsedInteger</a></div><div class="ttdeci">uint64_t getFnAttributeAsParsedInteger(StringRef Kind, uint64_t Default=0) const</div><div class="ttdoc">For a string attribute Kind, parse attribute as an integer.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00674">Function.cpp:674</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a4a67bf6ab49ae2630d14e3159ef51cf4"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a4a67bf6ab49ae2630d14e3159ef51cf4">llvm::IRPosition::inst</a></div><div class="ttdeci">static const IRPosition inst(const Instruction &amp;I, const CallBaseContext *CBContext=nullptr)</div><div class="ttdoc">Create a position describing the instruction I.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00596">Attributor.h:596</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdeci">@ A</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00034">ARMBaseInfo.h:34</a></div></div>
<div class="ttc" id="astructllvm_1_1IntegerStateBase_html_ad0867ce36e300e45599fab369cd25853"><div class="ttname"><a href="structllvm_1_1IntegerStateBase.html#ad0867ce36e300e45599fab369cd25853">llvm::IntegerStateBase&lt; bool, true, false &gt;::operator==</a></div><div class="ttdeci">bool operator==(const IntegerStateBase&lt; base_t, BestState, WorstState &gt; &amp;R) const</div><div class="ttdoc">Equality for IntegerStateBase.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l02512">Attributor.h:2512</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a83b8c9e572130f403445c0b0f69b837c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">llvm::CallBase::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const</div><div class="ttdoc">Returns the function called, or null if this is an indirect function invocation or the function signa...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01406">InstrTypes.h:1406</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_ae0be78032e5e87dd0906a9a925b8555b"><div class="ttname"><a href="OpenMPOpt_8cpp.html#ae0be78032e5e87dd0906a9a925b8555b">HideMemoryTransferLatency</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; HideMemoryTransferLatency(&quot;openmp-hide-memory-transfer-latency&quot;, cl::desc(&quot;[WIP] Tries to hide the latency of host to device memory&quot; &quot; transfers&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_af398ef0df0e0b9d6840d7d8c9ef0be53"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#af398ef0df0e0b9d6840d7d8c9ef0be53">llvm::AttributorConfig::IsModulePass</a></div><div class="ttdeci">bool IsModulePass</div><div class="ttdoc">Is the user of the Attributor a module pass or not.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01410">Attributor.h:1410</a></div></div>
<div class="ttc" id="astructllvm_1_1Attributor_html_afc978039286fb06b8edb5dd4b0cdb0d3"><div class="ttname"><a href="structllvm_1_1Attributor.html#afc978039286fb06b8edb5dd4b0cdb0d3">llvm::Attributor::SimplifictionCallbackTy</a></div><div class="ttdeci">std::function&lt; std::optional&lt; Value * &gt;(const IRPosition &amp;, const AbstractAttribute *, bool &amp;)&gt; SimplifictionCallbackTy</div><div class="ttdoc">Register CB as a simplification callback.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01887">Attributor.h:1887</a></div></div>
<div class="ttc" id="astructllvm_1_1AA_1_1ValueAndContext_html"><div class="ttname"><a href="structllvm_1_1AA_1_1ValueAndContext.html">llvm::AA::ValueAndContext</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00175">Attributor.h:175</a></div></div>
<div class="ttc" id="anamespacellvm_1_1jitlink_1_1aarch64_html_a54a878e42755b4a0e4cc8709f3f34e51"><div class="ttname"><a href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">llvm::jitlink::aarch64::PointerSize</a></div><div class="ttdeci">constexpr uint64_t PointerSize</div><div class="ttdoc">aarch64 pointer size.</div><div class="ttdef"><b>Definition:</b> <a href="aarch64_8h_source.html#l00479">aarch64.h:479</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_a850d8262cd900958b3153c4aa080b2bb"><div class="ttname"><a href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">llvm::CallInst::Create</a></div><div class="ttdeci">static CallInst * Create(FunctionType *Ty, Value *F, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01528">Instructions.h:1528</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1EnumeratedArray_html"><div class="ttname"><a href="classllvm_1_1EnumeratedArray.html">llvm::EnumeratedArray</a></div><div class="ttdef"><b>Definition:</b> <a href="EnumeratedArray_8h_source.html#l00026">EnumeratedArray.h:26</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMemoryLocation_html"><div class="ttname"><a href="structllvm_1_1AAMemoryLocation.html">llvm::AAMemoryLocation</a></div><div class="ttdoc">An abstract interface for all memory location attributes (readnone/argmemonly/inaccessiblememonly/ina...</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l04289">Attributor.h:4289</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19"><div class="ttname"><a href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">llvm::omp::OMP_TGT_EXEC_MODE_SPMD</a></div><div class="ttdeci">@ OMP_TGT_EXEC_MODE_SPMD</div><div class="ttdef"><b>Definition:</b> <a href="OMPDeviceConstants_8h_source.html#l00023">OMPDeviceConstants.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">llvm::AArch64CC::HS</a></div><div class="ttdeci">@ HS</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00257">AArch64BaseInfo.h:257</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html">llvm::MaybeAlign</a></div><div class="ttdoc">This struct is a compact representation of a valid (power of two) or undefined (0) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00117">Alignment.h:117</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">llvm::pdb::PDB_SymType::Caller</a></div><div class="ttdeci">@ Caller</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_aea16db681aa18f4eded0015e284fdfe5"><div class="ttname"><a href="structllvm_1_1IRPosition.html#aea16db681aa18f4eded0015e284fdfe5">llvm::IRPosition::getPositionKind</a></div><div class="ttdeci">Kind getPositionKind() const</div><div class="ttdoc">Return the associated position kind.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00800">Attributor.h:800</a></div></div>
<div class="ttc" id="anamespacellvm_html_adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405"><div class="ttname"><a href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1a7951811e4b085cf68ed3dc3191f36405">llvm::DepClassTy::OPTIONAL</a></div><div class="ttdeci">@ OPTIONAL</div><div class="ttdoc">The target may be valid if the source is not.</div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a35ee267850af7c235474a8c46c7ac5af"><div class="ttname"><a href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">llvm::Value::setName</a></div><div class="ttdeci">void setName(const Twine &amp;Name)</div><div class="ttdoc">Change the name of the value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00375">Value.cpp:375</a></div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01740">Constants.cpp:1740</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a50a2e57da274f8d69b9f932977379cdf"><div class="ttname"><a href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">llvm::Use::getUser</a></div><div class="ttdeci">User * getUser() const</div><div class="ttdoc">Returns the User that contains this Use.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00072">Use.h:72</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3b1c5788b85ffa254be0e834edf5cf8f"><div class="ttname"><a href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">llvm::getUnderlyingObject</a></div><div class="ttdeci">const Value * getUnderlyingObject(const Value *V, unsigned MaxLookup=6)</div><div class="ttdoc">This method strips off any GEP address adjustments and pointer casts from the specified value,...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04567">ValueTracking.cpp:4567</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a138a1ab10971c55c181b7f23b60e4582"><div class="ttname"><a href="namespacellvm_1_1omp.html#a138a1ab10971c55c181b7f23b60e4582">llvm::omp::isOpenMPDevice</a></div><div class="ttdeci">bool isOpenMPDevice(Module &amp;M)</div><div class="ttdoc">Helper to determine if M is a OpenMP target offloading device module.</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l05537">OpenMPOpt.cpp:5537</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">llvm::GlobalValue::InternalLinkage</a></div><div class="ttdeci">@ InternalLinkage</div><div class="ttdoc">Rename collisions when linking (static functions).</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00055">GlobalValue.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">llvm::MCID::Call</a></div><div class="ttdeci">@ Call</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00156">MCInstrDesc.h:156</a></div></div>
<div class="ttc" id="aclassllvm_1_1Metadata_html"><div class="ttname"><a href="classllvm_1_1Metadata.html">llvm::Metadata</a></div><div class="ttdoc">Root of the metadata hierarchy.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00061">Metadata.h:61</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_a068d18c1fc465f017895d6512d47467b"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#a068d18c1fc465f017895d6512d47467b">llvm::AttributorConfig::MaxFixpointIterations</a></div><div class="ttdeci">std::optional&lt; unsigned &gt; MaxFixpointIterations</div><div class="ttdoc">Maximum number of iterations to run until fixpoint.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01433">Attributor.h:1433</a></div></div>
<div class="ttc" id="aclassllvm_1_1OpenMPIRBuilder_html_a50c6490cf353f064946c4e32673ac098"><div class="ttname"><a href="classllvm_1_1OpenMPIRBuilder.html#a50c6490cf353f064946c4e32673ac098">llvm::OpenMPIRBuilder::addAttributes</a></div><div class="ttdeci">void addAttributes(omp::RuntimeFunction FnID, Function &amp;Fn)</div><div class="ttdoc">Add attributes known for FnID to Fn.</div><div class="ttdef"><b>Definition:</b> <a href="OMPIRBuilder_8cpp_source.html#l00331">OMPIRBuilder.cpp:331</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ae81c68608606dfb25edd3103a78d138a"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ae81c68608606dfb25edd3103a78d138a">llvm::IRBuilderBase::CreateAddrSpaceCast</a></div><div class="ttdeci">Value * CreateAddrSpaceCast(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02013">IRBuilder.h:2013</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_afac5b39bcbb90d660f83d9b4bd8c6d95"><div class="ttname"><a href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">llvm::CallBase::getCaller</a></div><div class="ttdeci">Function * getCaller()</div><div class="ttdoc">Helper to get the caller (the parent function).</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00293">Instructions.cpp:293</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_1_1PointerTypeAnalysis_html_ae574a4c1d84b9e67bc94489f356805b4"><div class="ttname"><a href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">llvm::dxil::PointerTypeAnalysis::run</a></div><div class="ttdeci">PointerTypeMap run(const Module &amp;M)</div><div class="ttdoc">Compute the PointerTypeMap for the module M.</div><div class="ttdef"><b>Definition:</b> <a href="PointerTypeAnalysis_8cpp_source.html#l00189">PointerTypeAnalysis.cpp:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_aac456a62894c9f0f8e9f06373bbf40f0"><div class="ttname"><a href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">llvm::BranchInst::getCondition</a></div><div class="ttdeci">Value * getCondition() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03220">Instructions.h:3220</a></div></div>
<div class="ttc" id="aAssumptions_8h_html"><div class="ttname"><a href="Assumptions_8h.html">Assumptions.h</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc"><div class="ttname"><a href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3a46335765005ff44b1fe1e38e5d2ddfcc">llvm::ChangeStatus::UNCHANGED</a></div><div class="ttdeci">@ UNCHANGED</div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a4608c581e6f18962661f7fc39ea88da2"><div class="ttname"><a href="namespacellvm_1_1omp.html#a4608c581e6f18962661f7fc39ea88da2">llvm::omp::InternalControlVar</a></div><div class="ttdeci">InternalControlVar</div><div class="ttdoc">IDs for all Internal Control Variables (ICVs).</div><div class="ttdef"><b>Definition:</b> <a href="OMPConstants_8h_source.html#l00027">OMPConstants.h:27</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a70c2cf8dfecc65410186dea5577367fe"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a70c2cf8dfecc65410186dea5577367fe">PrintOpenMPKernels</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; PrintOpenMPKernels(&quot;openmp-print-gpu-kernels&quot;, cl::init(false), cl::Hidden)</div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a8b653cb4535ffcdc32d19861bbef30ae"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a8b653cb4535ffcdc32d19861bbef30ae">llvm::BitmaskEnumDetail::operator^=</a></div><div class="ttdeci">E &amp; operator^=(E &amp;LHS, E RHS)</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00137">BitmaskEnum.h:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1function__ref_html"><div class="ttname"><a href="classllvm_1_1function__ref.html">llvm::function_ref</a></div><div class="ttdoc">An efficient, type-erasing, non-owning reference to a callable.</div><div class="ttdef"><b>Definition:</b> <a href="STLFunctionalExtras_8h_source.html#l00036">STLFunctionalExtras.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ac2e338e4c120fc3ea43099b54880f1f1"><div class="ttname"><a href="classllvm_1_1Value.html#ac2e338e4c120fc3ea43099b54880f1f1">llvm::Value::user_back</a></div><div class="ttdeci">User * user_back()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00407">Value.h:407</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a4c503140c7f851151906d85b515330e9"><div class="ttname"><a href="namespacellvm_1_1omp.html#a4c503140c7f851151906d85b515330e9">llvm::omp::RuntimeFunction</a></div><div class="ttdeci">RuntimeFunction</div><div class="ttdoc">IDs for all omp runtime library (RTL) functions.</div><div class="ttdef"><b>Definition:</b> <a href="OMPConstants_8h_source.html#l00046">OMPConstants.h:46</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_af8a50544090e81ac83601aff8f4b0142"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">llvm::SmallPtrSetImplBase::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00092">SmallPtrSet.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet</a></div><div class="ttdoc">Implements a dense probed hash-table based set.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00268">DenseSet.h:268</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6"><div class="ttname"><a href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">llvm::HighlightColor::Remark</a></div><div class="ttdeci">@ Remark</div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aAttributor_8h_html"><div class="ttname"><a href="Attributor_8h.html">Attributor.h</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_a04ea2fc0b7c81a7bb90ced540e3b075a"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#a04ea2fc0b7c81a7bb90ced540e3b075a">llvm::AttributorConfig::InitializationCallback</a></div><div class="ttdeci">std::function&lt; void(Attributor &amp;A, const Function &amp;F)&gt; InitializationCallback</div><div class="ttdoc">Callback function to be invoked on internal functions marked live.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01423">Attributor.h:1423</a></div></div>
<div class="ttc" id="aclassllvm_1_1Clause_html"><div class="ttname"><a href="classllvm_1_1Clause.html">llvm::Clause</a></div><div class="ttdef"><b>Definition:</b> <a href="DirectiveEmitter_8h_source.html#l00128">DirectiveEmitter.h:128</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a4c17a71e75898bbc42578a1c0b94c6b6"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a4c17a71e75898bbc42578a1c0b94c6b6">llvm::IRPosition::callsite_argument</a></div><div class="ttdeci">static const IRPosition callsite_argument(const CallBase &amp;CB, unsigned ArgNo)</div><div class="ttdoc">Create a position describing the argument of CB at position ArgNo.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00633">Attributor.h:633</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7e3e687ddfdcbacd404bcf17b917dd88"><div class="ttname"><a href="namespacellvm.html#a7e3e687ddfdcbacd404bcf17b917dd88">llvm::instructions</a></div><div class="ttdeci">inst_range instructions(Function *F)</div><div class="ttdef"><b>Definition:</b> <a href="InstIterator_8h_source.html#l00133">InstIterator.h:133</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_a0e5946885029c1bce1350d34f2539b1b"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">llvm::GlobalVariable::getInitializer</a></div><div class="ttdeci">const Constant * getInitializer() const</div><div class="ttdoc">getInitializer - Return the initializer for this global variable.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00135">GlobalVariable.h:135</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="anamespacellvm_html_a51e547c2283920aa77da2650a8ee3a7aab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aab50339a10e1de285ac99d4c3990b8693">llvm::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdoc">Do not track a dependence between source and target.</div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a2d989cf6c0da10e436e1e95e380e0e09"><div class="ttname"><a href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">llvm::CallBase::doesNotAccessMemory</a></div><div class="ttdeci">bool doesNotAccessMemory(unsigned OpNo) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01724">InstrTypes.h:1724</a></div></div>
<div class="ttc" id="astructllvm_1_1AbstractAttribute_html"><div class="ttname"><a href="structllvm_1_1AbstractAttribute.html">llvm::AbstractAttribute</a></div><div class="ttdoc">Base struct for all &quot;concrete attribute&quot; deductions.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l03105">Attributor.h:3105</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_adf4e7878fc0b3b8dcde545178564190d"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#adf4e7878fc0b3b8dcde545178564190d">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, 4, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00110">DenseMap.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab1772fd431decccb7926d484ea223db7"><div class="ttname"><a href="namespacellvm.html#ab1772fd431decccb7926d484ea223db7">llvm::count</a></div><div class="ttdeci">auto count(R &amp;&amp;Range, const E &amp;Element)</div><div class="ttdoc">Wrapper function around std::count to count the number of times an element Element occurs in the give...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01896">STLExtras.h:1896</a></div></div>
<div class="ttc" id="anamespacellvm_html_adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0"><div class="ttname"><a href="namespacellvm.html#adadcb655edca867f08f7ea6068a7d8a1aebdf9721be38d1fc1cd6db8c737d1be0">llvm::DepClassTy::REQUIRED</a></div><div class="ttdeci">@ REQUIRED</div><div class="ttdoc">The target cannot be valid if the source is not.</div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a9ecb71ea2b9e2a17b205ca3c03fb5a9d"><div class="ttname"><a href="namespacellvm_1_1omp.html#a9ecb71ea2b9e2a17b205ca3c03fb5a9d">llvm::omp::Kernel</a></div><div class="ttdeci">Function * Kernel</div><div class="ttdoc">Summary of a kernel (=entry point for target offloading).</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8h_source.html#l00021">OpenMPOpt.h:21</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html">llvm::MemorySSAUpdater</a></div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8h_source.html#l00054">MemorySSAUpdater.h:54</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a24b6e620b18edd37201fb9c0897835a8">llvm::MCID::Barrier</a></div><div class="ttdeci">@ Barrier</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00157">MCInstrDesc.h:157</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_a3df192ae0cdf572691dd5ff490278739"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#a3df192ae0cdf572691dd5ff490278739">llvm::AttributorConfig::RewriteSignatures</a></div><div class="ttdeci">bool RewriteSignatures</div><div class="ttdoc">Flag to determine if we rewrite function signatures.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01416">Attributor.h:1416</a></div></div>
<div class="ttc" id="aAArch64MCAsmInfo_8cpp_html_ad9974102ac4ab550bae0600eca728899a9683fc965be285edded4502f972f9d19"><div class="ttname"><a href="AArch64MCAsmInfo_8cpp.html#ad9974102ac4ab550bae0600eca728899a9683fc965be285edded4502f972f9d19">Generic</a></div><div class="ttdeci">@ Generic</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MCAsmInfo_8cpp_source.html#l00023">AArch64MCAsmInfo.cpp:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1BumpPtrAllocatorImpl_html"><div class="ttname"><a href="classllvm_1_1BumpPtrAllocatorImpl.html">llvm::BumpPtrAllocatorImpl</a></div><div class="ttdoc">Allocate memory in an ever growing pool, as if by bump-pointer.</div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00063">Allocator.h:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">llvm::GlobalValue::WeakAnyLinkage</a></div><div class="ttdeci">@ WeakAnyLinkage</div><div class="ttdoc">Keep one copy of named function when linking (weak)</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00052">GlobalValue.h:52</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a8c6f525466cc262e00c409c31f9a4272aa6156ea9d66fef24e87e841fbabf7cca"><div class="ttname"><a href="namespacellvm_1_1omp.html#a8c6f525466cc262e00c409c31f9a4272aa6156ea9d66fef24e87e841fbabf7cca">llvm::omp::AddressSpace::Shared</a></div><div class="ttdeci">@ Shared</div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0aa823f70d88660d88196943a3f09301da">llvm::IRPosition::IRP_FUNCTION</a></div><div class="ttdeci">@ IRP_FUNCTION</div><div class="ttdoc">An attribute for a function (scope).</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00572">Attributor.h:572</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_af552a06c4a7b7060450f45b05632c0d9"><div class="ttname"><a href="structllvm_1_1IRPosition.html#af552a06c4a7b7060450f45b05632c0d9">llvm::IRPosition::getAnchorValue</a></div><div class="ttdeci">Value &amp; getAnchorValue() const</div><div class="ttdoc">Return the value this abstract attribute is anchored with.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00677">Attributor.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a38df51256d4b415b6a817b5e1c6d4d36"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03195">Instructions.h:3195</a></div></div>
<div class="ttc" id="aMemoryLocation_8h_html"><div class="ttname"><a href="MemoryLocation_8h.html">MemoryLocation.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="astructllvm_1_1AAAssumptionInfo_html"><div class="ttname"><a href="structllvm_1_1AAAssumptionInfo.html">llvm::AAAssumptionInfo</a></div><div class="ttdoc">An abstract attribute for getting assumption information.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l05503">Attributor.h:5503</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a20cdc3911828248e70dbeae018106b76"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">llvm::FunctionType::getParamType</a></div><div class="ttdeci">Type * getParamType(unsigned i) const</div><div class="ttdoc">Parameter type accessors.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00135">DerivedTypes.h:135</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_abf73a826b5d6f739eb4af48ddf14c5b4"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#abf73a826b5d6f739eb4af48ddf14c5b4">llvm::SmallPtrSetImpl::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00403">SmallPtrSet.h:403</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="astructllvm_1_1AAIsDead_html"><div class="ttname"><a href="structllvm_1_1AAIsDead.html">llvm::AAIsDead</a></div><div class="ttdoc">An abstract interface for liveness abstract attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l03615">Attributor.h:3615</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a82741d1f59899bd473969ef3b9311939"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a82741d1f59899bd473969ef3b9311939">PrintModuleBeforeOptimizations</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; PrintModuleBeforeOptimizations(&quot;openmp-opt-print-module-before&quot;, cl::desc(&quot;Print the current module before OpenMP optimizations.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_ae451867ac0034a201153b54cc466386d"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#ae451867ac0034a201153b54cc466386d">llvm::ilist_node_with_parent::getPrevNode</a></div><div class="ttdeci">NodeTy * getPrevNode()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00275">ilist_node.h:275</a></div></div>
<div class="ttc" id="astructllvm_1_1AbstractState_html"><div class="ttname"><a href="structllvm_1_1AbstractState.html">llvm::AbstractState</a></div><div class="ttdoc">An interface to query the internal state of an abstract attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l02428">Attributor.h:2428</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a231ea6a9a0009e38969a20d4293119c7a5ced2def0c3f656428eb2144b4aaf6fb"><div class="ttname"><a href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7a5ced2def0c3f656428eb2144b4aaf6fb">llvm::omp::OMPScheduleType::UnorderedStatic</a></div><div class="ttdeci">@ UnorderedStatic</div></div>
<div class="ttc" id="astructllvm_1_1AAUnderlyingObjects_html"><div class="ttname"><a href="structllvm_1_1AAUnderlyingObjects.html">llvm::AAUnderlyingObjects</a></div><div class="ttdoc">An abstract attribute for getting all assumption underlying objects.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l05537">Attributor.h:5537</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_aecc0c27ae96638bc9d8fa4caffa92c31"><div class="ttname"><a href="classllvm_1_1CallBase.html#aecc0c27ae96638bc9d8fa4caffa92c31">llvm::CallBase::hasOperandBundles</a></div><div class="ttdeci">bool hasOperandBundles() const</div><div class="ttdoc">Return true if this User has any operand bundles.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01954">InstrTypes.h:1954</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a3ba1af4b9d9faa4a33729bbbecee83d1"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a3ba1af4b9d9faa4a33729bbbecee83d1">llvm::GlobalValue::hasLocalLinkage</a></div><div class="ttdeci">bool hasLocalLinkage() const</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00523">GlobalValue.h:523</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a4cb2a061e2ceec7947d57a2c1db03918"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a4cb2a061e2ceec7947d57a2c1db03918">SharedMemoryLimit</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; SharedMemoryLimit(&quot;openmp-opt-shared-limit&quot;, cl::Hidden, cl::desc(&quot;Maximum amount of shared memory to use.&quot;), cl::init(std::numeric_limits&lt; unsigned &gt;::max()))</div></div>
<div class="ttc" id="astructllvm_1_1AAMemoryLocation_html_ace2d4d5ab8dffea597c39bc129d90f7f"><div class="ttname"><a href="structllvm_1_1AAMemoryLocation.html#ace2d4d5ab8dffea597c39bc129d90f7f">llvm::AAMemoryLocation::AccessKind</a></div><div class="ttdeci">AccessKind</div><div class="ttdoc">Simple enum to distinguish read/write/read-write accesses.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l04414">Attributor.h:4414</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html"><div class="ttname"><a href="structllvm_1_1IRPosition.html">llvm::IRPosition</a></div><div class="ttdoc">Helper to describe and deal with positions in the LLVM-IR.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00560">Attributor.h:560</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphUpdater_html_a08fe25aef5a7fa6ebb858ee29125ce9a"><div class="ttname"><a href="classllvm_1_1CallGraphUpdater.html#a08fe25aef5a7fa6ebb858ee29125ce9a">llvm::CallGraphUpdater::registerOutlinedFunction</a></div><div class="ttdeci">void registerOutlinedFunction(Function &amp;OriginalFn, Function &amp;NewFn)</div><div class="ttdoc">If a new function was created by outlining, this method can be called to update the call graph for th...</div><div class="ttdef"><b>Definition:</b> <a href="CallGraphUpdater_8cpp_source.html#l00101">CallGraphUpdater.cpp:101</a></div></div>
<div class="ttc" id="aSIWholeQuadMode_8cpp_html_a0c198437833c48138f49e3589bd08773"><div class="ttname"><a href="SIWholeQuadMode_8cpp.html#a0c198437833c48138f49e3589bd08773">Mode</a></div><div class="ttdeci">SI Whole Quad Mode</div><div class="ttdef"><b>Definition:</b> <a href="SIWholeQuadMode_8cpp_source.html#l00262">SIWholeQuadMode.cpp:262</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a58b53550e1be2a034095e3e31fc82d66"><div class="ttname"><a href="namespacellvm_1_1omp.html#a58b53550e1be2a034095e3e31fc82d66">llvm::omp::ICVInitValue</a></div><div class="ttdeci">ICVInitValue</div><div class="ttdef"><b>Definition:</b> <a href="OMPConstants_8h_source.html#l00036">OMPConstants.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayType_html_adf411edc4f135b570ab218079474ce77"><div class="ttname"><a href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">llvm::ArrayType::get</a></div><div class="ttdeci">static ArrayType * get(Type *ElementType, uint64_t NumElements)</div><div class="ttdoc">This static method is the primary way to construct an ArrayType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00640">Type.cpp:640</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_aa9760ec3616ef020c7356dfc24a5cd7f"><div class="ttname"><a href="OpenMPOpt_8cpp.html#aa9760ec3616ef020c7356dfc24a5cd7f">DisableOpenMPOptStateMachineRewrite</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableOpenMPOptStateMachineRewrite(&quot;openmp-opt-disable-state-machine-rewrite&quot;, cl::desc(&quot;Disable OpenMP optimizations that replace the state machine.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1Node_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1Node.html">llvm::LazyCallGraph::Node</a></div><div class="ttdoc">A node in the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00315">LazyCallGraph.h:315</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM_1_1WinEH_html_aeb1849a948db3f783d1598b797186c4a"><div class="ttname"><a href="namespacellvm_1_1ARM_1_1WinEH.html#aeb1849a948db3f783d1598b797186c4a">llvm::ARM::WinEH::ReturnType</a></div><div class="ttdeci">ReturnType</div><div class="ttdef"><b>Definition:</b> <a href="ARMWinEH_8h_source.html#l00025">ARMWinEH.h:25</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4d812a2dd18aa186c164447e20e348e7"><div class="ttname"><a href="namespacellvm.html#a4d812a2dd18aa186c164447e20e348e7">llvm::operator==</a></div><div class="ttdeci">bool operator==(const AddressRangeValuePair &amp;LHS, const AddressRangeValuePair &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00153">AddressRanges.h:153</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a></div><div class="ttdeci">@ ICMP_SLT</div><div class="ttdoc">signed less than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00747">InstrTypes.h:747</a></div></div>
<div class="ttc" id="anamespacellvm_html_a10f3d955592ae2bc745f57e5b48ae115"><div class="ttname"><a href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">llvm::size</a></div><div class="ttdeci">auto size(R &amp;&amp;Range, std::enable_if_t&lt; std::is_base_of&lt; std::random_access_iterator_tag, typename std::iterator_traits&lt; decltype(Range.begin())&gt;::iterator_category &gt;::value, void &gt; *=nullptr)</div><div class="ttdoc">Get the size of a range.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01716">STLExtras.h:1716</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1CPol_html_a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1CPol.html#a7d79a4b341da8ac60b91c1f4b1ea42c4aca1659af59093b2b14c2f8aad41e8e2a">llvm::AMDGPU::CPol::SCC</a></div><div class="ttdeci">@ SCC</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00316">SIDefines.h:316</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5d737fb4258bb27586a1bffd557fbb49a7757dfb07e9ac64f8c7076644e2deac1"><div class="ttname"><a href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49a7757dfb07e9ac64f8c7076644e2deac1">llvm::ThinOrFullLTOPhase::FullLTOPostLink</a></div><div class="ttdeci">@ FullLTOPostLink</div><div class="ttdoc">Full LTO postlink (backend compile) phase.</div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a8bd94921b59d24f031ef7e64525e14f8">llvm::IRPosition::IRP_CALL_SITE_RETURNED</a></div><div class="ttdeci">@ IRP_CALL_SITE_RETURNED</div><div class="ttdoc">An attribute for a call site return value.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00571">Attributor.h:571</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a7f2eade374bf61ed94ab98b04803a079"><div class="ttname"><a href="namespacellvm_1_1omp.html#a7f2eade374bf61ed94ab98b04803a079">llvm::omp::getDeviceKernels</a></div><div class="ttdeci">KernelSet getDeviceKernels(Module &amp;M)</div><div class="ttdoc">Get OpenMP device kernels in M.</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l05501">OpenMPOpt.cpp:5501</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="anamespacellvm_html_a51e547c2283920aa77da2650a8ee3a7aaa705a97e17b5651633fcbb938bb1f79f"><div class="ttname"><a href="namespacellvm.html#a51e547c2283920aa77da2650a8ee3a7aaa705a97e17b5651633fcbb938bb1f79f">llvm::CGSCC</a></div><div class="ttdeci">@ CGSCC</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l05574">Attributor.h:5574</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0afd1465681c30be50be67dcf938d73f5f">llvm::IRPosition::IRP_INVALID</a></div><div class="ttdeci">@ IRP_INVALID</div><div class="ttdoc">An invalid position.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00567">Attributor.h:567</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae959364e4640ac025bbc046d3d7c7e61"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae959364e4640ac025bbc046d3d7c7e61">llvm::Instruction::setSuccessor</a></div><div class="ttdeci">void setSuccessor(unsigned Idx, BasicBlock *BB)</div><div class="ttdoc">Update the specified successor to point at the provided block.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00847">Instruction.cpp:847</a></div></div>
<div class="ttc" id="aMemorySSA_8cpp_html_aced78c3344e93eaed9a44b319bf14c29"><div class="ttname"><a href="MemorySSA_8cpp.html#aced78c3344e93eaed9a44b319bf14c29">Printer</a></div><div class="ttdeci">Memory true print Memory SSA Printer</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8cpp_source.html#l00078">MemorySSA.cpp:78</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="ainclude_2llvm_2Support_2CMakeLists_8txt_html_aef9367eb0b7430eaf70b1f2725488f2a"><div class="ttname"><a href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a></div><div class="ttdeci">if(llvm_vc STREQUAL &quot;&quot;) set(fake_version_inc &quot;$</div><div class="ttdef"><b>Definition:</b> <a href="include_2llvm_2Support_2CMakeLists_8txt_source.html#l00014">CMakeLists.txt:14</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a882d55a6aa2028e1a5ad708b275334e0"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">llvm::ConstantInt::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">This is just a convenience method to make client code smaller for a common code.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00193">Constants.h:193</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6a66ebb3aa12757479a3c88de77d78f8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">llvm::Instruction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const</div><div class="ttdoc">Return the function this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00074">Instruction.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aEnumeratedArray_8h_html"><div class="ttname"><a href="EnumeratedArray_8h.html">EnumeratedArray.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ace940beeee97c222f836fe0ac70f6cf5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">llvm::BasicBlock::Create</a></div><div class="ttdeci">static BasicBlock * Create(LLVMContext &amp;Context, const Twine &amp;Name=&quot;&quot;, Function *Parent=nullptr, BasicBlock *InsertBefore=nullptr)</div><div class="ttdoc">Creates a new BasicBlock.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00105">BasicBlock.h:105</a></div></div>
<div class="ttc" id="aBasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00806">BasicAliasAnalysis.cpp:806</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="astructllvm_1_1AANoSync_html_a79dea56e8e62d80d48cddd4319a55380"><div class="ttname"><a href="structllvm_1_1AANoSync.html#a79dea56e8e62d80d48cddd4319a55380">llvm::AANoSync::isAlignedBarrier</a></div><div class="ttdeci">static bool isAlignedBarrier(const CallBase &amp;CB, bool ExecutedAligned)</div><div class="ttdoc">Helper function to determine if CB is an aligned (GPU) barrier.</div><div class="ttdef"><b>Definition:</b> <a href="AttributorAttributes_8cpp_source.html#l02288">AttributorAttributes.cpp:2288</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_a3ffd7d836cc546feb2fb671fd3cf0b73"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#a3ffd7d836cc546feb2fb671fd3cf0b73">llvm::AttributorConfig::PassName</a></div><div class="ttdeci">const char * PassName</div><div class="ttdoc">}</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01443">Attributor.h:1443</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="astructllvm_1_1AAPotentialValues_html"><div class="ttname"><a href="structllvm_1_1AAPotentialValues.html">llvm::AAPotentialValues</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l04774">Attributor.h:4774</a></div></div>
<div class="ttc" id="astructllvm_1_1AAExecutionDomain_html"><div class="ttname"><a href="structllvm_1_1AAExecutionDomain.html">llvm::AAExecutionDomain</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l05004">Attributor.h:5004</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a"><div class="ttname"><a href="namespacellvm.html#acd850975ae5042cacb64a9d0ea4715f3ae6b94e58bfd13b21bc786578d9f8ba4a">llvm::ChangeStatus::CHANGED</a></div><div class="ttdeci">@ CHANGED</div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa8f4be0661aa64f5b1f20b15e93bb403"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">llvm::ConstantInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit integer value after it has been sign extended as appropriate for the ...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00147">Constants.h:147</a></div></div>
<div class="ttc" id="astructllvm_1_1Attributor_html_a312bc8ef3e9761ec87b3b6d05d6e2420"><div class="ttname"><a href="structllvm_1_1Attributor.html#a312bc8ef3e9761ec87b3b6d05d6e2420">llvm::Attributor::isInternalizable</a></div><div class="ttdeci">static bool isInternalizable(Function &amp;F)</div><div class="ttdoc">Returns true if the function F can be internalized.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8cpp_source.html#l02593">Attributor.cpp:2593</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkAnalysis.html">llvm::OptimizationRemarkAnalysis</a></div><div class="ttdoc">Diagnostic information for optimization analysis remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00780">DiagnosticInfo.h:780</a></div></div>
<div class="ttc" id="aCallGraphSCCPass_8h_html"><div class="ttname"><a href="CallGraphSCCPass_8h.html">CallGraphSCCPass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a99f811d53704275b4158c62a2dd138d9"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, 4, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00207">DenseMap.h:207</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a1a039c806c0a203f470ea11b6932402c"><div class="ttname"><a href="namespacellvm_1_1omp.html#a1a039c806c0a203f470ea11b6932402c">llvm::omp::containsOpenMP</a></div><div class="ttdeci">bool containsOpenMP(Module &amp;M)</div><div class="ttdoc">Helper to determine if M contains OpenMP.</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l05529">OpenMPOpt.cpp:5529</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a1600c7959045cb6b6a5f5a1d427ec67e"><div class="ttname"><a href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">llvm::User::replaceUsesOfWith</a></div><div class="ttdeci">bool replaceUsesOfWith(Value *From, Value *To)</div><div class="ttdoc">Replace uses of one Value with another.</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00021">User.cpp:21</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0af5dba641c6a961375aee403f7cde7b31">llvm::IRPosition::IRP_CALL_SITE_ARGUMENT</a></div><div class="ttdeci">@ IRP_CALL_SITE_ARGUMENT</div><div class="ttdoc">An attribute for a call site argument.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00575">Attributor.h:575</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_aeb548ad4e336f7f3d3cc91578b5de0a8"><div class="ttname"><a href="classllvm_1_1Module.html#aeb548ad4e336f7f3d3cc91578b5de0a8">llvm::Module::getGlobalVariable</a></div><div class="ttdeci">GlobalVariable * getGlobalVariable(StringRef Name) const</div><div class="ttdoc">Look up the specified global variable in the module symbol table.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00414">Module.h:414</a></div></div>
<div class="ttc" id="aclassllvm_1_1NamedMDNode_html_acfe76fbea7879969fb26502ea5ffba97"><div class="ttname"><a href="classllvm_1_1NamedMDNode.html#acfe76fbea7879969fb26502ea5ffba97">llvm::NamedMDNode::operands</a></div><div class="ttdeci">iterator_range&lt; op_iterator &gt; operands()</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l01683">Metadata.h:1683</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a966eb231e7d4e572874d2cb49b18faea"><div class="ttname"><a href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">const Value * stripPointerCasts() const</div><div class="ttdoc">Strip off pointer casts, all-zero GEPs and address space casts.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00685">Value.cpp:685</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_a0e1c3175b0ac22fe3853651c28e1ecb8"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">llvm::SmallPtrSetImplBase::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00093">SmallPtrSet.h:93</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionCallee_html_a0055cd5464b935f571b36979a86bd7fc"><div class="ttname"><a href="classllvm_1_1FunctionCallee.html#a0055cd5464b935f571b36979a86bd7fc">llvm::FunctionCallee::getCallee</a></div><div class="ttdeci">Value * getCallee()</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00184">DerivedTypes.h:184</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab706e7ebb1969c5e34f28bfcf2ff719e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00326">BasicBlock.h:326</a></div></div>
<div class="ttc" id="astructllvm_1_1Attributor_html_aed892a6809e769b95c507a0b850dfe4d"><div class="ttname"><a href="structllvm_1_1Attributor.html#aed892a6809e769b95c507a0b850dfe4d">llvm::Attributor::VirtualUseCallbackTy</a></div><div class="ttdeci">std::function&lt; bool(Attributor &amp;, const AbstractAttribute *)&gt; VirtualUseCallbackTy</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01899">Attributor.h:1899</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6ea260be710ac7b61309534308da3147"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">llvm::Instruction::mayHaveSideEffects</a></div><div class="ttdeci">bool mayHaveSideEffects() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction may have side effects.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00745">Instruction.cpp:745</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a8c6f525466cc262e00c409c31f9a4272a8045a0a6c688b0635e3caccc408a1446"><div class="ttname"><a href="namespacellvm_1_1omp.html#a8c6f525466cc262e00c409c31f9a4272a8045a0a6c688b0635e3caccc408a1446">llvm::omp::AddressSpace::Generic</a></div><div class="ttdeci">@ Generic</div></div>
<div class="ttc" id="astructllvm_1_1CGSCCUpdateResult_html"><div class="ttname"><a href="structllvm_1_1CGSCCUpdateResult.html">llvm::CGSCCUpdateResult</a></div><div class="ttdoc">Support structure for SCC passes to communicate updates the call graph back to the CGSCC pass manager...</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8h_source.html#l00232">CGSCCPassManager.h:232</a></div></div>
<div class="ttc" id="astructllvm_1_1SetState_html_a9ff5a4bc95239fcf7ec442a9c1bf0cc9"><div class="ttname"><a href="structllvm_1_1SetState.html#a9ff5a4bc95239fcf7ec442a9c1bf0cc9">llvm::SetState::indicateOptimisticFixpoint</a></div><div class="ttdeci">ChangeStatus indicateOptimisticFixpoint() override</div><div class="ttdoc">See AbstractState::indicateOptimisticFixpoint(...)</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l02939">Attributor.h:2939</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_ac760bb314a61ad7d42edfcd3929ca4e0"><div class="ttname"><a href="OpenMPOpt_8cpp.html#ac760bb314a61ad7d42edfcd3929ca4e0">EnableParallelRegionMerging</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableParallelRegionMerging(&quot;openmp-opt-enable-merging&quot;, cl::desc(&quot;Enable the OpenMP region merging optimization.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a82dbbd8e3688b0bc1eedb338864d0d0c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">llvm::ConstantInt::getTrue</a></div><div class="ttdeci">static ConstantInt * getTrue(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00835">Constants.cpp:835</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_a584c356b083da5f7ca5ece1765a7e206"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#a584c356b083da5f7ca5ece1765a7e206">llvm::AttributorConfig::OREGetter</a></div><div class="ttdeci">OptimizationRemarkGetter OREGetter</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01439">Attributor.h:1439</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a53f576f97e0dfa8314afb16bd74a76d0a4b033e6b489e8f06fe2819955eb8011b">llvm::IRPosition::IRP_CALL_SITE</a></div><div class="ttdeci">@ IRP_CALL_SITE</div><div class="ttdoc">An attribute for a call site (function scope).</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00573">Attributor.h:573</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00851">BitVector.h:851</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdoc">Constructor to create a '0' constant of arbitrary type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00356">Constants.cpp:356</a></div></div>
<div class="ttc" id="aclassllvm_1_1OpenMPOptPass_html_ad0812a5ba88f8645505134a108f639b2"><div class="ttname"><a href="classllvm_1_1OpenMPOptPass.html#ad0812a5ba88f8645505134a108f639b2">llvm::OpenMPOptPass::run</a></div><div class="ttdeci">PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l05322">OpenMPOpt.cpp:5322</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a38c50aa8e3e9588f4f968c2e03a0cee0"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a38c50aa8e3e9588f4f968c2e03a0cee0">llvm::SmallVectorImpl::assign</a></div><div class="ttdeci">void assign(size_type NumElts, ValueParamT Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00708">SmallVector.h:708</a></div></div>
<div class="ttc" id="anamespacellvm_html_a63540526d092e2f4bbc70590b6034f4e"><div class="ttname"><a href="namespacellvm.html#a63540526d092e2f4bbc70590b6034f4e">llvm::toString</a></div><div class="ttdeci">const char * toString(DWARFSectionKind Kind)</div><div class="ttdef"><b>Definition:</b> <a href="DWARFUnitIndex_8h_source.html#l00067">DWARFUnitIndex.h:67</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86_html_a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e"><div class="ttname"><a href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">llvm::X86::FirstMacroFusionInstKind::Cmp</a></div><div class="ttdeci">@ Cmp</div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_afe7d477c6022fe7123b90e3b39c58e69"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">llvm::ConstantInt::getBool</a></div><div class="ttdeci">static ConstantInt * getBool(LLVMContext &amp;Context, bool V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00849">Constants.cpp:849</a></div></div>
<div class="ttc" id="astructllvm_1_1AAExecutionDomain_html_aab1e417c2b00db90ff3c20bdd29401c6"><div class="ttname"><a href="structllvm_1_1AAExecutionDomain.html#aab1e417c2b00db90ff3c20bdd29401c6">llvm::AAExecutionDomain::getFunctionExecutionDomain</a></div><div class="ttdeci">virtual ExecutionDomainTy getFunctionExecutionDomain() const =0</div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a8052a4f265aa7540f68ca3103a55538d"><div class="ttname"><a href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">llvm::Function::getArg</a></div><div class="ttdeci">Argument * getArg(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00784">Function.h:784</a></div></div>
<div class="ttc" id="aGlobalVariable_8h_html"><div class="ttname"><a href="GlobalVariable_8h.html">GlobalVariable.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AA_html_add4df090e923f2fe0dceeb0c60e5f74b"><div class="ttname"><a href="namespacellvm_1_1AA.html#add4df090e923f2fe0dceeb0c60e5f74b">llvm::AA::isNoSyncInst</a></div><div class="ttdeci">bool isNoSyncInst(Attributor &amp;A, const Instruction &amp;I, const AbstractAttribute &amp;QueryingAA)</div><div class="ttdoc">Return true if I is a nosync instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8cpp_source.html#l00190">Attributor.cpp:190</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMemoryLocation_html_acffe374fb52ac7da0511285fdf18db3f"><div class="ttname"><a href="structllvm_1_1AAMemoryLocation.html#acffe374fb52ac7da0511285fdf18db3f">llvm::AAMemoryLocation::MemoryLocationsKind</a></div><div class="ttdeci">StateType::base_t MemoryLocationsKind</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l04293">Attributor.h:4293</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ad736fb9b585509388546c12617def38f"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ad736fb9b585509388546c12617def38f">llvm::ConstantInt::getSigned</a></div><div class="ttdeci">static ConstantInt * getSigned(IntegerType *Ty, int64_t V)</div><div class="ttdoc">Return a ConstantInt with the specified value for the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00901">Constants.cpp:901</a></div></div>
<div class="ttc" id="aDiagnosticInfo_8h_html"><div class="ttname"><a href="DiagnosticInfo_8h.html">DiagnosticInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a21c2c6ae5ec23004dc4020eacf83bbce"><div class="ttname"><a href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const key_type &amp;key) const</div><div class="ttdoc">Count the number of elements of a given key in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00208">SetVector.h:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_adc01a7457de85fc52a3bb860d7e1c6a4"><div class="ttname"><a href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0) const</div><div class="ttdoc">Return a pointer to the current type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00776">Type.cpp:776</a></div></div>
<div class="ttc" id="astructllvm_1_1Attributor_html"><div class="ttname"><a href="structllvm_1_1Attributor.html">llvm::Attributor</a></div><div class="ttdoc">The fixpoint analysis framework that orchestrates the attribute deduction.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01473">Attributor.h:1473</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html_a8c4c3b7c7daea37c75c50563654bf934"><div class="ttname"><a href="classllvm_1_1ReturnInst.html#a8c4c3b7c7daea37c75c50563654bf934">llvm::ReturnInst::Create</a></div><div class="ttdeci">static ReturnInst * Create(LLVMContext &amp;C, Value *retVal=nullptr, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03084">Instructions.h:3084</a></div></div>
<div class="ttc" id="astructllvm_1_1AttributorConfig_html_af5d73bb34e01f98a095edeaff5338ecc"><div class="ttname"><a href="structllvm_1_1AttributorConfig.html#af5d73bb34e01f98a095edeaff5338ecc">llvm::AttributorConfig::DefaultInitializeLiveInternals</a></div><div class="ttdeci">bool DefaultInitializeLiveInternals</div><div class="ttdoc">Flag to determine if we want to initialize all default AAs for an internal function marked live.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01420">Attributor.h:1420</a></div></div>
<div class="ttc" id="anamespacellvm_html_afc6337ef6e00f6bebd44d81b685d655f"><div class="ttname"><a href="namespacellvm.html#afc6337ef6e00f6bebd44d81b685d655f">llvm::GetPointerBaseWithConstantOffset</a></div><div class="ttdeci">Value * GetPointerBaseWithConstantOffset(Value *Ptr, int64_t &amp;Offset, const DataLayout &amp;DL, bool AllowNonInbounds=true)</div><div class="ttdoc">Analyze the specified pointer to see if it can be expressed as a base pointer plus a constant offset.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8h_source.html#l00271">ValueTracking.h:271</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_aeef35bb007616add7418161b0313b56b"><div class="ttname"><a href="structllvm_1_1IRPosition.html#aeef35bb007616add7418161b0313b56b">llvm::IRPosition::callsite_function</a></div><div class="ttdeci">static const IRPosition callsite_function(const CallBase &amp;CB)</div><div class="ttdoc">Create a position describing the function scope of CB.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00623">Attributor.h:623</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReversePostOrderTraversal_html"><div class="ttname"><a href="classllvm_1_1ReversePostOrderTraversal.html">llvm::ReversePostOrderTraversal</a></div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00293">PostOrderIterator.h:293</a></div></div>
<div class="ttc" id="aOMPConstants_8h_html"><div class="ttname"><a href="OMPConstants_8h.html">OMPConstants.h</a></div></div>
<div class="ttc" id="astructllvm_1_1AAHeapToStack_html"><div class="ttname"><a href="structllvm_1_1AAHeapToStack.html">llvm::AAHeapToStack</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l04149">Attributor.h:4149</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a3b4a54b076454fec43b13554b28252a9"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">llvm::CmpInst::Create</a></div><div class="ttdeci">static CmpInst * Create(OtherOps Op, Predicate predicate, Value *S1, Value *S2, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Construct a compare instruction, given the opcode, the predicate and the two operands.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l04025">Instructions.cpp:4025</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a79fd2bece62d2060209f319c45450c0c"><div class="ttname"><a href="classllvm_1_1Function.html#a79fd2bece62d2060209f319c45450c0c">llvm::Function::front</a></div><div class="ttdeci">const BasicBlock &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00758">Function.h:758</a></div></div>
<div class="ttc" id="aCallGraph_8h_html"><div class="ttname"><a href="CallGraph_8h.html">CallGraph.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a6e20e76960d952de088354cbcd14c3ab"><div class="ttname"><a href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">llvm::Type::getVoidTy</a></div><div class="ttdeci">static Type * getVoidTy(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00224">Type.cpp:224</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_affac0dc3d407ef3dee29b8bc9a4836bc"><div class="ttname"><a href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">llvm::SetVector::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Get an iterator to the end of the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00092">SetVector.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a6d3231fb84ed4182ec22e9442a87dbf8"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a6d3231fb84ed4182ec22e9442a87dbf8">llvm::BasicBlock::reverse_iterator</a></div><div class="ttdeci">InstListType::reverse_iterator reverse_iterator</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00089">BasicBlock.h:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">llvm::GlobalValue::PrivateLinkage</a></div><div class="ttdeci">@ PrivateLinkage</div><div class="ttdoc">Like Internal, but omit from symbol table.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00056">GlobalValue.h:56</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aPostOrderIterator_8h_html"><div class="ttname"><a href="PostOrderIterator_8h.html">PostOrderIterator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a28bf8984fbfb08fd27df435e631e6832"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a28bf8984fbfb08fd27df435e631e6832">llvm::ConstantExpr::getPointerBitCastOrAddrSpaceCast</a></div><div class="ttdeci">static Constant * getPointerBitCastOrAddrSpaceCast(Constant *C, Type *Ty)</div><div class="ttdoc">Create a BitCast or AddrSpaceCast for a pointer type depending on the address space.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02056">Constants.cpp:2056</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="astructllvm_1_1IntegerStateBase_html_aa3d9223692390a32c796d8160c6f058c"><div class="ttname"><a href="structllvm_1_1IntegerStateBase.html#aa3d9223692390a32c796d8160c6f058c">llvm::IntegerStateBase&lt; bool, true, false &gt;::indicatePessimisticFixpoint</a></div><div class="ttdeci">ChangeStatus indicatePessimisticFixpoint() override</div><div class="ttdoc">See AbstractState::indicatePessimisticFixpoint(...)</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l02499">Attributor.h:2499</a></div></div>
<div class="ttc" id="aInlineInfo_8cpp_html_a5db99f4b7f8744e0b1c8b50dba8ec5a2"><div class="ttname"><a href="InlineInfo_8cpp.html#a5db99f4b7f8744e0b1c8b50dba8ec5a2">lookup</a></div><div class="ttdeci">static bool lookup(const GsymReader &amp;GR, DataExtractor &amp;Data, uint64_t &amp;Offset, uint64_t BaseAddr, uint64_t Addr, SourceLocations &amp;SrcLocs, llvm::Error &amp;Err)</div><div class="ttdoc">A Lookup helper functions.</div><div class="ttdef"><b>Definition:</b> <a href="InlineInfo_8cpp_source.html#l00109">InlineInfo.cpp:109</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aRegAllocBasic_8cpp_html_ad5d00e1d77644d95847b9bf8da12b759"><div class="ttname"><a href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a></div><div class="ttdeci">Basic Register Allocator</div><div class="ttdef"><b>Definition:</b> <a href="RegAllocBasic_8cpp_source.html#l00143">RegAllocBasic.cpp:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html_ac0f741735997264d3018e30ce2a6b2d3"><div class="ttname"><a href="classllvm_1_1PointerType.html#ac0f741735997264d3018e30ce2a6b2d3">llvm::PointerType::getWithSamePointeeType</a></div><div class="ttdeci">static PointerType * getWithSamePointeeType(PointerType *PT, unsigned AddressSpace)</div><div class="ttdoc">This constructs a pointer type with the same pointee type as input PointerType (or opaque pointer if ...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00666">DerivedTypes.h:666</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="anamespacellvm_html_a13c1b5a253da5da49ce33d03dc1efc07"><div class="ttname"><a href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">llvm::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;Value)</div><div class="ttdef"><b>Definition:</b> <a href="ScopedPrinter_8h_source.html#l00085">ScopedPrinter.h:85</a></div></div>
<div class="ttc" id="astructllvm_1_1AAExecutionDomain_1_1ExecutionDomainTy_html_a67e0a6ee379bd5b1b474c11641de68c4"><div class="ttname"><a href="structllvm_1_1AAExecutionDomain_1_1ExecutionDomainTy.html#a67e0a6ee379bd5b1b474c11641de68c4">llvm::AAExecutionDomain::ExecutionDomainTy::IsReachedFromAlignedBarrierOnly</a></div><div class="ttdeci">bool IsReachedFromAlignedBarrierOnly</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l05028">Attributor.h:5028</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a85ffb6531d4cda988ea81f18d4e56fb7"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">llvm::ArrayRef::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">size - Get the array size.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00163">ArrayRef.h:163</a></div></div>
<div class="ttc" id="astructllvm_1_1AnalysisGetter_html"><div class="ttname"><a href="structllvm_1_1AnalysisGetter.html">llvm::AnalysisGetter</a></div><div class="ttdoc">Wrapper for FunctionAnalysisManager.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l01102">Attributor.h:1102</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionCallee_html"><div class="ttname"><a href="classllvm_1_1FunctionCallee.html">llvm::FunctionCallee</a></div><div class="ttdoc">A handy container for a FunctionType+Callee-pointer pair, which can be passed around as a single enti...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00165">DerivedTypes.h:165</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_aaa7ffb579a72260b325fb2139c8a758a"><div class="ttname"><a href="OpenMPOpt_8cpp.html#aaa7ffb579a72260b325fb2139c8a758a">DisableInternalization</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableInternalization(&quot;openmp-opt-disable-internalization&quot;, cl::desc(&quot;Disable function internalization.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a87f56db834c58ca630624956ecf6972f"><div class="ttname"><a href="classllvm_1_1Type.html#a87f56db834c58ca630624956ecf6972f">llvm::Type::getInt16Ty</a></div><div class="ttdeci">static IntegerType * getInt16Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00240">Type.cpp:240</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl&lt; Instruction * &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSetVector_html"><div class="ttname"><a href="classllvm_1_1SmallSetVector.html">llvm::SmallSetVector</a></div><div class="ttdoc">A SetVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00300">SetVector.h:300</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a422d1075ccfadded5ddc52f1ffe7d26f"><div class="ttname"><a href="classllvm_1_1SetVector.html#a422d1075ccfadded5ddc52f1ffe7d26f">llvm::SetVector::back</a></div><div class="ttdeci">const T &amp; back() const</div><div class="ttdoc">Return the last element of the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00128">SetVector.h:128</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1InnerAnalysisManagerProxy_html"><div class="ttname"><a href="classllvm_1_1InnerAnalysisManagerProxy.html">llvm::InnerAnalysisManagerProxy</a></div><div class="ttdoc">An analysis over an &quot;outer&quot; IR unit that provides access to an analysis manager over an &quot;inner&quot; IR un...</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00931">PassManager.h:931</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a48fab4c5bc866fd3cbda51b75511da6b"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a48fab4c5bc866fd3cbda51b75511da6b">DisableOpenMPOptFolding</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableOpenMPOptFolding(&quot;openmp-opt-disable-folding&quot;, cl::desc(&quot;Disable OpenMP optimizations involving folding.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="astructllvm_1_1AAExecutionDomain_html_a49479d09ce9ca5942db280559eab93c4"><div class="ttname"><a href="structllvm_1_1AAExecutionDomain.html#a49479d09ce9ca5942db280559eab93c4">llvm::AAExecutionDomain::createForPosition</a></div><div class="ttdeci">static AAExecutionDomain &amp; createForPosition(const IRPosition &amp;IRP, Attributor &amp;A)</div><div class="ttdoc">Create an abstract attribute view for the position IRP.</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l05238">OpenMPOpt.cpp:5238</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdoc">A debug info location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00033">DebugLoc.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdoc">an instruction to allocate memory on the stack</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="aCallGraphUpdater_8h_html"><div class="ttname"><a href="CallGraphUpdater_8h.html">CallGraphUpdater.h</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a231ea6a9a0009e38969a20d4293119c7ab32d50fad87058c7739867aa6c7f05b0"><div class="ttname"><a href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7ab32d50fad87058c7739867aa6c7f05b0">llvm::omp::OMPScheduleType::OrderedDistributeChunked</a></div><div class="ttdeci">@ OrderedDistributeChunked</div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_aa0c0d79dafb0d22308ce48808689f430a3a7132dd26b3986109b8fffccd140f41"><div class="ttname"><a href="namespacellvm_1_1omp.html#aa0c0d79dafb0d22308ce48808689f430a3a7132dd26b3986109b8fffccd140f41">llvm::omp::OMP_TGT_EXEC_MODE_GENERIC_SPMD</a></div><div class="ttdeci">@ OMP_TGT_EXEC_MODE_GENERIC_SPMD</div><div class="ttdef"><b>Definition:</b> <a href="OMPDeviceConstants_8h_source.html#l00024">OMPDeviceConstants.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDString_html_ae44259d9edd71181ea8b89d18f27a967"><div class="ttname"><a href="classllvm_1_1MDString.html#ae44259d9edd71181ea8b89d18f27a967">llvm::MDString::getString</a></div><div class="ttdeci">StringRef getString() const</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00507">Metadata.cpp:507</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html">llvm::LazyCallGraph</a></div><div class="ttdoc">A lazily constructed view of the call graph of a module.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00110">LazyCallGraph.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphUpdater_html_ad87000cd59cd61d387ff649d7f2774f1"><div class="ttname"><a href="classllvm_1_1CallGraphUpdater.html#ad87000cd59cd61d387ff649d7f2774f1">llvm::CallGraphUpdater::initialize</a></div><div class="ttdeci">void initialize(CallGraph &amp;CG, CallGraphSCC &amp;SCC)</div><div class="ttdoc">Initializers for usage outside of a CGSCC pass, inside a CGSCC pass in the old and new pass manager (...</div><div class="ttdef"><b>Definition:</b> <a href="CallGraphUpdater_8h_source.html#l00063">CallGraphUpdater.h:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphUpdater_html_a7bf8126709349339746d58096776d4f3"><div class="ttname"><a href="classllvm_1_1CallGraphUpdater.html#a7bf8126709349339746d58096776d4f3">llvm::CallGraphUpdater::reanalyzeFunction</a></div><div class="ttdeci">void reanalyzeFunction(Function &amp;Fn)</div><div class="ttdoc">After an CGSCC pass changes a function in ways that affect the call graph, this method can be called ...</div><div class="ttdef"><b>Definition:</b> <a href="CallGraphUpdater_8cpp_source.html#l00089">CallGraphUpdater.cpp:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector&lt; Function * &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a231ea6a9a0009e38969a20d4293119c7"><div class="ttname"><a href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7">llvm::omp::OMPScheduleType</a></div><div class="ttdeci">OMPScheduleType</div><div class="ttdef"><b>Definition:</b> <a href="OMPConstants_8h_source.html#l00077">OMPConstants.h:77</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">llvm::CallingConv::Cold</a></div><div class="ttdeci">@ Cold</div><div class="ttdoc">Attempts to make code in the caller as efficient as possible under the assumption that the call is no...</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00047">CallingConv.h:47</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a22b55f73ab4057a8c3da9f32bd582f4b"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a22b55f73ab4057a8c3da9f32bd582f4b">llvm::IRPosition::callsite_returned</a></div><div class="ttdeci">static const IRPosition callsite_returned(const CallBase &amp;CB)</div><div class="ttdoc">Create a position describing the returned value of CB.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00628">Attributor.h:628</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionAnalysisManagerCGSCCProxy_html"><div class="ttname"><a href="classllvm_1_1FunctionAnalysisManagerCGSCCProxy.html">llvm::FunctionAnalysisManagerCGSCCProxy</a></div><div class="ttdoc">A proxy from a FunctionAnalysisManager to an SCC.</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8h_source.html#l00392">CGSCCPassManager.h:392</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDString_html"><div class="ttname"><a href="classllvm_1_1MDString.html">llvm::MDString</a></div><div class="ttdoc">A single uniqued string.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00611">Metadata.h:611</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad295cb34421c21507bc9cdefe1ba3f16"><div class="ttname"><a href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">llvm::SplitBlock</a></div><div class="ttdeci">BasicBlock * SplitBlock(BasicBlock *Old, Instruction *SplitPt, DominatorTree *DT, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the specified block at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00935">BasicBlockUtils.cpp:935</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a122fb4045a202a92aa4aac18c7d8116d"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a122fb4045a202a92aa4aac18c7d8116d">DeduceICVValues</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DeduceICVValues(&quot;openmp-deduce-icv-values&quot;, cl::init(false), cl::Hidden)</div></div>
<div class="ttc" id="astructllvm_1_1AbstractAttribute_html_af34bd448298e7021ee074394446795f2"><div class="ttname"><a href="structllvm_1_1AbstractAttribute.html#af34bd448298e7021ee074394446795f2">llvm::AbstractAttribute::getIdAddr</a></div><div class="ttdeci">virtual const char * getIdAddr() const =0</div><div class="ttdoc">This function should return the address of the ID of the AbstractAttribute.</div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">llvm::OptimizationRemarkEmitterAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00164">OptimizationRemarkEmitter.h:164</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023af121d798d2c14b32e81d537a1f0cff8d"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023af121d798d2c14b32e81d537a1f0cff8d">llvm::MCID::Terminator</a></div><div class="ttdeci">@ Terminator</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00158">MCInstrDesc.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="astructllvm_1_1BooleanState_html"><div class="ttname"><a href="structllvm_1_1BooleanState.html">llvm::BooleanState</a></div><div class="ttdoc">Simple wrapper for a single bit (boolean) state.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l02709">Attributor.h:2709</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a231ea6a9a0009e38969a20d4293119c7adfd02d2fed222f2c28301f5ac837f2b2"><div class="ttname"><a href="namespacellvm_1_1omp.html#a231ea6a9a0009e38969a20d4293119c7adfd02d2fed222f2c28301f5ac837f2b2">llvm::omp::OMPScheduleType::UnorderedStaticChunked</a></div><div class="ttdeci">@ UnorderedStaticChunked</div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_a8328e3a26ee4f202629864b9e7bb8c78"><div class="ttname"><a href="OpenMPOpt_8cpp.html#a8328e3a26ee4f202629864b9e7bb8c78">AlwaysInlineDeviceFunctions</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; AlwaysInlineDeviceFunctions(&quot;openmp-opt-inline-device&quot;, cl::desc(&quot;Inline all applicible functions on the device.&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a7e4be8b16fbd68c9045a388904044e01"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03218">Instructions.h:3218</a></div></div>
<div class="ttc" id="aOpenMPOpt_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="OpenMPOpt_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="OpenMPOpt_8cpp_source.html#l00061">OpenMPOpt.cpp:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ac63dbb4994494c46f025715272cdb81e"><div class="ttname"><a href="classllvm_1_1CallBase.html#ac63dbb4994494c46f025715272cdb81e">llvm::CallBase::args</a></div><div class="ttdeci">iterator_range&lt; User::op_iterator &gt; args()</div><div class="ttdoc">Iteration adapter for range-for loops.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01342">InstrTypes.h:1342</a></div></div>
<div class="ttc" id="astructllvm_1_1IRPosition_html_a2422bd05c002b7bb1686feaa13f08acd"><div class="ttname"><a href="structllvm_1_1IRPosition.html#a2422bd05c002b7bb1686feaa13f08acd">llvm::IRPosition::returned</a></div><div class="ttdeci">static const IRPosition returned(const Function &amp;F, const CallBaseContext *CBContext=nullptr)</div><div class="ttdoc">Create a position describing the returned value of F.</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l00610">Attributor.h:610</a></div></div>
<div class="ttc" id="aSetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_a095f8f031d99ce3c0b25478713293dea"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#a095f8f031d99ce3c0b25478713293dea">llvm::GlobalVariable::setInitializer</a></div><div class="ttdeci">void setInitializer(Constant *InitVal)</div><div class="ttdoc">setInitializer - Sets the initializer for this global variable, removing any existing initializer if ...</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00472">Globals.cpp:472</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdoc">Unlink this instruction from its current basic block and insert it into the basic block that MovePos ...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00108">Instruction.cpp:108</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a0851b4de29686e9c3918449b054cfada"><div class="ttname"><a href="classllvm_1_1CallBase.html#a0851b4de29686e9c3918449b054cfada">llvm::CallBase::setCallingConv</a></div><div class="ttdeci">void setCallingConv(CallingConv::ID CC)</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01469">InstrTypes.h:1469</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html"><div class="ttname"><a href="classllvm_1_1FunctionType.html">llvm::FunctionType</a></div><div class="ttdoc">Class to represent function types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00103">DerivedTypes.h:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="astructllvm_1_1Attributor_html_af85fe4610a8ddd0d57149e73008f32fb"><div class="ttname"><a href="structllvm_1_1Attributor.html#af85fe4610a8ddd0d57149e73008f32fb">llvm::Attributor::internalizeFunctions</a></div><div class="ttdeci">static bool internalizeFunctions(SmallPtrSetImpl&lt; Function * &gt; &amp;FnSet, DenseMap&lt; Function *, Function * &gt; &amp;FnMap)</div><div class="ttdoc">Make copies of each function in the set FnSet such that the copied version has internal linkage after...</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8cpp_source.html#l02613">Attributor.cpp:2613</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a94d23373106467003722f7d6c17b1528"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a94d23373106467003722f7d6c17b1528">llvm::SmallVectorImpl::insert</a></div><div class="ttdeci">iterator insert(iterator I, T &amp;&amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00809">SmallVector.h:809</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMemoryLocation_html_abf48d6a7d79173d89799bc4361d26515a0e7b3ae5911d61bd79225d9bda18f625"><div class="ttname"><a href="structllvm_1_1AAMemoryLocation.html#abf48d6a7d79173d89799bc4361d26515a0e7b3ae5911d61bd79225d9bda18f625">llvm::AAMemoryLocation::ALL_LOCATIONS</a></div><div class="ttdeci">@ ALL_LOCATIONS</div><div class="ttdef"><b>Definition:</b> <a href="Attributor_8h_source.html#l04300">Attributor.h:4300</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:27:11 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
