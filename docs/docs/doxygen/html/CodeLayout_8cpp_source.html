<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Utils/CodeLayout.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_f75c00afeb315f44d76556a7c675e6e8.html">Utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CodeLayout.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CodeLayout_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- CodeLayout.cpp - Implementation of code layout algorithms ----------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// ExtTSP - layout of basic blocks with i-cache optimization.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The algorithm tries to find a layout of nodes (basic blocks) of a given CFG</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// optimizing jump locality and thus processor I-cache utilization. This is</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// achieved via increasing the number of fall-through jumps and co-locating</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// frequently executed nodes together. The name follows the underlying</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// optimization problem, Extended-TSP, which is a generalization of classical</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// (maximum) Traveling Salesmen Problem.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// The algorithm is a greedy heuristic that works with chains (ordered lists)</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// of basic blocks. Initially all chains are isolated basic blocks. On every</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// iteration, we pick a pair of chains whose merging yields the biggest increase</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// in the ExtTSP score, which models how i-cache &quot;friendly&quot; a specific chain is.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// A pair of chains giving the maximum gain is merged into a new chain. The</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// procedure stops when there is only one chain left, or when merging does not</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// increase ExtTSP. In the latter case, the remaining chains are sorted by</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// density in the decreasing order.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// An important aspect is the way two chains are merged. Unlike earlier</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// algorithms (e.g., based on the approach of Pettis-Hansen), two</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// chains, X and Y, are first split into three, X1, X2, and Y. Then we</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// consider all possible ways of gluing the three chains (e.g., X1YX2, X1X2Y,</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// X2X1Y, X2YX1, YX1X2, YX2X1) and choose the one producing the largest score.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// This improves the quality of the final result (the search space is larger)</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// while keeping the implementation sufficiently fast.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// Reference:</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//   * A. Newell and S. Pupyrev, Improved Basic Block Reordering,</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//     IEEE Transactions on Computers, 2020</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//     https://arxiv.org/abs/1809.04676</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeLayout_8h.html">llvm/Transforms/Utils/CodeLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="CodeLayout_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   48</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;code-layout&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="namespacellvm.html#ae4599fe5d1385154f1bfbc41a10495c5">EnableExtTspBlockPlacement</a>(</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="stringliteral">&quot;enable-ext-tsp-block-placement&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable machine block placement based on the ext-tsp model, &quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;             <span class="stringliteral">&quot;optimizing I-cache utilization.&quot;</span>));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="namespacellvm.html#a57336ac2ea37a70e1daeb0de8f401464">ApplyExtTspWithoutProfile</a>(</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="stringliteral">&quot;ext-tsp-apply-without-profile&quot;</span>,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Whether to apply ext-tsp placement for instances w/o profile&quot;</span>),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;} <span class="comment">// namespace llvm</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// Algorithm-specific params. The values are tuned for the best performance</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// of large-scale front-end bound binaries.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a9929edc0836ff87cb4ef1da1572257f6">ForwardWeightCond</a>(</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="stringliteral">&quot;ext-tsp-forward-weight-cond&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0.1),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The weight of conditional forward jumps for ExtTSP value&quot;</span>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a887ce3cb7bb095f6941da7c4d33438c7">ForwardWeightUncond</a>(</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="stringliteral">&quot;ext-tsp-forward-weight-uncond&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0.1),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The weight of unconditional forward jumps for ExtTSP value&quot;</span>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a5b1c646e5c6042dcbfcc7b9576f24f0a">BackwardWeightCond</a>(</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="stringliteral">&quot;ext-tsp-backward-weight-cond&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0.1),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The weight of conditonal backward jumps for ExtTSP value&quot;</span>));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="CodeLayout_8cpp.html#af7e2716df850fddba89c8346ff71d0d3">BackwardWeightUncond</a>(</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="stringliteral">&quot;ext-tsp-backward-weight-uncond&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0.1),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The weight of unconditonal backward jumps for ExtTSP value&quot;</span>));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="CodeLayout_8cpp.html#afeead781d03cc49b7c123ff7debacccf">FallthroughWeightCond</a>(</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="stringliteral">&quot;ext-tsp-fallthrough-weight-cond&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(1.0),</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The weight of conditional fallthrough jumps for ExtTSP value&quot;</span>));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a6c0062c50b45dce57654a7a2726de648">FallthroughWeightUncond</a>(</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="stringliteral">&quot;ext-tsp-fallthrough-weight-uncond&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(1.05),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The weight of unconditional fallthrough jumps for ExtTSP value&quot;</span>));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a3b159c2eb75048f9f2a2b8302b640418">ForwardDistance</a>(</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="stringliteral">&quot;ext-tsp-forward-distance&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(1024),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The maximum distance (in bytes) of a forward jump for ExtTSP&quot;</span>));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a9b1f915358684d3dddf2e0d9bcdd1856">BackwardDistance</a>(</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="stringliteral">&quot;ext-tsp-backward-distance&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(640),</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The maximum distance (in bytes) of a backward jump for ExtTSP&quot;</span>));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// The maximum size of a chain created by the algorithm. The size is bounded</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// so that the algorithm can efficiently process extremely large instance.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="CodeLayout_8cpp.html#a5528970393affdbbba2a8748878953da">MaxChainSize</a>(<span class="stringliteral">&quot;ext-tsp-max-chain-size&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(4096),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                 <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The maximum size of a chain to create.&quot;</span>));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// The maximum size of a chain for splitting. Larger values of the threshold</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// may yield better quality at the cost of worsen run-time.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="CodeLayout_8cpp.html#aa2b0ee00c73d7c2efb1ba261738573a9">ChainSplitThreshold</a>(</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="stringliteral">&quot;ext-tsp-chain-split-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(128),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The maximum size of a chain to apply splitting&quot;</span>));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// The option enables splitting (large) chains along in-coming and out-going</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">// jumps. This typically results in a better quality.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="CodeLayout_8cpp.html#a38101f24d850d53b478af4394ee40362">EnableChainSplitAlongJumps</a>(</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="stringliteral">&quot;ext-tsp-enable-chain-split-along-jumps&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The maximum size of a chain to apply splitting&quot;</span>));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">// Epsilon for comparison of doubles.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;constexpr <span class="keywordtype">double</span> EPS = 1<a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>-8;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">// Compute the Ext-TSP score for a given jump.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">double</span> jumpExtTSPScore(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> JumpDist, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> JumpMaxDist, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                       <span class="keywordtype">double</span> Weight) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (JumpDist &gt; JumpMaxDist)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">double</span> Prob = 1.0 - <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(JumpDist) / JumpMaxDist;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">return</span> Weight * Prob * Count;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">// Compute the Ext-TSP score for a jump between a given pair of blocks,</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">// using their sizes, (estimated) addresses and the jump execution count.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">double</span> extTSPScore(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcAddr, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcSize, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> DstAddr,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                   <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count, <span class="keywordtype">bool</span> IsConditional) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// Fallthrough</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (SrcAddr + SrcSize == DstAddr) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> jumpExtTSPScore(0, 1, Count,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                           IsConditional ? <a class="code" href="CodeLayout_8cpp.html#afeead781d03cc49b7c123ff7debacccf">FallthroughWeightCond</a></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                         : <a class="code" href="CodeLayout_8cpp.html#a6c0062c50b45dce57654a7a2726de648">FallthroughWeightUncond</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// Forward</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (SrcAddr + SrcSize &lt; DstAddr) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Dist = DstAddr - (SrcAddr + SrcSize);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> jumpExtTSPScore(Dist, <a class="code" href="CodeLayout_8cpp.html#a3b159c2eb75048f9f2a2b8302b640418">ForwardDistance</a>, Count,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                           IsConditional ? <a class="code" href="CodeLayout_8cpp.html#a9929edc0836ff87cb4ef1da1572257f6">ForwardWeightCond</a></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                         : <a class="code" href="CodeLayout_8cpp.html#a887ce3cb7bb095f6941da7c4d33438c7">ForwardWeightUncond</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// Backward</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Dist = SrcAddr + SrcSize - DstAddr;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> jumpExtTSPScore(Dist, <a class="code" href="CodeLayout_8cpp.html#a9b1f915358684d3dddf2e0d9bcdd1856">BackwardDistance</a>, Count,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                         IsConditional ? <a class="code" href="CodeLayout_8cpp.html#a5b1c646e5c6042dcbfcc7b9576f24f0a">BackwardWeightCond</a></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                       : <a class="code" href="CodeLayout_8cpp.html#af7e2716df850fddba89c8346ff71d0d3">BackwardWeightUncond</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/// A type of merging two chains, X and Y. The former chain is split into</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">/// X1 and X2 and then concatenated with Y in the order specified by the type.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span><span class="keyword">enum class</span> MergeTypeTy : <a class="code" href="lib_2Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a> { X_Y, X1_Y_X2, Y_X2_X1, X2_X1_Y };</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">/// The gain of merging two chains, that is, the Ext-TSP score of the merge</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/// together with the corresponfiding merge &#39;type&#39; and &#39;offset&#39;.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span><span class="keyword">class </span>MergeGainTy {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">explicit</span> MergeGainTy() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">explicit</span> MergeGainTy(<span class="keywordtype">double</span> Score, <span class="keywordtype">size_t</span> MergeOffset, MergeTypeTy MergeType)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      : Score(Score), MergeOffset(MergeOffset), MergeType(MergeType) {}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">double</span> score()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Score; }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">size_t</span> mergeOffset()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> MergeOffset; }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  MergeTypeTy mergeType()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> MergeType; }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// Returns &#39;true&#39; iff Other is preferred over this.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">operator&lt;</a>(<span class="keyword">const</span> MergeGainTy &amp;Other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Score &gt; EPS &amp;&amp; <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Score &gt; Score + EPS);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// Update the current gain if Other is preferred over this.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">void</span> updateIfLessThan(<span class="keyword">const</span> MergeGainTy &amp;Other) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (*<span class="keyword">this</span> &lt; Other)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      *<span class="keyword">this</span> = <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">double</span> Score{-1.0};</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">size_t</span> MergeOffset{0};</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  MergeTypeTy MergeType{MergeTypeTy::X_Y};</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;};</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keyword">class </span>Jump;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">class </span>Chain;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">class </span>ChainEdge;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/// A node in the graph, typically corresponding to a basic block in CFG.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>(<span class="keyword">const</span> Block &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>(Block &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> &amp;operator=(<span class="keyword">const</span> Block &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> &amp;operator=(Block &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// The original index of the block in CFG.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>{0};</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// The index of the block in the current chain.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">size_t</span> CurIndex{0};</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Size of the block in the binary.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>{0};</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Execution count of the block in the profile data.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ExecutionCount{0};</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// Current chain of the node.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  Chain *CurChain{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// An offset of the block in the current chain.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">mutable</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EstimatedAddr{0};</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// Forced successor of the block in CFG.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *ForcedSucc{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Forced predecessor of the block in CFG.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *ForcedPred{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// Outgoing jumps from the block.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  std::vector&lt;Jump *&gt; OutJumps;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// Incoming jumps to the block.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  std::vector&lt;Jump *&gt; InJumps;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>(<span class="keywordtype">size_t</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EC)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      : <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>), <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>), ExecutionCount(<a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>) {}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">bool</span> isEntry()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> == 0; }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;};</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">/// An arc in the graph, typically corresponding to a jump between two blocks.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span><span class="keyword">class </span>Jump {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  Jump(<span class="keyword">const</span> Jump &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  Jump(Jump &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  Jump &amp;operator=(<span class="keyword">const</span> Jump &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  Jump &amp;operator=(Jump &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// Source block of the jump.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Target block of the jump.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *<a class="code" href="classllvm_1_1Target.html">Target</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// Execution count of the arc in the profile data.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ExecutionCount{0};</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// Whether the jump corresponds to a conditional branch.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">bool</span> IsConditional{<span class="keyword">false</span>};</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">explicit</span> Jump(Block *<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>, Block *<a class="code" href="classllvm_1_1Target.html">Target</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ExecutionCount)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      : <a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>(<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>), <a class="code" href="classllvm_1_1Target.html">Target</a>(<a class="code" href="classllvm_1_1Target.html">Target</a>), ExecutionCount(ExecutionCount) {}</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;};</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">/// A chain (ordered sequence) of blocks.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span><span class="keyword">class </span>Chain {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  Chain(<span class="keyword">const</span> Chain &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  Chain(Chain &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  Chain &amp;operator=(<span class="keyword">const</span> Chain &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  Chain &amp;operator=(Chain &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keyword">explicit</span> Chain(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>, Block *Block)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      : <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>), Score(0), Blocks(1, <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>) {}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> id()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>; }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">bool</span> isEntry()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Blocks[0]-&gt;Index == 0; }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">bool</span> isCold()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Block : Blocks) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;ExecutionCount &gt; 0)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">double</span> score()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Score; }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">void</span> setScore(<span class="keywordtype">double</span> NewScore) { Score = NewScore; }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keyword">const</span> std::vector&lt;Block *&gt; &amp;blocks()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Blocks; }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">size_t</span> numBlocks()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Blocks.size(); }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">const</span> std::vector&lt;std::pair&lt;Chain *, ChainEdge *&gt;&gt; &amp;edges()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span> Edges;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  ChainEdge *getEdge(Chain *Other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> It : Edges) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">if</span> (It.first == Other)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">return</span> It.second;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">void</span> removeEdge(Chain *Other) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">auto</span> It = Edges.begin();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">while</span> (It != Edges.end()) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (It-&gt;first == Other) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        Edges.erase(It);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      It++;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="LazyCallGraph_8cpp.html#aec802e48dd5ef69029e285eddfc4158d">addEdge</a>(Chain *Other, ChainEdge *Edge) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    Edges.push_back(std::make_pair(Other, Edge));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="LoopDeletion_8cpp.html#a66a2592ace8a67bc796c72710d632bab">merge</a>(Chain *Other, <span class="keyword">const</span> std::vector&lt;Block *&gt; &amp;MergedBlocks) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    Blocks = MergedBlocks;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// Update the block&#39;s chains</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Idx = 0; Idx &lt; Blocks.size(); Idx++) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      Blocks[Idx]-&gt;CurChain = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      Blocks[Idx]-&gt;CurIndex = Idx;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">void</span> mergeEdges(Chain *Other);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="Coroutines_8cpp.html#ac781ce96aa25ba7f6fd38f72de665450">clear</a>() {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    Blocks.clear();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    Blocks.shrink_to_fit();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    Edges.clear();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    Edges.shrink_to_fit();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// Unique chain identifier.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// Cached ext-tsp score for the chain.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">double</span> Score;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// Blocks of the chain.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  std::vector&lt;Block *&gt; Blocks;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// Adjacent chains and corresponding edges (lists of jumps).</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  std::vector&lt;std::pair&lt;Chain *, ChainEdge *&gt;&gt; Edges;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;};</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/// An edge in CFG representing jumps between two chains.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/// When blocks are merged into chains, the edges are combined too so that</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// there is always at most one edge between a pair of chains</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span><span class="keyword">class </span>ChainEdge {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  ChainEdge(<span class="keyword">const</span> ChainEdge &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  ChainEdge(ChainEdge &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  ChainEdge &amp;operator=(<span class="keyword">const</span> ChainEdge &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  ChainEdge &amp;operator=(ChainEdge &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keyword">explicit</span> ChainEdge(Jump *Jump)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      : SrcChain(Jump-&gt;<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>-&gt;CurChain), DstChain(Jump-&gt;<a class="code" href="classllvm_1_1Target.html">Target</a>-&gt;CurChain),</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        Jumps(1, Jump) {}</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keyword">const</span> std::vector&lt;Jump *&gt; &amp;jumps()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Jumps; }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">void</span> changeEndpoint(Chain *<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>, Chain *To) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a> == SrcChain)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      SrcChain = To;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a> == DstChain)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      DstChain = To;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">void</span> appendJump(Jump *Jump) { Jumps.push_back(Jump); }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">void</span> moveJumps(ChainEdge *Other) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    Jumps.insert(Jumps.end(), <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>-&gt;Jumps.begin(), <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>-&gt;Jumps.end());</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>-&gt;Jumps.clear();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>-&gt;Jumps.shrink_to_fit();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">bool</span> hasCachedMergeGain(Chain *Src, Chain *Dst)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> Src == SrcChain ? CacheValidForward : CacheValidBackward;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  MergeGainTy getCachedMergeGain(Chain *Src, Chain *Dst)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> Src == SrcChain ? CachedGainForward : CachedGainBackward;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">void</span> setCachedMergeGain(Chain *Src, Chain *Dst, MergeGainTy MergeGain) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span> (Src == SrcChain) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      CachedGainForward = MergeGain;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      CacheValidForward = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      CachedGainBackward = MergeGain;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      CacheValidBackward = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">void</span> invalidateCache() {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    CacheValidForward = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    CacheValidBackward = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// Source chain.</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  Chain *SrcChain{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// Destination chain.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  Chain *DstChain{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// Original jumps in the binary with correspinding execution counts.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  std::vector&lt;Jump *&gt; Jumps;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// Cached ext-tsp value for merging the pair of chains.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// Since the gain of merging (Src, Dst) and (Dst, Src) might be different,</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// we store both values here.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  MergeGainTy CachedGainForward;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  MergeGainTy CachedGainBackward;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// Whether the cached value must be recomputed.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">bool</span> CacheValidForward{<span class="keyword">false</span>};</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">bool</span> CacheValidBackward{<span class="keyword">false</span>};</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;};</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordtype">void</span> Chain::mergeEdges(Chain *Other) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<span class="keyword">this</span> != Other &amp;&amp; <span class="stringliteral">&quot;cannot merge a chain with itself&quot;</span>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// Update edges adjacent to chain Other</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> EdgeIt : <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>-&gt;Edges) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    Chain *DstChain = EdgeIt.first;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    ChainEdge *DstEdge = EdgeIt.second;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    Chain *TargetChain = DstChain == <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a> ? <a class="code" href="lib_2Analysis_2README_8txt.html#ad5ccdce1179bbfb942a084b3005f360d">this</a> : DstChain;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    ChainEdge *CurEdge = getEdge(TargetChain);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span> (CurEdge == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      DstEdge-&gt;changeEndpoint(Other, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      this-&gt;<a class="code" href="LazyCallGraph_8cpp.html#aec802e48dd5ef69029e285eddfc4158d">addEdge</a>(TargetChain, DstEdge);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">if</span> (DstChain != <span class="keyword">this</span> &amp;&amp; DstChain != Other) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        DstChain-&gt;addEdge(<span class="keyword">this</span>, DstEdge);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      CurEdge-&gt;moveJumps(DstEdge);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// Cleanup leftover edge</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (DstChain != Other) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      DstChain-&gt;removeEdge(Other);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keyword">using</span> BlockIter = std::vector&lt;Block *&gt;::const_iterator;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">/// A wrapper around three chains of blocks; it is used to avoid extra</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">/// instantiation of the vectors.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span><span class="keyword">class </span>MergedChain {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  MergedChain(BlockIter Begin1, BlockIter End1, BlockIter Begin2 = BlockIter(),</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;              BlockIter End2 = BlockIter(), BlockIter Begin3 = BlockIter(),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              BlockIter End3 = BlockIter())</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      : Begin1(Begin1), End1(End1), Begin2(Begin2), End2(End2), Begin3(Begin3),</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        End3(End3) {}</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> F&gt; <span class="keywordtype">void</span> forEach(<span class="keyword">const</span> <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;Func)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> It = Begin1; It != End1; It++)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>(*It);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> It = Begin2; It != End2; It++)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>(*It);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> It = Begin3; It != End3; It++)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>(*It);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  std::vector&lt;Block *&gt; getBlocks()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    std::vector&lt;Block *&gt; <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.reserve(std::distance(Begin1, End1) + std::distance(Begin2, End2) +</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                   std::distance(Begin3, End3));</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.insert(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.end(), Begin1, End1);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.insert(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.end(), Begin2, End2);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.insert(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.end(), Begin3, End3);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *getFirstBlock()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *Begin1; }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  BlockIter Begin1;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  BlockIter End1;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  BlockIter Begin2;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  BlockIter End2;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  BlockIter Begin3;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  BlockIter End3;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;};</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">/// The implementation of the ExtTSP algorithm.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span><span class="keyword">class </span>ExtTSPImpl {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacellvm.html#a192943e2af09ba1010f9f1d14ecef24c">EdgeT</a> = std::pair&lt;uint64_t, uint64_t&gt;;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">using</span> EdgeCountMap = std::vector&lt;std::pair&lt;EdgeT, uint64_t&gt;&gt;;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  ExtTSPImpl(<span class="keywordtype">size_t</span> NumNodes, <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeSizes,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;             <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeCounts,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;             <span class="keyword">const</span> EdgeCountMap &amp;EdgeCounts)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      : NumNodes(NumNodes) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(NodeSizes, NodeCounts, EdgeCounts);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">  /// Run the algorithm and return an optimized ordering of blocks.</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">run</a>(std::vector&lt;uint64_t&gt; &amp;Result) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Pass 1: Merge blocks with their mutually forced successors</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    mergeForcedPairs();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// Pass 2: Merge pairs of chains while improving the ExtTSP objective</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    mergeChainPairs();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Pass 3: Merge cold blocks to reduce code size</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    mergeColdChains();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Collect blocks from all chains</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    concatChains(Result);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">  /// Initialize the algorithm&#39;s data structures.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a>(<span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeSizes,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                  <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeCounts,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                  <span class="keyword">const</span> EdgeCountMap &amp;EdgeCounts) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// Initialize blocks</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    AllBlocks.reserve(NumNodes);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Node = 0; Node &lt; NumNodes; Node++) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = std::max&lt;uint64_t&gt;(NodeSizes[Node], 1ULL);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ExecutionCount = NodeCounts[Node];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">// The execution count of the entry block is set to at least 1</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">if</span> (Node == 0 &amp;&amp; ExecutionCount == 0)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        ExecutionCount = 1;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      AllBlocks.emplace_back(Node, Size, ExecutionCount);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// Initialize jumps between blocks</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    SuccNodes.resize(NumNodes);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    PredNodes.resize(NumNodes);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    std::vector&lt;uint64_t&gt; OutDegree(NumNodes, 0);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    AllJumps.reserve(EdgeCounts.size());</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> It : EdgeCounts) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keyword">auto</span> Pred = It.first.first;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keyword">auto</span> Succ = It.first.second;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      OutDegree[Pred]++;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="comment">// Ignore self-edges</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordflow">if</span> (Pred == Succ)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      SuccNodes[Pred].push_back(Succ);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      PredNodes[Succ].push_back(Pred);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keyword">auto</span> ExecutionCount = It.second;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span> (ExecutionCount &gt; 0) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = AllBlocks[Pred];</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keyword">auto</span> &amp;SuccBlock = AllBlocks[Succ];</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        AllJumps.emplace_back(&amp;Block, &amp;SuccBlock, ExecutionCount);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        SuccBlock.InJumps.push_back(&amp;AllJumps.back());</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.OutJumps.push_back(&amp;AllJumps.back());</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Jump : AllJumps) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutDegree[Jump.Source-&gt;Index] &gt; 0);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      Jump.IsConditional = OutDegree[Jump.Source-&gt;Index] &gt; 1;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// Initialize chains</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    AllChains.reserve(NumNodes);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    HotChains.reserve(NumNodes);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">for</span> (Block &amp;Block : AllBlocks) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      AllChains.emplace_back(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.Index, &amp;Block);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.CurChain = &amp;AllChains.back();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ExecutionCount &gt; 0) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        HotChains.push_back(&amp;AllChains.back());</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Initialize chain edges</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    AllEdges.reserve(AllJumps.size());</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">for</span> (Block &amp;Block : AllBlocks) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Jump : <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.OutJumps) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keyword">auto</span> SuccBlock = Jump-&gt;Target;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        ChainEdge *CurEdge = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.CurChain-&gt;getEdge(SuccBlock-&gt;CurChain);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// this edge is already present in the graph</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (CurEdge != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuccBlock-&gt;CurChain-&gt;getEdge(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.CurChain) != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          CurEdge-&gt;appendJump(Jump);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">// this is a new edge</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        AllEdges.emplace_back(Jump);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.CurChain-&gt;addEdge(SuccBlock-&gt;CurChain, &amp;AllEdges.back());</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        SuccBlock-&gt;CurChain-&gt;addEdge(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.CurChain, &amp;AllEdges.back());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">  /// For a pair of blocks, A and B, block B is the forced successor of A,</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">  /// if (i) all jumps (based on profile) from A goes to B and (ii) all jumps</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">  /// to B are from A. Such blocks should be adjacent in the optimal ordering;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">  /// the method finds and merges such pairs of blocks.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> mergeForcedPairs() {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// Find fallthroughs based on edge weights</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Block : AllBlocks) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">if</span> (SuccNodes[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.Index].size() == 1 &amp;&amp;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          PredNodes[SuccNodes[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.Index][0]].size() == 1 &amp;&amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          SuccNodes[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.Index][0] != 0) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordtype">size_t</span> SuccIndex = SuccNodes[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.Index][0];</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedSucc = &amp;AllBlocks[SuccIndex];</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        AllBlocks[SuccIndex].ForcedPred = &amp;<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">// There might be &#39;cycles&#39; in the forced dependencies, since profile</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// data isn&#39;t 100% accurate. Typically this is observed in loops, when the</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">// loop edges are the hottest successors for the basic blocks of the loop.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Break the cycles by choosing the block with the smallest index as the</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// head. This helps to keep the original order of the loops, which likely</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">// have already been rotated in the optimized manner.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Block : AllBlocks) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedSucc == <span class="keyword">nullptr</span> || <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedPred == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keyword">auto</span> SuccBlock = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedSucc;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">while</span> (SuccBlock != <span class="keyword">nullptr</span> &amp;&amp; SuccBlock != &amp;Block) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        SuccBlock = SuccBlock-&gt;ForcedSucc;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">if</span> (SuccBlock == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="comment">// Break the cycle</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      AllBlocks[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedPred-&gt;Index].ForcedSucc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedPred = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// Merge blocks with their fallthrough successors</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Block : AllBlocks) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedPred == <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.ForcedSucc != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keyword">auto</span> CurBlock = &amp;<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">while</span> (CurBlock-&gt;ForcedSucc != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> NextBlock = CurBlock-&gt;ForcedSucc;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          mergeChains(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.CurChain, NextBlock-&gt;CurChain, 0, MergeTypeTy::X_Y);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          CurBlock = NextBlock;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">  /// Merge pairs of chains while improving the ExtTSP objective.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> mergeChainPairs() {<span class="comment"></span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">    /// Deterministically compare pairs of chains</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span>    <span class="keyword">auto</span> compareChainPairs = [](<span class="keyword">const</span> Chain *A1, <span class="keyword">const</span> Chain *B1,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                <span class="keyword">const</span> Chain *A2, <span class="keyword">const</span> Chain *B2) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">if</span> (A1 != A2)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">return</span> A1-&gt;id() &lt; A2-&gt;id();</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">return</span> B1-&gt;id() &lt; B2-&gt;id();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    };</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">while</span> (HotChains.size() &gt; 1) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      Chain *BestChainPred = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      Chain *BestChainSucc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keyword">auto</span> BestGain = MergeGainTy();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">// Iterate over all pairs of chains</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordflow">for</span> (Chain *ChainPred : HotChains) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="comment">// Get candidates for merging with the current chain</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> EdgeIter : ChainPred-&gt;edges()) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          Chain *ChainSucc = EdgeIter.first;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          <span class="keyword">class </span>ChainEdge *ChainEdge = EdgeIter.second;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          <span class="comment">// Ignore loop edges</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <span class="keywordflow">if</span> (ChainPred == ChainSucc)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          <span class="comment">// Stop early if the combined chain violates the maximum allowed size</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          <span class="keywordflow">if</span> (ChainPred-&gt;numBlocks() + ChainSucc-&gt;numBlocks() &gt;= <a class="code" href="CodeLayout_8cpp.html#a5528970393affdbbba2a8748878953da">MaxChainSize</a>)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="comment">// Compute the gain of merging the two chains</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          MergeGainTy CurGain =</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;              getBestMergeGain(ChainPred, ChainSucc, ChainEdge);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          <span class="keywordflow">if</span> (CurGain.score() &lt;= EPS)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          <span class="keywordflow">if</span> (BestGain &lt; CurGain ||</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;              (<a class="code" href="namespacellvm.html#a2816e84a08c108d18bc4665bc1817e01">std::abs</a>(CurGain.score() - BestGain.score()) &lt; EPS &amp;&amp;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;               compareChainPairs(ChainPred, ChainSucc, BestChainPred,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                 BestChainSucc))) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            BestGain = CurGain;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            BestChainPred = ChainPred;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            BestChainSucc = ChainSucc;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="comment">// Stop merging when there is no improvement</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span> (BestGain.score() &lt;= EPS)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="comment">// Merge the best pair of chains</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      mergeChains(BestChainPred, BestChainSucc, BestGain.mergeOffset(),</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                  BestGain.mergeType());</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">  /// Merge remaining blocks into chains w/o taking jump counts into</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">  /// consideration. This allows to maintain the original block order in the</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">  /// absense of profile data</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> mergeColdChains() {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> SrcBB = 0; SrcBB &lt; NumNodes; SrcBB++) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="comment">// Iterating in reverse order to make sure original fallthrough jumps are</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="comment">// merged first; this might be beneficial for code size.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordtype">size_t</span> NumSuccs = SuccNodes[SrcBB].size();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Idx = 0; Idx &lt; NumSuccs; Idx++) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keyword">auto</span> DstBB = SuccNodes[SrcBB][NumSuccs - Idx - 1];</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keyword">auto</span> SrcChain = AllBlocks[SrcBB].CurChain;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keyword">auto</span> DstChain = AllBlocks[DstBB].CurChain;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">if</span> (SrcChain != DstChain &amp;&amp; !DstChain-&gt;isEntry() &amp;&amp;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            SrcChain-&gt;blocks().back()-&gt;Index == SrcBB &amp;&amp;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            DstChain-&gt;blocks().front()-&gt;Index == DstBB &amp;&amp;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            SrcChain-&gt;isCold() == DstChain-&gt;isCold()) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          mergeChains(SrcChain, DstChain, 0, MergeTypeTy::X_Y);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">  /// Compute the Ext-TSP score for a given block order and a list of jumps.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> extTSPScore(<span class="keyword">const</span> MergedChain &amp;MergedBlocks,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                     <span class="keyword">const</span> std::vector&lt;Jump *&gt; &amp;Jumps)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (Jumps.empty())</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> CurAddr = 0;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    MergedBlocks.forEach([&amp;](<span class="keyword">const</span> Block *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;EstimatedAddr = CurAddr;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      CurAddr += <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;Size;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    });</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">double</span> Score = 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Jump : Jumps) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *SrcBlock = Jump-&gt;Source;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> *DstBlock = Jump-&gt;Target;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      Score += ::extTSPScore(SrcBlock-&gt;EstimatedAddr, SrcBlock-&gt;Size,</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                             DstBlock-&gt;EstimatedAddr, Jump-&gt;ExecutionCount,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                             Jump-&gt;IsConditional);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">return</span> Score;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">  /// Compute the gain of merging two chains.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">  /// The function considers all possible ways of merging two chains and</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">  /// computes the one having the largest increase in ExtTSP objective. The</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">  /// result is a pair with the first element being the gain and the second</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">  /// element being the corresponding merging type.</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"></span>  MergeGainTy getBestMergeGain(Chain *ChainPred, Chain *ChainSucc,</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                               ChainEdge *Edge)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (Edge-&gt;hasCachedMergeGain(ChainPred, ChainSucc)) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">return</span> Edge-&gt;getCachedMergeGain(ChainPred, ChainSucc);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// Precompute jumps between ChainPred and ChainSucc</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keyword">auto</span> Jumps = Edge-&gt;jumps();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    ChainEdge *EdgePP = ChainPred-&gt;getEdge(ChainPred);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (EdgePP != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      Jumps.insert(Jumps.end(), EdgePP-&gt;jumps().begin(), EdgePP-&gt;jumps().end());</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Jumps.empty() &amp;&amp; <span class="stringliteral">&quot;trying to merge chains w/o jumps&quot;</span>);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// The object holds the best currently chosen gain of merging the two chains</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    MergeGainTy Gain = MergeGainTy();</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">    /// Given a merge offset and a list of merge types, try to merge two chains</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">    /// and update Gain with a better alternative</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"></span>    <span class="keyword">auto</span> tryChainMerging = [&amp;](<span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                               <span class="keyword">const</span> std::vector&lt;MergeTypeTy&gt; &amp;MergeTypes) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// Skip merging corresponding to concatenation w/o splitting</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> == 0 || <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> == ChainPred-&gt;blocks().size())</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="comment">// Skip merging if it breaks Forced successors</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keyword">auto</span> <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = ChainPred-&gt;blocks()[<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> - 1];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;ForcedSucc != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="comment">// Apply the merge, compute the corresponding gain, and update the best</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="comment">// value, if the merge is beneficial</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;MergeType : MergeTypes) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        Gain.updateIfLessThan(</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            computeMergeGain(ChainPred, ChainSucc, Jumps, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, MergeType));</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    };</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// Try to concatenate two chains w/o splitting</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    Gain.updateIfLessThan(</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        computeMergeGain(ChainPred, ChainSucc, Jumps, 0, MergeTypeTy::X_Y));</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="CodeLayout_8cpp.html#a38101f24d850d53b478af4394ee40362">EnableChainSplitAlongJumps</a>) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="comment">// Attach (a part of) ChainPred before the first block of ChainSucc</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Jump : ChainSucc-&gt;blocks().front()-&gt;InJumps) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> SrcBlock = Jump-&gt;Source;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">if</span> (SrcBlock-&gt;CurChain != ChainPred)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = SrcBlock-&gt;CurIndex + 1;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        tryChainMerging(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, {MergeTypeTy::X1_Y_X2, MergeTypeTy::X2_X1_Y});</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="comment">// Attach (a part of) ChainPred after the last block of ChainSucc</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Jump : ChainSucc-&gt;blocks().back()-&gt;OutJumps) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> DstBlock = Jump-&gt;Source;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">if</span> (DstBlock-&gt;CurChain != ChainPred)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = DstBlock-&gt;CurIndex;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        tryChainMerging(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, {MergeTypeTy::X1_Y_X2, MergeTypeTy::Y_X2_X1});</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// Try to break ChainPred in various ways and concatenate with ChainSucc</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (ChainPred-&gt;blocks().size() &lt;= <a class="code" href="CodeLayout_8cpp.html#aa2b0ee00c73d7c2efb1ba261738573a9">ChainSplitThreshold</a>) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = 1; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> &lt; ChainPred-&gt;blocks().<a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>(); <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>++) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// Try to split the chain in different ways. In practice, applying</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">// X2_Y_X1 merging is almost never provides benefits; thus, we exclude</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">// it from consideration to reduce the search space</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        tryChainMerging(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, {MergeTypeTy::X1_Y_X2, MergeTypeTy::Y_X2_X1,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                 MergeTypeTy::X2_X1_Y});</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    Edge-&gt;setCachedMergeGain(ChainPred, ChainSucc, Gain);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">return</span> Gain;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">  /// Compute the score gain of merging two chains, respecting a given</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">  /// merge &#39;type&#39; and &#39;offset&#39;.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">  /// The two chains are not modified in the method.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"></span>  MergeGainTy computeMergeGain(<span class="keyword">const</span> Chain *ChainPred, <span class="keyword">const</span> Chain *ChainSucc,</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                               <span class="keyword">const</span> std::vector&lt;Jump *&gt; &amp;Jumps,</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                               <span class="keywordtype">size_t</span> MergeOffset,</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                               MergeTypeTy MergeType)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keyword">auto</span> MergedBlocks = mergeBlocks(ChainPred-&gt;blocks(), ChainSucc-&gt;blocks(),</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                    MergeOffset, MergeType);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// Do not allow a merge that does not preserve the original entry block</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">if</span> ((ChainPred-&gt;isEntry() || ChainSucc-&gt;isEntry()) &amp;&amp;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        !MergedBlocks.getFirstBlock()-&gt;isEntry())</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="keywordflow">return</span> MergeGainTy();</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// The gain for the new chain</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keyword">auto</span> NewGainScore = extTSPScore(MergedBlocks, Jumps) - ChainPred-&gt;score();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">return</span> MergeGainTy(NewGainScore, MergeOffset, MergeType);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">  /// Merge two chains of blocks respecting a given merge &#39;type&#39; and &#39;offset&#39;.</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">  /// If MergeType == 0, then the result is a concatenation of two chains.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">  /// Otherwise, the first chain is cut into two sub-chains at the offset,</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">  /// and merged using all possible ways of concatenating three chains.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"></span>  MergedChain mergeBlocks(<span class="keyword">const</span> std::vector&lt;Block *&gt; &amp;<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                          <span class="keyword">const</span> std::vector&lt;Block *&gt; &amp;<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>, <span class="keywordtype">size_t</span> MergeOffset,</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                          MergeTypeTy MergeType)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// Split the first chain, X, into X1 and X2</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    BlockIter BeginX1 = <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>.begin();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    BlockIter EndX1 = <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>.begin() + MergeOffset;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    BlockIter BeginX2 = <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>.begin() + MergeOffset;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    BlockIter EndX2 = <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>.end();</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    BlockIter BeginY = <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>.begin();</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    BlockIter EndY = <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>.end();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// Construct a new chain from the three existing ones</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">switch</span> (MergeType) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">case</span> MergeTypeTy::X_Y:</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">return</span> MergedChain(BeginX1, EndX2, BeginY, EndY);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">case</span> MergeTypeTy::X1_Y_X2:</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">return</span> MergedChain(BeginX1, EndX1, BeginY, EndY, BeginX2, EndX2);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">case</span> MergeTypeTy::Y_X2_X1:</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">return</span> MergedChain(BeginY, EndY, BeginX2, EndX2, BeginX1, EndX1);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">case</span> MergeTypeTy::X2_X1_Y:</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">return</span> MergedChain(BeginX2, EndX2, BeginX1, EndX1, BeginY, EndY);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;unexpected chain merge type&quot;</span>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">  /// Merge chain From into chain Into, update the list of active chains,</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">  /// adjacency information, and the corresponding cached values.</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> mergeChains(Chain *Into, Chain *<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>, <span class="keywordtype">size_t</span> MergeOffset,</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                   MergeTypeTy MergeType) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Into != <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a> &amp;&amp; <span class="stringliteral">&quot;a chain cannot be merged with itself&quot;</span>);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// Merge the blocks</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    MergedChain MergedBlocks =</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        mergeBlocks(Into-&gt;blocks(), <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>-&gt;blocks(), MergeOffset, MergeType);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    Into-&gt;merge(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>, MergedBlocks.getBlocks());</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    Into-&gt;mergeEdges(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>-&gt;clear();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Update cached ext-tsp score for the new chain</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    ChainEdge *SelfEdge = Into-&gt;getEdge(Into);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (SelfEdge != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      MergedBlocks = MergedChain(Into-&gt;blocks().begin(), Into-&gt;blocks().end());</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      Into-&gt;setScore(extTSPScore(MergedBlocks, SelfEdge-&gt;jumps()));</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// Remove chain From from the list of active chains</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="namespacellvm.html#aa82bb12b2879425012b3742487e10964">llvm::erase_value</a>(HotChains, <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">// Invalidate caches</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> EdgeIter : Into-&gt;edges()) {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      EdgeIter.second-&gt;invalidateCache();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">  /// Concatenate all chains into a final order of blocks.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> concatChains(std::vector&lt;uint64_t&gt; &amp;Order) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">// Collect chains and calculate some stats for their sorting</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    std::vector&lt;Chain *&gt; SortedChains;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Chain *, double&gt;</a> ChainDensity;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Chain : AllChains) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">if</span> (!Chain.blocks().empty()) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        SortedChains.push_back(&amp;Chain);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="comment">// Using doubles to avoid overflow of ExecutionCount</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = 0;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordtype">double</span> ExecutionCount = 0;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Block : Chain.blocks()) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> += <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;Size);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          ExecutionCount += <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;ExecutionCount);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; 0 &amp;&amp; <span class="stringliteral">&quot;a chain of zero size&quot;</span>);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        ChainDensity[&amp;Chain] = ExecutionCount / <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">// Sorting chains by density in the decreasing order</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">std::stable_sort</a>(SortedChains.begin(), SortedChains.end(),</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                     [&amp;](<span class="keyword">const</span> Chain *<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>, <span class="keyword">const</span> Chain *C2) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                       <span class="comment">// Make sure the original entry block is at the</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                       <span class="comment">// beginning of the order</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                       if (C1-&gt;isEntry() != C2-&gt;isEntry()) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                         return C1-&gt;isEntry();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                       }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> D1 = ChainDensity[<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>];</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> D2 = ChainDensity[C2];</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                       <span class="comment">// Compare by density and break ties by chain identifiers</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                       <a class="code" href="lib_2Target_2README_8txt.html#a1c73f662a0ce6b37b8203009d82287b1">return</a> (D1 != D2) ? (D1 &gt; D2) : (<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;id() &lt; C2-&gt;id());</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                     });</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// Collect the blocks in the order specified by their chains</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    Order.reserve(NumNodes);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">for</span> (Chain *Chain : SortedChains) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">for</span> (Block *Block : Chain-&gt;blocks()) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        Order.push_back(<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;Index);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">  /// The number of nodes in the graph.</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> NumNodes;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">  /// Successors of each node.</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"></span>  std::vector&lt;std::vector&lt;uint64_t&gt;&gt; SuccNodes;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">  /// Predecessors of each node.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"></span>  std::vector&lt;std::vector&lt;uint64_t&gt;&gt; PredNodes;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">  /// All basic blocks.</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment"></span>  std::vector&lt;Block&gt; AllBlocks;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">  /// All jumps between blocks.</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span>  std::vector&lt;Jump&gt; AllJumps;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">  /// All chains of basic blocks.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment"></span>  std::vector&lt;Chain&gt; AllChains;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">  /// All edges between chains.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment"></span>  std::vector&lt;ChainEdge&gt; AllEdges;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">  /// Active chains. The vector gets updated at runtime when chains are merged.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment"></span>  std::vector&lt;Chain *&gt; HotChains;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;};</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;} <span class="comment">// end of anonymous namespace</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;std::vector&lt;uint64_t&gt; <a class="code" href="namespacellvm.html#aaaebb4f1a443276ae5c99e021c05cb19">llvm::applyExtTspLayout</a>(</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeSizes,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeCounts,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::pair&lt;EdgeT, uint64_t&gt;&gt; &amp;EdgeCounts) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keywordtype">size_t</span> NumNodes = NodeSizes.size();</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// Verify correctness of the input data.</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NodeCounts.size() == NodeSizes.size() &amp;&amp; <span class="stringliteral">&quot;Incorrect input&quot;</span>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumNodes &gt; 2 &amp;&amp; <span class="stringliteral">&quot;Incorrect input&quot;</span>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">// Apply the reordering algorithm.</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keyword">auto</span> Alg = ExtTSPImpl(NumNodes, NodeSizes, NodeCounts, EdgeCounts);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  std::vector&lt;uint64_t&gt; <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  Alg.run(Result);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// Verify correctness of the output.</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.front() == 0 &amp;&amp; <span class="stringliteral">&quot;Original entry point is not preserved&quot;</span>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.size() == NumNodes &amp;&amp; <span class="stringliteral">&quot;Incorrect size of reordered layout&quot;</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;}</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespacellvm.html#a75b5127030db5fe3a72b0086fda24332">llvm::calcExtTspScore</a>(</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;Order, <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeSizes,</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeCounts,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::pair&lt;EdgeT, uint64_t&gt;&gt; &amp;EdgeCounts) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// Estimate addresses of the blocks in memory</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  std::vector&lt;uint64_t&gt; <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>(NodeSizes.size(), 0);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Idx = 1; Idx &lt; Order.size(); Idx++) {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>[Order[Idx]] = <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>[Order[Idx - 1]] + NodeSizes[Order[Idx - 1]];</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  std::vector&lt;uint64_t&gt; OutDegree(NodeSizes.size(), 0);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> It : EdgeCounts) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keyword">auto</span> Pred = It.first.first;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    OutDegree[Pred]++;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="comment">// Increase the score for each jump</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordtype">double</span> Score = 0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> It : EdgeCounts) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keyword">auto</span> Pred = It.first.first;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keyword">auto</span> Succ = It.first.second;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count = It.second;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordtype">bool</span> IsConditional = OutDegree[Pred] &gt; 1;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    Score += ::extTSPScore(<a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>[Pred], NodeSizes[Pred], <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>[Succ], Count,</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                           IsConditional);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordflow">return</span> Score;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;}</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespacellvm.html#a75b5127030db5fe3a72b0086fda24332">llvm::calcExtTspScore</a>(</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeSizes,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint64_t&gt; &amp;NodeCounts,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::pair&lt;EdgeT, uint64_t&gt;&gt; &amp;EdgeCounts) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  std::vector&lt;uint64_t&gt; Order(NodeSizes.size());</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Idx = 0; Idx &lt; NodeSizes.size(); Idx++) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    Order[Idx] = Idx;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a75b5127030db5fe3a72b0086fda24332">calcExtTspScore</a>(Order, NodeSizes, NodeCounts, EdgeCounts);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a1c73f662a0ce6b37b8203009d82287b1"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a1c73f662a0ce6b37b8203009d82287b1">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00242">README.txt:242</a></div></div>
<div class="ttc" id="aLazyCallGraph_8cpp_html_aec802e48dd5ef69029e285eddfc4158d"><div class="ttname"><a href="LazyCallGraph_8cpp.html#aec802e48dd5ef69029e285eddfc4158d">addEdge</a></div><div class="ttdeci">static void addEdge(SmallVectorImpl&lt; LazyCallGraph::Edge &gt; &amp;Edges, DenseMap&lt; LazyCallGraph::Node *, int &gt; &amp;EdgeIndexMap, LazyCallGraph::Node &amp;N, LazyCallGraph::Edge::Kind EK)</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8cpp_source.html#l00060">LazyCallGraph.cpp:60</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00263">README.txt:263</a></div></div>
<div class="ttc" id="aclassllvm_1_1Target_html"><div class="ttname"><a href="classllvm_1_1Target.html">llvm::Target</a></div><div class="ttdoc">Target - Wrapper for Target specific information.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegistry_8h_source.html#l00149">TargetRegistry.h:149</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_a19d27915595e7f0a0ef271448bcdac6f"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#a19d27915595e7f0a0ef271448bcdac6f">initialize</a></div><div class="ttdeci">static void initialize(TargetLibraryInfoImpl &amp;TLI, const Triple &amp;T, ArrayRef&lt; StringLiteral &gt; StandardNames)</div><div class="ttdoc">Initialize the set of available library functions based on the specified target triple.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00152">TargetLibraryInfo.cpp:152</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a887ce3cb7bb095f6941da7c4d33438c7"><div class="ttname"><a href="CodeLayout_8cpp.html#a887ce3cb7bb095f6941da7c4d33438c7">ForwardWeightUncond</a></div><div class="ttdeci">static cl::opt&lt; double &gt; ForwardWeightUncond(&quot;ext-tsp-forward-weight-uncond&quot;, cl::ReallyHidden, cl::init(0.1), cl::desc(&quot;The weight of unconditional forward jumps for ExtTSP value&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_aaaebb4f1a443276ae5c99e021c05cb19"><div class="ttname"><a href="namespacellvm.html#aaaebb4f1a443276ae5c99e021c05cb19">llvm::applyExtTspLayout</a></div><div class="ttdeci">std::vector&lt; uint64_t &gt; applyExtTspLayout(const std::vector&lt; uint64_t &gt; &amp;NodeSizes, const std::vector&lt; uint64_t &gt; &amp;NodeCounts, const std::vector&lt; EdgeCountT &gt; &amp;EdgeCounts)</div><div class="ttdoc">Find a layout of nodes (basic blocks) of a given CFG optimizing jump locality and thus processor I-ca...</div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">llvm::cl::ReallyHidden</a></div><div class="ttdeci">@ ReallyHidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00139">CommandLine.h:139</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aCoroutines_8cpp_html_ac781ce96aa25ba7f6fd38f72de665450"><div class="ttname"><a href="Coroutines_8cpp.html#ac781ce96aa25ba7f6fd38f72de665450">clear</a></div><div class="ttdeci">static void clear(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="Coroutines_8cpp_source.html#l00149">Coroutines.cpp:149</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a5528970393affdbbba2a8748878953da"><div class="ttname"><a href="CodeLayout_8cpp.html#a5528970393affdbbba2a8748878953da">MaxChainSize</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxChainSize(&quot;ext-tsp-max-chain-size&quot;, cl::ReallyHidden, cl::init(4096), cl::desc(&quot;The maximum size of a chain to create.&quot;))</div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_af7e2716df850fddba89c8346ff71d0d3"><div class="ttname"><a href="CodeLayout_8cpp.html#af7e2716df850fddba89c8346ff71d0d3">BackwardWeightUncond</a></div><div class="ttdeci">static cl::opt&lt; double &gt; BackwardWeightUncond(&quot;ext-tsp-backward-weight-uncond&quot;, cl::ReallyHidden, cl::init(0.1), cl::desc(&quot;The weight of unconditonal backward jumps for ExtTSP value&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_a57336ac2ea37a70e1daeb0de8f401464"><div class="ttname"><a href="namespacellvm.html#a57336ac2ea37a70e1daeb0de8f401464">llvm::ApplyExtTspWithoutProfile</a></div><div class="ttdeci">cl::opt&lt; bool &gt; ApplyExtTspWithoutProfile</div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a3217063f680fa8e35dea3c59b6e52b18"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a></div><div class="ttdeci">Clang compiles this i1 i64 store i64 i64 store i64 i64 store i64 i64 store i64 align Which gets codegen d xmm0 movaps rbp movaps rbp movaps rbp movaps rbp rbp rbp rbp rbp It would be better to have movq s of instead of the movaps s LLVM produces ret int</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00536">README.txt:536</a></div></div>
<div class="ttc" id="aOcamlGCPrinter_8cpp_html_afcf2f797ed287a723263583c9b1c1bce"><div class="ttname"><a href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; OcamlGCMetadataPrinter &gt; Y(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible collector&quot;)</div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">llvm::ms_demangle::QualifierMangleMode::Result</a></div><div class="ttdeci">@ Result</div></div>
<div class="ttc" id="aLoopDeletion_8cpp_html_a66a2592ace8a67bc796c72710d632bab"><div class="ttname"><a href="LoopDeletion_8cpp.html#a66a2592ace8a67bc796c72710d632bab">merge</a></div><div class="ttdeci">static LoopDeletionResult merge(LoopDeletionResult A, LoopDeletionResult B)</div><div class="ttdef"><b>Definition:</b> <a href="LoopDeletion_8cpp_source.html#l00053">LoopDeletion.cpp:53</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae4599fe5d1385154f1bfbc41a10495c5"><div class="ttname"><a href="namespacellvm.html#ae4599fe5d1385154f1bfbc41a10495c5">llvm::EnableExtTspBlockPlacement</a></div><div class="ttdeci">cl::opt&lt; bool &gt; EnableExtTspBlockPlacement</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfile_8cpp_source.html#l00315">SampleProfile.cpp:315</a></div></div>
<div class="ttc" id="anamespacellvm_html_a192943e2af09ba1010f9f1d14ecef24c"><div class="ttname"><a href="namespacellvm.html#a192943e2af09ba1010f9f1d14ecef24c">llvm::EdgeT</a></div><div class="ttdeci">std::pair&lt; uint64_t, uint64_t &gt; EdgeT</div><div class="ttdef"><b>Definition:</b> <a href="CodeLayout_8h_source.html#l00023">CodeLayout.h:23</a></div></div>
<div class="ttc" id="aCodeLayout_8h_html"><div class="ttname"><a href="CodeLayout_8h.html">CodeLayout.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a75b5127030db5fe3a72b0086fda24332"><div class="ttname"><a href="namespacellvm.html#a75b5127030db5fe3a72b0086fda24332">llvm::calcExtTspScore</a></div><div class="ttdeci">double calcExtTspScore(const std::vector&lt; uint64_t &gt; &amp;Order, const std::vector&lt; uint64_t &gt; &amp;NodeSizes, const std::vector&lt; uint64_t &gt; &amp;NodeCounts, const std::vector&lt; EdgeCountT &gt; &amp;EdgeCounts)</div><div class="ttdoc">Estimate the &quot;quality&quot; of a given node order in CFG.</div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a9929edc0836ff87cb4ef1da1572257f6"><div class="ttname"><a href="CodeLayout_8cpp.html#a9929edc0836ff87cb4ef1da1572257f6">ForwardWeightCond</a></div><div class="ttdeci">static cl::opt&lt; double &gt; ForwardWeightCond(&quot;ext-tsp-forward-weight-cond&quot;, cl::ReallyHidden, cl::init(0.1), cl::desc(&quot;The weight of conditional forward jumps for ExtTSP value&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_aa82bb12b2879425012b3742487e10964"><div class="ttname"><a href="namespacellvm.html#aa82bb12b2879425012b3742487e10964">llvm::erase_value</a></div><div class="ttdeci">void erase_value(Container &amp;C, ValueType V)</div><div class="ttdoc">Wrapper function to remove a value from a container:</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02006">STLExtras.h:2006</a></div></div>
<div class="ttc" id="aErlangGCPrinter_8cpp_html_a74b474c0616ab55c1d9487f11fd31d26"><div class="ttname"><a href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; ErlangGCPrinter &gt; X(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_1_1PointerTypeAnalysis_html_ae574a4c1d84b9e67bc94489f356805b4"><div class="ttname"><a href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">llvm::dxil::PointerTypeAnalysis::run</a></div><div class="ttdeci">PointerTypeMap run(const Module &amp;M)</div><div class="ttdoc">Compute the PointerTypeMap for the module M.</div><div class="ttdef"><b>Definition:</b> <a href="PointerTypeAnalysis_8cpp_source.html#l00189">PointerTypeAnalysis.cpp:189</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a5b1c646e5c6042dcbfcc7b9576f24f0a"><div class="ttname"><a href="CodeLayout_8cpp.html#a5b1c646e5c6042dcbfcc7b9576f24f0a">BackwardWeightCond</a></div><div class="ttdeci">static cl::opt&lt; double &gt; BackwardWeightCond(&quot;ext-tsp-backward-weight-cond&quot;, cl::ReallyHidden, cl::init(0.1), cl::desc(&quot;The weight of conditonal backward jumps for ExtTSP value&quot;))</div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a9b1f915358684d3dddf2e0d9bcdd1856"><div class="ttname"><a href="CodeLayout_8cpp.html#a9b1f915358684d3dddf2e0d9bcdd1856">BackwardDistance</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; BackwardDistance(&quot;ext-tsp-backward-distance&quot;, cl::ReallyHidden, cl::init(640), cl::desc(&quot;The maximum distance (in bytes) of a backward jump for ExtTSP&quot;))</div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a38101f24d850d53b478af4394ee40362"><div class="ttname"><a href="CodeLayout_8cpp.html#a38101f24d850d53b478af4394ee40362">EnableChainSplitAlongJumps</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableChainSplitAlongJumps(&quot;ext-tsp-enable-chain-split-along-jumps&quot;, cl::ReallyHidden, cl::init(true), cl::desc(&quot;The maximum size of a chain to apply splitting&quot;))</div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a9df82a8be2f17e80535a8937bf23e022"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a></div><div class="ttdeci">uint64_t Addr</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00079">ELFObjHandler.cpp:79</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="anamespacellvm_html_a061b224a1a3c3486fd854e5009a858c9"><div class="ttname"><a href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">llvm::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(int64_t V1, const APSInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APSInt_8h_source.html#l00361">APSInt.h:361</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a6c0062c50b45dce57654a7a2726de648"><div class="ttname"><a href="CodeLayout_8cpp.html#a6c0062c50b45dce57654a7a2726de648">FallthroughWeightUncond</a></div><div class="ttdeci">static cl::opt&lt; double &gt; FallthroughWeightUncond(&quot;ext-tsp-fallthrough-weight-uncond&quot;, cl::ReallyHidden, cl::init(1.05), cl::desc(&quot;The weight of unconditional fallthrough jumps for ExtTSP value&quot;))</div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">llvm::codeview::CompileSym2Flags::EC</a></div><div class="ttdeci">@ EC</div></div>
<div class="ttc" id="anamespacellvm_html_a10f3d955592ae2bc745f57e5b48ae115"><div class="ttname"><a href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">llvm::size</a></div><div class="ttdeci">auto size(R &amp;&amp;Range, std::enable_if_t&lt; std::is_base_of&lt; std::random_access_iterator_tag, typename std::iterator_traits&lt; decltype(Range.begin())&gt;::iterator_category &gt;::value, void &gt; *=nullptr)</div><div class="ttdoc">Get the size of a range.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01716">STLExtras.h:1716</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Sched_html_ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9"><div class="ttname"><a href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">llvm::Sched::Source</a></div><div class="ttdeci">@ Source</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00100">TargetLowering.h:100</a></div></div>
<div class="ttc" id="alib_2Analysis_2README_8txt_html_ad5ccdce1179bbfb942a084b3005f360d"><div class="ttname"><a href="lib_2Analysis_2README_8txt.html#ad5ccdce1179bbfb942a084b3005f360d">this</a></div><div class="ttdeci">Analysis the ScalarEvolution expression for r is this</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Analysis_2README_8txt_source.html#l00008">README.txt:8</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">llvm::Offset</a></div><div class="ttdeci">@ Offset</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_a3b159c2eb75048f9f2a2b8302b640418"><div class="ttname"><a href="CodeLayout_8cpp.html#a3b159c2eb75048f9f2a2b8302b640418">ForwardDistance</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ForwardDistance(&quot;ext-tsp-forward-distance&quot;, cl::ReallyHidden, cl::init(1024), cl::desc(&quot;The maximum distance (in bytes) of a forward jump for ExtTSP&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1ifs_html_adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df"><div class="ttname"><a href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">llvm::ifs::IFSSymbolType::Func</a></div><div class="ttdeci">@ Func</div></div>
<div class="ttc" id="anamespacellvm_html_a076f93c387f454f0db13d4bc7d4e7f9c"><div class="ttname"><a href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a></div><div class="ttdeci">void stable_sort(R &amp;&amp;Range)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01948">STLExtras.h:1948</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_aa2b0ee00c73d7c2efb1ba261738573a9"><div class="ttname"><a href="CodeLayout_8cpp.html#aa2b0ee00c73d7c2efb1ba261738573a9">ChainSplitThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ChainSplitThreshold(&quot;ext-tsp-chain-split-threshold&quot;, cl::ReallyHidden, cl::init(128), cl::desc(&quot;The maximum size of a chain to apply splitting&quot;))</div></div>
<div class="ttc" id="aELFYAML_8cpp_html_a941c34da9850676ce3380813c636cff2"><div class="ttname"><a href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a></div><div class="ttdeci">std::optional&lt; std::vector&lt; StOtherPiece &gt; &gt; Other</div><div class="ttdef"><b>Definition:</b> <a href="ELFYAML_8cpp_source.html#l01260">ELFYAML.cpp:1260</a></div></div>
<div class="ttc" id="aCodeLayout_8cpp_html_afeead781d03cc49b7c123ff7debacccf"><div class="ttname"><a href="CodeLayout_8cpp.html#afeead781d03cc49b7c123ff7debacccf">FallthroughWeightCond</a></div><div class="ttdeci">static cl::opt&lt; double &gt; FallthroughWeightCond(&quot;ext-tsp-fallthrough-weight-cond&quot;, cl::ReallyHidden, cl::init(1.0), cl::desc(&quot;The weight of conditional fallthrough jumps for ExtTSP value&quot;))</div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">InlinePriorityMode::Size</a></div><div class="ttdeci">@ Size</div></div>
<div class="ttc" id="aBlockVerifier_8cpp_html_ae45c7d73c0ff5d177b59153ffae77f84"><div class="ttname"><a href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a></div><div class="ttdeci">BlockVerifier::State From</div><div class="ttdef"><b>Definition:</b> <a href="BlockVerifier_8cpp_source.html#l00055">BlockVerifier.cpp:55</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1VGPRIndexMode_html_a9afd95476c40096a5898ba0f06370b3a"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">llvm::AMDGPU::VGPRIndexMode::Id</a></div><div class="ttdeci">Id</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00250">SIDefines.h:250</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">llvm::pdb::PDB_SymType::Block</a></div><div class="ttdeci">@ Block</div></div>
<div class="ttc" id="anamespacellvm_html_a2816e84a08c108d18bc4665bc1817e01"><div class="ttname"><a href="namespacellvm.html#a2816e84a08c108d18bc4665bc1817e01">llvm::abs</a></div><div class="ttdeci">APFloat abs(APFloat X)</div><div class="ttdoc">Returns the absolute value of the argument.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01332">APFloat.h:1332</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:35:44 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
