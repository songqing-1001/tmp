<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: include/llvm/ADT/Bitfields.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_dcde91663b8816e1e2311938ccd8f690.html">llvm</a></li><li class="navelem"><a class="el" href="dir_32453792af2ba70c54e3ccae3a790d1b.html">ADT</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">Bitfields.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;climits&gt;</code><br />
<code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;type_traits&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Bitfields.h:</div>
<div class="dyncontent">
<div class="center"><img src="Bitfields_8h__incl.png" border="0" usemap="#include_2llvm_2ADT_2Bitfields_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="Bitfields_8h__dep__incl.png" border="0" usemap="#include_2llvm_2ADT_2Bitfields_8hdep" alt=""/></div>
</div>
</div>
<p><a href="Bitfields_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1BitPatterns.html">llvm::bitfields_details::BitPatterns&lt; T, Bits &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct defining useful bit patterns for n-bits integer types.  <a href="structllvm_1_1bitfields__details_1_1BitPatterns.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1Compressor.html">llvm::bitfields_details::Compressor&lt; T, Bits, bool &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code><a class="el" href="structllvm_1_1bitfields__details_1_1Compressor.html" title="Compressor is used to manipulate the bits of a (possibly signed) integer type so it can be packed and...">Compressor</a></code> is used to manipulate the bits of a (possibly signed) integer type so it can be packed and unpacked into a <code>bits</code> sized integer, <code><a class="el" href="structllvm_1_1bitfields__details_1_1Compressor.html" title="Compressor is used to manipulate the bits of a (possibly signed) integer type so it can be packed and...">Compressor</a></code> is specialized on signed-ness so no runtime cost is incurred.  <a href="structllvm_1_1bitfields__details_1_1Compressor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1Compressor_3_01T_00_01Bits_00_01false_01_4.html">llvm::bitfields_details::Compressor&lt; T, Bits, false &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1Impl.html">llvm::bitfields_details::Impl&lt; Bitfield, StorageType &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structllvm_1_1bitfields__details_1_1Impl.html" title="Impl is where Bifield description and Storage are put together to interact with values.">Impl</a> is where Bifield description and Storage are put together to interact with values.  <a href="structllvm_1_1bitfields__details_1_1Impl.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1ResolveUnderlyingType.html">llvm::bitfields_details::ResolveUnderlyingType&lt; T, bool &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code><a class="el" href="structllvm_1_1Bitfield.html" title="Holds functions to get, set or test bitfields.">Bitfield</a></code> deals with the following type:  <a href="structllvm_1_1bitfields__details_1_1ResolveUnderlyingType.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1ResolveUnderlyingType_3_01T_00_01false_01_4.html">llvm::bitfields_details::ResolveUnderlyingType&lt; T, false &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1bitfields__details_1_1ResolveUnderlyingType_3_01bool_00_01false_01_4.html">llvm::bitfields_details::ResolveUnderlyingType&lt; bool, false &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1Bitfield.html">llvm::Bitfield</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds functions to get, set or test bitfields.  <a href="structllvm_1_1Bitfield.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllvm_1_1Bitfield_1_1Element.html">llvm::Bitfield::Element&lt; T, Offset, Size, MaxValue &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes an element of a <a class="el" href="structllvm_1_1Bitfield.html" title="Holds functions to get, set or test bitfields.">Bitfield</a>.  <a href="structllvm_1_1Bitfield_1_1Element.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacellvm"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacellvm.html">llvm</a></td></tr>
<tr class="memdesc:namespacellvm"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is an optimization pass for GlobalISel generic memory operations. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacellvm_1_1bitfields__details"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacellvm_1_1bitfields__details.html">llvm::bitfields_details</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file implements methods to test, set and extract typed bits from packed unsigned integers.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Why not C++ bitfields?</h2>
<p>C++ bitfields do not offer control over the bit layout nor consistent behavior when it comes to out of range values. For instance, the layout is implementation defined and adjacent bits may be packed together but are not required to. This is problematic when storage is sparse and data must be stored in a particular integer type.</p>
<p>The methods provided in this file ensure precise control over the layout/storage as well as protection against out of range values.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Usage example</h2>
<div class="fragment"><div class="line">uint8_t Storage = 0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Store and retrieve a single bit as bool.</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a29dcc89db32a1eead61fe67cff38c060">Bool</a> = Bitfield::Element&lt;bool, 0, 1&gt;;</div>
<div class="line">Bitfield::set&lt;Bool&gt;(Storage, <span class="keyword">true</span>);</div>
<div class="line">EXPECT_EQ(Storage, 0b00000001);</div>
<div class="line"><span class="comment">//                          ^</span></div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Bool&gt;(Storage), <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Store and retrieve a 2 bit typed enum.</span></div>
<div class="line"><span class="comment">// Note: enum underlying type must be unsigned.</span></div>
<div class="line"><span class="keyword">enum class</span> SuitEnum : uint8_t { CLUBS, DIAMONDS, HEARTS, SPADES };</div>
<div class="line"><span class="comment">// Note: enum maximum value needs to be passed in as last parameter.</span></div>
<div class="line"><span class="keyword">using</span> Suit = Bitfield::Element&lt;SuitEnum, 1, 2, SuitEnum::SPADES&gt;;</div>
<div class="line">Bitfield::set&lt;Suit&gt;(Storage, SuitEnum::HEARTS);</div>
<div class="line">EXPECT_EQ(Storage, 0b00000101);</div>
<div class="line"><span class="comment">//                        ^^</span></div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Suit&gt;(Storage), SuitEnum::HEARTS);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Store and retrieve a 5 bit value as unsigned.</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">Value</a> = Bitfield::Element&lt;unsigned, 3, 5&gt;;</div>
<div class="line">Bitfield::set&lt;Value&gt;(Storage, 10);</div>
<div class="line">EXPECT_EQ(Storage, 0b01010101);</div>
<div class="line"><span class="comment">//                   ^^^^^</span></div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Value&gt;(Storage), 10U);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Interpret the same 5 bit value as signed.</span></div>
<div class="line"><span class="keyword">using</span> SignedValue = Bitfield::Element&lt;int, 3, 5&gt;;</div>
<div class="line">Bitfield::set&lt;SignedValue&gt;(Storage, -2);</div>
<div class="line">EXPECT_EQ(Storage, 0b11110101);</div>
<div class="line"><span class="comment">//                   ^^^^^</span></div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;SignedValue&gt;(Storage), -2);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Ability to efficiently test if a field is non zero.</span></div>
<div class="line">EXPECT_TRUE(Bitfield::test&lt;Value&gt;(Storage));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Alter Storage changes value.</span></div>
<div class="line">Storage = 0;</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Bool&gt;(Storage), <span class="keyword">false</span>);</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Suit&gt;(Storage), SuitEnum::CLUBS);</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Value&gt;(Storage), 0U);</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;SignedValue&gt;(Storage), 0);</div>
<div class="line"> </div>
<div class="line">Storage = 255;</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Bool&gt;(Storage), <span class="keyword">true</span>);</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Suit&gt;(Storage), SuitEnum::SPADES);</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;Value&gt;(Storage), 31U);</div>
<div class="line">EXPECT_EQ(Bitfield::get&lt;SignedValue&gt;(Storage), -1);</div>
</div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="Bitfields_8h_source.html">Bitfields.h</a>.</p>
</div></div><!-- contents -->
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a29dcc89db32a1eead61fe67cff38c060"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a29dcc89db32a1eead61fe67cff38c060">Bool</a></div><div class="ttdeci">@ Bool</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00047">TargetLibraryInfo.cpp:47</a></div></div>
<div class="ttc" id="anamespacellvm_1_1TargetStackID_html_a71392100eb15ba746b1f898986f5d8a5"><div class="ttname"><a href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">llvm::TargetStackID::Value</a></div><div class="ttdeci">Value</div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00027">TargetFrameLowering.h:27</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:40:38 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
