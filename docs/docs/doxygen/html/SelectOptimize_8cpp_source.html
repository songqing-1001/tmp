<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/CodeGen/SelectOptimize.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_1e8ad0574bd6e387992681ee57691a07.html">CodeGen</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SelectOptimize.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SelectOptimize_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===--- SelectOptimize.cpp - Convert select to branches if profitable ---===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This pass converts selects to conditional jumps when profitable.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BlockFrequencyInfo_8h.html">llvm/Analysis/BlockFrequencyInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BranchProbabilityInfo_8h.html">llvm/Analysis/BranchProbabilityInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfileSummaryInfo_8h.html">llvm/Analysis/ProfileSummaryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeGen_2Passes_8h.html">llvm/CodeGen/Passes.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLowering_8h.html">llvm/CodeGen/TargetLowering.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetPassConfig_8h.html">llvm/CodeGen/TargetPassConfig.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetSchedule_8h.html">llvm/CodeGen/TargetSchedule.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetSubtargetInfo_8h.html">llvm/CodeGen/TargetSubtargetInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfDataUtils_8h.html">llvm/IR/ProfDataUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScaledNumber_8h.html">llvm/Support/ScaledNumber.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SizeOpts_8h.html">llvm/Transforms/Utils/SizeOpts.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;stack&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   45</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;select-optimize&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectOptAnalyzed,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <span class="stringliteral">&quot;Number of select groups considered for conversion to branch&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectConvertedExpColdOperand,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          <span class="stringliteral">&quot;Number of select groups converted due to expensive cold operand&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectConvertedHighPred,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          <span class="stringliteral">&quot;Number of select groups converted due to high-predictability&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectUnPred,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          <span class="stringliteral">&quot;Number of select groups not converted due to unpredictability&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectColdBB,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          <span class="stringliteral">&quot;Number of select groups not converted due to cold basic block&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectConvertedLoop,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          <span class="stringliteral">&quot;Number of select groups converted due to loop-level analysis&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSelectsConverted, <span class="stringliteral">&quot;Number of selects converted&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="SelectOptimize_8cpp.html#a0becd1956c8f86ceb3b377a215ccd47b">ColdOperandThreshold</a>(</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="stringliteral">&quot;cold-operand-threshold&quot;</span>,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Maximum frequency of path for an operand to be considered cold.&quot;</span>),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(20), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="SelectOptimize_8cpp.html#a9a3adbb1e07982c9153b848f65a65e4a">ColdOperandMaxCostMultiplier</a>(</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="stringliteral">&quot;cold-operand-max-cost-multiplier&quot;</span>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Maximum cost multiplier of TCC_expensive for the dependence &quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;             <span class="stringliteral">&quot;slice of a cold operand to be considered inexpensive.&quot;</span>),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(1), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#a4daea2175d48636809e21d8be21d508b">GainGradientThreshold</a>(<span class="stringliteral">&quot;select-opti-loop-gradient-gain-threshold&quot;</span>,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                          <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Gradient gain threshold (%).&quot;</span>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                          <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(25), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#aae2afa0fa53d26e800f466c0f7f58c67">GainCycleThreshold</a>(<span class="stringliteral">&quot;select-opti-loop-cycle-gain-threshold&quot;</span>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                       <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Minimum gain per loop (in cycles) threshold.&quot;</span>),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                       <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(4), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="SelectOptimize_8cpp.html#aa9f0da0c38c7e72bc418897c343e9fca">GainRelativeThreshold</a>(</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="stringliteral">&quot;select-opti-loop-relative-gain-threshold&quot;</span>,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="stringliteral">&quot;Minimum relative gain per loop threshold (1/X). Defaults to 12.5%&quot;</span>),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(8), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="SelectOptimize_8cpp.html#ad441df3dd94fa519afd51bac25947eda">MispredictDefaultRate</a>(</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="stringliteral">&quot;mispredict-default-rate&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(25),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Default mispredict rate (initialized to 25%).&quot;</span>));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#a98e27e67cea9203143b6573737429c0b">DisableLoopLevelHeuristics</a>(<span class="stringliteral">&quot;disable-loop-level-heuristics&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                               <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                               <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable loop-level heuristics.&quot;</span>));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">class </span>SelectOptimize : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetSubtargetInfo.html">TargetSubtargetInfo</a> *TSI;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> *TLI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  std::unique_ptr&lt;BlockFrequencyInfo&gt; <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  std::unique_ptr&lt;BranchProbabilityInfo&gt; BPI;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classllvm_1_1TargetSchedModel.html">TargetSchedModel</a> TSchedModel;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  SelectOptimize() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="namespacellvm.html#ad3854d85c03c0c709977e3625cb8158b">initializeSelectOptimizePass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1ProfileSummaryInfoWrapperPass.html">ProfileSummaryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a>&gt;();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterWrapperPass.html">OptimizationRemarkEmitterWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Select groups consist of consecutive select instructions with the same</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// condition.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">using</span> SelectGroup = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 2&gt;</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">using</span> SelectGroups = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectGroup, 2&gt;</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">using</span> <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> = <a class="code" href="classllvm_1_1ScaledNumber.html">ScaledNumber&lt;uint64_t&gt;</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">struct </span>CostInfo {<span class="comment"></span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    /// Predicated cost (with selects as conditional moves).</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> PredCost;<span class="comment"></span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">    /// Non-predicated cost (with selects converted to branches).</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> NonPredCost;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  };</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// Converts select instructions of a function to conditional jumps when deemed</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// profitable. Returns true if at least one select was converted.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">bool</span> optimizeSelects(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// Heuristics for determining which select instructions can be profitably</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// conveted to branches. Separate heuristics for selects in inner-most loops</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// and the rest of code regions (base heuristics for non-inner-most loop</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// regions).</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">void</span> optimizeSelectsBase(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, SelectGroups &amp;ProfSIGroups);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">void</span> optimizeSelectsInnerLoops(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, SelectGroups &amp;ProfSIGroups);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// Converts to branches the select groups that were deemed</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// profitable-to-convert.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">void</span> convertProfitableSIGroups(SelectGroups &amp;ProfSIGroups);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// Splits selects of a given basic block into select groups.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">void</span> collectSelectGroups(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, SelectGroups &amp;SIGroups);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Determines for which select groups it is profitable converting to branches</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// (base and inner-most-loop heuristics).</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">void</span> findProfitableSIGroupsBase(SelectGroups &amp;SIGroups,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                  SelectGroups &amp;ProfSIGroups);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">void</span> findProfitableSIGroupsInnerLoops(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, SelectGroups &amp;SIGroups,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                        SelectGroups &amp;ProfSIGroups);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// Determines if a select group should be converted to a branch (base</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// heuristics).</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">bool</span> isConvertToBranchProfitableBase(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 2&gt;</a> &amp;ASI);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// Returns true if there are expensive instructions in the cold value</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// operand&#39;s (if any) dependence slice of any of the selects of the given</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// group.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">bool</span> hasExpensiveColdOperand(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 2&gt;</a> &amp;ASI);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// For a given source instruction, collect its backwards dependence slice</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// consisting of instructions exclusively computed for producing the operands</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// of the source instruction.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">void</span> getExclBackwardsSlice(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, std::stack&lt;Instruction *&gt; &amp;Slice,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                             <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keywordtype">bool</span> ForSinking = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// Returns true if the condition of the select is highly predictable.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">bool</span> isSelectHighlyPredictable(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// Loop-level checks to determine if a non-predicated version (with branches)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// of the given loop is more profitable than its predicated version.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">bool</span> checkLoopHeuristics(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> CostInfo LoopDepth[2]);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// Computes instruction and loop-critical-path costs for both the predicated</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// and non-predicated version of the given loop.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">bool</span> computeLoopCosts(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> SelectGroups &amp;SIGroups,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Instruction *, CostInfo&gt;</a> &amp;InstCostMap,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        CostInfo *LoopCost);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// Returns a set of all the select instructions in the given select groups.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Instruction *, 2&gt;</a> getSIset(<span class="keyword">const</span> SelectGroups &amp;SIGroups);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Returns the latency cost of a given instruction.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  std::optional&lt;uint64_t&gt; computeInstCost(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Returns the misprediction cost of a given select when converted to branch.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> getMispredictionCost(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> CondCost);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// Returns the cost of a branch when the prediction is correct.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> getPredictedPathCost(<a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> TrueCost, <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> FalseCost,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// Returns true if the target architecture supports lowering a given select.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">bool</span> isSelectKindSupported(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;};</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">SelectOptimize::ID</a> = 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<a class="code" href="SelectOptimize_8cpp.html#aab588fc778ee5107e3aafae0f569143a">INITIALIZE_PASS_BEGIN</a>(SelectOptimize, <a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;Optimize selects&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                      <span class="keyword">false</span>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1ProfileSummaryInfoWrapperPass.html">ProfileSummaryInfoWrapperPass</a>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1OptimizationRemarkEmitterWrapperPass.html">OptimizationRemarkEmitterWrapperPass</a>)</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#a3d495d9a0daf7fe32f1b1fb0aa153929">  226</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(SelectOptimize, <a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, &quot;Optimize <a class="code" href="SelectOptimize_8cpp.html#a3d495d9a0daf7fe32f1b1fb0aa153929">selects</a>&quot;, <a class="code" href="namespacefalse.html">false</a>,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="namespacellvm.html#a2cedf757f360f8a9b439d7ff9dcdd981">  229</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#a2cedf757f360f8a9b439d7ff9dcdd981">createSelectOptimizePass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> SelectOptimize(); }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">SelectOptimize::runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> = &amp;getAnalysis&lt;TargetPassConfig&gt;().getTM&lt;<a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a>&gt;();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  TSI = <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>-&gt;getSubtargetImpl(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  TLI = TSI-&gt;getTargetLowering();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// If none of the select types is supported then skip this pass.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// This is an optimization pass. Legality issues will be handled by</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// instruction selection.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (!TLI-&gt;isSelectSupported(<a class="code" href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda87a93c29e9b581a0845c5cd878a8d3b7">TargetLowering::ScalarValSelect</a>) &amp;&amp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      !TLI-&gt;isSelectSupported(<a class="code" href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda14714058f9e9eb27b0a4ec62d23bddd5">TargetLowering::ScalarCondVectorVal</a>) &amp;&amp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      !TLI-&gt;isSelectSupported(<a class="code" href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda57d13a184979a5a9b7110c20e9d6f55d">TargetLowering::VectorMaskSelect</a>))</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> = &amp;getAnalysis&lt;TargetTransformInfoWrapperPass&gt;().getTTI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a72110d5a1a43e21651a36bd96cfdec98">enableSelectOptimize</a>())</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  DT = &amp;getAnalysis&lt;DominatorTreeWrapperPass&gt;().getDomTree();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  LI = &amp;getAnalysis&lt;LoopInfoWrapperPass&gt;().getLoopInfo();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  BPI.reset(<span class="keyword">new</span> <a class="code" href="classllvm_1_1BranchProbabilityInfo.html">BranchProbabilityInfo</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, *LI));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>.reset(<span class="keyword">new</span> <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, *BPI, *LI));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  PSI = &amp;getAnalysis&lt;ProfileSummaryInfoWrapperPass&gt;().getPSI();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  ORE = &amp;getAnalysis&lt;OptimizationRemarkEmitterWrapperPass&gt;().getORE();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  TSchedModel.init(TSI);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// When optimizing for size, selects are preferable over branches.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasOptSize() || <a class="code" href="namespacellvm.html#a3af72f14ea20f2c762c751d2d49e5ea3">llvm::shouldOptimizeForSize</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PSI, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>.get()))</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">return</span> optimizeSelects(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::optimizeSelects(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Determine for which select groups it is profitable converting to branches.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  SelectGroups ProfSIGroups;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// Base heuristics apply only to non-loops and outer loops.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  optimizeSelectsBase(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ProfSIGroups);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// Separate heuristics for inner-most loops.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  optimizeSelectsInnerLoops(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ProfSIGroups);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// Convert to branches the select groups that were deemed</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// profitable-to-convert.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  convertProfitableSIGroups(ProfSIGroups);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// Code modified if at least one select group was converted.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">return</span> !ProfSIGroups.empty();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">void</span> SelectOptimize::optimizeSelectsBase(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                         SelectGroups &amp;ProfSIGroups) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// Collect all the select groups.</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  SelectGroups SIGroups;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// Base heuristics apply only to non-loops and outer loops.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;getLoopFor(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (L &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">isInnermost</a>())</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    collectSelectGroups(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, SIGroups);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// Determine for which select groups it is profitable converting to branches.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  findProfitableSIGroupsBase(SIGroups, ProfSIGroups);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordtype">void</span> SelectOptimize::optimizeSelectsInnerLoops(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                               SelectGroups &amp;ProfSIGroups) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Loop *, 4&gt;</a> <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>(LI-&gt;begin(), LI-&gt;end());</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// Need to check size on each iteration as we accumulate child loops.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size(); ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *ChildL : <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getSubLoops())</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.push_back(ChildL);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">isInnermost</a>())</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    SelectGroups SIGroups;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a5cc113cb783ab6e5ca7b69241431c19c">getBlocks</a>())</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      collectSelectGroups(*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, SIGroups);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    findProfitableSIGroupsInnerLoops(L, SIGroups, ProfSIGroups);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">/// If \p isTrue is true, return the true value of \p SI, otherwise return</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/// false value of \p SI. If the true/false value of \p SI is defined by any</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">/// select instructions in \p Selects, look through the defining select</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/// instruction until the true/false value is not defined in \p Selects.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *</div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#a8dd1128758268fa3aa05eeba358baf3f">  321</a></span>&#160;<a class="code" href="SelectOptimize_8cpp.html#a8dd1128758268fa3aa05eeba358baf3f">getTrueOrFalseValue</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keywordtype">bool</span> isTrue,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Instruction *, 2&gt;</a> &amp;Selects) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *DefSI = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>; DefSI != <span class="keyword">nullptr</span> &amp;&amp; Selects.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(DefSI);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;       DefSI = dyn_cast&lt;SelectInst&gt;(V)) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DefSI-&gt;getCondition() == <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition() &amp;&amp;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;           <span class="stringliteral">&quot;The condition of DefSI does not match with SI&quot;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    V = (isTrue ? DefSI-&gt;getTrueValue() : DefSI-&gt;getFalseValue());</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V &amp;&amp; <span class="stringliteral">&quot;Failed to get select true/false value&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">void</span> SelectOptimize::convertProfitableSIGroups(SelectGroups &amp;ProfSIGroups) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span> (SelectGroup &amp;ASI : ProfSIGroups) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// The code transformation here is a modified version of the sinking</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// transformation in CodeGenPrepare::optimizeSelectInst with a more</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// aggressive strategy of which instructions to sink.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// TODO: eliminate the redundancy of logic transforming selects to branches</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// by removing CodeGenPrepare::optimizeSelectInst and optimizing here</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// selects for all cases (with and without profile information).</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Transform a sequence like this:</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">//    start:</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">//       %cmp = cmp uge i32 %a, %b</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">//       %sel = select i1 %cmp, i32 %c, i32 %d</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Into:</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//    start:</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//       %cmp = cmp uge i32 %a, %b</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">//       %cmp.frozen = freeze %cmp</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//       br i1 %cmp.frozen, label %select.true, label %select.false</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//    select.true:</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//       br label %select.end</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">//    select.false:</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//       br label %select.end</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">//    select.end:</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//       %sel = phi i32 [ %c, %select.true ], [ %d, %select.false ]</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// %cmp should be frozen, otherwise it may introduce undefined behavior.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// In addition, we may sink instructions that produce %c or %d into the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// destination(s) of the new branch.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// If the true or false blocks do not contain a sunken instruction, that</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// block and its branch may be optimized away. In that case, one side of the</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// first branch will point directly to select.end, and the corresponding PHI</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// predecessor block will be the start block.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// Find all the instructions that can be soundly sunk to the true/false</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// blocks. These are instructions that are computed solely for producing the</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// operands of the select instructions in the group and can be sunk without</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// breaking the semantics of the LLVM IR (e.g., cannot sink instructions</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// with side effects).</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::stack&lt;Instruction *&gt;</a>, 2&gt; TrueSlices, FalseSlices;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">typedef</span> std::stack&lt;Instruction *&gt;::size_type StackSizeType;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    StackSizeType maxTrueSliceLen = 0, maxFalseSliceLen = 0;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : ASI) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">// For each select, compute the sinkable dependence chains of the true and</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// false operands.</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *TI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getTrueValue())) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        std::stack&lt;Instruction *&gt; TrueSlice;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        getExclBackwardsSlice(TI, TrueSlice, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        maxTrueSliceLen = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(maxTrueSliceLen, TrueSlice.size());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        TrueSlices.push_back(TrueSlice);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *FI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getFalseValue())) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        std::stack&lt;Instruction *&gt; FalseSlice;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        getExclBackwardsSlice(FI, FalseSlice, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        maxFalseSliceLen = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(maxFalseSliceLen, FalseSlice.size());</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        FalseSlices.push_back(FalseSlice);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// In the case of multiple select instructions in the same group, the order</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// of non-dependent instructions (instructions of different dependence</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// slices) in the true/false blocks appears to affect performance.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// Interleaving the slices seems to experimentally be the optimal approach.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// This interleaving scheduling allows for more ILP (with a natural downside</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// of increasing a bit register pressure) compared to a simple ordering of</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// one whole chain after another. One would expect that this ordering would</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// not matter since the scheduling in the backend of the compiler  would</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// take care of it, but apparently the scheduler fails to deliver optimal</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// ILP with a naive ordering here.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 2&gt;</a> TrueSlicesInterleaved, FalseSlicesInterleaved;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">for</span> (StackSizeType IS = 0; IS &lt; maxTrueSliceLen; ++IS) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : TrueSlices) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.empty()) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          TrueSlicesInterleaved.push_back(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.top());</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.pop();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">for</span> (StackSizeType IS = 0; IS &lt; maxFalseSliceLen; ++IS) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : FalseSlices) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.empty()) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          FalseSlicesInterleaved.push_back(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.top());</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.pop();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// We split the block containing the select(s) into two blocks.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = ASI.front();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *LastSI = ASI.back();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *StartBlock = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> SplitPt = ++(<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a>(LastSI));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EndBlock = StartBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(SplitPt, <span class="stringliteral">&quot;select.end&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>-&gt;setBlockFreq(EndBlock, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>-&gt;getBlockFreq(StartBlock).getFrequency());</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// Delete the unconditional branch that was just created by the split.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    StartBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Move any debug/pseudo instructions that were in-between the select</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// group to the newly-created end block.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 2&gt;</a> DebugPseudoINS;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">auto</span> DIt = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getIterator();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">while</span> (&amp;*DIt != LastSI) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">if</span> (DIt-&gt;isDebugOrPseudoInst())</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        DebugPseudoINS.push_back(&amp;*DIt);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      DIt++;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DI : DebugPseudoINS) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      DI-&gt;moveBefore(&amp;*EndBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// These are the new basic blocks for the conditional branch.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// At least one will become an actual new basic block.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *TrueBlock = <span class="keyword">nullptr</span>, *FalseBlock = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *TrueBranch = <span class="keyword">nullptr</span>, *FalseBranch = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (!TrueSlicesInterleaved.empty()) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      TrueBlock = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(LastSI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), <span class="stringliteral">&quot;select.true.sink&quot;</span>,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                     EndBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>(), EndBlock);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      TrueBranch = <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(EndBlock, TrueBlock);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      TrueBranch-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(LastSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TrueInst : TrueSlicesInterleaved)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        TrueInst-&gt;moveBefore(TrueBranch);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (!FalseSlicesInterleaved.empty()) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      FalseBlock = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(LastSI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), <span class="stringliteral">&quot;select.false.sink&quot;</span>,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                      EndBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>(), EndBlock);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      FalseBranch = <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(EndBlock, FalseBlock);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      FalseBranch-&gt;setDebugLoc(LastSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FalseInst : FalseSlicesInterleaved)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        FalseInst-&gt;moveBefore(FalseBranch);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// If there was nothing to sink, then arbitrarily choose the &#39;false&#39; side</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// for a new input value to the PHI.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (TrueBlock == FalseBlock) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TrueBlock == <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;             <span class="stringliteral">&quot;Unexpected basic block transform while optimizing select&quot;</span>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      FalseBlock = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getContext(), <span class="stringliteral">&quot;select.false&quot;</span>,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                      EndBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>(), EndBlock);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keyword">auto</span> *FalseBranch = <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(EndBlock, FalseBlock);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      FalseBranch-&gt;setDebugLoc(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// Insert the real conditional branch based on the original condition.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// If we did not create a new block for one of the &#39;true&#39; or &#39;false&#39; paths</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// of the condition, it means that side of the branch goes to the end block</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// directly and the path originates from the start block from the point of</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// view of the new PHI.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="namespacellvm_1_1ARM.html#a5667e0461a51d2c4887056c3f684c341adf1f3edb9115acb0a1e04209b7a9937b">TT</a>, *FT;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (TrueBlock == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <a class="code" href="namespacellvm_1_1ARM.html#a5667e0461a51d2c4887056c3f684c341adf1f3edb9115acb0a1e04209b7a9937b">TT</a> = EndBlock;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      FT = FalseBlock;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      TrueBlock = StartBlock;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FalseBlock == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="namespacellvm_1_1ARM.html#a5667e0461a51d2c4887056c3f684c341adf1f3edb9115acb0a1e04209b7a9937b">TT</a> = TrueBlock;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      FT = EndBlock;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      FalseBlock = StartBlock;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <a class="code" href="namespacellvm_1_1ARM.html#a5667e0461a51d2c4887056c3f684c341adf1f3edb9115acb0a1e04209b7a9937b">TT</a> = TrueBlock;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      FT = FalseBlock;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a438dbcc76b79fb10acb447ec5d141287">IB</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">auto</span> *CondFr =</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a438dbcc76b79fb10acb447ec5d141287">IB</a>.CreateFreeze(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getName() + <span class="stringliteral">&quot;.frozen&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a438dbcc76b79fb10acb447ec5d141287">IB</a>.CreateCondBr(CondFr, TT, FT, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Instruction *, 2&gt;</a> INS;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    INS.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(ASI.begin(), ASI.end());</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// Use reverse iterator because later select may use the value of the</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// earlier select, and we need to propagate value through earlier select</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// to get the PHI operand.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> It = ASI.rbegin(); It != ASI.rend(); ++It) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = *It;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">// The select itself is replaced with a PHI Node.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getType(), 2, <span class="stringliteral">&quot;&quot;</span>, &amp;EndBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      PN-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="SelectOptimize_8cpp.html#a8dd1128758268fa3aa05eeba358baf3f">getTrueOrFalseValue</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keyword">true</span>, INS), TrueBlock);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="SelectOptimize_8cpp.html#a8dd1128758268fa3aa05eeba358baf3f">getTrueOrFalseValue</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keyword">false</span>, INS), FalseBlock);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;replaceAllUsesWith(PN);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      INS.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      ++NumSelectsConverted;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#a8991a94a0e3635a9af17c74222975838">  521</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SelectOptimize_8cpp.html#a8991a94a0e3635a9af17c74222975838">isSpecialSelect</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// If the select is a logical-and/logical-or then it is better treated as a</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// and/or by the backend.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#af4feec45578e32fe65d8efc59112bc8e">m_CombineOr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a213e6c0ca6e838157373b9a6018c0769">m_LogicalAnd</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>()),</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                            <a class="code" href="namespacellvm_1_1PatternMatch.html#a1a06b1cff93069d7403ea03e6150e386">m_LogicalOr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>()))))</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordtype">void</span> SelectOptimize::collectSelectGroups(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                         SelectGroups &amp;SIGroups) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BBIt = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.begin();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">while</span> (BBIt != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.end()) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = &amp;*BBIt++;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="SelectOptimize_8cpp.html#a8991a94a0e3635a9af17c74222975838">isSpecialSelect</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      SelectGroup SIGroup;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      SIGroup.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">while</span> (BBIt != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.end()) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NI = &amp;*BBIt;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *NSI = dyn_cast&lt;SelectInst&gt;(NI);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">if</span> (NSI &amp;&amp; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition() == NSI-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a93a29cd4a753518a59c20c1b6ec88c76">getCondition</a>()) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          SIGroup.push_back(NSI);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!NI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a323444895ce923a737f0a7af82a30f54">isDebugOrPseudoInst</a>()) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          <span class="comment">// Debug/pseudo instructions should be skipped and not prevent the</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          <span class="comment">// formation of a select group.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        ++BBIt;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="comment">// If the select type is not supported, no point optimizing it.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="comment">// Instruction selection will take care of it.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">if</span> (!isSelectKindSupported(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      SIGroups.push_back(SIGroup);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keywordtype">void</span> SelectOptimize::findProfitableSIGroupsBase(SelectGroups &amp;SIGroups,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                                SelectGroups &amp;ProfSIGroups) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">for</span> (SelectGroup &amp;ASI : SIGroups) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    ++NumSelectOptAnalyzed;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (isConvertToBranchProfitableBase(ASI))</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      ProfSIGroups.push_back(ASI);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">  576</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                               <a class="code" href="classllvm_1_1DiagnosticInfoOptimizationBase.html">DiagnosticInfoOptimizationBase</a> &amp;Rem) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Rem.<a class="code" href="classllvm_1_1DiagnosticInfoOptimizationBase.html#a579ac4d6814d2caddee0904ca72250c7">getMsg</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>(Rem);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordtype">void</span> SelectOptimize::findProfitableSIGroupsInnerLoops(</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, SelectGroups &amp;SIGroups, SelectGroups &amp;ProfSIGroups) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  NumSelectOptAnalyzed += SIGroups.size();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// For each select group in an inner-most loop,</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// a branch is more preferable than a select/conditional-move if:</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// i) conversion to branches for all the select groups of the loop satisfies</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">//    loop-level heuristics including reducing the loop&#39;s critical path by</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">//    some threshold (see SelectOptimize::checkLoopHeuristics); and</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// ii) the total cost of the select group is cheaper with a branch compared</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">//     to its predicated version. The cost is in terms of latency and the cost</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">//     of a select group is the cost of its most expensive select instruction</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">//     (assuming infinite resources and thus fully leveraging available ILP).</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Instruction *, CostInfo&gt;</a> InstCostMap;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  CostInfo LoopCost[2] = {{Scaled64::getZero(), Scaled64::getZero()},</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                          {Scaled64::getZero(), Scaled64::getZero()}};</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">if</span> (!computeLoopCosts(L, SIGroups, InstCostMap, LoopCost) ||</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      !checkLoopHeuristics(L, LoopCost)) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">for</span> (SelectGroup &amp;ASI : SIGroups) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">// Assuming infinite resources, the cost of a group of instructions is the</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">// cost of the most expensive instruction of the group.</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> SelectCost = Scaled64::getZero(), BranchCost = Scaled64::getZero();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : ASI) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      SelectCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(SelectCost, InstCostMap[<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>].PredCost);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      BranchCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(BranchCost, InstCostMap[<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>].NonPredCost);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> (BranchCost &lt; SelectCost) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>, ASI.front());</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Profitable to convert to branch (loop analysis). BranchCost=&quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         &lt;&lt; BranchCost.toString() &lt;&lt; <span class="stringliteral">&quot;, SelectCost=&quot;</span> &lt;&lt; SelectCost.<a class="code" href="classllvm_1_1ScaledNumber.html#a628cc55e3eb3abc28be11f6fb90b948a">toString</a>()</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      ++NumSelectConvertedLoop;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      ProfSIGroups.push_back(ASI);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> ORmiss(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>, ASI.front());</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      ORmiss &lt;&lt; <span class="stringliteral">&quot;Select is more profitable (loop analysis). BranchCost=&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;             &lt;&lt; BranchCost.toString()</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;, SelectCost=&quot;</span> &lt;&lt; SelectCost.<a class="code" href="classllvm_1_1ScaledNumber.html#a628cc55e3eb3abc28be11f6fb90b948a">toString</a>() &lt;&lt; <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmiss);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::isConvertToBranchProfitableBase(</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 2&gt;</a> &amp;ASI) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = ASI.front();</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Analyzing select group containing &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> ORmiss(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// Skip cold basic blocks. Better to optimize for size for cold blocks.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">if</span> (PSI-&gt;isColdBlock(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent(), <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>.get())) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    ++NumSelectColdBB;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    ORmiss &lt;&lt; <span class="stringliteral">&quot;Not converted to branch because of cold basic block. &quot;</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmiss);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// If unpredictable, branch form is less profitable.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getMetadata(LLVMContext::MD_unpredictable)) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    ++NumSelectUnPred;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    ORmiss &lt;&lt; <span class="stringliteral">&quot;Not converted to branch because of unpredictable branch. &quot;</span>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmiss);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// If highly predictable, branch form is more profitable, unless a</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// predictable select is inexpensive in the target architecture.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">if</span> (isSelectHighlyPredictable(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) &amp;&amp; TLI-&gt;isPredictableSelectExpensive()) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    ++NumSelectConvertedHighPred;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Converted to branch because of highly predictable branch. &quot;</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">// Look for expensive instructions in the cold operand&#39;s (if any) dependence</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// slice of any of the selects in the group.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> (hasExpensiveColdOperand(ASI)) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    ++NumSelectConvertedExpColdOperand;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a> &lt;&lt; <span class="stringliteral">&quot;Converted to branch because of expensive cold operand.&quot;</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">OR</a>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  ORmiss &lt;&lt; <span class="stringliteral">&quot;Not profitable to convert to branch (base heuristic).&quot;</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmiss);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#a1b2f058ab8cbdeb85a364999aecef644">  675</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="namespacellvm.html#a646699d7e9479783d02a368364310c67">divideNearest</a>(<a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Numerator,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                     <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Denominator) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">return</span> (Numerator + (Denominator / 2)) / Denominator;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;}</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::hasExpensiveColdOperand(</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 2&gt;</a> &amp;ASI) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordtype">bool</span> ColdOperand = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TrueWeight, FalseWeight, TotalWeight;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ac19cbbc4935a23e1d44f65e1eaba6b1d">extractBranchWeights</a>(*ASI.front(), TrueWeight, FalseWeight)) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MinWeight = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(TrueWeight, FalseWeight);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    TotalWeight = TrueWeight + FalseWeight;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Is there a path with frequency &lt;ColdOperandThreshold% (default:20%) ?</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    ColdOperand = TotalWeight * <a class="code" href="SelectOptimize_8cpp.html#a0becd1956c8f86ceb3b377a215ccd47b">ColdOperandThreshold</a> &gt; 100 * MinWeight;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSI-&gt;hasProfileSummary()) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> ORmiss(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>, ASI.front());</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    ORmiss &lt;&lt; <span class="stringliteral">&quot;Profile data available but missing branch-weights metadata for &quot;</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;              <span class="stringliteral">&quot;select instruction. &quot;</span>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmiss);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (!ColdOperand)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="comment">// Check if the cold path&#39;s dependence slice is expensive for any of the</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// selects of the group.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : ASI) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ColdI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> HotWeight;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span> (TrueWeight &lt; FalseWeight) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      ColdI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getTrueValue());</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      HotWeight = FalseWeight;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      ColdI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getFalseValue());</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      HotWeight = TrueWeight;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> (ColdI) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      std::stack&lt;Instruction *&gt; ColdSlice;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      getExclBackwardsSlice(ColdI, ColdSlice, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> SliceCost = 0;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">while</span> (!ColdSlice.empty()) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        SliceCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(ColdSlice.top(),</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                             <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba81b2c6f1f1e13e4a575e6d1c8b29b6e1">TargetTransformInfo::TCK_Latency</a>);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        ColdSlice.pop();</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="comment">// The colder the cold value operand of the select is the more expensive</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">// the cmov becomes for computing the cold value operand every time. Thus,</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="comment">// the colder the cold operand is the more its cost counts.</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// Get nearest integer cost adjusted for coldness.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> AdjSliceCost =</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          <a class="code" href="namespacellvm.html#a646699d7e9479783d02a368364310c67">divideNearest</a>(SliceCost * HotWeight, TotalWeight);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span> (AdjSliceCost &gt;=</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          <a class="code" href="SelectOptimize_8cpp.html#a9a3adbb1e07982c9153b848f65a65e4a">ColdOperandMaxCostMultiplier</a> * <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8">TargetTransformInfo::TCC_Expensive</a>)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">// Check if it is safe to move LoadI next to the SI.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">// Conservatively assume it is safe only if there is no instruction</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">// modifying memory in-between the load and the select instruction.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="SelectOptimize_8cpp.html#a011daeefef283046fe04a47f46d857ef">  735</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SelectOptimize_8cpp.html#a011daeefef283046fe04a47f46d857ef">isSafeToSinkLoad</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *LoadI, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="comment">// Assume loads from different basic blocks are unsafe to move.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span> (LoadI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent())</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keyword">auto</span> It = LoadI-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">while</span> (&amp;*It != <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (It-&gt;mayWriteToMemory())</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    It++;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">// For a given source instruction, collect its backwards dependence slice</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">// consisting of instructions exclusively computed for the purpose of producing</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">// the operands of the source instruction. As an approximation</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">// (sufficiently-accurate in practice), we populate this set with the</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">// instructions of the backwards dependence slice that only have one-use and</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">// form an one-use chain that leads to the source instruction.</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordtype">void</span> SelectOptimize::getExclBackwardsSlice(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                           std::stack&lt;Instruction *&gt; &amp;Slice,</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                           <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keywordtype">bool</span> ForSinking) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 2&gt;</a> Visited;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  std::queue&lt;Instruction *&gt; Worklist;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  Worklist.push(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *II = Worklist.front();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    Worklist.pop();</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// Avoid cycles.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(II).second)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (!II-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>())</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">// Cannot soundly sink instructions with side-effects.</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// Terminator or phi instructions cannot be sunk.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// Avoid sinking other select instructions (should be handled separetely).</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (ForSinking &amp;&amp; (II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">isTerminator</a>() || II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">mayHaveSideEffects</a>() ||</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                       isa&lt;SelectInst&gt;(II) || isa&lt;PHINode&gt;(II)))</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// Avoid sinking loads in order not to skip state-modifying instructions,</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// that may alias with the loaded address.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// Only allow sinking of loads within the same basic block that are</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// conservatively proven to be safe.</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (ForSinking &amp;&amp; II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9149819221d66953ac6c2938b87f0136">mayReadFromMemory</a>() &amp;&amp; !<a class="code" href="SelectOptimize_8cpp.html#a011daeefef283046fe04a47f46d857ef">isSafeToSinkLoad</a>(II, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// Avoid considering instructions with less frequency than the source</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// instruction (i.e., avoid colder code regions of the dependence slice).</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>-&gt;getBlockFreq(II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) &lt; <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>-&gt;getBlockFreq(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()))</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// Eligible one-use instruction added to the dependence slice.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    Slice.push(II);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">// Explore all the operands of the current instruction to expand the slice.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; II-&gt;<a class="code" href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">getNumOperands</a>(); ++k)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *OpI = dyn_cast&lt;Instruction&gt;(II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(k)))</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        Worklist.push(OpI);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;}</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::isSelectHighlyPredictable(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TrueWeight, FalseWeight;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ac19cbbc4935a23e1d44f65e1eaba6b1d">extractBranchWeights</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, TrueWeight, FalseWeight)) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1pdb.html#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(TrueWeight, FalseWeight);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Sum = TrueWeight + FalseWeight;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">if</span> (Sum != 0) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keyword">auto</span> Probability = <a class="code" href="classllvm_1_1BranchProbability.html#a0333345669e75a54c7de3d5fe0f6e746">BranchProbability::getBranchProbability</a>(Max, Sum);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (Probability &gt; <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a99b320fd35acaf648a0a7826a0bdd777">getPredictableBranchThreshold</a>())</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;}</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::checkLoopHeuristics(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                         <span class="keyword">const</span> CostInfo LoopCost[2]) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// Loop-level checks to determine if a non-predicated version (with branches)</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// of the loop is more profitable than its predicated version.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SelectOptimize_8cpp.html#a98e27e67cea9203143b6573737429c0b">DisableLoopLevelHeuristics</a>)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> ORmissL(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                   L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (LoopCost[0].NonPredCost &gt; LoopCost[0].PredCost ||</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      LoopCost[1].NonPredCost &gt;= LoopCost[1].PredCost) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    ORmissL &lt;&lt; <span class="stringliteral">&quot;No select conversion in the loop due to no reduction of loop&#39;s &quot;</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;               <span class="stringliteral">&quot;critical path. &quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmissL);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> Gain[2] = {LoopCost[0].PredCost - LoopCost[0].NonPredCost,</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                      LoopCost[1].PredCost - LoopCost[1].NonPredCost};</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// Profitably converting to branches need to reduce the loop&#39;s critical path</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// by at least some threshold (absolute gain of GainCycleThreshold cycles and</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// relative gain of 12.5%).</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (Gain[1] &lt; <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(<a class="code" href="SelectOptimize_8cpp.html#aae2afa0fa53d26e800f466c0f7f58c67">GainCycleThreshold</a>) ||</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      Gain[1] * <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(<a class="code" href="SelectOptimize_8cpp.html#aa9f0da0c38c7e72bc418897c343e9fca">GainRelativeThreshold</a>) &lt; LoopCost[1].PredCost) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> RelativeGain = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(100) * Gain[1] / LoopCost[1].PredCost;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    ORmissL &lt;&lt; <span class="stringliteral">&quot;No select conversion in the loop due to small reduction of &quot;</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;               <span class="stringliteral">&quot;loop&#39;s critical path. Gain=&quot;</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            &lt;&lt; Gain[1].<a class="code" href="classllvm_1_1ScaledNumber.html#a628cc55e3eb3abc28be11f6fb90b948a">toString</a>()</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, RelativeGain=&quot;</span> &lt;&lt; RelativeGain.<a class="code" href="classllvm_1_1ScaledNumber.html#a628cc55e3eb3abc28be11f6fb90b948a">toString</a>() &lt;&lt; <span class="stringliteral">&quot;%. &quot;</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmissL);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">// If the loop&#39;s critical path involves loop-carried dependences, the gradient</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// of the gain needs to be at least GainGradientThreshold% (defaults to 25%).</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// This check ensures that the latency reduction for the loop&#39;s critical path</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// keeps decreasing with sufficient rate beyond the two analyzed loop</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// iterations.</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordflow">if</span> (Gain[1] &gt; Gain[0]) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> GradientGain = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(100) * (Gain[1] - Gain[0]) /</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                            (LoopCost[1].PredCost - LoopCost[0].PredCost);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (GradientGain &lt; <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(<a class="code" href="SelectOptimize_8cpp.html#a4daea2175d48636809e21d8be21d508b">GainGradientThreshold</a>)) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      ORmissL &lt;&lt; <span class="stringliteral">&quot;No select conversion in the loop due to small gradient gain. &quot;</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                 <span class="stringliteral">&quot;GradientGain=&quot;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;              &lt;&lt; GradientGain.<a class="code" href="classllvm_1_1ScaledNumber.html#a628cc55e3eb3abc28be11f6fb90b948a">toString</a>() &lt;&lt; <span class="stringliteral">&quot;%. &quot;</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmissL);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">// If the gain decreases it is not profitable to convert.</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Gain[1] &lt; Gain[0]) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    ORmissL</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;No select conversion in the loop due to negative gradient gain. &quot;</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmissL);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">// Non-predicated version of the loop is more profitable than its</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// predicated version.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">// Computes instruction and loop-critical-path costs for both the predicated</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">// and non-predicated version of the given loop.</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">// Returns false if unable to compute these costs due to invalid cost of loop</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">// instruction(s).</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::computeLoopCosts(</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> SelectGroups &amp;SIGroups,</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Instruction *, CostInfo&gt;</a> &amp;InstCostMap, CostInfo *LoopCost) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Calculating Latency / IPredCost / INonPredCost of loop &quot;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    &lt;&lt; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;SIset = getSIset(SIGroups);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// Compute instruction and loop-critical-path costs across two iterations for</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// both predicated and non-predicated version.</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Iterations = 2;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Iter = 0; Iter &lt; Iterations; ++Iter) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// Cost of the loop&#39;s critical path.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    CostInfo &amp;MaxCost = LoopCost[Iter];</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a5cc113cb783ab6e5ca7b69241431c19c">getBlocks</a>()) {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isDebugOrPseudoInst())</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">// Compute the predicated and non-predicated cost of the instruction.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> IPredCost = Scaled64::getZero(),</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                 INonPredCost = Scaled64::getZero();</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="comment">// Assume infinite resources that allow to fully exploit the available</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="comment">// instruction-level parallelism.</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="comment">// InstCost = InstLatency + max(Op1Cost, Op2Cost,  OpNCost)</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands()) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <span class="keyword">auto</span> UI = dyn_cast&lt;Instruction&gt;(U.get());</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="keywordflow">if</span> (!UI)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          <span class="keywordflow">if</span> (InstCostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(UI)) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            IPredCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(IPredCost, InstCostMap[UI].PredCost);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            INonPredCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(INonPredCost, InstCostMap[UI].NonPredCost);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keyword">auto</span> ILatency = computeInstCost(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">if</span> (!ILatency) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;          <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> ORmissL(<a class="code" href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectOpti&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          ORmissL &lt;&lt; <span class="stringliteral">&quot;Invalid instruction cost preventing analysis and &quot;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                     <span class="stringliteral">&quot;optimization of the inner-most loop containing this &quot;</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                     <span class="stringliteral">&quot;instruction. &quot;</span>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          <a class="code" href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a>(ORE, ORmissL);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        IPredCost += <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(*ILatency);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        INonPredCost += <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(*ILatency);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="comment">// For a select that can be converted to branch,</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// compute its cost as a branch (non-predicated cost).</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">// BranchCost = PredictedPathCost + MispredictCost</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="comment">// PredictedPathCost = TrueOpCost * TrueProb + FalseOpCost * FalseProb</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="comment">// MispredictCost = max(MispredictPenalty, CondCost) * MispredictRate</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">if</span> (SIset.contains(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="keyword">auto</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = cast&lt;SelectInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> TrueOpCost = Scaled64::getZero(),</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                   FalseOpCost = Scaled64::getZero();</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *TI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getTrueValue()))</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">if</span> (InstCostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(TI))</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;              TrueOpCost = InstCostMap[TI].NonPredCost;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *FI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getFalseValue()))</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">if</span> (InstCostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(FI))</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;              FalseOpCost = InstCostMap[FI].NonPredCost;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;          <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> PredictedPathCost =</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              getPredictedPathCost(TrueOpCost, FalseOpCost, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> CondCost = Scaled64::getZero();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CI = dyn_cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition()))</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="keywordflow">if</span> (InstCostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(CI))</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;              CondCost = InstCostMap[CI].NonPredCost;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;          <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> MispredictCost = getMispredictionCost(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, CondCost);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          INonPredCost = PredictedPathCost + MispredictCost;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ILatency &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; IPredCost &lt;&lt; <span class="stringliteral">&quot;/&quot;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                          &lt;&lt; INonPredCost &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        InstCostMap[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = {IPredCost, INonPredCost};</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        MaxCost.PredCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(MaxCost.PredCost, IPredCost);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        MaxCost.NonPredCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(MaxCost.NonPredCost, INonPredCost);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Iteration &quot;</span> &lt;&lt; Iter + 1</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; MaxCost = &quot;</span> &lt;&lt; MaxCost.PredCost &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                      &lt;&lt; MaxCost.NonPredCost &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;}</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Instruction *, 2&gt;</a></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;SelectOptimize::getSIset(<span class="keyword">const</span> SelectGroups &amp;SIGroups) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Instruction *, 2&gt;</a> SIset;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> SelectGroup &amp;ASI : SIGroups)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : ASI)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      SIset.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">return</span> SIset;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;}</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;std::optional&lt;uint64_t&gt; SelectOptimize::computeInstCost(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> ICost =</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba81b2c6f1f1e13e4a575e6d1c8b29b6e1">TargetTransformInfo::TCK_Latency</a>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1SystemZISD.html#a24fe7decb4ebdd8b4c7a774d65fcaa7ea6908fddc602ce5a12ea10c07af44a9ef">OC</a> = ICost.<a class="code" href="classllvm_1_1InstructionCost.html#aefaba3912f52186ea896035ea0f5b00c">getValue</a>())</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">return</span> std::optional&lt;uint64_t&gt;(*<a class="code" href="namespacellvm_1_1SystemZISD.html#a24fe7decb4ebdd8b4c7a774d65fcaa7ea6908fddc602ce5a12ea10c07af44a9ef">OC</a>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;}</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<a class="code" href="classllvm_1_1ScaledNumber.html">ScaledNumber&lt;uint64_t&gt;</a></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;SelectOptimize::getMispredictionCost(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> CondCost) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MispredictPenalty = TSchedModel.getMCSchedModel()-&gt;MispredictPenalty;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="comment">// Account for the default misprediction rate when using a branch</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="comment">// (conservatively set to 25% by default).</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MispredictRate = <a class="code" href="SelectOptimize_8cpp.html#ad441df3dd94fa519afd51bac25947eda">MispredictDefaultRate</a>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="comment">// If the select condition is obviously predictable, then the misprediction</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="comment">// rate is zero.</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">if</span> (isSelectHighlyPredictable(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    MispredictRate = 0;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// CondCost is included to account for cases where the computation of the</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// condition is part of a long dependence chain (potentially loop-carried)</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// that would delay detection of a misprediction and increase its cost.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> MispredictCost =</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(MispredictPenalty), CondCost) *</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(MispredictRate);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  MispredictCost /= <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(100);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keywordflow">return</span> MispredictCost;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;}</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">// Returns the cost of a branch when the prediction is correct.</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">// TrueCost * TrueProbability + FalseCost * FalseProbability.</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<a class="code" href="classllvm_1_1ScaledNumber.html">ScaledNumber&lt;uint64_t&gt;</a></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;SelectOptimize::getPredictedPathCost(<a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> TrueCost, <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> FalseCost,</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="classllvm_1_1ScaledNumber.html">Scaled64</a> PredPathCost;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TrueWeight, FalseWeight;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ac19cbbc4935a23e1d44f65e1eaba6b1d">extractBranchWeights</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, TrueWeight, FalseWeight)) {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SumWeight = TrueWeight + FalseWeight;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">if</span> (SumWeight != 0) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      PredPathCost = TrueCost * <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(TrueWeight) +</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                     FalseCost * <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(FalseWeight);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      PredPathCost /= <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(SumWeight);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordflow">return</span> PredPathCost;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">// Without branch weight metadata, we assume 75% for the one path and 25% for</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">// the other, and pick the result with the biggest cost.</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  PredPathCost = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(TrueCost * <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(3) + FalseCost,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                          FalseCost * <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(3) + TrueCost);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  PredPathCost /= <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">Scaled64::get</a>(4);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">return</span> PredPathCost;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;}</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keywordtype">bool</span> SelectOptimize::isSelectKindSupported(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordtype">bool</span> VectorCond = !<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition()-&gt;getType()-&gt;isIntegerTy(1);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">if</span> (VectorCond)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="code" href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cd">TargetLowering::SelectSupportKind</a> SelectKind;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getType()-&gt;isVectorTy())</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    SelectKind = <a class="code" href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda14714058f9e9eb27b0a4ec62d23bddd5">TargetLowering::ScalarCondVectorVal</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    SelectKind = <a class="code" href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda87a93c29e9b581a0845c5cd878a8d3b7">TargetLowering::ScalarValSelect</a>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">return</span> TLI-&gt;isSelectSupported(SelectKind);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionCost_html"><div class="ttname"><a href="classllvm_1_1InstructionCost.html">llvm::InstructionCost</a></div><div class="ttdef"><b>Definition:</b> <a href="InstructionCost_8h_source.html#l00029">InstructionCost.h:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a7653277511df1034148a37520a585bb5"><div class="ttname"><a href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">llvm::Instruction::isTerminator</a></div><div class="ttdeci">bool isTerminator() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00171">Instruction.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8">llvm::TargetTransformInfo::TCC_Expensive</a></div><div class="ttdeci">@ TCC_Expensive</div><div class="ttdoc">The cost of a 'div' instruction on x86.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00269">TargetTransformInfo.h:269</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac77dbedcfd916a5c9b58e753b2678a98"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">llvm::TargetTransformInfo::getInstructionCost</a></div><div class="ttdeci">InstructionCost getInstructionCost(const User *U, ArrayRef&lt; const Value * &gt; Operands, TargetCostKind CostKind) const</div><div class="ttdoc">Estimate the cost of a given IR user when lowered.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00230">TargetTransformInfo.cpp:230</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a11045c7973ab24a8d6315b61fa337d4e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">llvm::SmallPtrSetImpl::erase</a></div><div class="ttdeci">bool erase(PtrType Ptr)</div><div class="ttdoc">erase - If the set contains the specified pointer, remove it and return true, otherwise return false.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00379">SmallPtrSet.h:379</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM_html_a5667e0461a51d2c4887056c3f684c341adf1f3edb9115acb0a1e04209b7a9937b"><div class="ttname"><a href="namespacellvm_1_1ARM.html#a5667e0461a51d2c4887056c3f684c341adf1f3edb9115acb0a1e04209b7a9937b">llvm::ARM::PredBlockMask::TT</a></div><div class="ttdeci">@ TT</div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a7415ab9f2172c59a2ee7c7a02afa56a4">llvm::ISD::OR</a></div><div class="ttdeci">@ OR</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00667">ISDOpcodes.h:667</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bba81b2c6f1f1e13e4a575e6d1c8b29b6e1"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba81b2c6f1f1e13e4a575e6d1c8b29b6e1">llvm::TargetTransformInfo::TCK_Latency</a></div><div class="ttdeci">@ TCK_Latency</div><div class="ttdoc">The latency of instruction.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00243">TargetTransformInfo.h:243</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a011daeefef283046fe04a47f46d857ef"><div class="ttname"><a href="SelectOptimize_8cpp.html#a011daeefef283046fe04a47f46d857ef">isSafeToSinkLoad</a></div><div class="ttdeci">static bool isSafeToSinkLoad(Instruction *LoadI, Instruction *SI)</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00735">SelectOptimize.cpp:735</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a8991a94a0e3635a9af17c74222975838"><div class="ttname"><a href="SelectOptimize_8cpp.html#a8991a94a0e3635a9af17c74222975838">isSpecialSelect</a></div><div class="ttdeci">static bool isSpecialSelect(SelectInst *SI)</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00521">SelectOptimize.cpp:521</a></div></div>
<div class="ttc" id="aHexagonHardwareLoops_8cpp_html_ada7c1594a393ede3ce32602d64d7ddb2"><div class="ttname"><a href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a></div><div class="ttdeci">Hexagon Hardware Loops</div><div class="ttdef"><b>Definition:</b> <a href="HexagonHardwareLoops_8cpp_source.html#l00374">HexagonHardwareLoops.cpp:374</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aSizeOpts_8h_html"><div class="ttname"><a href="SizeOpts_8h.html">SizeOpts.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_af4feec45578e32fe65d8efc59112bc8e"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#af4feec45578e32fe65d8efc59112bc8e">llvm::PatternMatch::m_CombineOr</a></div><div class="ttdeci">match_combine_or&lt; LTy, RTy &gt; m_CombineOr(const LTy &amp;L, const RTy &amp;R)</div><div class="ttdoc">Combine two pattern matchers matching L || R.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00218">PatternMatch.h:218</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a9a3adbb1e07982c9153b848f65a65e4a"><div class="ttname"><a href="SelectOptimize_8cpp.html#a9a3adbb1e07982c9153b848f65a65e4a">ColdOperandMaxCostMultiplier</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ColdOperandMaxCostMultiplier(&quot;cold-operand-max-cost-multiplier&quot;, cl::desc(&quot;Maximum cost multiplier of TCC_expensive for the dependence &quot; &quot;slice of a cold operand to be considered inexpensive.&quot;), cl::init(1), cl::Hidden)</div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1LoopInfoWrapperPass.html">llvm::LoopInfoWrapperPass</a></div><div class="ttdoc">The legacy pass manager's analysis pass to compute loop information.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01293">LoopInfo.h:1293</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a3d495d9a0daf7fe32f1b1fb0aa153929"><div class="ttname"><a href="SelectOptimize_8cpp.html#a3d495d9a0daf7fe32f1b1fb0aa153929">selects</a></div><div class="ttdeci">Optimize selects</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00226">SelectOptimize.cpp:226</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a8dd1128758268fa3aa05eeba358baf3f"><div class="ttname"><a href="SelectOptimize_8cpp.html#a8dd1128758268fa3aa05eeba358baf3f">getTrueOrFalseValue</a></div><div class="ttdeci">static Value * getTrueOrFalseValue(SelectInst *SI, bool isTrue, const SmallPtrSet&lt; const Instruction *, 2 &gt; &amp;Selects)</div><div class="ttdoc">If isTrue is true, return the true value of SI, otherwise return false value of SI.</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00321">SelectOptimize.cpp:321</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a52c990590792c91dd20b6d45acebe359"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00401">BasicBlock.cpp:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a53408c95a7bfb5443b43fb2134c3eb23"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">Return 1 if the specified key is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00145">DenseMap.h:145</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchProbability_html_a0333345669e75a54c7de3d5fe0f6e746"><div class="ttname"><a href="classllvm_1_1BranchProbability.html#a0333345669e75a54c7de3d5fe0f6e746">llvm::BranchProbability::getBranchProbability</a></div><div class="ttdeci">static BranchProbability getBranchProbability(uint64_t Numerator, uint64_t Denominator)</div><div class="ttdef"><b>Definition:</b> <a href="BranchProbability_8cpp_source.html#l00053">BranchProbability.cpp:53</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_aa9f0da0c38c7e72bc418897c343e9fca"><div class="ttname"><a href="SelectOptimize_8cpp.html#aa9f0da0c38c7e72bc418897c343e9fca">GainRelativeThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; GainRelativeThreshold(&quot;select-opti-loop-relative-gain-threshold&quot;, cl::desc(&quot;Minimum relative gain per loop threshold (1/X). Defaults to 12.5%&quot;), cl::init(8), cl::Hidden)</div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a99b320fd35acaf648a0a7826a0bdd777"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a99b320fd35acaf648a0a7826a0bdd777">llvm::TargetTransformInfo::getPredictableBranchThreshold</a></div><div class="ttdeci">BranchProbability getPredictableBranchThreshold() const</div><div class="ttdoc">If a branch or a select condition is skewed in one direction by more than this factor,...</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00239">TargetTransformInfo.cpp:239</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aclassllvm_1_1DiagnosticInfoOptimizationBase_html"><div class="ttname"><a href="classllvm_1_1DiagnosticInfoOptimizationBase.html">llvm::DiagnosticInfoOptimizationBase</a></div><div class="ttdoc">Common features for diagnostics dealing with optimization remarks that are used by both IR and MIR pa...</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00413">DiagnosticInfo.h:413</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9149819221d66953ac6c2938b87f0136"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9149819221d66953ac6c2938b87f0136">llvm::Instruction::mayReadFromMemory</a></div><div class="ttdeci">bool mayReadFromMemory() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction may read memory.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00626">Instruction.cpp:626</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aTargetLowering_8h_html"><div class="ttname"><a href="TargetLowering_8h.html">TargetLowering.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html">llvm::BlockFrequencyInfo</a></div><div class="ttdoc">BlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate IR basic block frequen...</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00037">BlockFrequencyInfo.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3af72f14ea20f2c762c751d2d49e5ea3"><div class="ttname"><a href="namespacellvm.html#a3af72f14ea20f2c762c751d2d49e5ea3">llvm::shouldOptimizeForSize</a></div><div class="ttdeci">bool shouldOptimizeForSize(const MachineFunction *MF, ProfileSummaryInfo *PSI, const MachineBlockFrequencyInfo *BFI, PGSOQueryType QueryType=PGSOQueryType::Other)</div><div class="ttdoc">Returns true if machine function MF is suggested to be size-optimized based on the profile.</div><div class="ttdef"><b>Definition:</b> <a href="MachineSizeOpts_8cpp_source.html#l00183">MachineSizeOpts.cpp:183</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_a93a29cd4a753518a59c20c1b6ec88c76"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a93a29cd4a753518a59c20c1b6ec88c76">llvm::SelectInst::getCondition</a></div><div class="ttdeci">const Value * getCondition() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01793">Instructions.h:1793</a></div></div>
<div class="ttc" id="aTarget_2TargetMachine_8h_html"><div class="ttname"><a href="Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLowering_html"><div class="ttname"><a href="classllvm_1_1TargetLowering.html">llvm::TargetLowering</a></div><div class="ttdoc">This class defines information used to lower LLVM code to legal SelectionDAG operators that the targe...</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l03515">TargetLowering.h:3515</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchProbabilityInfo_html"><div class="ttname"><a href="classllvm_1_1BranchProbabilityInfo.html">llvm::BranchProbabilityInfo</a></div><div class="ttdoc">Analysis providing branch probability information.</div><div class="ttdef"><b>Definition:</b> <a href="BranchProbabilityInfo_8h_source.html#l00113">BranchProbabilityInfo.h:113</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a5cc113cb783ab6e5ca7b69241431c19c"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a5cc113cb783ab6e5ca7b69241431c19c">llvm::LoopBase::getBlocks</a></div><div class="ttdeci">ArrayRef&lt; BlockT * &gt; getBlocks() const</div><div class="ttdoc">Get a list of the basic blocks which make up this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00188">LoopInfo.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeWrapperPass_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeWrapperPass.html">llvm::DominatorTreeWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00314">Dominators.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a46ef6115027606b67adcf4d28f3dac17"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">const Instruction * getFirstNonPHI() const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00208">BasicBlock.cpp:208</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00059">PassSupport.h:59</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00040">ProfileSummaryInfo.h:40</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aCodeGen_2Passes_8h_html"><div class="ttname"><a href="CodeGen_2Passes_8h.html">Passes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetPassConfig_html"><div class="ttname"><a href="classllvm_1_1TargetPassConfig.html">llvm::TargetPassConfig</a></div><div class="ttdoc">Target-Independent Code Generator Pass Configuration Options.</div><div class="ttdef"><b>Definition:</b> <a href="TargetPassConfig_8h_source.html#l00084">TargetPassConfig.h:84</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aTargetSchedule_8h_html"><div class="ttname"><a href="TargetSchedule_8h.html">TargetSchedule.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aBranchProbabilityInfo_8h_html"><div class="ttname"><a href="BranchProbabilityInfo_8h.html">BranchProbabilityInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetSchedModel_html"><div class="ttname"><a href="classllvm_1_1TargetSchedModel.html">llvm::TargetSchedModel</a></div><div class="ttdoc">Provide an instruction scheduling machine model to CodeGen passes.</div><div class="ttdef"><b>Definition:</b> <a href="TargetSchedule_8h_source.html#l00030">TargetSchedule.h:30</a></div></div>
<div class="ttc" id="aProfileSummaryInfo_8h_html"><div class="ttname"><a href="ProfileSummaryInfo_8h.html">ProfileSummaryInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfoWrapperPass.html">llvm::TargetTransformInfoWrapperPass</a></div><div class="ttdoc">Wrapper pass for TargetTransformInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l02682">TargetTransformInfo.h:2682</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a1a06b1cff93069d7403ea03e6150e386"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a1a06b1cff93069d7403ea03e6150e386">llvm::PatternMatch::m_LogicalOr</a></div><div class="ttdeci">LogicalOp_match&lt; LHS, RHS, Instruction::Or &gt; m_LogicalOr(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches L || R either in the form of L | R or L ? true : R.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l02574">PatternMatch.h:2574</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aProfDataUtils_8h_html"><div class="ttname"><a href="ProfDataUtils_8h.html">ProfDataUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a38df51256d4b415b6a817b5e1c6d4d36"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03195">Instructions.h:3195</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46a438dbcc76b79fb10acb447ec5d141287"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a438dbcc76b79fb10acb447ec5d141287">llvm::AArch64PACKey::IB</a></div><div class="ttdeci">@ IB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00792">AArch64BaseInfo.h:792</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfoWrapperPass.html">llvm::ProfileSummaryInfoWrapperPass</a></div><div class="ttdoc">An analysis pass based on legacy pass manager to deliver ProfileSummaryInfo.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00194">ProfileSummaryInfo.h:194</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="aTargetPassConfig_8h_html"><div class="ttname"><a href="TargetPassConfig_8h.html">TargetPassConfig.h</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1TargetMachine_html"><div class="ttname"><a href="classllvm_1_1TargetMachine.html">llvm::TargetMachine</a></div><div class="ttdoc">Primary interface to the complete machine description for the target machine.</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00078">TargetMachine.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SystemZISD_html_a24fe7decb4ebdd8b4c7a774d65fcaa7ea6908fddc602ce5a12ea10c07af44a9ef"><div class="ttname"><a href="namespacellvm_1_1SystemZISD.html#a24fe7decb4ebdd8b4c7a774d65fcaa7ea6908fddc602ce5a12ea10c07af44a9ef">llvm::SystemZISD::OC</a></div><div class="ttdeci">@ OC</div><div class="ttdef"><b>Definition:</b> <a href="SystemZISelLowering_8h_source.html#l00124">SystemZISelLowering.h:124</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionCost_html_aefaba3912f52186ea896035ea0f5b00c"><div class="ttname"><a href="classllvm_1_1InstructionCost.html#aefaba3912f52186ea896035ea0f5b00c">llvm::InstructionCost::getValue</a></div><div class="ttdeci">std::optional&lt; CostType &gt; getValue() const</div><div class="ttdoc">This function is intended to be used as sparingly as possible, since the class provides the full rang...</div><div class="ttdef"><b>Definition:</b> <a href="InstructionCost_8h_source.html#l00087">InstructionCost.h:87</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a98e27e67cea9203143b6573737429c0b"><div class="ttname"><a href="SelectOptimize_8cpp.html#a98e27e67cea9203143b6573737429c0b">DisableLoopLevelHeuristics</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableLoopLevelHeuristics(&quot;disable-loop-level-heuristics&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Disable loop-level heuristics.&quot;))</div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a0becd1956c8f86ceb3b377a215ccd47b"><div class="ttname"><a href="SelectOptimize_8cpp.html#a0becd1956c8f86ceb3b377a215ccd47b">ColdOperandThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ColdOperandThreshold(&quot;cold-operand-threshold&quot;, cl::desc(&quot;Maximum frequency of path for an operand to be considered cold.&quot;), cl::init(20), cl::Hidden)</div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScaledNumber_html_a628cc55e3eb3abc28be11f6fb90b948a"><div class="ttname"><a href="classllvm_1_1ScaledNumber.html#a628cc55e3eb3abc28be11f6fb90b948a">llvm::ScaledNumber::toString</a></div><div class="ttdeci">std::string toString(unsigned Precision=DefaultPrecision)</div><div class="ttdoc">Convert to a decimal representation in a string.</div><div class="ttdef"><b>Definition:</b> <a href="ScaledNumber_8h_source.html#l00596">ScaledNumber.h:596</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_a4daea2175d48636809e21d8be21d508b"><div class="ttname"><a href="SelectOptimize_8cpp.html#a4daea2175d48636809e21d8be21d508b">GainGradientThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; GainGradientThreshold(&quot;select-opti-loop-gradient-gain-threshold&quot;, cl::desc(&quot;Gradient gain threshold (%).&quot;), cl::init(25), cl::Hidden)</div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ace940beeee97c222f836fe0ac70f6cf5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">llvm::BasicBlock::Create</a></div><div class="ttdeci">static BasicBlock * Create(LLVMContext &amp;Context, const Twine &amp;Name=&quot;&quot;, Function *Parent=nullptr, BasicBlock *InsertBefore=nullptr)</div><div class="ttdoc">Creates a new BasicBlock.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00105">BasicBlock.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aTargetSubtargetInfo_8h_html"><div class="ttname"><a href="TargetSubtargetInfo_8h.html">TargetSubtargetInfo.h</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_aab588fc778ee5107e3aafae0f569143a"><div class="ttname"><a href="SelectOptimize_8cpp.html#aab588fc778ee5107e3aafae0f569143a">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(SelectOptimize, DEBUG_TYPE, &quot;Optimize selects&quot;, false, false) INITIALIZE_PASS_END(SelectOptimize</div></div>
<div class="ttc" id="aBlockFrequencyInfo_8h_html"><div class="ttname"><a href="BlockFrequencyInfo_8h.html">BlockFrequencyInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">llvm::AMDGPUISD::BFI</a></div><div class="ttdeci">@ BFI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00441">AMDGPUISelLowering.h:441</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aScaledNumber_8h_html"><div class="ttname"><a href="ScaledNumber_8h.html">ScaledNumber.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetSubtargetInfo_html"><div class="ttname"><a href="classllvm_1_1TargetSubtargetInfo.html">llvm::TargetSubtargetInfo</a></div><div class="ttdoc">TargetSubtargetInfo - Generic base class for all target subtargets.</div><div class="ttdef"><b>Definition:</b> <a href="TargetSubtargetInfo_8h_source.html#l00062">TargetSubtargetInfo.h:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab706e7ebb1969c5e34f28bfcf2ff719e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00326">BasicBlock.h:326</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6ea260be710ac7b61309534308da3147"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">llvm::Instruction::mayHaveSideEffects</a></div><div class="ttdeci">bool mayHaveSideEffects() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction may have side effects.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00745">Instruction.cpp:745</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_aae2afa0fa53d26e800f466c0f7f58c67"><div class="ttname"><a href="SelectOptimize_8cpp.html#aae2afa0fa53d26e800f466c0f7f58c67">GainCycleThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; GainCycleThreshold(&quot;select-opti-loop-cycle-gain-threshold&quot;, cl::desc(&quot;Minimum gain per loop (in cycles) threshold.&quot;), cl::init(4), cl::Hidden)</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a323444895ce923a737f0a7af82a30f54"><div class="ttname"><a href="classllvm_1_1Instruction.html#a323444895ce923a737f0a7af82a30f54">llvm::Instruction::isDebugOrPseudoInst</a></div><div class="ttdeci">bool isDebugOrPseudoInst() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction is a DbgInfoIntrinsic or PseudoProbeInst.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00781">Instruction.cpp:781</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition:</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00085">EntryExitInstrumenter.cpp:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a16165c1e5da45acaa086c3a54a188d34"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">llvm::LoopBase::isInnermost</a></div><div class="ttdeci">bool isInnermost() const</div><div class="ttdoc">Return true if the loop does not contain any (natural) loops.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00182">LoopInfo.h:182</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScaledNumber_html"><div class="ttname"><a href="classllvm_1_1ScaledNumber.html">llvm::ScaledNumber&lt; uint64_t &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterWrapperPass_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterWrapperPass.html">llvm::OptimizationRemarkEmitterWrapperPass</a></div><div class="ttdoc">OptimizationRemarkEmitter legacy analysis pass.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00146">OptimizationRemarkEmitter.h:146</a></div></div>
<div class="ttc" id="aclassllvm_1_1DiagnosticInfoOptimizationBase_html_a579ac4d6814d2caddee0904ca72250c7"><div class="ttname"><a href="classllvm_1_1DiagnosticInfoOptimizationBase.html#a579ac4d6814d2caddee0904ca72250c7">llvm::DiagnosticInfoOptimizationBase::getMsg</a></div><div class="ttdeci">std::string getMsg() const</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8cpp_source.html#l00394">DiagnosticInfo.cpp:394</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2cedf757f360f8a9b439d7ff9dcdd981"><div class="ttname"><a href="namespacellvm.html#a2cedf757f360f8a9b439d7ff9dcdd981">llvm::createSelectOptimizePass</a></div><div class="ttdeci">FunctionPass * createSelectOptimizePass()</div><div class="ttdoc">This pass converts conditional moves to conditional jumps when profitable.</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00229">SelectOptimize.cpp:229</a></div></div>
<div class="ttc" id="alib_2Target_2PowerPC_2README_8txt_html_aa91241c8c54738377749dc47ee489e0d"><div class="ttname"><a href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">get</a></div><div class="ttdeci">Should compile to something r4 addze r3 instead we get</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2PowerPC_2README_8txt_source.html#l00024">README.txt:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLoweringBase_html_a575e134a5e8414029a5c4a284858e6cda87a93c29e9b581a0845c5cd878a8d3b7"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda87a93c29e9b581a0845c5cd878a8d3b7">llvm::TargetLoweringBase::ScalarValSelect</a></div><div class="ttdeci">@ ScalarValSelect</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00239">TargetLowering.h:239</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="SelectOptimize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00045">SelectOptimize.cpp:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLoweringBase_html_a575e134a5e8414029a5c4a284858e6cda57d13a184979a5a9b7110c20e9d6f55d"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda57d13a184979a5a9b7110c20e9d6f55d">llvm::TargetLoweringBase::VectorMaskSelect</a></div><div class="ttdeci">@ VectorMaskSelect</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00242">TargetLowering.h:242</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad3854d85c03c0c709977e3625cb8158b"><div class="ttname"><a href="namespacellvm.html#ad3854d85c03c0c709977e3625cb8158b">llvm::initializeSelectOptimizePass</a></div><div class="ttdeci">void initializeSelectOptimizePass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_addec638786f763d967811b45cb662f1f"><div class="ttname"><a href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00191">User.h:191</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">llvm::pdb::DbgHeaderType::Max</a></div><div class="ttdeci">@ Max</div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_ae02f5a84142c2d7909ce301489a6adef"><div class="ttname"><a href="SelectOptimize_8cpp.html#ae02f5a84142c2d7909ce301489a6adef">EmitAndPrintRemark</a></div><div class="ttdeci">static void EmitAndPrintRemark(OptimizationRemarkEmitter *ORE, DiagnosticInfoOptimizationBase &amp;Rem)</div><div class="ttdef"><b>Definition:</b> <a href="SelectOptimize_8cpp_source.html#l00576">SelectOptimize.cpp:576</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLoweringBase_html_a575e134a5e8414029a5c4a284858e6cda14714058f9e9eb27b0a4ec62d23bddd5"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cda14714058f9e9eb27b0a4ec62d23bddd5">llvm::TargetLoweringBase::ScalarCondVectorVal</a></div><div class="ttdeci">@ ScalarCondVectorVal</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00240">TargetLowering.h:240</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a72110d5a1a43e21651a36bd96cfdec98"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a72110d5a1a43e21651a36bd96cfdec98">llvm::TargetTransformInfo::enableSelectOptimize</a></div><div class="ttdeci">bool enableSelectOptimize() const</div><div class="ttdoc">Should the Select Optimization pass be enabled and ran.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00558">TargetTransformInfo.cpp:558</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00047">PatternMatch.h:47</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ab76052bb166c65901edb603a3e1f03ab"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a></div><div class="ttdeci">const char LLVMTargetMachineRef TM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00047">PassBuilderBindings.cpp:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac19cbbc4935a23e1d44f65e1eaba6b1d"><div class="ttname"><a href="namespacellvm.html#ac19cbbc4935a23e1d44f65e1eaba6b1d">llvm::extractBranchWeights</a></div><div class="ttdeci">bool extractBranchWeights(const MDNode *ProfileData, SmallVectorImpl&lt; uint32_t &gt; &amp;Weights)</div><div class="ttdoc">Extract branch weights from MD_prof metadata.</div><div class="ttdef"><b>Definition:</b> <a href="ProfDataUtils_8cpp_source.html#l00122">ProfDataUtils.cpp:122</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="aSelectOptimize_8cpp_html_ad441df3dd94fa519afd51bac25947eda"><div class="ttname"><a href="SelectOptimize_8cpp.html#ad441df3dd94fa519afd51bac25947eda">MispredictDefaultRate</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MispredictDefaultRate(&quot;mispredict-default-rate&quot;, cl::Hidden, cl::init(25), cl::desc(&quot;Default mispredict rate (initialized to 25%).&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00381">Value.cpp:381</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="anamespacellvm_html_a646699d7e9479783d02a368364310c67"><div class="ttname"><a href="namespacellvm.html#a646699d7e9479783d02a368364310c67">llvm::divideNearest</a></div><div class="ttdeci">uint64_t divideNearest(uint64_t Numerator, uint64_t Denominator)</div><div class="ttdoc">Returns the integer nearest(Numerator / Denominator).</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00527">MathExtras.h:527</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLoweringBase_html_a575e134a5e8414029a5c4a284858e6cd"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a575e134a5e8414029a5c4a284858e6cd">llvm::TargetLoweringBase::SelectSupportKind</a></div><div class="ttdeci">SelectSupportKind</div><div class="ttdoc">Enum that describes what type of support for selects the target has.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00238">TargetLowering.h:238</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a213e6c0ca6e838157373b9a6018c0769"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a213e6c0ca6e838157373b9a6018c0769">llvm::PatternMatch::m_LogicalAnd</a></div><div class="ttdeci">LogicalOp_match&lt; LHS, RHS, Instruction::And &gt; m_LogicalAnd(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches L &amp;&amp; R either in the form of L &amp; R or L ? R : false.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l02556">PatternMatch.h:2556</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:01:09 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
