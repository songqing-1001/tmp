<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Utils/CallPromotionUtils.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_f75c00afeb315f44d76556a7c675e6e8.html">Utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CallPromotionUtils.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CallPromotionUtils_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- CallPromotionUtils.cpp - Utilities for call promotion ----*- C++ -*-===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements utilities useful for promoting indirect call sites to</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// direct call sites.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallPromotionUtils_8h.html">llvm/Transforms/Utils/CallPromotionUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Loads_8h.html">llvm/Analysis/Loads.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TypeMetadataUtils_8h.html">llvm/Analysis/TypeMetadataUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="CallPromotionUtils_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   23</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;call-promotion-utils&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/// Fix-up phi nodes in an invoke instruction&#39;s normal destination.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/// After versioning an invoke instruction, values coming from the original</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/// block will now be coming from the &quot;merge&quot; block. For example, in the code</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/// below:</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">///   then_bb:</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">///     %t0 = invoke i32 %ptr() to label %merge_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">///   else_bb:</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">///     %t1 = invoke i32 %ptr() to label %merge_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">///   merge_bb:</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">///     %t2 = phi i32 [ %t0, %then_bb ], [ %t1, %else_bb ]</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">///     br %normal_dst</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">///   normal_dst:</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">///     %t3 = phi i32 [ %x, %orig_bb ], ...</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// &quot;orig_bb&quot; is no longer a predecessor of &quot;normal_dst&quot;, so the phi nodes in</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/// &quot;normal_dst&quot; must be fixed to refer to &quot;merge_bb&quot;:</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">///    normal_dst:</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">///      %t3 = phi i32 [ %x, %merge_bb ], ...</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="CallPromotionUtils_8cpp.html#a51ff57d75f102e980e39535df6ff00bb">   50</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CallPromotionUtils_8cpp.html#a51ff57d75f102e980e39535df6ff00bb">fixupPHINodeForNormalDest</a>(<a class="code" href="classllvm_1_1InvokeInst.html">InvokeInst</a> *Invoke, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigBlock,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *MergeBlock) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;Phi : Invoke-&gt;<a class="code" href="classllvm_1_1InvokeInst.html#a100bd3005ea84bf47f3b4021e8022633">getNormalDest</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> Idx = Phi.getBasicBlockIndex(OrigBlock);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (Idx == -1)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    Phi.setIncomingBlock(Idx, MergeBlock);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/// Fix-up phi nodes in an invoke instruction&#39;s unwind destination.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">/// After versioning an invoke instruction, values coming from the original</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/// block will now be coming from either the &quot;then&quot; block or the &quot;else&quot; block.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">/// For example, in the code below:</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">///   then_bb:</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">///     %t0 = invoke i32 %ptr() to label %merge_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">///   else_bb:</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">///     %t1 = invoke i32 %ptr() to label %merge_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">///   unwind_dst:</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">///     %t3 = phi i32 [ %x, %orig_bb ], ...</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">/// &quot;orig_bb&quot; is no longer a predecessor of &quot;unwind_dst&quot;, so the phi nodes in</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/// &quot;unwind_dst&quot; must be fixed to refer to &quot;then_bb&quot; and &quot;else_bb&quot;:</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">///   unwind_dst:</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">///     %t3 = phi i32 [ %x, %then_bb ], [ %x, %else_bb ], ...</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="CallPromotionUtils_8cpp.html#a59b92d3bbd9b21b61a2afbb73c10c3b0">   81</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CallPromotionUtils_8cpp.html#a59b92d3bbd9b21b61a2afbb73c10c3b0">fixupPHINodeForUnwindDest</a>(<a class="code" href="classllvm_1_1InvokeInst.html">InvokeInst</a> *Invoke, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigBlock,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ThenBlock,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ElseBlock) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;Phi : Invoke-&gt;<a class="code" href="classllvm_1_1InvokeInst.html#a5ba379c3251d99b4c23c8f2e6abe4a6c">getUnwindDest</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">int</span> Idx = Phi.getBasicBlockIndex(OrigBlock);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (Idx == -1)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keyword">auto</span> *V = Phi.getIncomingValue(Idx);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    Phi.setIncomingBlock(Idx, ThenBlock);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    Phi.addIncoming(V, ElseBlock);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/// Create a phi node for the returned value of a call or invoke instruction.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/// After versioning a call or invoke instruction that returns a value, we have</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">/// to merge the value of the original and new instructions. We do this by</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">/// creating a phi node and replacing uses of the original instruction with this</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">/// phi node.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/// For example, if \p OrigInst is defined in &quot;else_bb&quot; and \p NewInst is</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/// defined in &quot;then_bb&quot;, we create the following phi node:</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">///   ; Uses of the original instruction are replaced by uses of the phi node.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">///   %t0 = phi i32 [ %orig_inst, %else_bb ], [ %new_inst, %then_bb ],</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="CallPromotionUtils_8cpp.html#abdf3ba57973320bd702d3b12b0b8fa8c">  107</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CallPromotionUtils_8cpp.html#abdf3ba57973320bd702d3b12b0b8fa8c">createRetPHINode</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OrigInst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewInst,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                             <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *MergeBlock, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (OrigInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>() || OrigInst-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;MergeBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(OrigInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;User *, 16&gt;</a> UsersToUpdate(OrigInst-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>());</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : UsersToUpdate)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    U-&gt;replaceUsesOfWith(OrigInst, Phi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(OrigInst, OrigInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewInst, NewInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/// Cast a call or invoke instruction to the given type.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">/// When promoting a call site, the return type of the call site might not match</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/// that of the callee. If this is the case, we have to cast the returned value</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/// to the correct type. The location of the cast depends on if we have a call</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/// or invoke instruction.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/// For example, if the call instruction below requires a bitcast after</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/// promotion:</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">///     %t0 = call i32 @func()</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">///     ...</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/// The bitcast is placed after the call instruction:</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">///     ; Uses of the original return value are replaced by uses of the bitcast.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">///     %t0 = call i32 @func()</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">///     %t1 = bitcast i32 %t0 to ...</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">///     ...</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">/// A similar transformation is performed for invoke instructions. However,</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/// since invokes are terminating, a new block is created for the bitcast. For</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/// example, if the invoke instruction below requires a bitcast after promotion:</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">///     %t0 = invoke i32 @func() to label %normal_dst unwind label %unwind_dst</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/// The edge between the original block and the invoke&#39;s normal destination is</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/// split, and the bitcast is placed there:</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">///     %t0 = invoke i32 @func() to label %split_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">///   split_bb:</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">///     ; Uses of the original return value are replaced by uses of the bitcast.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">///     %t1 = bitcast i32 %t0 to ...</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">///     br label %normal_dst</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="CallPromotionUtils_8cpp.html#a8c9ae0be5e6bcad90cdf141962a117f3">  162</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CallPromotionUtils_8cpp.html#a8c9ae0be5e6bcad90cdf141962a117f3">createRetBitCast</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1Type.html">Type</a> *RetTy, <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> **RetBitCast) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// Save the users of the calling instruction. These uses will be changed to</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// use the bitcast after we create it.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;User *, 16&gt;</a> UsersToUpdate(CB.<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// Determine an appropriate location to create the bitcast for the return</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// value. The location depends on if we have a call or invoke instruction.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertBefore = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Invoke = dyn_cast&lt;InvokeInst&gt;(&amp;CB))</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    InsertBefore =</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        &amp;<a class="code" href="namespacellvm.html#adf83581f514774264d616eef5706cf6e">SplitEdge</a>(Invoke-&gt;getParent(), Invoke-&gt;getNormalDest())-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    InsertBefore = &amp;*std::next(CB.<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// Bitcast the return value to the correct type.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keyword">auto</span> *Cast = <a class="code" href="classllvm_1_1CastInst.html#a31d2885660f654b31d8741726c3ea8d9">CastInst::CreateBitOrPointerCast</a>(&amp;CB, RetTy, <span class="stringliteral">&quot;&quot;</span>, InsertBefore);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (RetBitCast)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    *RetBitCast = Cast;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// Replace all the original uses of the calling instruction with the bitcast.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : UsersToUpdate)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    U-&gt;<a class="code" href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">replaceUsesOfWith</a>(&amp;CB, Cast);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/// Predicate and clone the given call site.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">/// This function creates an if-then-else structure at the location of the call</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/// site. The &quot;if&quot; condition compares the call site&#39;s called value to the given</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/// callee. The original call site is moved into the &quot;else&quot; block, and a clone</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/// of the call site is placed in the &quot;then&quot; block. The cloned instruction is</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/// returned.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/// For example, the call instruction below:</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">///     %t0 = call i32 %ptr()</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">///     ...</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">/// Is replace by the following:</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">///     %cond = icmp eq i32 ()* %ptr, @func</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">///     br i1 %cond, %then_bb, %else_bb</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">///   then_bb:</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">///     ; The clone of the original call instruction is placed in the &quot;then&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">///     ; block. It is not yet promoted.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">///     %t1 = call i32 %ptr()</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">///     br merge_bb</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">///   else_bb:</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">///     ; The original call instruction is moved to the &quot;else&quot; block.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">///     %t0 = call i32 %ptr()</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">///     br merge_bb</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">///   merge_bb:</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">///     ; Uses of the original call instruction are replaced by uses of the phi</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">///     ; node.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">///     %t2 = phi i32 [ %t0, %else_bb ], [ %t1, %then_bb ]</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">///     ...</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/// A similar transformation is performed for invoke instructions. However,</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">/// since invokes are terminating, more work is required. For example, the</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">/// invoke instruction below:</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">///     %t0 = invoke %ptr() to label %normal_dst unwind label %unwind_dst</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/// Is replace by the following:</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">///     %cond = icmp eq i32 ()* %ptr, @func</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">///     br i1 %cond, %then_bb, %else_bb</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">///   then_bb:</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">///     ; The clone of the original invoke instruction is placed in the &quot;then&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">///     ; block, and its normal destination is set to the &quot;merge&quot; block. It is</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">///     ; not yet promoted.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">///     %t1 = invoke i32 %ptr() to label %merge_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">///   else_bb:</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">///     ; The original invoke instruction is moved into the &quot;else&quot; block, and</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">///     ; its normal destination is set to the &quot;merge&quot; block.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">///     %t0 = invoke i32 %ptr() to label %merge_bb unwind label %unwind_dst</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">///   merge_bb:</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">///     ; Uses of the original invoke instruction are replaced by uses of the</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">///     ; phi node, and the merge block branches to the normal destination.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">///     %t2 = phi i32 [ %t0, %else_bb ], [ %t1, %then_bb ]</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">///     br %normal_dst</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">/// An indirect musttail call is processed slightly differently in that:</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">/// 1. No merge block needed for the orginal and the cloned callsite, since</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">///    either one ends the flow. No phi node is needed either.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/// 2. The return statement following the original call site is duplicated too</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">///    and placed immediately after the cloned call site per the IR convention.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/// For example, the musttail call instruction below:</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">///     %t0 = musttail call i32 %ptr()</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">///     ...</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/// Is replaced by the following:</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">///   cond_bb:</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">///     %cond = icmp eq i32 ()* %ptr, @func</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">///     br i1 %cond, %then_bb, %orig_bb</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">///   then_bb:</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">///     ; The clone of the original call instruction is placed in the &quot;then&quot;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">///     ; block. It is not yet promoted.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">///     %t1 = musttail call i32 %ptr()</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">///     ret %t1</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">///   orig_bb:</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">///     ; The original call instruction stays in its original block.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">///     %t0 = musttail call i32 %ptr()</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">///     ret %t0</span></div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="namespacellvm.html#a84163d559062da6b736ab943644e0a16">  282</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm.html#a84163d559062da6b736ab943644e0a16">llvm::versionCallSite</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1Value.html">Value</a> *Callee,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *BranchWeights) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(&amp;CB);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *OrigInst = &amp;CB;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigBlock = OrigInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Create the compare. The called value and callee must have the same type to</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// be compared.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span> (CB.<a class="code" href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">getCalledOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getType())</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, CB.<a class="code" href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">getCalledOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpEQ(CB.<a class="code" href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">getCalledOperand</a>(), <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span> (OrigInst-&gt;<a class="code" href="classllvm_1_1CallBase.html#a50426b12f4acb3d9f74d0778948e9597">isMustTailCall</a>()) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Create an if-then structure. The original instruction stays in its block,</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// and a clone of the original instruction is placed in the &quot;then&quot; block.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ThenTerm =</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="namespacellvm.html#ae2aea60aed775d05692317bf4855c291">SplitBlockAndInsertIfThen</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, &amp;CB, <span class="keyword">false</span>, BranchWeights);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ThenBlock = ThenTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ThenBlock-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;if.true.direct_targ&quot;</span>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *NewInst = cast&lt;CallBase&gt;(OrigInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    NewInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(ThenTerm);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// Place a clone of the optional bitcast after the new call site.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewRetVal = NewInst;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">auto</span> Next = OrigInst-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BitCast = dyn_cast_or_null&lt;BitCastInst&gt;(Next)) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BitCast-&gt;getOperand(0) == OrigInst &amp;&amp;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;             <span class="stringliteral">&quot;bitcast following musttail call must use the call&quot;</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keyword">auto</span> NewBitCast = BitCast-&gt;clone();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      NewBitCast-&gt;replaceUsesOfWith(OrigInst, NewInst);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      NewBitCast-&gt;insertBefore(ThenTerm);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      NewRetVal = NewBitCast;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      Next = BitCast-&gt;getNextNode();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// Place a clone of the return instruction after the new call site.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classllvm_1_1ReturnInst.html">ReturnInst</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = dyn_cast_or_null&lt;ReturnInst&gt;(Next);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> &amp;&amp; <span class="stringliteral">&quot;musttail call must precede a ret with an optional bitcast&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">auto</span> NewRet = <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>-&gt;clone();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>-&gt;getReturnValue())</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      NewRet-&gt;replaceUsesOfWith(<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>-&gt;getReturnValue(), NewRetVal);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    NewRet-&gt;insertBefore(ThenTerm);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// A return instructions is terminating, so we don&#39;t need the terminator</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// instruction just created.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    ThenTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> *NewInst;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// Create an if-then-else structure. The original instruction is moved into</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// the &quot;else&quot; block, and a clone of the original instruction is placed in the</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// &quot;then&quot; block.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ThenTerm = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ElseTerm = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="namespacellvm.html#a47d9d4544f29bfafd32f0d62db009915">SplitBlockAndInsertIfThenElse</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, &amp;CB, &amp;ThenTerm, &amp;ElseTerm, BranchWeights);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ThenBlock = ThenTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ElseBlock = ElseTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *MergeBlock = OrigInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  ThenBlock-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;if.true.direct_targ&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  ElseBlock-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;if.false.orig_indirect&quot;</span>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  MergeBlock-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;if.end.icp&quot;</span>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *NewInst = cast&lt;CallBase&gt;(OrigInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  OrigInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(ElseTerm);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  NewInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(ThenTerm);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// If the original call site is an invoke instruction, we have extra work to</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// do since invoke instructions are terminating. We have to fix-up phi nodes</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// in the invoke&#39;s normal and unwind destinations.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *OrigInvoke = dyn_cast&lt;InvokeInst&gt;(OrigInst)) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">auto</span> *NewInvoke = cast&lt;InvokeInst&gt;(NewInst);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// Invoke instructions are terminating, so we don&#39;t need the terminator</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// instructions that were just created.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    ThenTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    ElseTerm-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// Branch from the &quot;merge&quot; block to the original normal destination.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(MergeBlock);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBr(OrigInvoke-&gt;getNormalDest());</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Fix-up phi nodes in the original invoke&#39;s normal and unwind destinations.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="CallPromotionUtils_8cpp.html#a51ff57d75f102e980e39535df6ff00bb">fixupPHINodeForNormalDest</a>(OrigInvoke, OrigBlock, MergeBlock);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="CallPromotionUtils_8cpp.html#a59b92d3bbd9b21b61a2afbb73c10c3b0">fixupPHINodeForUnwindDest</a>(OrigInvoke, MergeBlock, ThenBlock, ElseBlock);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// Now set the normal destinations of the invoke instructions to be the</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// &quot;merge&quot; block.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    OrigInvoke-&gt;setNormalDest(MergeBlock);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    NewInvoke-&gt;setNormalDest(MergeBlock);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// Create a phi node for the returned value of the call site.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="CallPromotionUtils_8cpp.html#abdf3ba57973320bd702d3b12b0b8fa8c">createRetPHINode</a>(OrigInst, NewInst, MergeBlock, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">return</span> *NewInst;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">  382</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">llvm::isLegalToPromote</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">char</span> **FailureReason) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!CB.<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>() &amp;&amp; <span class="stringliteral">&quot;Only indirect call sites can be promoted&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// Check the return type. The callee&#39;s return value type must be bitcast</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// compatible with the call site&#39;s type.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CallRetTy = CB.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *FuncRetTy = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getReturnType();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">if</span> (CallRetTy != FuncRetTy)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1CastInst.html#a94f850488e8bda1d1b400821d6d61bd1">CastInst::isBitOrNoopPointerCastable</a>(FuncRetTy, CallRetTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        *FailureReason = <span class="stringliteral">&quot;Return type mismatch&quot;</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// The number of formal arguments of the callee.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordtype">unsigned</span> NumParams = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a104d6154321899b53e40455e71d8e83a">getNumParams</a>();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// The number of actual arguments in the call.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">unsigned</span> NumArgs = CB.<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Check the number of arguments. The callee and call site must agree on the</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// number of arguments.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (NumArgs != NumParams &amp;&amp; !<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isVarArg()) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      *FailureReason = <span class="stringliteral">&quot;The number of arguments mismatch&quot;</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// Check the argument types. The callee&#39;s formal argument types must be</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// bitcast compatible with the corresponding actual argument types of the call</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// site.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">for</span> (; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumParams; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// Make sure that the callee and call agree on byval/inalloca. The types do</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// not have to match.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;hasParamAttribute(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Attribute::ByVal) !=</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        CB.<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeList.html#ab04846c93ea7d802afbaa48efd84f37e">hasParamAttr</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Attribute::ByVal)) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        *FailureReason = <span class="stringliteral">&quot;byval mismatch&quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;hasParamAttribute(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Attribute::InAlloca) !=</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        CB.<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeList.html#ab04846c93ea7d802afbaa48efd84f37e">hasParamAttr</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Attribute::InAlloca)) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        *FailureReason = <span class="stringliteral">&quot;inalloca mismatch&quot;</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *FormalTy = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac9c20e4a8194779750a20ce5caef81f7">getFunctionParamType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ActualTy = CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (FormalTy == ActualTy)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1CastInst.html#a94f850488e8bda1d1b400821d6d61bd1">CastInst::isBitOrNoopPointerCastable</a>(ActualTy, FormalTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        *FailureReason = <span class="stringliteral">&quot;Argument type mismatch&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// MustTail call needs stricter type match. See</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// Verifier::verifyMustTailCall().</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (CB.<a class="code" href="classllvm_1_1CallBase.html#a50426b12f4acb3d9f74d0778948e9597">isMustTailCall</a>()) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *PF = dyn_cast&lt;PointerType&gt;(FormalTy);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *PA = dyn_cast&lt;PointerType&gt;(ActualTy);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordflow">if</span> (!PF || !PA || PF-&gt;<a class="code" href="classllvm_1_1PointerType.html#af8aeced5e71d2589fa3e9791043af5cb">getAddressSpace</a>() != PA-&gt;<a class="code" href="classllvm_1_1PointerType.html#af8aeced5e71d2589fa3e9791043af5cb">getAddressSpace</a>()) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          *FailureReason = <span class="stringliteral">&quot;Musttail call Argument type mismatch&quot;</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">for</span> (; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumArgs; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Vararg functions can have more arguments than parameters.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isVarArg());</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (CB.<a class="code" href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">paramHasAttr</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Attribute::StructRet)) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">if</span> (FailureReason)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        *FailureReason = <span class="stringliteral">&quot;SRet arg to vararg function&quot;</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="namespacellvm.html#a90c1755a8480ebc1dcc4f05d56271b00">  468</a></span>&#160;<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm.html#a90c1755a8480ebc1dcc4f05d56271b00">llvm::promoteCall</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                            <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> **RetBitCast) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!CB.<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>() &amp;&amp; <span class="stringliteral">&quot;Only indirect call sites can be promoted&quot;</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Set the called function of the call site to be the given callee (but don&#39;t</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// change the type).</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  CB.<a class="code" href="classllvm_1_1CallBase.html#ad70fe60b7ed052c6a74863944b518251">setCalledOperand</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Since the call site will no longer be direct, we must clear metadata that</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// is only appropriate for indirect calls. This includes !prof and !callees</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// metadata.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  CB.<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_prof, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  CB.<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_callees, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// If the function type of the call site matches that of the callee, no</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// additional work is required.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (CB.<a class="code" href="classllvm_1_1CallBase.html#a5e4a09f80c7cd5283dbbc7256d122d12">getFunctionType</a>() == <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>())</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span> CB;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// Save the return types of the call site and callee.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CallSiteRetTy = CB.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CalleeRetTy = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getReturnType();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// Change the function type of the call site the match that of the callee.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  CB.<a class="code" href="classllvm_1_1CallBase.html#aba272b7337f4e135f28eeb0bcc69adbb">mutateFunctionType</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>());</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Inspect the arguments of the call site. If an argument&#39;s type doesn&#39;t</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// match the corresponding formal argument&#39;s type in the callee, bitcast it</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// to the correct type.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">auto</span> CalleeType = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keyword">auto</span> CalleeParamNum = CalleeType-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a104d6154321899b53e40455e71d8e83a">getNumParams</a>();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctx = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getContext();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> &amp;CallerPAL = CB.<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>();</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// The new list of argument attributes.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;AttributeSet, 4&gt;</a> NewArgAttrs;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordtype">bool</span> AttributeChanged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgNo = 0; ArgNo &lt; CalleeParamNum; ++ArgNo) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ArgNo);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *FormalTy = CalleeType-&gt;getParamType(ArgNo);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ActualTy = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getType();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (FormalTy != ActualTy) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keyword">auto</span> *Cast = <a class="code" href="classllvm_1_1CastInst.html#a31d2885660f654b31d8741726c3ea8d9">CastInst::CreateBitOrPointerCast</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, FormalTy, <span class="stringliteral">&quot;&quot;</span>, &amp;CB);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      CB.<a class="code" href="classllvm_1_1CallBase.html#abc10b887caad109288ffceb230493a85">setArgOperand</a>(ArgNo, Cast);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="comment">// Remove any incompatible attributes for the argument.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> ArgAttrs(Ctx, CallerPAL.<a class="code" href="classllvm_1_1AttributeList.html#ada7a173c40ca7ac048a4b7099ceb71c0">getParamAttrs</a>(ArgNo));</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      ArgAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#abf8bb6f24f26021a4ea1b6486bc983db">remove</a>(<a class="code" href="namespacellvm_1_1AttributeFuncs.html#ae48bd752d74f193a0651b89931b28025">AttributeFuncs::typeIncompatible</a>(FormalTy));</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="comment">// We may have a different byval/inalloca type.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">if</span> (ArgAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a896321410e516a7a0fbeca5a0885739a">getByValType</a>())</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        ArgAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a5f0b4baa6787e964dded34f7137090ff">addByValAttr</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getParamByValType(ArgNo));</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">if</span> (ArgAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a1d94009083a38ad3fe4c50fcd7834a03">getInAllocaType</a>())</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        ArgAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#aa4629ac8989d1523b9d92c979b8e7bdf">addInAllocaAttr</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getParamInAllocaType(ArgNo));</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      NewArgAttrs.push_back(<a class="code" href="classllvm_1_1AttributeSet.html#ae8ed437b15a7ca943716e5284a9cb9a6">AttributeSet::get</a>(Ctx, ArgAttrs));</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      AttributeChanged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      NewArgAttrs.push_back(CallerPAL.<a class="code" href="classllvm_1_1AttributeList.html#ada7a173c40ca7ac048a4b7099ceb71c0">getParamAttrs</a>(ArgNo));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// If the return type of the call site doesn&#39;t match that of the callee, cast</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// the returned value to the appropriate type.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// Remove any incompatible return value attribute.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> RAttrs(Ctx, CallerPAL.<a class="code" href="classllvm_1_1AttributeList.html#a5604157867b3d226260f6388b987e49a">getRetAttrs</a>());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (!CallSiteRetTy-&gt;<a class="code" href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>() &amp;&amp; CallSiteRetTy != CalleeRetTy) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="CallPromotionUtils_8cpp.html#a8c9ae0be5e6bcad90cdf141962a117f3">createRetBitCast</a>(CB, CallSiteRetTy, RetBitCast);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    RAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#abf8bb6f24f26021a4ea1b6486bc983db">remove</a>(<a class="code" href="namespacellvm_1_1AttributeFuncs.html#ae48bd752d74f193a0651b89931b28025">AttributeFuncs::typeIncompatible</a>(CalleeRetTy));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    AttributeChanged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// Set the new callsite attribute.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">if</span> (AttributeChanged)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    CB.<a class="code" href="classllvm_1_1CallBase.html#a9da3b29e8e71b9be4645874e1721207a">setAttributes</a>(<a class="code" href="classllvm_1_1AttributeList.html#a5cc6492c8f2e06a8bae9dc0d121fab9f">AttributeList::get</a>(Ctx, CallerPAL.<a class="code" href="classllvm_1_1AttributeList.html#a1cf553641e8527095ae4c8ec88a2cd92">getFnAttrs</a>(),</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                        <a class="code" href="classllvm_1_1AttributeSet.html#ae8ed437b15a7ca943716e5284a9cb9a6">AttributeSet::get</a>(Ctx, RAttrs),</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                        NewArgAttrs));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">return</span> CB;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="namespacellvm.html#a23c23396eb61a7a78555e926700dbf47">  549</a></span>&#160;<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm.html#a23c23396eb61a7a78555e926700dbf47">llvm::promoteCallWithIfThenElse</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                          <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *BranchWeights) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// Version the indirect call site. If the called value is equal to the given</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// callee, &#39;NewInst&#39; will be executed, otherwise the original call site will</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// be executed.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;NewInst = <a class="code" href="namespacellvm.html#a84163d559062da6b736ab943644e0a16">versionCallSite</a>(CB, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, BranchWeights);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// Promote &#39;NewInst&#39; so that it directly calls the desired function.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a90c1755a8480ebc1dcc4f05d56271b00">promoteCall</a>(NewInst, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="namespacellvm.html#ad3219f7b717320ae52f53ccb09ad5a84">  561</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#ad3219f7b717320ae52f53ccb09ad5a84">llvm::tryPromoteCall</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!CB.<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>());</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CB.<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDataLayout();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CB.<a class="code" href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">getCalledOperand</a>();</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *VTableEntryLoad = dyn_cast&lt;LoadInst&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">if</span> (!VTableEntryLoad)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Not a vtable entry load.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VTableEntryPtr = VTableEntryLoad-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> VTableOffset(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(VTableEntryPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), 0);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VTableBasePtr = VTableEntryPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a4c539f826d954ab3bd78cdb0882540bd">stripAndAccumulateConstantOffsets</a>(</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, VTableOffset, <span class="comment">/* AllowNonInbounds */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *VTablePtrLoad = dyn_cast&lt;LoadInst&gt;(VTableBasePtr);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (!VTablePtrLoad)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Not a vtable load.</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#a1855f41d4a13b499837ed703cff6b389a497031794414a552435f90151ac3b54b">Object</a> = VTablePtrLoad-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> ObjectOffset(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(<a class="code" href="namespacellvm.html#a1855f41d4a13b499837ed703cff6b389a497031794414a552435f90151ac3b54b">Object</a>-&gt;getType()), 0);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ObjectBase = <a class="code" href="namespacellvm.html#a1855f41d4a13b499837ed703cff6b389a497031794414a552435f90151ac3b54b">Object</a>-&gt;stripAndAccumulateConstantOffsets(</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ObjectOffset, <span class="comment">/* AllowNonInbounds */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">if</span> (!(isa&lt;AllocaInst&gt;(ObjectBase) &amp;&amp; ObjectOffset == 0))</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// Not an Alloca or the offset isn&#39;t zero.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// Look for the vtable pointer store into the object by the ctor.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BBI(VTablePtrLoad);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VTablePtr = <a class="code" href="namespacellvm.html#a4112c4d55a504c443acdc97bf2a3acdf">FindAvailableLoadedValue</a>(</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      VTablePtrLoad, VTablePtrLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), BBI, 0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">if</span> (!VTablePtr)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// No vtable found.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> VTableOffsetGVBase(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(VTablePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), 0);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VTableGVBase = VTablePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a4c539f826d954ab3bd78cdb0882540bd">stripAndAccumulateConstantOffsets</a>(</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, VTableOffsetGVBase, <span class="comment">/* AllowNonInbounds */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a> *GV = dyn_cast&lt;GlobalVariable&gt;(VTableGVBase);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (!(GV &amp;&amp; GV-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#aa859e108741fa64681b63f0c0c672512">isConstant</a>() &amp;&amp; GV-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#aec2d700d8b1e57f830a673c39a1f30dc">hasDefinitiveInitializer</a>()))</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Not in the form of a global constant variable with an initializer.</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *VTableGVInitializer = GV-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">getInitializer</a>();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> VTableGVOffset = VTableOffsetGVBase + VTableOffset;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">if</span> (!(VTableGVOffset.<a class="code" href="classllvm_1_1APInt.html#a3015474e70e59c0a3ed4f9f0e8644b75">getActiveBits</a>() &lt;= 64))</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Out of range.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="namespacellvm.html#af9ea314c7ebcfef667f1d7b67fe09c69">getPointerAtOffset</a>(VTableGVInitializer,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                     VTableGVOffset.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>(),</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                     *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// No constant (function) pointer found.</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *DirectCallee = dyn_cast&lt;Function&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;stripPointerCasts());</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (!DirectCallee)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// No function pointer found.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">isLegalToPromote</a>(CB, DirectCallee))</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">// Success.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <a class="code" href="namespacellvm.html#a90c1755a8480ebc1dcc4f05d56271b00">promoteCall</a>(CB, DirectCallee);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#undef DEBUG_TYPE</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassllvm_1_1InvokeInst_html_a100bd3005ea84bf47f3b4021e8022633"><div class="ttname"><a href="classllvm_1_1InvokeInst.html#a100bd3005ea84bf47f3b4021e8022633">llvm::InvokeInst::getNormalDest</a></div><div class="ttdeci">BasicBlock * getNormalDest() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03946">Instructions.h:3946</a></div></div>
<div class="ttc" id="aCallPromotionUtils_8cpp_html_a59b92d3bbd9b21b61a2afbb73c10c3b0"><div class="ttname"><a href="CallPromotionUtils_8cpp.html#a59b92d3bbd9b21b61a2afbb73c10c3b0">fixupPHINodeForUnwindDest</a></div><div class="ttdeci">static void fixupPHINodeForUnwindDest(InvokeInst *Invoke, BasicBlock *OrigBlock, BasicBlock *ThenBlock, BasicBlock *ElseBlock)</div><div class="ttdoc">Fix-up phi nodes in an invoke instruction's unwind destination.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00081">CallPromotionUtils.cpp:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_a896321410e516a7a0fbeca5a0885739a"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#a896321410e516a7a0fbeca5a0885739a">llvm::AttrBuilder::getByValType</a></div><div class="ttdeci">Type * getByValType() const</div><div class="ttdoc">Retrieve the byval type.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l01139">Attributes.h:1139</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html"><div class="ttname"><a href="classllvm_1_1ReturnInst.html">llvm::ReturnInst</a></div><div class="ttdoc">Return a value (possibly void), from a function.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03057">Instructions.h:3057</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aLoads_8h_html"><div class="ttname"><a href="Loads_8h.html">Loads.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_aba272b7337f4e135f28eeb0bcc69adbb"><div class="ttname"><a href="classllvm_1_1CallBase.html#aba272b7337f4e135f28eeb0bcc69adbb">llvm::CallBase::mutateFunctionType</a></div><div class="ttdeci">void mutateFunctionType(FunctionType *FTy)</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01266">InstrTypes.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a26708685cc8b94fe3d7092ee080dbb34"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">llvm::ilist_node_with_parent::getNextNode</a></div><div class="ttdeci">NodeTy * getNextNode()</div><div class="ttdoc">Get the next node, or nullptr for the list tail.</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00289">ilist_node.h:289</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00039">GlobalVariable.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html_af8aeced5e71d2589fa3e9791043af5cb"><div class="ttname"><a href="classllvm_1_1PointerType.html#af8aeced5e71d2589fa3e9791043af5cb">llvm::PointerType::getAddressSpace</a></div><div class="ttdeci">unsigned getAddressSpace() const</div><div class="ttdoc">Return the address space of the Pointer type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00682">DerivedTypes.h:682</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_a5cc6492c8f2e06a8bae9dc0d121fab9f"><div class="ttname"><a href="classllvm_1_1AttributeList.html#a5cc6492c8f2e06a8bae9dc0d121fab9f">llvm::AttributeList::get</a></div><div class="ttdeci">static AttributeList get(LLVMContext &amp;C, ArrayRef&lt; std::pair&lt; unsigned, Attribute &gt;&gt; Attrs)</div><div class="ttdoc">Create an AttributeList with the specified parameters in it.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01132">Attributes.cpp:1132</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a482498a1c760122fd33c7fc8190dd277"><div class="ttname"><a href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">llvm::Instruction::insertBefore</a></div><div class="ttdeci">void insertBefore(Instruction *InsertPos)</div><div class="ttdoc">Insert an unlinked instruction into a basic block immediately before the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00088">Instruction.cpp:88</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html"><div class="ttname"><a href="classllvm_1_1AttributeList.html">llvm::AttributeList</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00432">Attributes.h:432</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ae0c55761fce39dd71617690b04385193"><div class="ttname"><a href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">llvm::CallBase::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the parameter attributes for this call.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01484">InstrTypes.h:1484</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a5e4a09f80c7cd5283dbbc7256d122d12"><div class="ttname"><a href="classllvm_1_1CallBase.html#a5e4a09f80c7cd5283dbbc7256d122d12">llvm::CallBase::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01264">InstrTypes.h:1264</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_a1cf553641e8527095ae4c8ec88a2cd92"><div class="ttname"><a href="classllvm_1_1AttributeList.html#a1cf553641e8527095ae4c8ec88a2cd92">llvm::AttributeList::getFnAttrs</a></div><div class="ttdeci">AttributeSet getFnAttrs() const</div><div class="ttdoc">The function attributes are returned.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01462">Attributes.cpp:1462</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a50426b12f4acb3d9f74d0778948e9597"><div class="ttname"><a href="classllvm_1_1CallBase.html#a50426b12f4acb3d9f74d0778948e9597">llvm::CallBase::isMustTailCall</a></div><div class="ttdeci">bool isMustTailCall() const</div><div class="ttdoc">Tests if this call site must be tail call optimized.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00309">Instructions.cpp:309</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a4c539f826d954ab3bd78cdb0882540bd"><div class="ttname"><a href="classllvm_1_1Value.html#a4c539f826d954ab3bd78cdb0882540bd">llvm::Value::stripAndAccumulateConstantOffsets</a></div><div class="ttdeci">const Value * stripAndAccumulateConstantOffsets(const DataLayout &amp;DL, APInt &amp;Offset, bool AllowNonInbounds, bool AllowInvariantGroup=false, function_ref&lt; bool(Value &amp;Value, APInt &amp;Offset)&gt; ExternalAnalysis=nullptr) const</div><div class="ttdoc">Accumulate the constant offset this value has compared to a base pointer.</div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a104d6154321899b53e40455e71d8e83a"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a104d6154321899b53e40455e71d8e83a">llvm::FunctionType::getNumParams</a></div><div class="ttdeci">unsigned getNumParams() const</div><div class="ttdoc">Return the number of fixed parameters this function type requires.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00139">DerivedTypes.h:139</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">llvm::MipsISD::Ret</a></div><div class="ttdeci">@ Ret</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00119">MipsISelLowering.h:119</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00264">Instructions.h:264</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set the metadata of the specified kind to the specified node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01455">Metadata.cpp:1455</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_abf8bb6f24f26021a4ea1b6486bc983db"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#abf8bb6f24f26021a4ea1b6486bc983db">llvm::AttrBuilder::remove</a></div><div class="ttdeci">AttrBuilder &amp; remove(const AttributeMask &amp;AM)</div><div class="ttdoc">Remove the attributes from the builder.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01848">Attributes.cpp:1848</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_a5f0b4baa6787e964dded34f7137090ff"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#a5f0b4baa6787e964dded34f7137090ff">llvm::AttrBuilder::addByValAttr</a></div><div class="ttdeci">AttrBuilder &amp; addByValAttr(Type *Ty)</div><div class="ttdoc">This turns a byval type into the form used internally in Attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01820">Attributes.cpp:1820</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aCallPromotionUtils_8cpp_html_abdf3ba57973320bd702d3b12b0b8fa8c"><div class="ttname"><a href="CallPromotionUtils_8cpp.html#abdf3ba57973320bd702d3b12b0b8fa8c">createRetPHINode</a></div><div class="ttdeci">static void createRetPHINode(Instruction *OrigInst, Instruction *NewInst, BasicBlock *MergeBlock, IRBuilder&lt;&gt; &amp;Builder)</div><div class="ttdoc">Create a phi node for the returned value of a call or invoke instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00107">CallPromotionUtils.cpp:107</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a83b8c9e572130f403445c0b0f69b837c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">llvm::CallBase::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const</div><div class="ttdoc">Returns the function called, or null if this is an indirect function invocation or the function signa...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01406">InstrTypes.h:1406</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a9da3b29e8e71b9be4645874e1721207a"><div class="ttname"><a href="classllvm_1_1CallBase.html#a9da3b29e8e71b9be4645874e1721207a">llvm::CallBase::setAttributes</a></div><div class="ttdeci">void setAttributes(AttributeList A)</div><div class="ttdoc">Set the parameter attributes for this call.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01488">InstrTypes.h:1488</a></div></div>
<div class="ttc" id="anamespacellvm_html_a23c23396eb61a7a78555e926700dbf47"><div class="ttname"><a href="namespacellvm.html#a23c23396eb61a7a78555e926700dbf47">llvm::promoteCallWithIfThenElse</a></div><div class="ttdeci">CallBase &amp; promoteCallWithIfThenElse(CallBase &amp;CB, Function *Callee, MDNode *BranchWeights=nullptr)</div><div class="ttdoc">Promote the given indirect call site to conditionally call Callee.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00549">CallPromotionUtils.cpp:549</a></div></div>
<div class="ttc" id="aTypeMetadataUtils_8h_html"><div class="ttname"><a href="TypeMetadataUtils_8h.html">TypeMetadataUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a217e0207d9cc8e046c2dccbf0e4bb198"><div class="ttname"><a href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Get zero extended value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01494">APInt.h:1494</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a72516971c5734dc0f7546e64affca425"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">llvm::BasicBlock::phis</a></div><div class="ttdeci">iterator_range&lt; const_phi_iterator &gt; phis() const</div><div class="ttdoc">Returns a range that iterates over the phis in the basic block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00372">BasicBlock.h:372</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a35ee267850af7c235474a8c46c7ac5af"><div class="ttname"><a href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">llvm::Value::setName</a></div><div class="ttdeci">void setName(const Twine &amp;Name)</div><div class="ttdoc">Change the name of the value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00375">Value.cpp:375</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionCallee_html_a9d67a499a48bda24fa4e87138341f613"><div class="ttname"><a href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">llvm::FunctionCallee::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType()</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00182">DerivedTypes.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_html_a47d9d4544f29bfafd32f0d62db009915"><div class="ttname"><a href="namespacellvm.html#a47d9d4544f29bfafd32f0d62db009915">llvm::SplitBlockAndInsertIfThenElse</a></div><div class="ttdeci">void SplitBlockAndInsertIfThenElse(Value *Cond, Instruction *SplitBefore, Instruction **ThenTerm, Instruction **ElseTerm, MDNode *BranchWeights=nullptr, DomTreeUpdater *DTU=nullptr)</div><div class="ttdoc">SplitBlockAndInsertIfThenElse is similar to SplitBlockAndInsertIfThen, but also creates the ElseBlock...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l01563">BasicBlockUtils.cpp:1563</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0e5b9e42ea84622605acea0b0d721fda"><div class="ttname"><a href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">llvm::isLegalToPromote</a></div><div class="ttdeci">bool isLegalToPromote(const CallBase &amp;CB, Function *Callee, const char **FailureReason=nullptr)</div><div class="ttdoc">Return true if the given indirect call site can be made to call Callee.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00382">CallPromotionUtils.cpp:382</a></div></div>
<div class="ttc" id="anamespacellvm_html_a84163d559062da6b736ab943644e0a16"><div class="ttname"><a href="namespacellvm.html#a84163d559062da6b736ab943644e0a16">llvm::versionCallSite</a></div><div class="ttdeci">CallBase &amp; versionCallSite(CallBase &amp;CB, Value *Callee, MDNode *BranchWeights)</div><div class="ttdoc">Predicate and clone the given call site.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00282">CallPromotionUtils.cpp:282</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a9d7de807ebdfe1819df3ff6cb0f16158"><div class="ttname"><a href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00344">Value.h:344</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_afac5b39bcbb90d660f83d9b4bd8c6d95"><div class="ttname"><a href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">llvm::CallBase::getCaller</a></div><div class="ttdeci">Function * getCaller()</div><div class="ttdoc">Helper to get the caller (the parent function).</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00293">Instructions.cpp:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1InvokeInst_html"><div class="ttname"><a href="classllvm_1_1InvokeInst.html">llvm::InvokeInst</a></div><div class="ttdoc">Invoke instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03814">Instructions.h:3814</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1855f41d4a13b499837ed703cff6b389a497031794414a552435f90151ac3b54b"><div class="ttname"><a href="namespacellvm.html#a1855f41d4a13b499837ed703cff6b389a497031794414a552435f90151ac3b54b">llvm::OutputFileType::Object</a></div><div class="ttdeci">@ Object</div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_a5604157867b3d226260f6388b987e49a"><div class="ttname"><a href="classllvm_1_1AttributeList.html#a5604157867b3d226260f6388b987e49a">llvm::AttributeList::getRetAttrs</a></div><div class="ttdeci">AttributeSet getRetAttrs() const</div><div class="ttdoc">The attributes for the ret value are returned.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01458">Attributes.cpp:1458</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_a0e5946885029c1bce1350d34f2539b1b"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">llvm::GlobalVariable::getInitializer</a></div><div class="ttdeci">const Constant * getInitializer() const</div><div class="ttdoc">getInitializer - Return the initializer for this global variable.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00135">GlobalVariable.h:135</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_aec2d700d8b1e57f830a673c39a1f30dc"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#aec2d700d8b1e57f830a673c39a1f30dc">llvm::GlobalVariable::hasDefinitiveInitializer</a></div><div class="ttdeci">bool hasDefinitiveInitializer() const</div><div class="ttdoc">hasDefinitiveInitializer - Whether the global variable has an initializer, and any other instances of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00109">GlobalVariable.h:109</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeSet_html_ae8ed437b15a7ca943716e5284a9cb9a6"><div class="ttname"><a href="classllvm_1_1AttributeSet.html#ae8ed437b15a7ca943716e5284a9cb9a6">llvm::AttributeSet::get</a></div><div class="ttdeci">static AttributeSet get(LLVMContext &amp;C, const AttrBuilder &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00693">Attributes.cpp:693</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_aa4629ac8989d1523b9d92c979b8e7bdf"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#aa4629ac8989d1523b9d92c979b8e7bdf">llvm::AttrBuilder::addInAllocaAttr</a></div><div class="ttdeci">AttrBuilder &amp; addInAllocaAttr(Type *Ty)</div><div class="ttdoc">This turns an inalloca type into the form used internally in Attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01836">Attributes.cpp:1836</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00067">LLVMContext.h:67</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html">llvm::AttrBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l01040">Attributes.h:1040</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdoc">Class to represent pointers.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00632">DerivedTypes.h:632</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ae8eaa0b4eeac52a2b2282cb1bfd981ae"><div class="ttname"><a href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const</div><div class="ttdoc">Return true if this is 'void'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00140">Type.h:140</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDNode_html"><div class="ttname"><a href="classllvm_1_1MDNode.html">llvm::MDNode</a></div><div class="ttdoc">Metadata node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00943">Metadata.h:943</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0a4d51e372293abe5e5f6dac133e80a6"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const</div><div class="ttdoc">Create a copy of 'this' instruction that is identical in all ways except the following:</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00903">Instruction.cpp:903</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aCallPromotionUtils_8h_html"><div class="ttname"><a href="CallPromotionUtils_8h.html">CallPromotionUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a94f850488e8bda1d1b400821d6d61bd1"><div class="ttname"><a href="classllvm_1_1CastInst.html#a94f850488e8bda1d1b400821d6d61bd1">llvm::CastInst::isBitOrNoopPointerCastable</a></div><div class="ttdeci">static bool isBitOrNoopPointerCastable(Type *SrcTy, Type *DestTy, const DataLayout &amp;DL)</div><div class="ttdoc">Check whether a bitcast, inttoptr, or ptrtoint cast between these types is valid and a no-op.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03614">Instructions.cpp:3614</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">This is the base class for all instructions that perform data casts.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00428">InstrTypes.h:428</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a4cbb2344996abd4332716e76178ad4f4"><div class="ttname"><a href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">llvm::CallBase::paramHasAttr</a></div><div class="ttdeci">bool paramHasAttr(unsigned ArgNo, Attribute::AttrKind Kind) const</div><div class="ttdoc">Determine whether the argument or parameter has the given attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00352">Instructions.cpp:352</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_abc10b887caad109288ffceb230493a85"><div class="ttname"><a href="classllvm_1_1CallBase.html#abc10b887caad109288ffceb230493a85">llvm::CallBase::setArgOperand</a></div><div class="ttdeci">void setArgOperand(unsigned i, Value *v)</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01356">InstrTypes.h:1356</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a1600c7959045cb6b6a5f5a1d427ec67e"><div class="ttname"><a href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">llvm::User::replaceUsesOfWith</a></div><div class="ttdeci">bool replaceUsesOfWith(Value *From, Value *To)</div><div class="ttdoc">Replace uses of one Value with another.</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00021">User.cpp:21</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab706e7ebb1969c5e34f28bfcf2ff719e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00326">BasicBlock.h:326</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_html_adf83581f514774264d616eef5706cf6e"><div class="ttname"><a href="namespacellvm.html#adf83581f514774264d616eef5706cf6e">llvm::SplitEdge</a></div><div class="ttdeci">BasicBlock * SplitEdge(BasicBlock *From, BasicBlock *To, DominatorTree *DT=nullptr, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, const Twine &amp;BBName=&quot;&quot;)</div><div class="ttdoc">Split the edge connecting the specified blocks, and return the newly created basic block between From...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00615">BasicBlockUtils.cpp:615</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a31d2885660f654b31d8741726c3ea8d9"><div class="ttname"><a href="classllvm_1_1CastInst.html#a31d2885660f654b31d8741726c3ea8d9">llvm::CastInst::CreateBitOrPointerCast</a></div><div class="ttdeci">static CastInst * CreateBitOrPointerCast(Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Create a BitCast, a PtrToInt, or an IntToPTr cast instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03509">Instructions.cpp:3509</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_adde2ea00dd2613ee41bfe91908e4e68e"><div class="ttname"><a href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">llvm::CallBase::arg_size</a></div><div class="ttdeci">unsigned arg_size() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01349">InstrTypes.h:1349</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4112c4d55a504c443acdc97bf2a3acdf"><div class="ttname"><a href="namespacellvm.html#a4112c4d55a504c443acdc97bf2a3acdf">llvm::FindAvailableLoadedValue</a></div><div class="ttdeci">Value * FindAvailableLoadedValue(LoadInst *Load, BasicBlock *ScanBB, BasicBlock::iterator &amp;ScanFrom, unsigned MaxInstsToScan=DefMaxInstsToScan, AAResults *AA=nullptr, bool *IsLoadCSE=nullptr, unsigned *NumScanedInst=nullptr)</div><div class="ttdoc">Scan backwards to see if we have the value of the given load available locally within a small number ...</div><div class="ttdef"><b>Definition:</b> <a href="Loads_8cpp_source.html#l00428">Loads.cpp:428</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AttributeFuncs_html_ae48bd752d74f193a0651b89931b28025"><div class="ttname"><a href="namespacellvm_1_1AttributeFuncs.html#ae48bd752d74f193a0651b89931b28025">llvm::AttributeFuncs::typeIncompatible</a></div><div class="ttdeci">AttributeMask typeIncompatible(Type *Ty, AttributeSafetyKind ASK=ASK_ALL)</div><div class="ttdoc">Which attributes cannot be applied to a type.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01889">Attributes.cpp:1889</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a7ac9329ef7292ee640d87f45ce7ae05c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">llvm::CallBase::getCalledOperand</a></div><div class="ttdeci">Value * getCalledOperand() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01399">InstrTypes.h:1399</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ad70fe60b7ed052c6a74863944b518251"><div class="ttname"><a href="classllvm_1_1CallBase.html#ad70fe60b7ed052c6a74863944b518251">llvm::CallBase::setCalledOperand</a></div><div class="ttdeci">void setCalledOperand(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01442">InstrTypes.h:1442</a></div></div>
<div class="ttc" id="aCallPromotionUtils_8cpp_html_a8c9ae0be5e6bcad90cdf141962a117f3"><div class="ttname"><a href="CallPromotionUtils_8cpp.html#a8c9ae0be5e6bcad90cdf141962a117f3">createRetBitCast</a></div><div class="ttdeci">static void createRetBitCast(CallBase &amp;CB, Type *RetTy, CastInst **RetBitCast)</div><div class="ttdoc">Cast a call or invoke instruction to the given type.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00162">CallPromotionUtils.cpp:162</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_af9ea314c7ebcfef667f1d7b67fe09c69"><div class="ttname"><a href="namespacellvm.html#af9ea314c7ebcfef667f1d7b67fe09c69">llvm::getPointerAtOffset</a></div><div class="ttdeci">Constant * getPointerAtOffset(Constant *I, uint64_t Offset, Module &amp;M, Constant *TopLevelGlobal=nullptr)</div><div class="ttdoc">Processes a Constant recursively looking into elements of arrays, structs and expressions to find a t...</div><div class="ttdef"><b>Definition:</b> <a href="TypeMetadataUtils_8cpp_source.html#l00130">TypeMetadataUtils.cpp:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_aa859e108741fa64681b63f0c0c672512"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#aa859e108741fa64681b63f0c0c672512">llvm::GlobalVariable::isConstant</a></div><div class="ttdeci">bool isConstant() const</div><div class="ttdoc">If the value is a global constant, its value is immutable throughout the runtime execution of the pro...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00152">GlobalVariable.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a3015474e70e59c0a3ed4f9f0e8644b75"><div class="ttname"><a href="classllvm_1_1APInt.html#a3015474e70e59c0a3ed4f9f0e8644b75">llvm::APInt::getActiveBits</a></div><div class="ttdeci">unsigned getActiveBits() const</div><div class="ttdoc">Compute the number of active bits in the value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01463">APInt.h:1463</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="anamespacellvm_html_a90c1755a8480ebc1dcc4f05d56271b00"><div class="ttname"><a href="namespacellvm.html#a90c1755a8480ebc1dcc4f05d56271b00">llvm::promoteCall</a></div><div class="ttdeci">CallBase &amp; promoteCall(CallBase &amp;CB, Function *Callee, CastInst **RetBitCast=nullptr)</div><div class="ttdoc">Promote the given indirect call site to unconditionally call Callee.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00468">CallPromotionUtils.cpp:468</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae2aea60aed775d05692317bf4855c291"><div class="ttname"><a href="namespacellvm.html#ae2aea60aed775d05692317bf4855c291">llvm::SplitBlockAndInsertIfThen</a></div><div class="ttdeci">Instruction * SplitBlockAndInsertIfThen(Value *Cond, Instruction *SplitBefore, bool Unreachable, MDNode *BranchWeights, DominatorTree *DT, LoopInfo *LI=nullptr, BasicBlock *ThenBlock=nullptr)</div><div class="ttdoc">Split the containing block at the specified instruction - everything before SplitBefore stays in the ...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l01542">BasicBlockUtils.cpp:1542</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac9c20e4a8194779750a20ce5caef81f7"><div class="ttname"><a href="classllvm_1_1Type.html#ac9c20e4a8194779750a20ce5caef81f7">llvm::Type::getFunctionParamType</a></div><div class="ttdeci">Type * getFunctionParamType(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00153">DerivedTypes.h:153</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_ab04846c93ea7d802afbaa48efd84f37e"><div class="ttname"><a href="classllvm_1_1AttributeList.html#ab04846c93ea7d802afbaa48efd84f37e">llvm::AttributeList::hasParamAttr</a></div><div class="ttdeci">bool hasParamAttr(unsigned ArgNo, Attribute::AttrKind Kind) const</div><div class="ttdoc">Return true if the attribute exists for the given argument.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00764">Attributes.h:764</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_ada7a173c40ca7ac048a4b7099ceb71c0"><div class="ttname"><a href="classllvm_1_1AttributeList.html#ada7a173c40ca7ac048a4b7099ceb71c0">llvm::AttributeList::getParamAttrs</a></div><div class="ttdeci">AttributeSet getParamAttrs(unsigned ArgNo) const</div><div class="ttdoc">The attributes for the argument or parameter at the given index are returned.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01454">Attributes.cpp:1454</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_a1d94009083a38ad3fe4c50fcd7834a03"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#a1d94009083a38ad3fe4c50fcd7834a03">llvm::AttrBuilder::getInAllocaType</a></div><div class="ttdeci">Type * getInAllocaType() const</div><div class="ttdoc">Retrieve the inalloca type.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l01153">Attributes.h:1153</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1InvokeInst_html_a5ba379c3251d99b4c23c8f2e6abe4a6c"><div class="ttname"><a href="classllvm_1_1InvokeInst.html#a5ba379c3251d99b4c23c8f2e6abe4a6c">llvm::InvokeInst::getUnwindDest</a></div><div class="ttdeci">BasicBlock * getUnwindDest() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03949">Instructions.h:3949</a></div></div>
<div class="ttc" id="aCallPromotionUtils_8cpp_html_a51ff57d75f102e980e39535df6ff00bb"><div class="ttname"><a href="CallPromotionUtils_8cpp.html#a51ff57d75f102e980e39535df6ff00bb">fixupPHINodeForNormalDest</a></div><div class="ttdeci">static void fixupPHINodeForNormalDest(InvokeInst *Invoke, BasicBlock *OrigBlock, BasicBlock *MergeBlock)</div><div class="ttdoc">Fix-up phi nodes in an invoke instruction's normal destination.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00050">CallPromotionUtils.cpp:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad3219f7b717320ae52f53ccb09ad5a84"><div class="ttname"><a href="namespacellvm.html#ad3219f7b717320ae52f53ccb09ad5a84">llvm::tryPromoteCall</a></div><div class="ttdeci">bool tryPromoteCall(CallBase &amp;CB)</div><div class="ttdoc">Try to promote (devirtualize) a virtual call on an Alloca.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00561">CallPromotionUtils.cpp:561</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdoc">Unlink this instruction from its current basic block and insert it into the basic block that MovePos ...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00108">Instruction.cpp:108</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:35:37 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
