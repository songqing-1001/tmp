<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Vectorize/VPlanHCFGBuilder.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_acb975f027bc8cf760392318543d920a.html">Vectorize</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">VPlanHCFGBuilder.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="VPlanHCFGBuilder_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- VPlanHCFGBuilder.cpp ----------------------------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// This file implements the construction of a VPlan-based Hierarchical CFG</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// (H-CFG) for an incoming IR. This construction comprises the following</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/// components and steps:</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/// 1. PlainCFGBuilder class: builds a plain VPBasicBlock-based CFG that</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/// faithfully represents the CFG in the incoming IR. A VPRegionBlock (Top</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/// Region) is created to enclose and serve as parent of all the VPBasicBlocks</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/// in the plain CFG.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/// NOTE: At this point, there is a direct correspondence between all the</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/// VPBasicBlocks created for the initial plain CFG and the incoming</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/// BasicBlocks. However, this might change in the future.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="VPlanHCFGBuilder_8h.html">VPlanHCFGBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopVectorizationPlanner_8h.html">LoopVectorizationPlanner.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopIterator_8h.html">llvm/Analysis/LoopIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="VPlanHCFGBuilder_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   28</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;loop-vectorize&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// Class that is used to build the plain CFG for the incoming IR.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">class </span>PlainCFGBuilder {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// The outermost loop of the input loop nest considered for vectorization.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *TheLoop;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// Loop Info analysis.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// Vectorization plan that we are working on.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classllvm_1_1VPlan.html">VPlan</a> &amp;Plan;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// Builder of the VPlan instruction-level representation.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classllvm_1_1VPBuilder.html">VPBuilder</a> VPIRBuilder;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// NOTE: The following maps are intentionally destroyed after the plain CFG</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// construction because subsequent VPlan-to-VPlan transformation may</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// invalidate them.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// Map incoming BasicBlocks to their newly-created VPBasicBlocks.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;BasicBlock *, VPBasicBlock *&gt;</a> BB2VPBB;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">// Map incoming Value definitions to their newly-created VPValues.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, VPValue *&gt;</a> IRDef2VPValue;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// Hold phi node&#39;s that need to be fixed once the plain CFG has been built.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> PhisToFix;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">  /// Maps loops in the original IR to their corresponding region.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Loop *, VPRegionBlock *&gt;</a> Loop2Region;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// Utility functions.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">void</span> setVPBBPredsFromBB(<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">void</span> fixPhiNodes();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *getOrCreateVPBB(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">bool</span> isExternalDef(<a class="code" href="classllvm_1_1Value.html">Value</a> *Val);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="classllvm_1_1VPValue.html">VPValue</a> *getOrCreateVPOperand(<a class="code" href="classllvm_1_1Value.html">Value</a> *IRVal);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordtype">void</span> createVPInstructionsForVPBB(<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  PlainCFGBuilder(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *Lp, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <a class="code" href="classllvm_1_1VPlan.html">VPlan</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      : TheLoop(Lp), LI(LI), Plan(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">  /// Build plain CFG for TheLoop. Return the pre-header VPBasicBlock connected</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">  /// to a new VPRegionBlock (TopRegion) enclosing the plain CFG.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *buildPlainCFG();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;};</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// Set predecessors of \p VPBB in the same order as they are in \p BB. \p VPBB</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// must have no predecessors.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">void</span> PlainCFGBuilder::setVPBBPredsFromBB(<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;VPBlockBase *, 8&gt;</a> VPBBPreds;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// Collect VPBB predecessors.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    VPBBPreds.push_back(getOrCreateVPBB(Pred));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  VPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#a6a02d7faad162c3e17d0c522d032320b">setPredecessors</a>(VPBBPreds);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// Add operands to VPInstructions representing phi nodes from the input IR.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">void</span> PlainCFGBuilder::fixPhiNodes() {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Phi : PhisToFix) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IRDef2VPValue.count(Phi) &amp;&amp; <span class="stringliteral">&quot;Missing VPInstruction for PHINode.&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classllvm_1_1VPValue.html">VPValue</a> *VPVal = IRDef2VPValue[Phi];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;VPWidenPHIRecipe&gt;(VPVal) &amp;&amp;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;           <span class="stringliteral">&quot;Expected WidenPHIRecipe for phi node.&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">auto</span> *VPPhi = cast&lt;VPWidenPHIRecipe&gt;(VPVal);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VPPhi-&gt;getNumOperands() == 0 &amp;&amp;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;           <span class="stringliteral">&quot;Expected VPInstruction with no operands.&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != Phi-&gt;getNumOperands(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      VPPhi-&gt;addIncoming(getOrCreateVPOperand(Phi-&gt;getIncomingValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                         BB2VPBB[Phi-&gt;getIncomingBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)]);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// Create a new empty VPBasicBlock for an incoming BasicBlock in the region</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// corresponding to the containing loop  or retrieve an existing one if it was</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">// already created. If no region exists yet for the loop containing \p BB, a new</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// one is created.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *PlainCFGBuilder::getOrCreateVPBB(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">auto</span> BlockIt = BB2VPBB.find(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (BlockIt != BB2VPBB.end())</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Retrieve existing VPBB.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> BlockIt-&gt;second;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// Get or create a region for the loop containing BB.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurrentLoop = LI-&gt;getLoopFor(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="classllvm_1_1VPRegionBlock.html">VPRegionBlock</a> *ParentR = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (CurrentLoop) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">auto</span> Iter = Loop2Region.insert({CurrentLoop, <span class="keyword">nullptr</span>});</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (Iter.second)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      Iter.first-&gt;second = <span class="keyword">new</span> <a class="code" href="classllvm_1_1VPRegionBlock.html">VPRegionBlock</a>(</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          CurrentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">str</a>(), <span class="keyword">false</span> <span class="comment">/*isReplicator*/</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ParentR = Iter.first-&gt;second;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Create new VPBB.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Creating VPBasicBlock for &quot;</span> &lt;&lt; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPBB = <span class="keyword">new</span> <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getName());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  BB2VPBB[<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>] = VPBB;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  VPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#ae2be49bdbbda0aeadd51549f4b88c839">setParent</a>(ParentR);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">return</span> VPBB;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">// Return true if \p Val is considered an external definition. An external</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// definition is either:</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">// 1. A Value that is not an Instruction. This will be refined in the future.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// 2. An Instruction that is outside of the CFG snippet represented in VPlan,</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// i.e., is not part of: a) the loop nest, b) outermost loop PH and, c)</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// outermost loop exits.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">bool</span> PlainCFGBuilder::isExternalDef(<a class="code" href="classllvm_1_1Value.html">Value</a> *Val) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// All the Values that are not Instructions are considered external</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// definitions for now.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = dyn_cast&lt;Instruction&gt;(Val);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span> (!Inst)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InstParent = Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InstParent &amp;&amp; <span class="stringliteral">&quot;Expected instruction parent.&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// Check whether Instruction definition is in loop PH.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PH = TheLoop-&gt;getLoopPreheader();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PH &amp;&amp; <span class="stringliteral">&quot;Expected loop pre-header.&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> (InstParent == PH)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Instruction definition is in outermost loop PH.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// Check whether Instruction definition is in the loop exit.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Exit = TheLoop-&gt;getUniqueExitBlock();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Exit &amp;&amp; <span class="stringliteral">&quot;Expected loop with single exit.&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (InstParent == Exit) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Instruction definition is in outermost loop exit.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// Check whether Instruction definition is in loop body.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">return</span> !TheLoop-&gt;contains(Inst);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// Create a new VPValue or retrieve an existing one for the Instruction&#39;s</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">// operand \p IRVal. This function must only be used to create/retrieve VPValues</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">// for *Instruction&#39;s operands* and not to create regular VPInstruction&#39;s. For</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">// the latter, please, look at &#39;createVPInstructionsForVPBB&#39;.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<a class="code" href="classllvm_1_1VPValue.html">VPValue</a> *PlainCFGBuilder::getOrCreateVPOperand(<a class="code" href="classllvm_1_1Value.html">Value</a> *IRVal) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">auto</span> VPValIt = IRDef2VPValue.find(IRVal);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (VPValIt != IRDef2VPValue.end())</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Operand has an associated VPInstruction or VPValue that was previously</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// created.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> VPValIt-&gt;second;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// Operand doesn&#39;t have a previously created VPInstruction/VPValue. This</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// means that operand is:</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">//   A) a definition external to VPlan,</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">//   B) any other Value without specific representation in VPlan.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// For now, we use VPValue to represent A and B and classify both as external</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// definitions. We may introduce specific VPValue subclasses for them in the</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// future.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isExternalDef(IRVal) &amp;&amp; <span class="stringliteral">&quot;Expected external definition as operand.&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// A and B: Create VPValue and add it to the pool of external definitions and</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// to the Value-&gt;VPValue map.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="classllvm_1_1VPValue.html">VPValue</a> *NewVPVal = Plan.getOrAddExternalDef(IRVal);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  IRDef2VPValue[IRVal] = NewVPVal;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">return</span> NewVPVal;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">// Create new VPInstructions in a VPBasicBlock, given its BasicBlock</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">// counterpart. This function must be invoked in RPO so that the operands of a</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">// VPInstruction in \p BB have been visited before (except for Phi nodes).</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">void</span> PlainCFGBuilder::createVPInstructionsForVPBB(<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPBB,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  VPIRBuilder.setInsertPoint(VPBB);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;InstRef : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = &amp;InstRef;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// There shouldn&#39;t be any VPValue for Inst at this point. Otherwise, we</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// visited Inst when we shouldn&#39;t, breaking the RPO traversal order.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!IRDef2VPValue.count(Inst) &amp;&amp;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;           <span class="stringliteral">&quot;Instruction shouldn&#39;t have been visited.&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Br = dyn_cast&lt;BranchInst&gt;(Inst)) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">// Conditional branch instruction are represented using BranchOnCond</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="comment">// recipes.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">if</span> (Br-&gt;isConditional()) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="classllvm_1_1VPValue.html">VPValue</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = getOrCreateVPOperand(Br-&gt;getCondition());</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        VPBB-&gt;<a class="code" href="classllvm_1_1VPBasicBlock.html#a23773e962f9a56c9bdf13f7668b063a5">appendRecipe</a>(</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keyword">new</span> <a class="code" href="classllvm_1_1VPInstruction.html">VPInstruction</a>(<a class="code" href="classllvm_1_1VPInstruction.html#a9ccd98ba5679e4659a9990fa63f418f0a0062eccdb4956531f7b6a3cf71c3320c">VPInstruction::BranchOnCond</a>, {<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>}));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">// Skip the rest of the Instruction processing for Branch instructions.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="classllvm_1_1VPValue.html">VPValue</a> *NewVPV;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Phi = dyn_cast&lt;PHINode&gt;(Inst)) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// Phi node&#39;s operands may have not been visited at this point. We create</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">// an empty VPInstruction that we will fix once the whole plain CFG has</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">// been built.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      NewVPV = <span class="keyword">new</span> <a class="code" href="classllvm_1_1VPWidenPHIRecipe.html">VPWidenPHIRecipe</a>(Phi);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      VPBB-&gt;<a class="code" href="classllvm_1_1VPBasicBlock.html#a23773e962f9a56c9bdf13f7668b063a5">appendRecipe</a>(cast&lt;VPWidenPHIRecipe&gt;(NewVPV));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      PhisToFix.push_back(Phi);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">// Translate LLVM-IR operands into VPValue operands and set them in the</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// new VPInstruction.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;VPValue *, 4&gt;</a> VPOperands;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : Inst-&gt;<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>())</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        VPOperands.push_back(getOrCreateVPOperand(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// Build VPInstruction for any arbitrary Instruction without specific</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// representation in VPlan.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      NewVPV = cast&lt;VPInstruction&gt;(</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          VPIRBuilder.createNaryOp(Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>(), VPOperands, Inst));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    IRDef2VPValue[Inst] = NewVPV;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">// Main interface to build the plain CFG.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *PlainCFGBuilder::buildPlainCFG() {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// 1. Scan the body of the loop in a topological order to visit each basic</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// block after having visited its predecessor basic blocks. Create a VPBB for</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// each BB and link it to its successor and predecessor VPBBs. Note that</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// predecessors must be set in the same order as they are in the incomming IR.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// Otherwise, there might be problems with existing phi nodes and algorithm</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// based on predecessors traversal.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Loop PH needs to be explicitly visited since it&#39;s not taken into account by</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// LoopBlocksDFS.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ThePreheaderBB = TheLoop-&gt;getLoopPreheader();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((ThePreheaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() == 1) &amp;&amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         <span class="stringliteral">&quot;Unexpected loop preheader&quot;</span>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *ThePreheaderVPBB = getOrCreateVPBB(ThePreheaderBB);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  ThePreheaderVPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#a2bd1c53f9607876b22c6fd3ec1e28a50">setName</a>(<span class="stringliteral">&quot;vector.ph&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *ThePreheaderBB) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isVoidTy())</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    IRDef2VPValue[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = Plan.getOrAddExternalDef(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// Create empty VPBB for Loop H so that we can link PH-&gt;H.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="classllvm_1_1VPBlockBase.html">VPBlockBase</a> *HeaderVPBB = getOrCreateVPBB(TheLoop-&gt;getHeader());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  HeaderVPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#a2bd1c53f9607876b22c6fd3ec1e28a50">setName</a>(<span class="stringliteral">&quot;vector.body&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  ThePreheaderVPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#ae0ad192a841a53fd3a289320e0958e10">setOneSuccessor</a>(HeaderVPBB);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classllvm_1_1LoopBlocksRPO.html">LoopBlocksRPO</a> RPO(TheLoop);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  RPO.perform(LI);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : RPO) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Create or retrieve the VPBasicBlock for this BB and create its</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// VPInstructions.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPBB = getOrCreateVPBB(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    createVPInstructionsForVPBB(VPBB, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// Set VPBB successors. We create empty VPBBs for successors if they don&#39;t</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// exist already. Recipes will be created when the successor is visited</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// during the RPO traversal.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TI &amp;&amp; <span class="stringliteral">&quot;Terminator expected.&quot;</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">unsigned</span> NumSuccs = TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (NumSuccs == 1) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *SuccVPBB = getOrCreateVPBB(TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6e5d2e18c81baaeec7dadc81a0dea993">getSuccessor</a>(0));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuccVPBB &amp;&amp; <span class="stringliteral">&quot;VPBB Successor not found.&quot;</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      VPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#ae0ad192a841a53fd3a289320e0958e10">setOneSuccessor</a>(SuccVPBB);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumSuccs == 2) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *SuccVPBB0 = getOrCreateVPBB(TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6e5d2e18c81baaeec7dadc81a0dea993">getSuccessor</a>(0));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuccVPBB0 &amp;&amp; <span class="stringliteral">&quot;Successor 0 not found.&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *SuccVPBB1 = getOrCreateVPBB(TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6e5d2e18c81baaeec7dadc81a0dea993">getSuccessor</a>(1));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuccVPBB1 &amp;&amp; <span class="stringliteral">&quot;Successor 1 not found.&quot;</span>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// Get VPBB&#39;s condition bit.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;BranchInst&gt;(TI) &amp;&amp; <span class="stringliteral">&quot;Unsupported terminator!&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">// Look up the branch condition to get the corresponding VPValue</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// representing the condition bit in VPlan (which may be in another VPBB).</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IRDef2VPValue.count(cast&lt;BranchInst&gt;(TI)-&gt;getCondition()) &amp;&amp;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;             <span class="stringliteral">&quot;Missing condition bit in IRDef2VPValue!&quot;</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// Link successors.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      VPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#aa13d3b4d460075f3bb6a6eeb6a5e9bd7">setTwoSuccessors</a>(SuccVPBB0, SuccVPBB1);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Number of successors not supported.&quot;</span>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Set VPBB predecessors in the same order as they are in the incoming BB.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    setVPBBPredsFromBB(VPBB, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// 2. Process outermost loop exit. We created an empty VPBB for the loop</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// single exit BB during the RPO traversal of the loop body but Instructions</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// weren&#39;t visited because it&#39;s not part of the the loop.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopExitBB = TheLoop-&gt;getUniqueExitBlock();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopExitBB &amp;&amp; <span class="stringliteral">&quot;Loops with multiple exits are not supported.&quot;</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *LoopExitVPBB = BB2VPBB[LoopExitBB];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// Loop exit was already set as successor of the loop exiting BB.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// We only set its predecessor VPBB now.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  setVPBBPredsFromBB(LoopExitVPBB, LoopExitBB);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// 3. Fix up region blocks for loops. For each loop,</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">//   * use the header block as entry to the corresponding region,</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">//   * use the latch block as exit of the corresponding region,</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">//   * set the region as successor of the loop pre-header, and</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">//   * set the exit block as successor to the region.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Loop *&gt;</a> LoopWorkList;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  LoopWorkList.push_back(TheLoop);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">while</span> (!LoopWorkList.empty()) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LoopWorkList.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Exiting = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Exiting == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">getExitingBlock</a>() &amp;&amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;           <span class="stringliteral">&quot;Latch must be the only exiting block&quot;</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="classllvm_1_1VPRegionBlock.html">VPRegionBlock</a> *<a class="code" href="classllvm_1_1Region.html">Region</a> = Loop2Region[L];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *HeaderVPBB = getOrCreateVPBB(Header);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *ExitingVPBB = getOrCreateVPBB(Exiting);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Disconnect backedge and pre-header from header.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *PreheaderVPBB = getOrCreateVPBB(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>());</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="classllvm_1_1VPBlockUtils.html#a61f1451694a3638db85170c7f55d5581">VPBlockUtils::disconnectBlocks</a>(PreheaderVPBB, HeaderVPBB);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="classllvm_1_1VPBlockUtils.html#a61f1451694a3638db85170c7f55d5581">VPBlockUtils::disconnectBlocks</a>(ExitingVPBB, HeaderVPBB);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;setParent(PreheaderVPBB-&gt;<a class="code" href="classllvm_1_1VPBlockBase.html#a392f732b65bedd5e31a46923407061d7">getParent</a>());</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;setEntry(HeaderVPBB);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="classllvm_1_1VPBlockUtils.html#abc51f1d1a60a9d62ebe015d72ea11699">VPBlockUtils::connectBlocks</a>(PreheaderVPBB, <a class="code" href="classllvm_1_1Region.html">Region</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// Disconnect exit block from exiting (=latch) block, set exiting block and</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// connect region to exit block.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *ExitVPBB = getOrCreateVPBB(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>());</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="classllvm_1_1VPBlockUtils.html#a61f1451694a3638db85170c7f55d5581">VPBlockUtils::disconnectBlocks</a>(ExitingVPBB, ExitVPBB);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;setExiting(ExitingVPBB);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classllvm_1_1VPBlockUtils.html#abc51f1d1a60a9d62ebe015d72ea11699">VPBlockUtils::connectBlocks</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>, ExitVPBB);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// Queue sub-loops for processing.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    LoopWorkList.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">begin</a>(), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a98eb0888f30e7a27151a7b02fa053205">end</a>());</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// 4. The whole CFG has been built at this point so all the input Values must</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// have a VPlan couterpart. Fix VPlan phi nodes by adding their corresponding</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// VPlan operands.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  fixPhiNodes();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">return</span> ThePreheaderVPBB;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *VPlanHCFGBuilder::buildPlainCFG() {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  PlainCFGBuilder PCFGBuilder(TheLoop, LI, Plan);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">return</span> PCFGBuilder.buildPlainCFG();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">// Public interface to build a H-CFG.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="classllvm_1_1VPlanHCFGBuilder.html#a8ef4332eb7802ff0c53ca8ba7e999298">  384</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1VPlanHCFGBuilder.html#a8ef4332eb7802ff0c53ca8ba7e999298">VPlanHCFGBuilder::buildHierarchicalCFG</a>() {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// Build Top Region enclosing the plain CFG and set it as VPlan entry.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classllvm_1_1VPBasicBlock.html">VPBasicBlock</a> *EntryVPBB = buildPlainCFG();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  Plan.<a class="code" href="classllvm_1_1VPlan.html#a0ef812735aa773bbe9dab2bc0a6f3e66">setEntry</a>(EntryVPBB);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(Plan.<a class="code" href="classllvm_1_1VPlan.html#a242fb01fcd9fab0be0f487b67fd94a0a">setName</a>(<span class="stringliteral">&quot;HCFGBuilder: Plain CFG\n&quot;</span>); <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Plan);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classllvm_1_1VPRegionBlock.html">VPRegionBlock</a> *TopRegion = Plan.<a class="code" href="classllvm_1_1VPlan.html#ab979aba6ac619479c6387779528e1fbb">getVectorLoopRegion</a>();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  Verifier.<a class="code" href="structllvm_1_1VPlanVerifier.html#aad8a0f2c84d5febdc9ea917f720418d3">verifyHierarchicalCFG</a>(TopRegion);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// Compute plain CFG dom tree for VPLInfo.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  VPDomTree.<a class="code" href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">recalculate</a>(Plan);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dominator Tree after building the plain CFG.\n&quot;</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;             VPDomTree.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a0b79243577798dfbefa6f61ff08898ea">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassllvm_1_1Instruction_html_a3287172f2d13af086e6d66364e8c6de3"><div class="ttname"><a href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">llvm::Instruction::getNumSuccessors</a></div><div class="ttdeci">unsigned getNumSuccessors() const LLVM_READONLY</div><div class="ttdoc">Return the number of successors that this instruction has.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00823">Instruction.cpp:823</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ab48af53a5000ecede46c76dabb4578d2"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">llvm::LoopBase::getExitBlock</a></div><div class="ttdeci">BlockT * getExitBlock() const</div><div class="ttdoc">If getExitBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00107">LoopInfoImpl.h:107</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a0b79243577798dfbefa6f61ff08898ea"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a0b79243577798dfbefa6f61ff08898ea">llvm::DominatorTreeBase::print</a></div><div class="ttdeci">void print(raw_ostream &amp;O) const</div><div class="ttdoc">print - Convert to human readable form</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00726">GenericDomTree.h:726</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a0b931781aa589c6ebe64a76c1447e5b2"><div class="ttname"><a href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">llvm::User::operands</a></div><div class="ttdeci">op_range operands()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00242">User.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBasicBlock_html"><div class="ttname"><a href="classllvm_1_1VPBasicBlock.html">llvm::VPBasicBlock</a></div><div class="ttdoc">VPBasicBlock serves as the leaf of the Hierarchical Control-Flow Graph.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l01945">VPlan.h:1945</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPWidenPHIRecipe_html"><div class="ttname"><a href="classllvm_1_1VPWidenPHIRecipe.html">llvm::VPWidenPHIRecipe</a></div><div class="ttdoc">A recipe for handling header phis that are widened in the vector loop.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l01215">VPlan.h:1215</a></div></div>
<div class="ttc" id="aVPlanHCFGBuilder_8h_html"><div class="ttname"><a href="VPlanHCFGBuilder_8h.html">VPlanHCFGBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPlanHCFGBuilder_html_a8ef4332eb7802ff0c53ca8ba7e999298"><div class="ttname"><a href="classllvm_1_1VPlanHCFGBuilder.html#a8ef4332eb7802ff0c53ca8ba7e999298">llvm::VPlanHCFGBuilder::buildHierarchicalCFG</a></div><div class="ttdeci">void buildHierarchicalCFG()</div><div class="ttdoc">Build H-CFG for TheLoop and update Plan accordingly.</div><div class="ttdef"><b>Definition:</b> <a href="VPlanHCFGBuilder_8cpp_source.html#l00384">VPlanHCFGBuilder.cpp:384</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_af2f81059dc7566164b018aac6555eb1a"><div class="ttname"><a href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">llvm::LoopBase::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00171">LoopInfo.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPInstruction_html_a9ccd98ba5679e4659a9990fa63f418f0a0062eccdb4956531f7b6a3cf71c3320c"><div class="ttname"><a href="classllvm_1_1VPInstruction.html#a9ccd98ba5679e4659a9990fa63f418f0a0062eccdb4956531f7b6a3cf71c3320c">llvm::VPInstruction::BranchOnCond</a></div><div class="ttdeci">@ BranchOnCond</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00800">VPlan.h:800</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBlocksRPO_html"><div class="ttname"><a href="classllvm_1_1LoopBlocksRPO.html">llvm::LoopBlocksRPO</a></div><div class="ttdoc">Wrapper class to LoopBlocksDFS that provides a standard begin()/end() interface for the DFS reverse p...</div><div class="ttdef"><b>Definition:</b> <a href="LoopIterator_8h_source.html#l00172">LoopIterator.h:172</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html">llvm::VPBlockBase</a></div><div class="ttdoc">VPBlockBase is the building block of the Hierarchical Control-Flow Graph.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00390">VPlan.h:390</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBasicBlock_html_a23773e962f9a56c9bdf13f7668b063a5"><div class="ttname"><a href="classllvm_1_1VPBasicBlock.html#a23773e962f9a56c9bdf13f7668b063a5">llvm::VPBasicBlock::appendRecipe</a></div><div class="ttdeci">void appendRecipe(VPRecipeBase *Recipe)</div><div class="ttdoc">Augment the existing recipes of a VPBasicBlock with an additional Recipe as the last recipe.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02013">VPlan.h:2013</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPInstruction_html"><div class="ttname"><a href="classllvm_1_1VPInstruction.html">llvm::VPInstruction</a></div><div class="ttdoc">This is a concrete Recipe that models a single VPlan-level instruction.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00779">VPlan.h:779</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBuilder_html"><div class="ttname"><a href="classllvm_1_1VPBuilder.html">llvm::VPBuilder</a></div><div class="ttdoc">VPlan-based builder utility analogous to IRBuilder.</div><div class="ttdef"><b>Definition:</b> <a href="LoopVectorizationPlanner_8h_source.html#l00043">LoopVectorizationPlanner.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html_a6a02d7faad162c3e17d0c522d032320b"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html#a6a02d7faad162c3e17d0c522d032320b">llvm::VPBlockBase::setPredecessors</a></div><div class="ttdeci">void setPredecessors(ArrayRef&lt; VPBlockBase * &gt; NewPreds)</div><div class="ttdoc">Set each VPBasicBlock in NewPreds as predecessor of this VPBlockBase.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00574">VPlan.h:574</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a98eb0888f30e7a27151a7b02fa053205"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a98eb0888f30e7a27151a7b02fa053205">llvm::LoopBase::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00172">LoopInfo.h:172</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPValue_html"><div class="ttname"><a href="classllvm_1_1VPValue.html">llvm::VPValue</a></div><div class="ttdef"><b>Definition:</b> <a href="VPlanValue_8h_source.html#l00044">VPlanValue.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a7efd1f0c1206d95e4fe01a9b49a57b82"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a7efd1f0c1206d95e4fe01a9b49a57b82">llvm::SmallVectorImpl::append</a></div><div class="ttdeci">void append(ItTy in_start, ItTy in_end)</div><div class="ttdoc">Add the specified range to the end of the SmallVector.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00687">SmallVector.h:687</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_adf6f53d7652b471c995b7d10f3dd2729"><div class="ttname"><a href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">llvm::LoopBase::getExitingBlock</a></div><div class="ttdeci">BlockT * getExitingBlock() const</div><div class="ttdoc">If getExitingBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00048">LoopInfoImpl.h:48</a></div></div>
<div class="ttc" id="aLoopIterator_8h_html"><div class="ttname"><a href="LoopIterator_8h.html">LoopIterator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPRegionBlock_html"><div class="ttname"><a href="classllvm_1_1VPRegionBlock.html">llvm::VPRegionBlock</a></div><div class="ttdoc">VPRegionBlock represents a collection of VPBasicBlocks and VPRegionBlocks which form a Single-Entry-S...</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02069">VPlan.h:2069</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPlan_html_a242fb01fcd9fab0be0f487b67fd94a0a"><div class="ttname"><a href="classllvm_1_1VPlan.html#a242fb01fcd9fab0be0f487b67fd94a0a">llvm::VPlan::setName</a></div><div class="ttdeci">void setName(const Twine &amp;newName)</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02282">VPlan.h:2282</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6e5d2e18c81baaeec7dadc81a0dea993"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6e5d2e18c81baaeec7dadc81a0dea993">llvm::Instruction::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned Idx) const LLVM_READONLY</div><div class="ttdoc">Return the specified successor. This instruction must be a terminator.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00835">Instruction.cpp:835</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockUtils_html_abc51f1d1a60a9d62ebe015d72ea11699"><div class="ttname"><a href="classllvm_1_1VPBlockUtils.html#abc51f1d1a60a9d62ebe015d72ea11699">llvm::VPBlockUtils::connectBlocks</a></div><div class="ttdeci">static void connectBlocks(VPBlockBase *From, VPBlockBase *To)</div><div class="ttdoc">Connect VPBlockBases From and To bi-directionally.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02524">VPlan.h:2524</a></div></div>
<div class="ttc" id="aLoopVectorizationPlanner_8h_html"><div class="ttname"><a href="LoopVectorizationPlanner_8h.html">LoopVectorizationPlanner.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ac3280e7f76f955403fe17eacf126b90d"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const</div><div class="ttdoc">If there is a preheader for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00183">LoopInfoImpl.h:183</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html_aa13d3b4d460075f3bb6a6eeb6a5e9bd7"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html#aa13d3b4d460075f3bb6a6eeb6a5e9bd7">llvm::VPBlockBase::setTwoSuccessors</a></div><div class="ttdeci">void setTwoSuccessors(VPBlockBase *IfTrue, VPBlockBase *IfFalse)</div><div class="ttdoc">Set two given VPBlockBases IfTrue and IfFalse to be the two successors of this VPBlockBase.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00565">VPlan.h:565</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1230fd674d2609b96527fe65eaf40b1b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const</div><div class="ttdoc">If there is a single latch block for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00232">LoopInfoImpl.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockUtils_html_a61f1451694a3638db85170c7f55d5581"><div class="ttname"><a href="classllvm_1_1VPBlockUtils.html#a61f1451694a3638db85170c7f55d5581">llvm::VPBlockUtils::disconnectBlocks</a></div><div class="ttdeci">static void disconnectBlocks(VPBlockBase *From, VPBlockBase *To)</div><div class="ttdoc">Disconnect VPBlockBases From and To bi-directionally.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02535">VPlan.h:2535</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_aa0641ae965656ff9988d67a35140e4d9"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">llvm::DominatorTreeBase::recalculate</a></div><div class="ttdeci">void recalculate(ParentType &amp;Func)</div><div class="ttdoc">recalculate - compute a dominator tree for the given function</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00795">GenericDomTree.h:795</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPlan_html_ab979aba6ac619479c6387779528e1fbb"><div class="ttname"><a href="classllvm_1_1VPlan.html#ab979aba6ac619479c6387779528e1fbb">llvm::VPlan::getVectorLoopRegion</a></div><div class="ttdeci">VPRegionBlock * getVectorLoopRegion()</div><div class="ttdoc">Returns the VPRegionBlock of the vector loop.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02359">VPlan.h:2359</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html_ae0ad192a841a53fd3a289320e0958e10"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html#ae0ad192a841a53fd3a289320e0958e10">llvm::VPBlockBase::setOneSuccessor</a></div><div class="ttdeci">void setOneSuccessor(VPBlockBase *Successor)</div><div class="ttdoc">Set a given VPBlockBase Successor as the single successor of this VPBlockBase.</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00556">VPlan.h:556</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html_ae2be49bdbbda0aeadd51549f4b88c839"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html#ae2be49bdbbda0aeadd51549f4b88c839">llvm::VPBlockBase::setParent</a></div><div class="ttdeci">void setParent(VPRegionBlock *P)</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00473">VPlan.h:473</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html_a392f732b65bedd5e31a46923407061d7"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html#a392f732b65bedd5e31a46923407061d7">llvm::VPBlockBase::getParent</a></div><div class="ttdeci">VPRegionBlock * getParent()</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00462">VPlan.h:462</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPlan_html_a0ef812735aa773bbe9dab2bc0a6f3e66"><div class="ttname"><a href="classllvm_1_1VPlan.html#a0ef812735aa773bbe9dab2bc0a6f3e66">llvm::VPlan::setEntry</a></div><div class="ttdeci">VPBlockBase * setEntry(VPBlockBase *Block)</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02232">VPlan.h:2232</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPBlockBase_html_a2bd1c53f9607876b22c6fd3ec1e28a50"><div class="ttname"><a href="classllvm_1_1VPBlockBase.html#a2bd1c53f9607876b22c6fd3ec1e28a50">llvm::VPBlockBase::setName</a></div><div class="ttdeci">void setName(const Twine &amp;newName)</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l00455">VPlan.h:455</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a223dd14e7d12bc5cea01889b972a98b2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">str - Get the contents as an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00222">StringRef.h:222</a></div></div>
<div class="ttc" id="astructllvm_1_1VPlanVerifier_html_aad8a0f2c84d5febdc9ea917f720418d3"><div class="ttname"><a href="structllvm_1_1VPlanVerifier.html#aad8a0f2c84d5febdc9ea917f720418d3">llvm::VPlanVerifier::verifyHierarchicalCFG</a></div><div class="ttdeci">void verifyHierarchicalCFG(const VPRegionBlock *TopRegion) const</div><div class="ttdoc">Verify the invariants of the H-CFG starting from TopRegion.</div><div class="ttdef"><b>Definition:</b> <a href="VPlanVerifier_8cpp_source.html#l00126">VPlanVerifier.cpp:126</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1Region_html"><div class="ttname"><a href="classllvm_1_1Region.html">llvm::Region</a></div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00889">RegionInfo.h:889</a></div></div>
<div class="ttc" id="aclassllvm_1_1VPlan_html"><div class="ttname"><a href="classllvm_1_1VPlan.html">llvm::VPlan</a></div><div class="ttdoc">VPlan models a candidate for vectorization, encoding various decisions take to produce efficient outp...</div><div class="ttdef"><b>Definition:</b> <a href="VPlan_8h_source.html#l02166">VPlan.h:2166</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:39:15 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
