<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/ObjCopy/COFF/COFFWriter.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_852ebda2bb84520f77418fa9810685ae.html">ObjCopy</a></li><li class="navelem"><a class="el" href="dir_20e217aa3fb0c7ee2a1e10d3c2f88786.html">COFF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">COFFWriter.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="COFFWriter_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- COFFWriter.cpp -----------------------------------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="COFFWriter_8h.html">COFFWriter.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="COFFObject_8h.html">COFFObject.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ArrayRef_8h.html">llvm/ADT/ArrayRef.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BinaryFormat_2COFF_8h.html">llvm/BinaryFormat/COFF.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Object_2COFF_8h.html">llvm/Object/COFF.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Errc_8h.html">llvm/Support/Errc.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">namespace </span>objcopy {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">namespace </span>coff {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using namespace </span><a class="code" href="lib_2Target_2X86_2README_8txt.html#a1562fc446f77d508d88246f2da381a16">object</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1logicalview.html#a68bf3a0b21ddaa5e5dd4700790af833ca4fa2ac5353638195d4ce3bc48a5a9db7">COFF</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605">Error</a> COFFWriter::finalizeRelocTargets() {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">for</span> (Section &amp;Sec : Obj.getMutableSections()) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">for</span> (Relocation &amp;R : Sec.Relocs) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1ARMBuildAttrs.html#aea10ca6bf098a425d51ac7fe65d30ed6aa10cda45fcbf7c8c9804e4e4d2e1bcdf">Symbol</a> *Sym = Obj.findSymbol(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Target);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordflow">if</span> (Sym == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::invalid_symbol_index,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                 <span class="stringliteral">&quot;relocation target &#39;%s&#39; (%zu) not found&quot;</span>,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                 <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.TargetName.str().c_str(), <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Target);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Reloc.SymbolTableIndex = Sym-&gt;RawIndex;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605">Error</a> COFFWriter::finalizeSymbolContents() {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">for</span> (Symbol &amp;Sym : Obj.getMutableSymbols()) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (Sym.TargetSectionId &lt;= 0) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="comment">// Undefined, or a special kind of symbol. These negative values</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="comment">// are stored in the SectionNumber field which is unsigned.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      Sym.Sym.SectionNumber = <span class="keyword">static_cast&lt;</span><a class="code" href="classuint32__t.html">uint32_t</a><span class="keyword">&gt;</span>(Sym.TargetSectionId);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1ARMBuildAttrs.html#aea10ca6bf098a425d51ac7fe65d30ed6a69c8a3bdf3f5753779a342f0cd97c090">Section</a> *Sec = Obj.findSection(Sym.TargetSectionId);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">if</span> (Sec == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::invalid_symbol_index,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                 <span class="stringliteral">&quot;symbol &#39;%s&#39; points to a removed section&quot;</span>,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                 Sym.Name.str().c_str());</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      Sym.Sym.SectionNumber = Sec-&gt;Index;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">if</span> (Sym.Sym.NumberOfAuxSymbols == 1 &amp;&amp;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          Sym.Sym.StorageClass == <a class="code" href="namespacellvm_1_1COFF.html#a906c310d62ec1ae55afe3295a4fc2115afc617a23fd5e4cce7f2adfc7c2966e1c">IMAGE_SYM_CLASS_STATIC</a>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        coff_aux_section_definition *SD =</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="keyword">reinterpret_cast&lt;</span>coff_aux_section_definition *<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                Sym.AuxData[0].Opaque);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="classuint32__t.html">uint32_t</a> SDSectionNumber;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span> (Sym.AssociativeComdatTargetSectionId == 0) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          <span class="comment">// Not a comdat associative section; just set the Number field to</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          <span class="comment">// the number of the section itself.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          SDSectionNumber = Sec-&gt;Index;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          Sec = Obj.findSection(Sym.AssociativeComdatTargetSectionId);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          <span class="keywordflow">if</span> (Sec == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                object_error::invalid_symbol_index,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="stringliteral">&quot;symbol &#39;%s&#39; is associative to a removed section&quot;</span>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                Sym.Name.str().c_str());</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          SDSectionNumber = Sec-&gt;Index;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">// Update the section definition with the new section number.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        SD-&gt;NumberLowPart = <span class="keyword">static_cast&lt;</span><a class="code" href="classuint16__t.html">uint16_t</a><span class="keyword">&gt;</span>(SDSectionNumber);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        SD-&gt;NumberHighPart = <span class="keyword">static_cast&lt;</span><a class="code" href="classuint16__t.html">uint16_t</a><span class="keyword">&gt;</span>(SDSectionNumber &gt;&gt; 16);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Check that we actually have got AuxData to match the weak symbol target</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// we want to set. Only &gt;= 1 would be required, but only == 1 makes sense.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (Sym.WeakTargetSymbolId &amp;&amp; Sym.Sym.NumberOfAuxSymbols == 1) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      coff_aux_weak_external *WE =</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          <span class="keyword">reinterpret_cast&lt;</span>coff_aux_weak_external *<span class="keyword">&gt;</span>(Sym.AuxData[0].Opaque);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1ARMBuildAttrs.html#aea10ca6bf098a425d51ac7fe65d30ed6aa10cda45fcbf7c8c9804e4e4d2e1bcdf">Symbol</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1Exp.html#af7592dc94276d1958420bcfb414b6998">Target</a> = Obj.findSymbol(*Sym.WeakTargetSymbolId);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (Target == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::invalid_symbol_index,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                 <span class="stringliteral">&quot;symbol &#39;%s&#39; is missing its weak target&quot;</span>,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                 Sym.Name.str().c_str());</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      WE-&gt;TagIndex = <a class="code" href="namespacellvm_1_1AMDGPU_1_1Exp.html#af7592dc94276d1958420bcfb414b6998">Target</a>-&gt;RawIndex;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordtype">void</span> COFFWriter::layoutSections() {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getMutableSections()) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData &gt; 0)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRawData = FileSize;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRawData = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    FileSize += <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData; <span class="comment">// For executables, this is already</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                        <span class="comment">// aligned to FileAlignment.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs.size() &gt;= 0xffff) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Characteristics |= <a class="code" href="namespacellvm_1_1COFF.html#a45c610228e069b0b3efbcbc1d5577f5aa7a0c196168bd2cee7fedcbcf0a5c8bf1">COFF::IMAGE_SCN_LNK_NRELOC_OVFL</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.NumberOfRelocations = 0xffff;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRelocations = FileSize;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      FileSize += <span class="keyword">sizeof</span>(coff_relocation);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.NumberOfRelocations = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs.size();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRelocations = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs.size() ? FileSize : 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    FileSize += <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs.size() * <span class="keyword">sizeof</span>(coff_relocation);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    FileSize = <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(FileSize, FileAlignment);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Characteristics &amp; <a class="code" href="namespacellvm_1_1COFF.html#a45c610228e069b0b3efbcbc1d5577f5aa6a1c5fd37f3374c2e8e233d9e19bd205">IMAGE_SCN_CNT_INITIALIZED_DATA</a>)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      SizeOfInitializedData += <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;Expected&lt;size_t&gt; COFFWriter::finalizeStringTable() {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSections())</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.size() &gt; <a class="code" href="namespacellvm_1_1COFF.html#a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61">COFF::NameSize</a>)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      StrTabBuilder.add(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSymbols())</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.size() &gt; <a class="code" href="namespacellvm_1_1COFF.html#a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61">COFF::NameSize</a>)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      StrTabBuilder.add(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  StrTabBuilder.finalize();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getMutableSections()) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    memset(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Name, 0, <span class="keyword">sizeof</span>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Name));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.size() &lt;= <a class="code" href="namespacellvm_1_1COFF.html#a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61">COFF::NameSize</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">// Short names can go in the field directly.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Name, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.data(), <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.size());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">// Offset of the section name in the string table.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = StrTabBuilder.getOffset(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1COFF.html#a90b631351c27f8d64f1788ec334d7b4c">COFF::encodeSectionName</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Name, Offset))</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::invalid_section_index,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                 <span class="stringliteral">&quot;COFF string table is greater than 64GB, &quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                 <span class="stringliteral">&quot;unable to encode section name offset&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getMutableSymbols()) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.size() &gt; <a class="code" href="namespacellvm_1_1COFF.html#a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61">COFF::NameSize</a>) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym.Name.Offset.Zeroes = 0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym.Name.Offset.Offset = StrTabBuilder.getOffset(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      strncpy(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym.Name.ShortName, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Name.data(), <a class="code" href="namespacellvm_1_1COFF.html#a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61">COFF::NameSize</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> StrTabBuilder.getSize();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SymbolTy&gt;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;std::pair&lt;size_t, size_t&gt; COFFWriter::finalizeSymbolTable() {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">size_t</span> RawSymIndex = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getMutableSymbols()) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Symbols normally have NumberOfAuxSymbols set correctly all the time.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// For file symbols, we need to know the output file&#39;s symbol size to be</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// able to calculate the number of slots it occupies.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.AuxFile.empty())</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym.NumberOfAuxSymbols =</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.AuxFile.size(), <span class="keyword">sizeof</span>(SymbolTy)) / <span class="keyword">sizeof</span>(SymbolTy);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.RawIndex = RawSymIndex;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    RawSymIndex += 1 + <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym.NumberOfAuxSymbols;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">return</span> std::make_pair(RawSymIndex * <span class="keyword">sizeof</span>(SymbolTy), <span class="keyword">sizeof</span>(SymbolTy));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605">Error</a> COFFWriter::finalize(<span class="keywordtype">bool</span> IsBigObj) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">size_t</span> SymTabSize, SymbolSize;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  std::tie(SymTabSize, SymbolSize) = IsBigObj</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                         ? finalizeSymbolTable&lt;coff_symbol32&gt;()</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                         : finalizeSymbolTable&lt;<a class="code" href="namespacellvm_1_1object.html#ad98e524907a76433707c34609a4409a7">coff_symbol16</a>&gt;();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (Error <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = finalizeRelocTargets())</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span> (Error <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = finalizeSymbolContents())</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">size_t</span> SizeOfHeaders = 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  FileAlignment = 1;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">size_t</span> PeHeaderSize = 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (Obj.IsPE) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    Obj.DosHeader.AddressOfNewExeHeader =</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">sizeof</span>(Obj.DosHeader) + Obj.DosStub.size();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    SizeOfHeaders += Obj.DosHeader.AddressOfNewExeHeader + <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1COFF.html#aece3d8774b856cfd520c842bf134d4a0">PEMagic</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    FileAlignment = Obj.PeHeader.FileAlignment;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    Obj.PeHeader.NumberOfRvaAndSize = Obj.DataDirectories.size();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    PeHeaderSize = Obj.Is64 ? <span class="keyword">sizeof</span>(pe32plus_header) : <span class="keyword">sizeof</span>(pe32_header);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    SizeOfHeaders +=</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        PeHeaderSize + <span class="keyword">sizeof</span>(data_directory) * Obj.DataDirectories.size();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  Obj.CoffFileHeader.NumberOfSections = Obj.getSections().size();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  SizeOfHeaders +=</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      IsBigObj ? <span class="keyword">sizeof</span>(coff_bigobj_file_header) : <span class="keyword">sizeof</span>(coff_file_header);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  SizeOfHeaders += <span class="keyword">sizeof</span>(coff_section) * Obj.getSections().size();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  SizeOfHeaders = <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(SizeOfHeaders, FileAlignment);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  Obj.CoffFileHeader.SizeOfOptionalHeader =</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      PeHeaderSize + <span class="keyword">sizeof</span>(data_directory) * Obj.DataDirectories.size();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  FileSize = SizeOfHeaders;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  SizeOfInitializedData = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="ELFObject_8cpp.html#a782bd3507c3ce21c87bc884e7211afe3">layoutSections</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span> (Obj.IsPE) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    Obj.PeHeader.SizeOfHeaders = SizeOfHeaders;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    Obj.PeHeader.SizeOfInitializedData = SizeOfInitializedData;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (!Obj.getSections().empty()) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1ARMBuildAttrs.html#aea10ca6bf098a425d51ac7fe65d30ed6a69c8a3bdf3f5753779a342f0cd97c090">Section</a> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = Obj.getSections().back();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      Obj.PeHeader.SizeOfImage =</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress + <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualSize,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                  Obj.PeHeader.SectionAlignment);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// If the PE header had a checksum, clear it, since it isn&#39;t valid</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// any longer. (We don&#39;t calculate a new one.)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    Obj.PeHeader.CheckSum = 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  Expected&lt;size_t&gt; StrTabSizeOrErr = finalizeStringTable();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span> (!StrTabSizeOrErr)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> StrTabSizeOrErr.takeError();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">size_t</span> StrTabSize = *StrTabSizeOrErr;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">size_t</span> PointerToSymbolTable = FileSize;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// StrTabSize &lt;= 4 is the size of an empty string table, only consisting</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// of the length field.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span> (SymTabSize == 0 &amp;&amp; StrTabSize &lt;= 4 &amp;&amp; Obj.IsPE) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// For executables, don&#39;t point to the symbol table and skip writing</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// the length field, if both the symbol and string tables are empty.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    PointerToSymbolTable = 0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    StrTabSize = 0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">size_t</span> NumRawSymbols = SymTabSize / SymbolSize;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  Obj.CoffFileHeader.PointerToSymbolTable = PointerToSymbolTable;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  Obj.CoffFileHeader.NumberOfSymbols = NumRawSymbols;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  FileSize += SymTabSize + StrTabSize;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  FileSize = <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(FileSize, FileAlignment);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keywordtype">void</span> COFFWriter::writeHeaders(<span class="keywordtype">bool</span> IsBigObj) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  uint8_t *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(Buf-&gt;getBufferStart());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span> (Obj.IsPE) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;Obj.DosHeader, <span class="keyword">sizeof</span>(Obj.DosHeader));</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(Obj.DosHeader);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, Obj.DosStub.data(), Obj.DosStub.size());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += Obj.DosStub.size();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="namespacellvm_1_1COFF.html#aece3d8774b856cfd520c842bf134d4a0">PEMagic</a>, <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1COFF.html#aece3d8774b856cfd520c842bf134d4a0">PEMagic</a>));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1COFF.html#aece3d8774b856cfd520c842bf134d4a0">PEMagic</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (!IsBigObj) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;Obj.CoffFileHeader, <span class="keyword">sizeof</span>(Obj.CoffFileHeader));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(Obj.CoffFileHeader);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// Generate a coff_bigobj_file_header, filling it in with the values</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// from Obj.CoffFileHeader. All extra fields that don&#39;t exist in</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// coff_file_header can be set to hardcoded values.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    coff_bigobj_file_header BigObjHeader;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    BigObjHeader.Sig1 = <a class="code" href="namespacellvm_1_1COFF.html#a38731f9b23370e15ad002c2a712d89a8a3b426e5bcc52a3693b62bdbf03dca30e">IMAGE_FILE_MACHINE_UNKNOWN</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    BigObjHeader.Sig2 = 0xffff;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    BigObjHeader.Version = <a class="code" href="structllvm_1_1COFF_1_1BigObjHeader.html#aae27e43be0d725ab9c5ac6da2b4cbf10a35098a5e6c71482140d6a477ec7f56ea">BigObjHeader::MinBigObjectVersion</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    BigObjHeader.Machine = Obj.CoffFileHeader.Machine;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    BigObjHeader.TimeDateStamp = Obj.CoffFileHeader.TimeDateStamp;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(BigObjHeader.UUID, <a class="code" href="namespacellvm_1_1COFF.html#ae89cd5cd0f88610c3b724d104f6f0fd8">BigObjMagic</a>, <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1COFF.html#ae89cd5cd0f88610c3b724d104f6f0fd8">BigObjMagic</a>));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    BigObjHeader.unused1 = 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    BigObjHeader.unused2 = 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    BigObjHeader.unused3 = 0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    BigObjHeader.unused4 = 0;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// The value in Obj.CoffFileHeader.NumberOfSections is truncated, thus</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// get the original one instead.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    BigObjHeader.NumberOfSections = Obj.getSections().size();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    BigObjHeader.PointerToSymbolTable = Obj.CoffFileHeader.PointerToSymbolTable;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    BigObjHeader.NumberOfSymbols = Obj.CoffFileHeader.NumberOfSymbols;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;BigObjHeader, <span class="keyword">sizeof</span>(BigObjHeader));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(BigObjHeader);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span> (Obj.IsPE) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (Obj.Is64) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;Obj.PeHeader, <span class="keyword">sizeof</span>(Obj.PeHeader));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(Obj.PeHeader);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      pe32_header PeHeader;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <a class="code" href="namespacellvm_1_1objcopy_1_1coff.html#a61250bbdb8bca0ef99f4652f3a429fe9">copyPeHeader</a>(PeHeader, Obj.PeHeader);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">// The pe32plus_header (stored in Object) lacks the BaseOfData field.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      PeHeader.BaseOfData = Obj.BaseOfData;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;PeHeader, <span class="keyword">sizeof</span>(PeHeader));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(PeHeader);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;DD : Obj.DataDirectories) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;DD, <span class="keyword">sizeof</span>(DD));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(DD);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSections()) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header, <span class="keyword">sizeof</span>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">void</span> COFFWriter::writeSections() {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSections()) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    uint8_t *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(Buf-&gt;getBufferStart()) +</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                   <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRawData;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    ArrayRef&lt;uint8_t&gt; Contents = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getContents();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="lib_2Target_2WebAssembly_2README_8txt.html#a79ea041233b5866026c3071dfc464ec0">std::copy</a>(Contents.begin(), Contents.end(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// For executable sections, pad the remainder of the raw data size with</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// 0xcc, which is int3 on x86.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.Characteristics &amp; <a class="code" href="namespacellvm_1_1COFF.html#a45c610228e069b0b3efbcbc1d5577f5aa2b3dbe611464bb08a83985d56d7bc67b">IMAGE_SCN_CNT_CODE</a>) &amp;&amp;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData &gt; Contents.size())</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      memset(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> + Contents.size(), 0xcc,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;             <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData - Contents.size());</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs.size() &gt;= 0xffff) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      object::coff_relocation <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.VirtualAddress = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs.size() + 1;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.SymbolTableIndex = 0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Type = 0;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;R, <span class="keyword">sizeof</span>(R));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;R : <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Relocs) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &amp;<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Reloc, <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Reloc));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Reloc);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SymbolTy&gt; <span class="keywordtype">void</span> COFFWriter::writeSymbolStringTables() {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  uint8_t *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(Buf-&gt;getBufferStart()) +</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                 Obj.CoffFileHeader.PointerToSymbolTable;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="lib_2Target_2README_8txt.html#a7df6ed7588301267782c2bd4b7f6899d">for</a> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSymbols()) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// Convert symbols back to the right size, from coff_symbol32.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    copySymbol&lt;SymbolTy, coff_symbol32&gt;(*<span class="keyword">reinterpret_cast&lt;</span>SymbolTy *<span class="keyword">&gt;</span>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>),</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(SymbolTy);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.AuxFile.empty()) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// For file symbols, just write the string into the aux symbol slots,</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// assuming that the unwritten parts are initialized to zero in the memory</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="comment">// mapped file.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <a class="code" href="lib_2Target_2WebAssembly_2README_8txt.html#a79ea041233b5866026c3071dfc464ec0">std::copy</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.AuxFile.begin(), <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.AuxFile.end(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Sym.NumberOfAuxSymbols * <span class="keyword">sizeof</span>(SymbolTy);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="comment">// For other auxillary symbols, write their opaque payload into one symbol</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">// table slot each. For big object files, the symbols are larger than the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">// opaque auxillary symbol struct and we leave padding at the end of each</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">// entry.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> AuxSymbol &amp;AuxSym : <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.AuxData) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        ArrayRef&lt;uint8_t&gt; <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea60baadb22e80b147e4885ad16760e569">Ref</a> = AuxSym.getRef();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="lib_2Target_2WebAssembly_2README_8txt.html#a79ea041233b5866026c3071dfc464ec0">std::copy</a>(<a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea60baadb22e80b147e4885ad16760e569">Ref</a>.begin(), <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea60baadb22e80b147e4885ad16760e569">Ref</a>.end(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(SymbolTy);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (StrTabBuilder.getSize() &gt; 4 || !Obj.IsPE) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Always write a string table in object files, even an empty one.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    StrTabBuilder.write(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += StrTabBuilder.getSize();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605">Error</a> <a class="code" href="classllvm_1_1objcopy_1_1coff_1_1COFFWriter.html#aa33178217f3adda9b3fe805c1dfa5b5f">COFFWriter::write</a>(<span class="keywordtype">bool</span> IsBigObj) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span> (Error <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="ARCBranchFinalize_8cpp.html#a8e08eb3768ea6054b445ad1e5f0b9bba">finalize</a>(IsBigObj))</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  Buf = <a class="code" href="classllvm_1_1WritableMemoryBuffer.html#a3ba0db4e545291ac0dbf07804f13d351">WritableMemoryBuffer::getNewMemBuffer</a>(FileSize);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span> (!Buf)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(<a class="code" href="namespacellvm.html#a59739a4f15fb2ec57a6b7fcfe938546baafdb5594dc3e484fc1bfd7c564d550c1">llvm::errc::not_enough_memory</a>,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                             <span class="stringliteral">&quot;failed to allocate memory buffer of &quot;</span> +</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                 <a class="code" href="classllvm_1_1Twine.html#acaa1b3e2d07a6c9d2d7030c7dc7ec6a7">Twine::utohexstr</a>(FileSize) + <span class="stringliteral">&quot; bytes.&quot;</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  writeHeaders(IsBigObj);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  writeSections();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span> (IsBigObj)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    writeSymbolStringTables&lt;coff_symbol32&gt;();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    writeSymbolStringTables&lt;coff_symbol16&gt;();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (Obj.IsPE)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (Error <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = patchDebugDirectory())</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// TODO: Implement direct writing to the output stream (without intermediate</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// memory buffer Buf).</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  Out.write(Buf-&gt;getBufferStart(), Buf-&gt;getBufferSize());</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;Expected&lt;uint32_t&gt; COFFWriter::virtualAddressToFileAddress(<a class="code" href="classuint32__t.html">uint32_t</a> RVA) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSections()) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (RVA &gt;= <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress &amp;&amp;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        RVA &lt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress + <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRawData + RVA - <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::parse_failed,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                           <span class="stringliteral">&quot;debug directory payload not found&quot;</span>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">// Locate which sections contain the debug directories, iterate over all</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">// the debug_directory structs in there, and set the PointerToRawData field</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">// in all of them, according to their new physical location in the file.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605">Error</a> COFFWriter::patchDebugDirectory() {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (Obj.DataDirectories.size() &lt;= <a class="code" href="namespacellvm_1_1COFF.html#a8ec28bc8cedea7febace40170acf2404ac180d06a50e9fc580140a835bb60fb8c">DEBUG_DIRECTORY</a>)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keyword">const</span> data_directory *Dir = &amp;Obj.DataDirectories[<a class="code" href="namespacellvm_1_1COFF.html#a8ec28bc8cedea7febace40170acf2404ac180d06a50e9fc580140a835bb60fb8c">DEBUG_DIRECTORY</a>];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span> (Dir-&gt;Size &lt;= 0)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Obj.getSections()) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (Dir-&gt;RelativeVirtualAddress &gt;= <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress &amp;&amp;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        Dir-&gt;RelativeVirtualAddress &lt;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress + <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> (Dir-&gt;RelativeVirtualAddress + Dir-&gt;Size &gt;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress + <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.SizeOfRawData)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::parse_failed,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                 <span class="stringliteral">&quot;debug directory extends past end of section&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = Dir-&gt;RelativeVirtualAddress - <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.VirtualAddress;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      uint8_t *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(Buf-&gt;getBufferStart()) +</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                     <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Header.PointerToRawData + Offset;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      uint8_t *End = <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> + Dir-&gt;Size;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      while (<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> &lt; End) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        debug_directory *<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da14af644ca4aff07a3768974c824ac9d5">Debug</a> = <span class="keyword">reinterpret_cast&lt;</span>debug_directory *<span class="keyword">&gt;</span>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da14af644ca4aff07a3768974c824ac9d5">Debug</a>-&gt;PointerToRawData) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          <span class="keywordflow">if</span> (Expected&lt;uint32_t&gt; FilePosOrErr =</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                  virtualAddressToFileAddress(<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da14af644ca4aff07a3768974c824ac9d5">Debug</a>-&gt;AddressOfRawData))</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da14af644ca4aff07a3768974c824ac9d5">Debug</a>-&gt;PointerToRawData = *FilePosOrErr;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">return</span> FilePosOrErr.takeError();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> += <span class="keyword">sizeof</span>(debug_directory);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> += <span class="keyword">sizeof</span>(debug_directory);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="comment">// Debug directory found and patched, all done.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::parse_failed,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                           <span class="stringliteral">&quot;debug directory not found&quot;</span>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classllvm_1_1objcopy_1_1coff_1_1COFFWriter.html#aa33178217f3adda9b3fe805c1dfa5b5f">  458</a></span>&#160;<a class="code" href="classllvm_1_1Error.html">Error</a> <a class="code" href="classllvm_1_1objcopy_1_1coff_1_1COFFWriter.html#aa33178217f3adda9b3fe805c1dfa5b5f">COFFWriter::write</a>() {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordtype">bool</span> IsBigObj = Obj.getSections().size() &gt; <a class="code" href="namespacellvm_1_1COFF.html#ad3097c5eaf4198579c34562fd89a240e">MaxNumberOfSections16</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">if</span> (IsBigObj &amp;&amp; Obj.IsPE)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">createStringError</a>(object_error::parse_failed,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                             <span class="stringliteral">&quot;too many sections for executable&quot;</span>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a0cc156a5675c3f3e0ae9d329163b9f8b">write</a>(IsBigObj);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;} <span class="comment">// end namespace coff</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;} <span class="comment">// end namespace objcopy</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;} <span class="comment">// end namespace llvm</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html_ab102f0f12dd38aeea5906b1d80c792ff"><div class="ttname"><a href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">llvm::alignTo</a></div><div class="ttdeci">uint64_t alignTo(uint64_t Size, Align A)</div><div class="ttdoc">Returns a multiple of A needed to store Size bytes.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00155">Alignment.h:155</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a45c610228e069b0b3efbcbc1d5577f5aa7a0c196168bd2cee7fedcbcf0a5c8bf1"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a45c610228e069b0b3efbcbc1d5577f5aa7a0c196168bd2cee7fedcbcf0a5c8bf1">llvm::COFF::IMAGE_SCN_LNK_NRELOC_OVFL</a></div><div class="ttdeci">@ IMAGE_SCN_LNK_NRELOC_OVFL</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00315">COFF.h:315</a></div></div>
<div class="ttc" id="anamespacellvm_1_1lltok_html_af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605"><div class="ttname"><a href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a3766a4dce43f4efc7208a749cc7ac605">llvm::lltok::Error</a></div><div class="ttdeci">@ Error</div><div class="ttdef"><b>Definition:</b> <a href="LLToken_8h_source.html#l00021">LLToken.h:21</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a906c310d62ec1ae55afe3295a4fc2115afc617a23fd5e4cce7f2adfc7c2966e1c"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a906c310d62ec1ae55afe3295a4fc2115afc617a23fd5e4cce7f2adfc7c2966e1c">llvm::COFF::IMAGE_SYM_CLASS_STATIC</a></div><div class="ttdeci">@ IMAGE_SYM_CLASS_STATIC</div><div class="ttdoc">Static.</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00210">COFF.h:210</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0cc156a5675c3f3e0ae9d329163b9f8b"><div class="ttname"><a href="namespacellvm.html#a0cc156a5675c3f3e0ae9d329163b9f8b">llvm::write</a></div><div class="ttdeci">Error write(MCStreamer &amp;Out, ArrayRef&lt; std::string &gt; Inputs)</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00551">DWP.cpp:551</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html"><div class="ttname"><a href="Support_2ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Error_html_a4dfd0813c3d0e0a30439b5a3e9196b59"><div class="ttname"><a href="classllvm_1_1Error.html#a4dfd0813c3d0e0a30439b5a3e9196b59">llvm::Error::success</a></div><div class="ttdeci">static ErrorSuccess success()</div><div class="ttdoc">Create a success value.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2Error_8h_source.html#l00330">Error.h:330</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a38731f9b23370e15ad002c2a712d89a8a3b426e5bcc52a3693b62bdbf03dca30e"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a38731f9b23370e15ad002c2a712d89a8a3b426e5bcc52a3693b62bdbf03dca30e">llvm::COFF::IMAGE_FILE_MACHINE_UNKNOWN</a></div><div class="ttdeci">@ IMAGE_FILE_MACHINE_UNKNOWN</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00095">COFF.h:95</a></div></div>
<div class="ttc" id="aBinaryFormat_2COFF_8h_html"><div class="ttname"><a href="BinaryFormat_2COFF_8h.html">COFF.h</a></div></div>
<div class="ttc" id="aErrc_8h_html"><div class="ttname"><a href="Errc_8h.html">Errc.h</a></div></div>
<div class="ttc" id="aELFObject_8cpp_html_a782bd3507c3ce21c87bc884e7211afe3"><div class="ttname"><a href="ELFObject_8cpp.html#a782bd3507c3ce21c87bc884e7211afe3">layoutSections</a></div><div class="ttdeci">static uint64_t layoutSections(Range Sections, uint64_t Offset)</div><div class="ttdef"><b>Definition:</b> <a href="ELFObject_8cpp_source.html#l02287">ELFObject.cpp:2287</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Exp_html_af7592dc94276d1958420bcfb414b6998"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Exp.html#af7592dc94276d1958420bcfb414b6998">llvm::AMDGPU::Exp::Target</a></div><div class="ttdeci">Target</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00868">SIDefines.h:868</a></div></div>
<div class="ttc" id="aCOFFWriter_8h_html"><div class="ttname"><a href="COFFWriter_8h.html">COFFWriter.h</a></div></div>
<div class="ttc" id="aCOFFObject_8h_html"><div class="ttname"><a href="COFFObject_8h.html">COFFObject.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_aece3d8774b856cfd520c842bf134d4a0"><div class="ttname"><a href="namespacellvm_1_1COFF.html#aece3d8774b856cfd520c842bf134d4a0">llvm::COFF::PEMagic</a></div><div class="ttdeci">static const char PEMagic[]</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00035">COFF.h:35</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RegState_html_aef4cc0c855dc833e2a9d58a50703320da14af644ca4aff07a3768974c824ac9d5"><div class="ttname"><a href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da14af644ca4aff07a3768974c824ac9d5">llvm::RegState::Debug</a></div><div class="ttdeci">@ Debug</div><div class="ttdoc">Register 'use' is for debugging purpose.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00056">MachineInstrBuilder.h:56</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARMBuildAttrs_html_aea10ca6bf098a425d51ac7fe65d30ed6a69c8a3bdf3f5753779a342f0cd97c090"><div class="ttname"><a href="namespacellvm_1_1ARMBuildAttrs.html#aea10ca6bf098a425d51ac7fe65d30ed6a69c8a3bdf3f5753779a342f0cd97c090">llvm::ARMBuildAttrs::Section</a></div><div class="ttdeci">@ Section</div><div class="ttdoc">Legacy Tags.</div><div class="ttdef"><b>Definition:</b> <a href="ARMBuildAttributes_8h_source.html#l00082">ARMBuildAttributes.h:82</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a45c610228e069b0b3efbcbc1d5577f5aa6a1c5fd37f3374c2e8e233d9e19bd205"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a45c610228e069b0b3efbcbc1d5577f5aa6a1c5fd37f3374c2e8e233d9e19bd205">llvm::COFF::IMAGE_SCN_CNT_INITIALIZED_DATA</a></div><div class="ttdeci">@ IMAGE_SCN_CNT_INITIALIZED_DATA</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00289">COFF.h:289</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9db8c44b250b90e3ab7e4d144e7c9c2ea60baadb22e80b147e4885ad16760e569"><div class="ttname"><a href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea60baadb22e80b147e4885ad16760e569">llvm::ModRefInfo::Ref</a></div><div class="ttdeci">@ Ref</div><div class="ttdoc">The access may reference the value stored in memory.</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aARCBranchFinalize_8cpp_html_a8e08eb3768ea6054b445ad1e5f0b9bba"><div class="ttname"><a href="ARCBranchFinalize_8cpp.html#a8e08eb3768ea6054b445ad1e5f0b9bba">finalize</a></div><div class="ttdeci">arc branch finalize</div><div class="ttdef"><b>Definition:</b> <a href="ARCBranchFinalize_8cpp_source.html#l00065">ARCBranchFinalize.cpp:65</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a68bf3a0b21ddaa5e5dd4700790af833ca4fa2ac5353638195d4ce3bc48a5a9db7"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a68bf3a0b21ddaa5e5dd4700790af833ca4fa2ac5353638195d4ce3bc48a5a9db7">llvm::logicalview::LVBinaryType::COFF</a></div><div class="ttdeci">@ COFF</div></div>
<div class="ttc" id="astructllvm_1_1COFF_1_1BigObjHeader_html_aae27e43be0d725ab9c5ac6da2b4cbf10a35098a5e6c71482140d6a477ec7f56ea"><div class="ttname"><a href="structllvm_1_1COFF_1_1BigObjHeader.html#aae27e43be0d725ab9c5ac6da2b4cbf10a35098a5e6c71482140d6a477ec7f56ea">llvm::COFF::BigObjHeader::MinBigObjectVersion</a></div><div class="ttdeci">@ MinBigObjectVersion</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00075">COFF.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1WritableMemoryBuffer_html_a3ba0db4e545291ac0dbf07804f13d351"><div class="ttname"><a href="classllvm_1_1WritableMemoryBuffer.html#a3ba0db4e545291ac0dbf07804f13d351">llvm::WritableMemoryBuffer::getNewMemBuffer</a></div><div class="ttdeci">static std::unique_ptr&lt; WritableMemoryBuffer &gt; getNewMemBuffer(size_t Size, const Twine &amp;BufferName=&quot;&quot;)</div><div class="ttdoc">Allocate a new zero-initialized MemoryBuffer of the specified size.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryBuffer_8cpp_source.html#l00330">MemoryBuffer.cpp:330</a></div></div>
<div class="ttc" id="anamespacellvm_1_1object_html_ad98e524907a76433707c34609a4409a7"><div class="ttname"><a href="namespacellvm_1_1object.html#ad98e524907a76433707c34609a4409a7">llvm::object::coff_symbol16</a></div><div class="ttdeci">coff_symbol&lt; support::ulittle16_t &gt; coff_symbol16</div><div class="ttdef"><b>Definition:</b> <a href="Object_2COFF_8h_source.html#l00265">COFF.h:265</a></div></div>
<div class="ttc" id="anamespacellvm_html_a59739a4f15fb2ec57a6b7fcfe938546baafdb5594dc3e484fc1bfd7c564d550c1"><div class="ttname"><a href="namespacellvm.html#a59739a4f15fb2ec57a6b7fcfe938546baafdb5594dc3e484fc1bfd7c564d550c1">llvm::errc::not_enough_memory</a></div><div class="ttdeci">@ not_enough_memory</div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_a1562fc446f77d508d88246f2da381a16"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#a1562fc446f77d508d88246f2da381a16">object</a></div><div class="ttdeci">bar al al movzbl eax ret Missed when stored in a memory object</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l01411">README.txt:1411</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html_acaa1b3e2d07a6c9d2d7030c7dc7ec6a7"><div class="ttname"><a href="classllvm_1_1Twine.html#acaa1b3e2d07a6c9d2d7030c7dc7ec6a7">llvm::Twine::utohexstr</a></div><div class="ttdeci">static Twine utohexstr(const uint64_t &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00404">Twine.h:404</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6110fc30bc7311a6cf99814530362e21"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">llvm::AMDGPU::Hwreg::Offset</a></div><div class="ttdeci">Offset</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00432">SIDefines.h:432</a></div></div>
<div class="ttc" id="aArrayRef_8h_html"><div class="ttname"><a href="ArrayRef_8h.html">ArrayRef.h</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ae2bb081d94f22e64ca6bc4bd58512a93"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a></div><div class="ttdeci">&lt;%struct.s * &gt; cast struct s *S to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *agg result to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *memtmp to sbyte *&lt; sbyte * &gt; sbyte uint ret void llc ends up issuing two memcpy or custom lower memcpy(of small size) to be ldmia/stmia. I think option 2 is better but the current register allocator cannot allocate a chunk of registers at a time. A feasible temporary solution is to use specific physical registers at the lowering time for small(&lt;</div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a816489140cf6cf87a35a98b154b6abd6a084ca1f72ecd10e22d3d8867548e0f61">llvm::COFF::NameSize</a></div><div class="ttdeci">@ NameSize</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00057">COFF.h:57</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a8ec28bc8cedea7febace40170acf2404ac180d06a50e9fc580140a835bb60fb8c"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a8ec28bc8cedea7febace40170acf2404ac180d06a50e9fc580140a835bb60fb8c">llvm::COFF::DEBUG_DIRECTORY</a></div><div class="ttdeci">@ DEBUG_DIRECTORY</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00589">COFF.h:589</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_ae89cd5cd0f88610c3b724d104f6f0fd8"><div class="ttname"><a href="namespacellvm_1_1COFF.html#ae89cd5cd0f88610c3b724d104f6f0fd8">llvm::COFF::BigObjMagic</a></div><div class="ttdeci">static const char BigObjMagic[]</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00037">COFF.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a90b631351c27f8d64f1788ec334d7b4c"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a90b631351c27f8d64f1788ec334d7b4c">llvm::COFF::encodeSectionName</a></div><div class="ttdeci">bool encodeSectionName(char *Out, uint64_t Offset)</div><div class="ttdoc">Encode section name based on string table offset.</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8cpp_source.html#l00039">COFF.cpp:39</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a7df6ed7588301267782c2bd4b7f6899d"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a7df6ed7588301267782c2bd4b7f6899d">for</a></div><div class="ttdeci">this could be done in SelectionDAGISel along with other special for</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00104">README.txt:104</a></div></div>
<div class="ttc" id="anamespacellvm_1_1objcopy_1_1coff_html_a61250bbdb8bca0ef99f4652f3a429fe9"><div class="ttname"><a href="namespacellvm_1_1objcopy_1_1coff.html#a61250bbdb8bca0ef99f4652f3a429fe9">llvm::objcopy::coff::copyPeHeader</a></div><div class="ttdeci">void copyPeHeader(PeHeader1Ty &amp;Dest, const PeHeader2Ty &amp;Src)</div><div class="ttdef"><b>Definition:</b> <a href="COFFObject_8h_source.html#l00175">COFFObject.h:175</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4d2fd926089a58d482fb67a362e11bad"><div class="ttname"><a href="namespacellvm.html#a4d2fd926089a58d482fb67a362e11bad">llvm::createStringError</a></div><div class="ttdeci">Error createStringError(std::error_code EC, char const *Fmt, const Ts &amp;... Vals)</div><div class="ttdoc">Create formatted StringError object.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2Error_8h_source.html#l01246">Error.h:1246</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_ad3097c5eaf4198579c34562fd89a240e"><div class="ttname"><a href="namespacellvm_1_1COFF.html#ad3097c5eaf4198579c34562fd89a240e">llvm::COFF::MaxNumberOfSections16</a></div><div class="ttdeci">const int32_t MaxNumberOfSections16</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00032">COFF.h:32</a></div></div>
<div class="ttc" id="aclassuint16__t_html"><div class="ttname"><a href="classuint16__t.html">uint16_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1Error_html"><div class="ttname"><a href="classllvm_1_1Error.html">llvm::Error</a></div><div class="ttdoc">Lightweight error class with error context and mandatory checking.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2Error_8h_source.html#l00156">Error.h:156</a></div></div>
<div class="ttc" id="anamespacellvm_1_1COFF_html_a45c610228e069b0b3efbcbc1d5577f5aa2b3dbe611464bb08a83985d56d7bc67b"><div class="ttname"><a href="namespacellvm_1_1COFF.html#a45c610228e069b0b3efbcbc1d5577f5aa2b3dbe611464bb08a83985d56d7bc67b">llvm::COFF::IMAGE_SCN_CNT_CODE</a></div><div class="ttdeci">@ IMAGE_SCN_CNT_CODE</div><div class="ttdef"><b>Definition:</b> <a href="BinaryFormat_2COFF_8h_source.html#l00288">COFF.h:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1objcopy_1_1coff_1_1COFFWriter_html_aa33178217f3adda9b3fe805c1dfa5b5f"><div class="ttname"><a href="classllvm_1_1objcopy_1_1coff_1_1COFFWriter.html#aa33178217f3adda9b3fe805c1dfa5b5f">llvm::objcopy::coff::COFFWriter::write</a></div><div class="ttdeci">Error write()</div><div class="ttdef"><b>Definition:</b> <a href="COFFWriter_8cpp_source.html#l00458">COFFWriter.cpp:458</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARMBuildAttrs_html_aea10ca6bf098a425d51ac7fe65d30ed6aa10cda45fcbf7c8c9804e4e4d2e1bcdf"><div class="ttname"><a href="namespacellvm_1_1ARMBuildAttrs.html#aea10ca6bf098a425d51ac7fe65d30ed6aa10cda45fcbf7c8c9804e4e4d2e1bcdf">llvm::ARMBuildAttrs::Symbol</a></div><div class="ttdeci">@ Symbol</div><div class="ttdef"><b>Definition:</b> <a href="ARMBuildAttributes_8h_source.html#l00083">ARMBuildAttributes.h:83</a></div></div>
<div class="ttc" id="aObject_2COFF_8h_html"><div class="ttname"><a href="Object_2COFF_8h.html">COFF.h</a></div></div>
<div class="ttc" id="alib_2Target_2WebAssembly_2README_8txt_html_a79ea041233b5866026c3071dfc464ec0"><div class="ttname"><a href="lib_2Target_2WebAssembly_2README_8txt.html#a79ea041233b5866026c3071dfc464ec0">copy</a></div><div class="ttdeci">we should consider alternate ways to model stack dependencies Lots of things could be done in WebAssemblyTargetTransformInfo cpp there are numerous optimization related hooks that can be overridden in WebAssemblyTargetLowering Instead of the OptimizeReturned which should consider preserving the returned attribute through to MachineInstrs and extending the MemIntrinsicResults pass to do this optimization on calls too That would also let the WebAssemblyPeephole pass clean up dead defs for such as it does for stores Consider implementing and or getMachineCombinerPatterns Find a clean way to fix the problem which leads to the Shrink Wrapping pass being run after the WebAssembly PEI pass When setting multiple variables to the same we currently get code like const It could be done with a smaller encoding like local tee $pop5 local copy</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2WebAssembly_2README_8txt_source.html#l00101">README.txt:101</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:06:42 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
