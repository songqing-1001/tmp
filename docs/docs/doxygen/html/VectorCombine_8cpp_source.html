<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Vectorize/VectorCombine.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_acb975f027bc8cf760392318543d920a.html">Vectorize</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">VectorCombine.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="VectorCombine_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===------- VectorCombine.cpp - Optimize partial vector operations -------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This pass optimizes scalar/vector interactions using target cost models. The</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// transforms implemented here may not fit in traditional loop-based or SLP</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// vectorization passes.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="VectorCombine_8h.html">llvm/Transforms/Vectorize/VectorCombine.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AssumptionCache_8h.html">llvm/Analysis/AssumptionCache.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicAliasAnalysis_8h.html">llvm/Analysis/BasicAliasAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalsModRef_8h.html">llvm/Analysis/GlobalsModRef.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Loads_8h.html">llvm/Analysis/Loads.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="VectorUtils_8h.html">llvm/Analysis/VectorUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Vectorize_8h.html">llvm/Transforms/Vectorize.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   35</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;vector-combine&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionWorklist_8h.html">llvm/Transforms/Utils/InstructionWorklist.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumVecLoad, <span class="stringliteral">&quot;Number of vector loads formed&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumVecCmp, <span class="stringliteral">&quot;Number of vector compares formed&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumVecBO, <span class="stringliteral">&quot;Number of vector binops formed&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumVecCmpBO, <span class="stringliteral">&quot;Number of vector compare + binop formed&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumShufOfBitcast, <span class="stringliteral">&quot;Number of shuffles moved after bitcast&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumScalarBO, <span class="stringliteral">&quot;Number of scalar binops formed&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumScalarCmp, <span class="stringliteral">&quot;Number of scalar compares formed&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="VectorCombine_8cpp.html#acbc63323033a5a9de3d069827c51d3bf">DisableVectorCombine</a>(</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="stringliteral">&quot;disable-vector-combine&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable all vector combine transforms&quot;</span>));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="VectorCombine_8cpp.html#af430e1420ae91582114e512b797e4964">DisableBinopExtractShuffle</a>(</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="stringliteral">&quot;disable-binop-extract-shuffle&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable binop extract to shuffle transforms&quot;</span>));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="VectorCombine_8cpp.html#aa0a0dd3a69912556b16b034162a4ae19">MaxInstrsToScan</a>(</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="stringliteral">&quot;vector-combine-max-scan-instrs&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(30), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Max number of instructions to scan for vector combining.&quot;</span>));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#a935a117ebc18605ba99cdc14c80bdf0c">   61</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="VectorCombine_8cpp.html#a935a117ebc18605ba99cdc14c80bdf0c">InvalidIndex</a> = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;unsigned&gt;::max</a>();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">class </span>VectorCombine {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  VectorCombine(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT, <a class="code" href="classllvm_1_1AAResults.html">AAResults</a> &amp;AA, <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;AC,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="keywordtype">bool</span> TryEarlyFoldsOnly)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext()), <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>), DT(DT), AA(AA), AC(AC),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        TryEarlyFoldsOnly(TryEarlyFoldsOnly) {}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">run</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">TTI</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classllvm_1_1AAResults.html">AAResults</a> &amp;AA;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;AC;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">  /// If true, only perform beneficial early IR transforms. Do not introduce new</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">  /// vector operations.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> TryEarlyFoldsOnly;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classllvm_1_1InstructionWorklist.html">InstructionWorklist</a> Worklist;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// TODO: Direct calls from the top-level &quot;run&quot; loop use a plain &quot;Instruction&quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">//       parameter. That should be updated to specific sub-classes because the</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//       run loop was changed to dispatch on opcode.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">bool</span> vectorizeLoadInsert(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">bool</span> widenSubvectorLoad(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *getShuffleExtract(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                        <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                        <span class="keywordtype">unsigned</span> PreferredExtractIndex) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">bool</span> isExtractExtractCheap(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0, <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                             <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *&amp;ConvertToShuffle,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                             <span class="keywordtype">unsigned</span> PreferredExtractIndex);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">void</span> foldExtExtCmp(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0, <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                     <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">void</span> foldExtExtBinop(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0, <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                       <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">bool</span> foldExtractExtract(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">bool</span> foldInsExtFNeg(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">bool</span> foldBitcastShuf(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">bool</span> scalarizeBinopOrCmp(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">bool</span> foldExtractedCmps(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">bool</span> foldSingleElementStore(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">bool</span> scalarizeLoadExtract(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">bool</span> foldShuffleOfBinops(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">bool</span> foldShuffleFromReductions(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">bool</span> foldSelectShuffle(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">bool</span> FromReduction = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">void</span> replaceValue(<a class="code" href="classllvm_1_1Value.html">Value</a> &amp;Old, <a class="code" href="classllvm_1_1Value.html">Value</a> &amp;New) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    Old.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(&amp;New);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *NewI = dyn_cast&lt;Instruction&gt;(&amp;New)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>.takeName(&amp;Old);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#a3cc9848611dc0c92d60735f5de94b03f">pushUsersToWorkList</a>(*NewI);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#a1f3230f90474f0528f094d946f4ccc95">pushValue</a>(NewI);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#a1f3230f90474f0528f094d946f4ccc95">pushValue</a>(&amp;Old);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="LICM_8cpp.html#ab0cfc793d55940eac67854827dd365e9">eraseInstruction</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands())</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#a1f3230f90474f0528f094d946f4ccc95">pushValue</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#abfbfe7ff58105b170ca57742a9d378ee">remove</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;};</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#a78d37997d6b920824dbdec1ec1213bc5">  134</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="VectorCombine_8cpp.html#a78d37997d6b920824dbdec1ec1213bc5">canWidenLoad</a>(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// Do not widen load if atomic/volatile or under asan/hwasan/memtag/tsan.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// The widened load may load data from dirty regions or create data races</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// non-existent in the source.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> || !<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;isSimple() || !<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;hasOneUse() ||</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getFunction()-&gt;hasFnAttribute(Attribute::SanitizeMemTag) ||</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="namespacellvm.html#a423120c6a3bab0386276333090b574f8">mustSuppressSpeculation</a>(*<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>))</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// We are potentially transforming byte-sized (8-bit) memory accesses, so make</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// sure we have all of our type-based constraints in place for this target.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getType()-&gt;getScalarType();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ScalarSize = ScalarTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">unsigned</span> MinVectorSize = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a8fa8b3631e74e836453f972aac6b4b65">getMinVectorRegisterBitWidth</a>();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (!ScalarSize || !MinVectorSize || MinVectorSize % ScalarSize != 0 ||</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      ScalarSize % 8 != 0)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">bool</span> VectorCombine::vectorizeLoadInsert(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// Match insert into fixed vector of scalar value.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// TODO: Handle non-zero insert index.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">m_InsertElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#adea6dc2e42baa345b97be48b0370313d">m_Undef</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Scalar), <a class="code" href="namespacellvm_1_1PatternMatch.html#a874d53817a4923de8e58af6b278c09b0">m_ZeroInt</a>())) ||</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      !<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>-&gt;hasOneUse())</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Optionally match an extract from another vector.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">bool</span> HasExtract = <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Scalar, <a class="code" href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">m_ExtractElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>), <a class="code" href="namespacellvm_1_1PatternMatch.html#a874d53817a4923de8e58af6b278c09b0">m_ZeroInt</a>()));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">if</span> (!HasExtract)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> = <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = dyn_cast&lt;LoadInst&gt;(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="VectorCombine_8cpp.html#a78d37997d6b920824dbdec1ec1213bc5">canWidenLoad</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>))</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>-&gt;getType();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ScalarSize = ScalarTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">unsigned</span> MinVectorSize = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a8fa8b3631e74e836453f972aac6b4b65">getMinVectorRegisterBitWidth</a>();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// Check safety of replacing the scalar load with a larger vector load.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// We use minimal alignment (maximum flexibility) because we only care about</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// the dereferenceable region. When calculating cost and creating a new op,</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// we may use a larger value based on alignment attributes.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPtr = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getPointerOperand()-&gt;stripPointerCasts();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;PointerType&gt;(SrcPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp; <span class="stringliteral">&quot;Expected a pointer type&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">unsigned</span> MinVecNumElts = MinVectorSize / ScalarSize;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">auto</span> *MinVecTy = <a class="code" href="classllvm_1_1VectorType.html#a8c90e6c50e795b17466482a04947690e">VectorType::get</a>(ScalarTy, MinVecNumElts, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">unsigned</span> OffsetEltIndex = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getAlign();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">isSafeToLoadUnconditionally</a>(SrcPtr, MinVecTy, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, &amp;AC,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                   &amp;DT)) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// It is not safe to load directly from the pointer, but we can still peek</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// through gep offsets and check if it safe to load from a base address with</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// updated alignment. If it is, we can shuffle the element(s) into place</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// after loading.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">unsigned</span> OffsetBitWidth = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexTypeSizeInBits(SrcPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>(OffsetBitWidth, 0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    SrcPtr = SrcPtr-&gt;<a class="code" href="classllvm_1_1Value.html#ae7a4de5d3c7d0f2ba56e3933fb2007bf">stripAndAccumulateInBoundsConstantOffsets</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, Offset);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// We want to shuffle the result down from a high element of a vector, so</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// the offset must be positive.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.isNegative())</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// The offset must be a multiple of the scalar element to shuffle cleanly</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// in the element&#39;s size.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ScalarSizeInBytes = ScalarSize / 8;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.urem(ScalarSizeInBytes) != 0)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// If we load MinVecNumElts, will our target element still be loaded?</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    OffsetEltIndex = <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.udiv(ScalarSizeInBytes).getZExtValue();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (OffsetEltIndex &gt;= MinVecNumElts)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">isSafeToLoadUnconditionally</a>(SrcPtr, MinVecTy, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, &amp;AC,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                     &amp;DT))</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// Update alignment with offset value. Note that the offset could be negated</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// to more accurately represent &quot;(new) SrcPtr - Offset = (old) SrcPtr&quot;, but</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// negation does not change the result of the alignment calculation.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    Alignment = <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(Alignment, <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.getZExtValue());</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Original pattern: insertelt undef, load [free casts of] PtrOp, 0</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// Use the greater of the alignment on the load or its source pointer.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  Alignment = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(SrcPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a47f5c74e1b14ba4a61db057400644acc">getPointerAlignment</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), Alignment);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *LoadTy = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getType();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">unsigned</span> AS = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getPointerAddressSpace();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost =</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, LoadTy, Alignment, AS);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts = <a class="code" href="classllvm_1_1APInt.html#aec662ee6ab1490a4cabebf2812e5b9ca">APInt::getOneBitSet</a>(MinVecNumElts, 0);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  OldCost +=</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ae7fe2d1bb4f708d68fe7a908ba675d1b">getScalarizationOverhead</a>(MinVecTy, DemandedElts,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                   <span class="comment">/* Insert */</span> <span class="keyword">true</span>, HasExtract, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// New pattern: load VecPtr</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> NewCost =</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, MinVecTy, Alignment, AS);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// Optionally, we are shuffling the loaded vector element(s) into place.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// For the mask set everything but element 0 to undef to prevent poison from</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// propagating from the extra loaded memory. This will also optionally</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// shrink/grow the vector from the loaded size to the output size.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// We assume this operation has no cost in codegen if there was no offset.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// Note that we could use freeze to avoid poison problems, but then we might</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// still need a shuffle to change the vector size.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">unsigned</span> OutputNumElts = Ty-&gt;getNumElements();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 16&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>(OutputNumElts, <a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OffsetEltIndex &lt; MinVecNumElts &amp;&amp; <span class="stringliteral">&quot;Address offset too big&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[0] = OffsetEltIndex;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (OffsetEltIndex)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    NewCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TTI::SK_PermuteSingleSrc</a>, MinVecTy, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// We can aggressively convert to the vector form because the backend can</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// invert this transform if it does not result in a performance win.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (OldCost &lt; NewCost || !NewCost.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>())</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// It is safe and potentially profitable to load a vector directly:</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// inselt undef, load Scalar, 0 --&gt; load VecPtr</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CastedPtr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePointerBitCastOrAddrSpaceCast(</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      SrcPtr, MinVecTy-&gt;getPointerTo(AS));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecLd = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlignedLoad(MinVecTy, CastedPtr, Alignment);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  VecLd = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(VecLd, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *VecLd);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  ++NumVecLoad;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">/// If we are loading a vector and then inserting it into a larger vector with</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">/// undefined elements, try to load the larger vector and eliminate the insert.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">/// This removes a shuffle in IR and may allow combining of other loaded values.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::widenSubvectorLoad(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// Match subvector insert of fixed vector.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">auto</span> *Shuf = cast&lt;ShuffleVectorInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> (!Shuf-&gt;isIdentityWithPadding())</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Allow a non-canonical shuffle mask that is choosing elements from op1.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">unsigned</span> NumOpElts =</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      cast&lt;FixedVectorType&gt;(Shuf-&gt;getOperand(0)-&gt;getType())-&gt;getNumElements();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="SPIRVModuleAnalysis_8cpp.html#acaab1e2660e7055669741c9f485e26c5">OpIndex</a> = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(Shuf-&gt;getShuffleMask(), [&amp;NumOpElts](<span class="keywordtype">int</span> M) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    return M &gt;= (int)(NumOpElts);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  });</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = dyn_cast&lt;LoadInst&gt;(Shuf-&gt;getOperand(<a class="code" href="SPIRVModuleAnalysis_8cpp.html#acaab1e2660e7055669741c9f485e26c5">OpIndex</a>));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="VectorCombine_8cpp.html#a78d37997d6b920824dbdec1ec1213bc5">canWidenLoad</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// We use minimal alignment (maximum flexibility) because we only care about</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// the dereferenceable region. When calculating cost and creating a new op,</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// we may use a larger value based on alignment attributes.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPtr = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getPointerOperand()-&gt;stripPointerCasts();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;PointerType&gt;(SrcPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp; <span class="stringliteral">&quot;Expected a pointer type&quot;</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getAlign();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">isSafeToLoadUnconditionally</a>(SrcPtr, Ty, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, &amp;AC, &amp;DT))</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  Alignment = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(SrcPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a47f5c74e1b14ba4a61db057400644acc">getPointerAlignment</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), Alignment);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *LoadTy = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getType();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">unsigned</span> AS = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getPointerAddressSpace();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// Original pattern: insert_subvector (load PtrOp)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// This conservatively assumes that the cost of a subvector insert into an</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// undef value is 0. We could add that cost if the cost model accurately</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// reflects the real cost of that operation.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost =</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, LoadTy, Alignment, AS);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// New pattern: load PtrOp</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> NewCost =</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, Ty, Alignment, AS);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// We can aggressively convert to the vector form because the backend can</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// invert this transform if it does not result in a performance win.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (OldCost &lt; NewCost || !NewCost.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>())</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CastedPtr =</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePointerBitCastOrAddrSpaceCast(SrcPtr, Ty-&gt;getPointerTo(AS));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecLd = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlignedLoad(Ty, CastedPtr, Alignment);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *VecLd);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  ++NumVecLoad;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/// Determine which, if any, of the inputs should be replaced by a shuffle</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/// followed by extract from a different index.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *VectorCombine::getShuffleExtract(</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0, <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">unsigned</span> PreferredExtractIndex = <a class="code" href="VectorCombine_8cpp.html#a935a117ebc18605ba99cdc14c80bdf0c">InvalidIndex</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keyword">auto</span> *Index0C = dyn_cast&lt;ConstantInt&gt;(Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>());</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keyword">auto</span> *Index1C = dyn_cast&lt;ConstantInt&gt;(Ext1-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>());</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Index0C &amp;&amp; Index1C &amp;&amp; <span class="stringliteral">&quot;Expected constant extract indexes&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordtype">unsigned</span> Index0 = Index0C-&gt;getZExtValue();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">unsigned</span> Index1 = Index1C-&gt;getZExtValue();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// If the extract indexes are identical, no shuffle is needed.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">if</span> (Index0 == Index1)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *VecTy = Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VecTy == Ext1-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() &amp;&amp; <span class="stringliteral">&quot;Need matching types&quot;</span>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Cost0 =</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext0, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, Index0);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Cost1 =</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext1, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, Index1);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// If both costs are invalid no shuffle is needed</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (!Cost0.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; !Cost1.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>())</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// We are extracting from 2 different indexes, so one operand must be shuffled</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// before performing a vector operation and/or extract. The more expensive</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// extract will be replaced by a shuffle.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (Cost0 &gt; Cost1)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> Ext0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (Cost1 &gt; Cost0)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> Ext1;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// If the costs are equal and there is a preferred extract index, shuffle the</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// opposite operand.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (PreferredExtractIndex == Index0)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> Ext1;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span> (PreferredExtractIndex == Index1)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">return</span> Ext0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// Otherwise, replace the extract with the higher index.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">return</span> Index0 &gt; Index1 ? Ext0 : Ext1;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">/// Compare the relative costs of 2 extracts followed by scalar operation vs.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">/// vector operation(s) followed by extract. Return true if the existing</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">/// instructions are cheaper than a vector alternative. Otherwise, return false</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">/// and if one of the extracts should be transformed to a shufflevector, set</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/// \p ConvertToShuffle to that extract instruction.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::isExtractExtractCheap(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                          <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                          <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *&amp;ConvertToShuffle,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                          <span class="keywordtype">unsigned</span> PreferredExtractIndex) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">auto</span> *Ext0IndexC = dyn_cast&lt;ConstantInt&gt;(Ext0-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">auto</span> *Ext1IndexC = dyn_cast&lt;ConstantInt&gt;(Ext1-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ext0IndexC &amp;&amp; Ext1IndexC &amp;&amp; <span class="stringliteral">&quot;Expected constant extract indexes&quot;</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = Ext0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;VectorType&gt;(Ext0-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> ScalarOpCost, VectorOpCost;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// Get cost estimates for scalar and vector versions of the operation.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordtype">bool</span> IsBinOp = <a class="code" href="classllvm_1_1Instruction.html#a5c88132322ca3f46f242f7c023a57010">Instruction::isBinaryOp</a>(Opcode);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">if</span> (IsBinOp) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    ScalarOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Opcode, ScalarTy);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    VectorOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Opcode, VecTy);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((Opcode == Instruction::ICmp || Opcode == Instruction::FCmp) &amp;&amp;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;           <span class="stringliteral">&quot;Expected a compare&quot;</span>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = cast&lt;CmpInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).getPredicate();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    ScalarOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        Opcode, ScalarTy, <a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(ScalarTy), Pred);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    VectorOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        Opcode, VecTy, <a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(VecTy), Pred);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// Get cost estimates for the extract elements. These costs will factor into</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// both sequences.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">unsigned</span> Ext0Index = Ext0IndexC-&gt;getZExtValue();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">unsigned</span> Ext1Index = Ext1IndexC-&gt;getZExtValue();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Extract0Cost =</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext0, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, Ext0Index);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Extract1Cost =</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext1, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, Ext1Index);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// A more expensive extract will always be replaced by a splat shuffle.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// For example, if Ext0 is more expensive:</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// opcode (extelt V0, Ext0), (ext V1, Ext1) --&gt;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// extelt (opcode (splat V0, Ext0), V1), Ext1</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// TODO: Evaluate whether that always results in lowest cost. Alternatively,</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">//       check the cost of creating a broadcast shuffle and shuffling both</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">//       operands to element 0.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> CheapExtractCost = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(Extract0Cost, Extract1Cost);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// Extra uses of the extracts mean that we include those costs in the</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// vector total because those instructions will not be eliminated.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost, NewCost;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">if</span> (Ext0-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == Ext1-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) &amp;&amp; Ext0Index == Ext1Index) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// Handle a special case. If the 2 extracts are identical, adjust the</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// formulas to account for that. The extra use charge allows for either the</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// CSE&#39;d pattern or an unoptimized form with identical values:</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// opcode (extelt V, C), (extelt V, C) --&gt; extelt (opcode V, V), C</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">bool</span> HasUseTax = Ext0 == Ext1 ? !Ext0-&gt;<a class="code" href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">hasNUses</a>(2)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                  : !Ext0-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() || !Ext1-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    OldCost = CheapExtractCost + ScalarOpCost;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    NewCost = VectorOpCost + CheapExtractCost + HasUseTax * CheapExtractCost;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// Handle the general case. Each extract is actually a different value:</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// opcode (extelt V0, C0), (extelt V1, C1) --&gt; extelt (opcode V0, V1), C</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    OldCost = Extract0Cost + Extract1Cost + ScalarOpCost;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    NewCost = VectorOpCost + CheapExtractCost +</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              !Ext0-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() * Extract0Cost +</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;              !Ext1-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() * Extract1Cost;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  ConvertToShuffle = getShuffleExtract(Ext0, Ext1, PreferredExtractIndex);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">if</span> (ConvertToShuffle) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (IsBinOp &amp;&amp; <a class="code" href="VectorCombine_8cpp.html#af430e1420ae91582114e512b797e4964">DisableBinopExtractShuffle</a>)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// If we are extracting from 2 different indexes, then one operand must be</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// shuffled before performing the vector operation. The shuffle mask is</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// undefined except for 1 lane that is being translated to the remaining</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// extraction lane. Therefore, it is a splat shuffle. Ex:</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// ShufMask = { undef, undef, 0, undef }</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// TODO: The cost model has an option for a &quot;broadcast&quot; shuffle</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">//       (splat-from-element-0), but no option for a more general splat.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    NewCost +=</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TargetTransformInfo::SK_PermuteSingleSrc</a>, VecTy);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Aggressively form a vector op if the cost is equal because the transform</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// may enable further optimization.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// Codegen can reverse this transform (scalarize) if it was not profitable.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">return</span> OldCost &lt; NewCost;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">/// Create a shuffle that translates (shifts) 1 element from the input vector</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/// to a new element location.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#ae59c9684e490f1375deefa7acf973595">  480</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="VectorCombine_8cpp.html#ae59c9684e490f1375deefa7acf973595">createShiftShuffle</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Vec, <span class="keywordtype">unsigned</span> OldIndex,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                 <span class="keywordtype">unsigned</span> NewIndex, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// The shuffle mask is undefined except for 1 lane that is being translated</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// to the new element index. Example for OldIndex == 2 and NewIndex == 0:</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// ShufMask = { 2, undef, undef, undef }</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(Vec-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 32&gt;</a> ShufMask(VecTy-&gt;getNumElements(), <a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  ShufMask[NewIndex] = OldIndex;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(Vec, ShufMask, <span class="stringliteral">&quot;shift&quot;</span>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">/// Given an extract element instruction with constant index operand, shuffle</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">/// the source vector (shift the scalar element) to a NewIndex for extraction.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">/// Return null if the input can be constant folded, so that we are not creating</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">/// unnecessary instructions.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#aa1743eec4f65f26420488de7cf4d5d63">  495</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *<a class="code" href="VectorCombine_8cpp.html#aa1743eec4f65f26420488de7cf4d5d63">translateExtract</a>(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *ExtElt,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                            <span class="keywordtype">unsigned</span> NewIndex,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                            <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// Shufflevectors can only be created for fixed-width vectors.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;FixedVectorType&gt;(ExtElt-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()))</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// If the extract can be constant-folded, this code is unsimplified. Defer</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// to other passes to handle that.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> = ExtElt-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = ExtElt-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;ConstantInt&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) &amp;&amp; <span class="stringliteral">&quot;Expected a constant index operand&quot;</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Constant&gt;(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>))</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf = <a class="code" href="VectorCombine_8cpp.html#ae59c9684e490f1375deefa7acf973595">createShiftShuffle</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, cast&lt;ConstantInt&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)-&gt;getZExtValue(),</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                   NewIndex, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">return</span> cast&lt;ExtractElementInst&gt;(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateExtractElement(Shuf, NewIndex));</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/// Try to reduce extract element costs by converting scalar compares to vector</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">/// compares followed by extract.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/// cmp (ext0 V0, C), (ext1 V1, C)</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> VectorCombine::foldExtExtCmp(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                  <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;CmpInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <span class="stringliteral">&quot;Expected a compare&quot;</span>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;ConstantInt&gt;(Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>())-&gt;getZExtValue() ==</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;             cast&lt;ConstantInt&gt;(Ext1-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>())-&gt;getZExtValue() &amp;&amp;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;         <span class="stringliteral">&quot;Expected matching constant extract indexes&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// cmp Pred (extelt V0, C), (extelt V1, C) --&gt; extelt (cmp Pred V0, V1), C</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  ++NumVecCmp;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = cast&lt;CmpInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;getPredicate();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V0 = Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>(), *V1 = Ext1-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecCmp = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCmp(Pred, V0, V1);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewExt = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateExtractElement(VecCmp, Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>());</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *NewExt);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">/// Try to reduce extract element costs by converting scalar binops to vector</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">/// binops followed by extract.</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">/// bo (ext0 V0, C), (ext1 V1, C)</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> VectorCombine::foldExtExtBinop(<a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext0,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                    <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *Ext1, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;BinaryOperator&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <span class="stringliteral">&quot;Expected a binary operator&quot;</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;ConstantInt&gt;(Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>())-&gt;getZExtValue() ==</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;             cast&lt;ConstantInt&gt;(Ext1-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>())-&gt;getZExtValue() &amp;&amp;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         <span class="stringliteral">&quot;Expected matching constant extract indexes&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// bo (extelt V0, C), (extelt V1, C) --&gt; extelt (bo V0, V1), C</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  ++NumVecBO;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V0 = Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>(), *V1 = Ext1-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">getVectorOperand</a>();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecBO =</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp(cast&lt;BinaryOperator&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;<a class="code" href="VPlanSLP_8cpp.html#af04704e906a9654777e92a4612c58c13">getOpcode</a>(), V0, V1);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// All IR flags are safe to back-propagate because any potential poison</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// created in unused vector elements is discarded by the extract.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *VecBOInst = dyn_cast&lt;Instruction&gt;(VecBO))</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    VecBOInst-&gt;copyIRFlags(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewExt = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateExtractElement(VecBO, Ext0-&gt;<a class="code" href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">getIndexOperand</a>());</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *NewExt);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">/// Match an instruction with extracted vector operands.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldExtractExtract(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// It is not safe to transform things like div, urem, etc. because we may</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// create undefined behavior when executing those on unknown vector elements.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#abe76d72cda6b2b4562c72accb510040b">isSafeToSpeculativelyExecute</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0, *<a class="code" href="namespacellvm_1_1dxil.html#af048a5a215837b0272b22d5e7a0bc04aaa18c217c4f2a811afcaaf5052945e31b">I1</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">CmpInst::BAD_ICMP_PREDICATE</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a753e1338645ec04d045211b8a46d968d">m_Cmp</a>(Pred, <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(I0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(I1))) &amp;&amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a43ac4fbaaf63a88eb5ac05f6d3e5649c">m_BinOp</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(I0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(I1))))</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V0, *V1;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> C0, <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(I0, <a class="code" href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">m_ExtractElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(V0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(C0))) ||</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(I1, <a class="code" href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">m_ExtractElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(V1), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>))) ||</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      V0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != V1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// If the scalar value &#39;I&#39; is going to be re-inserted into a vector, then try</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// to create an extract to that same element. The extract/insert can be</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// reduced to a &quot;select shuffle&quot;.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">// TODO: If we add a larger pattern match that starts from an insert, this</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">//       probably becomes unnecessary.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keyword">auto</span> *Ext0 = cast&lt;ExtractElementInst&gt;(I0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keyword">auto</span> *Ext1 = cast&lt;ExtractElementInst&gt;(I1);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> InsertIndex = <a class="code" href="VectorCombine_8cpp.html#a935a117ebc18605ba99cdc14c80bdf0c">InvalidIndex</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.hasOneUse())</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.user_back(),</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <a class="code" href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">m_InsertElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(InsertIndex)));</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *ExtractToChange;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span> (isExtractExtractCheap(Ext0, Ext1, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ExtractToChange, InsertIndex))</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (ExtractToChange) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">unsigned</span> CheapExtractIdx = ExtractToChange == Ext0 ? <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> : C0;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *NewExtract =</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="VectorCombine_8cpp.html#aa1743eec4f65f26420488de7cf4d5d63">translateExtract</a>(ExtractToChange, CheapExtractIdx, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (!NewExtract)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (ExtractToChange == Ext0)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      Ext0 = NewExtract;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      Ext1 = NewExtract;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (Pred != <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">CmpInst::BAD_ICMP_PREDICATE</a>)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    foldExtExtCmp(Ext0, Ext1, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    foldExtExtBinop(Ext0, Ext1, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#a87029746a970dab9ed9f32a106d86370">push</a>(Ext0);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  Worklist.<a class="code" href="classllvm_1_1InstructionWorklist.html#a87029746a970dab9ed9f32a106d86370">push</a>(Ext1);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">/// Try to replace an extract + scalar fneg + insert with a vector fneg +</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">/// shuffle.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldInsExtFNeg(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// Match an insert (op (extract)) pattern.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DestVec;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FNeg;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">m_InsertElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(DestVec), <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(FNeg)),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                             <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>))))</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// Note: This handles the canonical fneg instruction and &quot;fsub -0.0, X&quot;.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcVec;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Extract;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(FNeg, <a class="code" href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">m_FNeg</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a575c2299c6f145ba3a12efa20829db43">m_CombineAnd</a>(</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                       <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(Extract),</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                       <a class="code" href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">m_ExtractElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(SrcVec), <a class="code" href="namespacellvm_1_1PatternMatch.html#a3acbd0be97863e3e03e3b85641254018">m_SpecificInt</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>))))))</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// TODO: We could handle this with a length-changing shuffle.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keywordflow">if</span> (SrcVec-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != VecTy)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// Ignore bogus insert/extract index.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = VecTy-&gt;getNumElements();</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &gt;= NumElts)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// We are inserting the negated element into the same lane that we extracted</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">// from. This is equivalent to a select-shuffle that chooses all but the</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// negated element from the destination vector.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>(NumElts);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  std::iota(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.begin(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.end(), 0);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>] = <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> + NumElts;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>();</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost =</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Instruction::FNeg, ScalarTy) +</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// If the extract has one use, it will be eliminated, so count it in the</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// original cost. If it has more than one use, ignore the cost because it will</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">// be the same before/after.</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">if</span> (Extract-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>())</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    OldCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Extract, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> NewCost =</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Instruction::FNeg, VecTy) +</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca64d439485545faa793c20de7fbfd274c">TargetTransformInfo::SK_Select</a>, VecTy, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span> (NewCost &gt; OldCost)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">// insertelt DestVec, (fneg (extractelt SrcVec, Index)), Index --&gt;</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// shuffle DestVec, (fneg SrcVec), Mask</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecFNeg = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateFNegFMF(SrcVec, FNeg);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(DestVec, VecFNeg, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *Shuf);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;}</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">/// If this is a bitcast of a shuffle, try to bitcast the source vector to the</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">/// destination type followed by shuffle. This can enable further transforms by</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">/// moving bitcasts or shuffles together.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldBitcastShuf(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;int&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#ac0467ca7fad871738b10db95feb40dad">m_BitCast</a>(</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                     <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#afd3e8a6706810fef8cdbaf1f9f40dfbd">m_Shuffle</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(V), <a class="code" href="namespacellvm_1_1PatternMatch.html#adea6dc2e42baa345b97be48b0370313d">m_Undef</a>(), <a class="code" href="structllvm_1_1PatternMatch_1_1m__Mask.html">m_Mask</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>))))))</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// 1) Do not fold bitcast shuffle for scalable type. First, shuffle cost for</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// scalable type is unknown; Second, we cannot reason if the narrowed shuffle</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">// mask for scalable type is a splat or not.</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// 2) Disallow non-vector casts and length-changing shuffles.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// TODO: We could allow any shuffle.</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keyword">auto</span> *SrcTy = dyn_cast&lt;FixedVectorType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (!SrcTy || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)-&gt;getType() != SrcTy)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keyword">auto</span> *DestTy = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">unsigned</span> DestNumElts = DestTy-&gt;getNumElements();</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">unsigned</span> SrcNumElts = SrcTy-&gt;getNumElements();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 16&gt;</a> NewMask;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">if</span> (SrcNumElts &lt;= DestNumElts) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// The bitcast is from wide to narrow/equal elements. The shuffle mask can</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// always be expanded to the equivalent form choosing narrower elements.</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DestNumElts % SrcNumElts == 0 &amp;&amp; <span class="stringliteral">&quot;Unexpected shuffle mask&quot;</span>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">unsigned</span> ScaleFactor = DestNumElts / SrcNumElts;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="namespacellvm.html#aa91449ed55cd3c525a3438252573527a">narrowShuffleMaskElts</a>(ScaleFactor, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, NewMask);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// The bitcast is from narrow elements to wide elements. The shuffle mask</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">// must choose consecutive elements to allow casting first.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcNumElts % DestNumElts == 0 &amp;&amp; <span class="stringliteral">&quot;Unexpected shuffle mask&quot;</span>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">unsigned</span> ScaleFactor = SrcNumElts / DestNumElts;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a4373d3025961c2c2eeca56b02d7d009d">widenShuffleMaskElts</a>(ScaleFactor, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, NewMask))</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// The new shuffle must not cost more than the old shuffle. The bitcast is</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">// moved ahead of the shuffle, so assume that it has the same cost as before.</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> DestCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TargetTransformInfo::SK_PermuteSingleSrc</a>, DestTy, NewMask);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> SrcCost =</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TargetTransformInfo::SK_PermuteSingleSrc</a>, SrcTy, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">if</span> (DestCost &gt; SrcCost || !DestCost.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>())</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// bitcast (shuf V, MaskC) --&gt; shuf (bitcast V), MaskC&#39;</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  ++NumShufOfBitcast;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CastV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(V, DestTy);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(CastV, NewMask);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *Shuf);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">/// Match a vector binop or compare instruction with at least one inserted</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">/// scalar operand and convert to scalar binop/cmp followed by insertelement.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::scalarizeBinopOrCmp(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">CmpInst::BAD_ICMP_PREDICATE</a>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Ins0, *Ins1;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a43ac4fbaaf63a88eb5ac05f6d3e5649c">m_BinOp</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Ins0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Ins1))) &amp;&amp;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a753e1338645ec04d045211b8a46d968d">m_Cmp</a>(Pred, <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Ins0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Ins1))))</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// Do not convert the vector condition of a vector select into a scalar</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// condition. That may cause problems for codegen because of differences in</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">// boolean formats and register-file transfers.</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// TODO: Can we account for that in the cost model?</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordtype">bool</span> IsCmp = Pred != CmpInst::Predicate::BAD_ICMP_PREDICATE;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">if</span> (IsCmp)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users())</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(U, <a class="code" href="namespacellvm_1_1PatternMatch.html#addb87fe3f509b7803d3f5933ee24b560">m_Select</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>())))</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// Match against one or both scalar values being inserted into constant</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// vectors:</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">// vec_op VecC0, (inselt VecC1, V1, Index)</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// vec_op (inselt VecC0, V0, Index), VecC1</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="comment">// vec_op (inselt VecC0, V0, Index), (inselt VecC1, V1, Index)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">// TODO: Deal with mismatched index constants and variable indexes?</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *VecC0 = <span class="keyword">nullptr</span>, *VecC1 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V0 = <span class="keyword">nullptr</span>, *V1 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Index0 = 0, Index1 = 0;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Ins0, <a class="code" href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">m_InsertElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">m_Constant</a>(VecC0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(V0),</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                               <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(Index0))) &amp;&amp;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Ins0, <a class="code" href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">m_Constant</a>(VecC0)))</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Ins1, <a class="code" href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">m_InsertElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">m_Constant</a>(VecC1), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(V1),</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                               <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(Index1))) &amp;&amp;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Ins1, <a class="code" href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">m_Constant</a>(VecC1)))</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordtype">bool</span> IsConst0 = !V0;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordtype">bool</span> IsConst1 = !V1;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">if</span> (IsConst0 &amp;&amp; IsConst1)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">if</span> (!IsConst0 &amp;&amp; !IsConst1 &amp;&amp; Index0 != Index1)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">// Bail for single insertion if it is a load.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// TODO: Handle this once getVectorInstrCost can cost for load/stores.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keyword">auto</span> *I0 = dyn_cast_or_null&lt;Instruction&gt;(V0);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1dxil.html#af048a5a215837b0272b22d5e7a0bc04aaa18c217c4f2a811afcaaf5052945e31b">I1</a> = dyn_cast_or_null&lt;Instruction&gt;(V1);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span> ((IsConst0 &amp;&amp; I1 &amp;&amp; <a class="code" href="namespacellvm_1_1dxil.html#af048a5a215837b0272b22d5e7a0bc04aaa18c217c4f2a811afcaaf5052945e31b">I1</a>-&gt;mayReadFromMemory()) ||</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      (IsConst1 &amp;&amp; I0 &amp;&amp; I0-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9149819221d66953ac6c2938b87f0136">mayReadFromMemory</a>()))</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = IsConst0 ? Index1 : Index0;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = IsConst0 ? V1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() : V0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *VecTy = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VecTy-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>() &amp;&amp;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;         (IsConst0 || IsConst1 || V0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == V1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         (ScalarTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() || ScalarTy-&gt;<a class="code" href="classllvm_1_1Type.html#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() ||</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          ScalarTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) &amp;&amp;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;         <span class="stringliteral">&quot;Unexpected types for insert element into binop or cmp&quot;</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> ScalarOpCost, VectorOpCost;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">if</span> (IsCmp) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = cast&lt;CmpInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).getPredicate();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    ScalarOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        Opcode, ScalarTy, <a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(ScalarTy), Pred);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    VectorOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        Opcode, VecTy, <a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(VecTy), Pred);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    ScalarOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Opcode, ScalarTy);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    VectorOpCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Opcode, VecTy);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">// Get cost estimate for the insert element. This cost will factor into</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">// both sequences.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> InsertCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      Instruction::InsertElement, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost =</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      (IsConst0 ? 0 : InsertCost) + (IsConst1 ? 0 : InsertCost) + VectorOpCost;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> NewCost = ScalarOpCost + InsertCost +</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                            (IsConst0 ? 0 : !Ins0-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() * InsertCost) +</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                            (IsConst1 ? 0 : !Ins1-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() * InsertCost);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// We want to scalarize unless the vector variant actually has lower cost.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">if</span> (OldCost &lt; NewCost || !NewCost.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>())</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">// vec_op (inselt VecC0, V0, Index), (inselt VecC1, V1, Index) --&gt;</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="comment">// inselt NewVecC, (scalar_op V0, V1), Index</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (IsCmp)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    ++NumScalarCmp;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    ++NumScalarBO;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">// For constant cases, extract the scalar element, this should constant fold.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordflow">if</span> (IsConst0)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    V0 = <a class="code" href="classllvm_1_1ConstantExpr.html#a078455f9a6da73bc84f24700a81d19d7">ConstantExpr::getExtractElement</a>(VecC0, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>));</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">if</span> (IsConst1)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    V1 = <a class="code" href="classllvm_1_1ConstantExpr.html#a078455f9a6da73bc84f24700a81d19d7">ConstantExpr::getExtractElement</a>(VecC1, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>));</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a> =</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      IsCmp ? <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCmp(Pred, V0, V1)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Opcode, V0, V1);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>-&gt;setName(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getName() + <span class="stringliteral">&quot;.scalar&quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// All IR flags are safe to back-propagate. There is no potential for extra</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// poison to be created by the scalar instruction.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ScalarInst = dyn_cast&lt;Instruction&gt;(Scalar))</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    ScalarInst-&gt;copyIRFlags(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// Fold the vector constants in the original vectors into a new base vector.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewVecC =</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      IsCmp ? <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCmp(Pred, VecC0, VecC1)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Opcode, VecC0, VecC1);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__P9_8txt.html#aa793083a95c48c23abfa352d4335685a">Insert</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertElement(NewVecC, Scalar, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *Insert);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;}</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">/// Try to combine a scalar binop + 2 scalar compares of extracted elements of</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">/// a vector into vector operations followed by extract. Note: The SLP pass</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">/// may miss this pattern because of implementation problems.</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldExtractedCmps(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// We are looking for a scalar binop of booleans.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// binop i1 (cmp Pred I0, C0), (cmp Pred I1, C1)</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isBinaryOp() || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isIntegerTy(1))</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">// The compare predicates should match, and each compare should have a</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// constant operand.</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// TODO: Relax the one-use constraints.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *B0 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0), *B1 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *I0, *<a class="code" href="namespacellvm_1_1dxil.html#af048a5a215837b0272b22d5e7a0bc04aaa18c217c4f2a811afcaaf5052945e31b">I1</a>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *C0, *<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> P0, P1;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(B0, <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a753e1338645ec04d045211b8a46d968d">m_Cmp</a>(P0, <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(I0), <a class="code" href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">m_Constant</a>(C0)))) ||</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(B1, <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a753e1338645ec04d045211b8a46d968d">m_Cmp</a>(P1, <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(I1), <a class="code" href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">m_Constant</a>(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>)))) ||</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      P0 != P1)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// The compare operands must be extracts of the same vector with constant</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// extract indexes.</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="comment">// TODO: Relax the one-use constraints.</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Index0, Index1;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(I0, <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">m_ExtractElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(Index0)))) ||</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(I1, <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">m_ExtractElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(Index1)))))</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keyword">auto</span> *Ext0 = cast&lt;ExtractElementInst&gt;(I0);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keyword">auto</span> *Ext1 = cast&lt;ExtractElementInst&gt;(I1);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="classllvm_1_1ExtractElementInst.html">ExtractElementInst</a> *ConvertToShuf = getShuffleExtract(Ext0, Ext1);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keywordflow">if</span> (!ConvertToShuf)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">// The original scalar pattern is:</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">// binop i1 (cmp Pred (ext X, Index0), C0), (cmp Pred (ext X, Index1), C1)</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = P0;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordtype">unsigned</span> CmpOpcode = <a class="code" href="classllvm_1_1CmpInst.html#a7bd850492d35a34f0fe419e5555997a9">CmpInst::isFPPredicate</a>(Pred) ? Instruction::FCmp</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                                    : Instruction::ICmp;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keyword">auto</span> *VecTy = dyn_cast&lt;FixedVectorType&gt;(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType());</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordflow">if</span> (!VecTy)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost =</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext0, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, Index0);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  OldCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext1, VecTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, Index1);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  OldCost +=</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(CmpOpcode, I0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                             <a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(I0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), Pred) *</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      2;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  OldCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// The proposed vector pattern is:</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">// vcmp = cmp Pred X, VecC</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">// ext (binop vNi1 vcmp, (shuffle vcmp, Index1)), Index0</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordtype">int</span> CheapIndex = ConvertToShuf == Ext0 ? Index1 : Index0;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordtype">int</span> ExpensiveIndex = ConvertToShuf == Ext0 ? Index0 : Index1;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keyword">auto</span> *CmpTy = cast&lt;FixedVectorType&gt;(<a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType()));</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> NewCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      CmpOpcode, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType(), <a class="code" href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">CmpInst::makeCmpResultType</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType()), Pred);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 32&gt;</a> ShufMask(VecTy-&gt;getNumElements(), <a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  ShufMask[CheapIndex] = ExpensiveIndex;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  NewCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TargetTransformInfo::SK_PermuteSingleSrc</a>, CmpTy,</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                ShufMask);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  NewCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(), CmpTy);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  NewCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(*Ext0, CmpTy, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>, CheapIndex);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// Aggressively form vector ops if the cost is equal because the transform</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">// may enable further optimization.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// Codegen can reverse this transform (scalarize) if it was not profitable.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">if</span> (OldCost &lt; NewCost || !NewCost.<a class="code" href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>())</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// Create a vector constant from the 2 scalar constants.</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 32&gt;</a> CmpC(VecTy-&gt;getNumElements(),</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                   <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(VecTy-&gt;getElementType()));</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  CmpC[Index0] = C0;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  CmpC[Index1] = <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VCmp = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCmp(Pred, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(CmpC));</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf = <a class="code" href="VectorCombine_8cpp.html#ae59c9684e490f1375deefa7acf973595">createShiftShuffle</a>(VCmp, ExpensiveIndex, CheapIndex, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VecLogic = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp(cast&lt;BinaryOperator&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).<a class="code" href="VPlanSLP_8cpp.html#af04704e906a9654777e92a4612c58c13">getOpcode</a>(),</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                        VCmp, Shuf);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewExt = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateExtractElement(VecLogic, CheapIndex);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *NewExt);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  ++NumVecCmpBO;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">// Check if memory loc modified between two instrs in the same BB</span></div>
<div class="line"><a name="l00950"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#ae76b679e73faaa60b69b4f4bafc0e456">  950</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="VectorCombine_8cpp.html#ae76b679e73faaa60b69b4f4bafc0e456">isMemModifiedBetween</a>(<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> Begin,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                 <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> End,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> &amp;Loc, <a class="code" href="classllvm_1_1AAResults.html">AAResults</a> &amp;AA) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordtype">unsigned</span> NumScanned = 0;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">std::any_of</a>(Begin, End, [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Instr) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(AA.<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(&amp;Instr, Loc)) ||</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;           ++NumScanned &gt; <a class="code" href="VectorCombine_8cpp.html#aa0a0dd3a69912556b16b034162a4ae19">MaxInstrsToScan</a>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  });</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;}</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">/// Helper class to indicate whether a vector index can be safely scalarized and</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">/// if a freeze needs to be inserted.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"></span><span class="keyword">class </span>ScalarizationResult {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keyword">enum class</span> StatusTy { Unsafe, Safe, SafeWithFreeze };</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  StatusTy <a class="code" href="structStatus.html">Status</a>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ToFreeze;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  ScalarizationResult(StatusTy <a class="code" href="structStatus.html">Status</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *ToFreeze = <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      : <a class="code" href="structStatus.html">Status</a>(<a class="code" href="structStatus.html">Status</a>), ToFreeze(ToFreeze) {}</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  ScalarizationResult(<span class="keyword">const</span> ScalarizationResult &amp;Other) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  ~ScalarizationResult() {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!ToFreeze &amp;&amp; <span class="stringliteral">&quot;freeze() not called with ToFreeze being set&quot;</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keyword">static</span> ScalarizationResult unsafe() { <span class="keywordflow">return</span> {StatusTy::Unsafe}; }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keyword">static</span> ScalarizationResult safe() { <span class="keywordflow">return</span> {StatusTy::Safe}; }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keyword">static</span> ScalarizationResult safeWithFreeze(<a class="code" href="classllvm_1_1Value.html">Value</a> *ToFreeze) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">return</span> {StatusTy::SafeWithFreeze, ToFreeze};</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">  /// Returns true if the index can be scalarize without requiring a freeze.</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isSafe()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structStatus.html">Status</a> == StatusTy::Safe; }<span class="comment"></span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">  /// Returns true if the index cannot be scalarized.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isUnsafe()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structStatus.html">Status</a> == StatusTy::Unsafe; }<span class="comment"></span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">  /// Returns true if the index can be scalarize, but requires inserting a</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">  /// freeze.</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isSafeWithFreeze()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structStatus.html">Status</a> == StatusTy::SafeWithFreeze; }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">  /// Reset the state of Unsafe and clear ToFreze if set.</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> discard() {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    ToFreeze = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="structStatus.html">Status</a> = StatusTy::Unsafe;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">  /// Freeze the ToFreeze and update the use in \p User to use it.</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="CanonicalizeFreezeInLoops_8cpp.html#a9680cc81ccaa4506cae9f5369cf5307e">freeze</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;UserI) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isSafeWithFreeze() &amp;&amp;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;           <span class="stringliteral">&quot;should only be used when freezing is required&quot;</span>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">is_contained</a>(ToFreeze-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>(), &amp;UserI) &amp;&amp;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;           <span class="stringliteral">&quot;UserI must be a user of ToFreeze&quot;</span>);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;::InsertPointGuard</a> Guard(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(cast&lt;Instruction&gt;(&amp;UserI));</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Frozen =</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateFreeze(ToFreeze, ToFreeze-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.frozen&quot;</span>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">make_early_inc_range</a>((UserI.<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>())))</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keywordflow">if</span> (U.get() == ToFreeze)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        U.set(Frozen);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    ToFreeze = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;};</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">/// Check if it is legal to scalarize a memory access to \p VecTy at index \p</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">/// Idx. \p Idx must access a valid vector element.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#a52e65b088a444dafdf68214186f7ad08"> 1019</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> ScalarizationResult <a class="code" href="VectorCombine_8cpp.html#a52e65b088a444dafdf68214186f7ad08">canScalarizeAccess</a>(<a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *VecTy,</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                              <a class="code" href="classllvm_1_1Value.html">Value</a> *Idx, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CtxI,</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                              <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;AC,</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(Idx)) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getValue().ult(VecTy-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>()))</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordflow">return</span> ScalarizationResult::safe();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">return</span> ScalarizationResult::unsafe();</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordtype">unsigned</span> IntWidth = Idx-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>();</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> Zero(IntWidth, 0);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> MaxElts(IntWidth, VecTy-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>());</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classllvm_1_1ConstantRange.html">ConstantRange</a> ValidIndices(Zero, MaxElts);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="classllvm_1_1ConstantRange.html">ConstantRange</a> IdxRange(IntWidth, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ae058c4750de2c85f12a1f96841ac9ae3">isGuaranteedNotToBePoison</a>(Idx, &amp;AC)) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">if</span> (ValidIndices.<a class="code" href="classllvm_1_1ConstantRange.html#aaca3a4d2b25c24b11179cbd01079b73c">contains</a>(<a class="code" href="namespacellvm.html#a546e6f5ba8f510c3e7ed2e20013548d9">computeConstantRange</a>(Idx, <span class="comment">/* ForSigned */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                                   <span class="keyword">true</span>, &amp;AC, CtxI, &amp;DT)))</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">return</span> ScalarizationResult::safe();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> ScalarizationResult::unsafe();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">// If the index may be poison, check if we can insert a freeze before the</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">// range of the index is restricted.</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IdxBase;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Idx, <a class="code" href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">m_And</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(IdxBase), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(CI)))) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    IdxRange = IdxRange.<a class="code" href="classllvm_1_1ConstantRange.html#aac5f27f8d0ff473183fff55780e5796c">binaryAnd</a>(CI-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">getValue</a>());</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Idx, <a class="code" href="namespacellvm_1_1PatternMatch.html#ae1a04895305aaea96e5e82d95c39bbe0">m_URem</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(IdxBase), <a class="code" href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">m_ConstantInt</a>(CI)))) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    IdxRange = IdxRange.<a class="code" href="classllvm_1_1ConstantRange.html#a336e2050c47c9d72b2cb4b13726fbba3">urem</a>(CI-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">getValue</a>());</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">if</span> (ValidIndices.<a class="code" href="classllvm_1_1ConstantRange.html#aaca3a4d2b25c24b11179cbd01079b73c">contains</a>(IdxRange))</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">return</span> ScalarizationResult::safeWithFreeze(IdxBase);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">return</span> ScalarizationResult::unsafe();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;}</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">/// The memory operation on a vector of \p ScalarType had alignment of</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">/// \p VectorAlignment. Compute the maximal, but conservatively correct,</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">/// alignment that will be valid for the memory operation on a single scalar</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">/// element of the same type with index \p Idx.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="VectorCombine_8cpp.html#a52ed36081b67923e2f71ace41dee161b"> 1061</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="structllvm_1_1Align.html">Align</a> <a class="code" href="VectorCombine_8cpp.html#a52ed36081b67923e2f71ace41dee161b">computeAlignmentAfterScalarization</a>(<a class="code" href="structllvm_1_1Align.html">Align</a> VectorAlignment,</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                                <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarType, <a class="code" href="classllvm_1_1Value.html">Value</a> *Idx,</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(Idx))</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(VectorAlignment,</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                           <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue() * <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(ScalarType));</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(VectorAlignment, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(ScalarType));</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;}</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">// Combine patterns like:</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">//   %0 = load &lt;4 x i32&gt;, &lt;4 x i32&gt;* %a</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">//   %1 = insertelement &lt;4 x i32&gt; %0, i32 %b, i32 1</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">//   store &lt;4 x i32&gt; %1, &lt;4 x i32&gt;* %a</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">// to:</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">//   %0 = bitcast &lt;4 x i32&gt;* %a to i32*</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">//   %1 = getelementptr inbounds i32, i32* %0, i64 0, i64 1</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">//   store i32 %b, i32* %1</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keywordtype">bool</span> VectorCombine::foldSingleElementStore(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isSimple() ||</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      !isa&lt;FixedVectorType&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType()))</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="comment">// TODO: Combine more complicated patterns (multiple insert) by referencing</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="comment">// TargetTransformInfo.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewElement;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Idx;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand(),</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;             <a class="code" href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">m_InsertElt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(NewElement),</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                         <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Idx))))</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = dyn_cast&lt;LoadInst&gt;(<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>)) {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keyword">auto</span> VecTy = cast&lt;FixedVectorType&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType());</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcAddr = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getPointerOperand()-&gt;stripPointerCasts();</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// Don&#39;t optimize for atomic/volatile load or store. Ensure memory is not</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">// modified between, vector type matches store size, and index is inbounds.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;isSimple() || <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getParent() != <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent() ||</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        !<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.typeSizeEqualsStoreSize(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getType()) ||</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        SrcAddr != <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand()-&gt;stripPointerCasts())</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keyword">auto</span> ScalarizableIdx = <a class="code" href="VectorCombine_8cpp.html#a52e65b088a444dafdf68214186f7ad08">canScalarizeAccess</a>(VecTy, Idx, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, AC, DT);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (ScalarizableIdx.isUnsafe() ||</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <a class="code" href="VectorCombine_8cpp.html#ae76b679e73faaa60b69b4f4bafc0e456">isMemModifiedBetween</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getIterator(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getIterator(),</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                             <a class="code" href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">MemoryLocation::get</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>), AA))</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span> (ScalarizableIdx.isSafeWithFreeze())</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      ScalarizableIdx.freeze(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, *cast&lt;Instruction&gt;(Idx));</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInBoundsGEP(</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand(),</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        {ConstantInt::get(Idx-&gt;getType(), 0), Idx});</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *NSI = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(NewElement, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    NSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> ScalarOpAlignment = <a class="code" href="VectorCombine_8cpp.html#a52ed36081b67923e2f71ace41dee161b">computeAlignmentAfterScalarization</a>(</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(), <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getAlign()), NewElement-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Idx,</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    NSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a55195fa18cf783fe74de0cced1ca6eb3">setAlignment</a>(ScalarOpAlignment);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *NSI);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <a class="code" href="LICM_8cpp.html#ab0cfc793d55940eac67854827dd365e9">eraseInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">/// Try to scalarize vector loads feeding extractelement instructions.</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::scalarizeLoadExtract(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#a78cd22f497c1e81c4d8a5e9073ef5a24">m_Load</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>))))</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keyword">auto</span> *FixedVT = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keyword">auto</span> *LI = cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">if</span> (LI-&gt;isVolatile() || !<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.typeSizeEqualsStoreSize(FixedVT))</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OriginalCost =</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, FixedVT, LI-&gt;getAlign(),</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                          LI-&gt;getPointerAddressSpace());</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> ScalarizedCost = 0;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *LastCheckedInst = LI;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordtype">unsigned</span> NumInstChecked = 0;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="comment">// Check if all users of the load are extracts with no memory modifications</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="comment">// between the load and the extract. Compute the cost of both the original</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">// code and the scalarized version.</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : LI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keyword">auto</span> *UI = dyn_cast&lt;ExtractElementInst&gt;(U);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">if</span> (!UI || UI-&gt;getParent() != LI-&gt;getParent())</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#ae058c4750de2c85f12a1f96841ac9ae3">isGuaranteedNotToBePoison</a>(UI-&gt;getOperand(1), &amp;AC, LI, &amp;DT))</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// Check if any instruction between the load and the extract may modify</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">// memory.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">if</span> (LastCheckedInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a784097fca76abad9e815cf1692de79c4">comesBefore</a>(UI)) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;           <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(std::next(LI-&gt;getIterator()), UI-&gt;getIterator())) {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="comment">// Bail out if we reached the check limit or the instruction may write</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="comment">// to memory.</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">if</span> (NumInstChecked == <a class="code" href="VectorCombine_8cpp.html#aa0a0dd3a69912556b16b034162a4ae19">MaxInstrsToScan</a> || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayWriteToMemory())</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        NumInstChecked++;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      LastCheckedInst = UI;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keyword">auto</span> ScalarIdx = <a class="code" href="VectorCombine_8cpp.html#a52e65b088a444dafdf68214186f7ad08">canScalarizeAccess</a>(FixedVT, UI-&gt;getOperand(1), &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, AC, DT);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">if</span> (!ScalarIdx.isSafe()) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">// TODO: Freeze index if it is safe to do so.</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      ScalarIdx.discard();</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = dyn_cast&lt;ConstantInt&gt;(UI-&gt;getOperand(1));</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TTI::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">TTI::TCK_RecipThroughput</a>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    OriginalCost +=</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">getVectorInstrCost</a>(Instruction::ExtractElement, FixedVT, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                               <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> ? <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>-&gt;getZExtValue() : -1);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    ScalarizedCost +=</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, FixedVT-&gt;getElementType(),</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                            <a class="code" href="structllvm_1_1Align.html">Align</a>(1), LI-&gt;getPointerAddressSpace());</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    ScalarizedCost += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a246f298958a4a730bf7d3a64440dd47b">getAddressComputationCost</a>(FixedVT-&gt;getElementType());</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">if</span> (ScalarizedCost &gt;= OriginalCost)</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">// Replace extracts with narrow scalar loads.</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : LI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keyword">auto</span> *EI = cast&lt;ExtractElementInst&gt;(U);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(EI);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Idx = EI-&gt;getOperand(1);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> =</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInBoundsGEP(FixedVT, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, {<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(0), Idx});</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keyword">auto</span> *NewLoad = cast&lt;LoadInst&gt;(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        FixedVT-&gt;getElementType(), <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, EI-&gt;getName() + <span class="stringliteral">&quot;.scalar&quot;</span>));</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> ScalarOpAlignment = <a class="code" href="VectorCombine_8cpp.html#a52ed36081b67923e2f71ace41dee161b">computeAlignmentAfterScalarization</a>(</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        LI-&gt;getAlign(), FixedVT-&gt;getElementType(), Idx, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    NewLoad-&gt;setAlignment(ScalarOpAlignment);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    replaceValue(*EI, *NewLoad);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;}</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">/// Try to convert &quot;shuffle (binop), (binop)&quot; with a shared binop operand into</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">/// &quot;binop (shuffle), (shuffle)&quot;.</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldShuffleOfBinops(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *B0, *B1;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;int&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#afd3e8a6706810fef8cdbaf1f9f40dfbd">m_Shuffle</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a43ac4fbaaf63a88eb5ac05f6d3e5649c">m_BinOp</a>(B0)), <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a43ac4fbaaf63a88eb5ac05f6d3e5649c">m_BinOp</a>(B1)),</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                           <a class="code" href="structllvm_1_1PatternMatch_1_1m__Mask.html">m_Mask</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>))) ||</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      B0-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() != B1-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() || B0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != VecTy)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="comment">// Try to replace a binop with a shuffle if the shuffle is not costly.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="comment">// The new shuffle will choose from a single, common operand, so it may be</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="comment">// cheaper than the existing two-operand shuffle.</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> UnaryMask = <a class="code" href="namespacellvm.html#a2bea09503a438b76b5c9253327118af5">createUnaryMask</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.size());</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a> Opcode = B0-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>();</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> BinopCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Opcode, VecTy);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> ShufCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TargetTransformInfo::SK_PermuteSingleSrc</a>, VecTy, UnaryMask);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="keywordflow">if</span> (ShufCost &gt; BinopCost)</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">// If we have something like &quot;add X, Y&quot; and &quot;add Z, X&quot;, swap ops to match.</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> = B0-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), *<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a> = B0-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ARCCC.html#a9a81d9a1b379cf08150b22e81d7dd006aceb189306b941666e679bf556207c1e4">Z</a> = B1-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">W</a> = B1-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html#a55743bd32282bf6f87aeb49237b1fb68">BinaryOperator::isCommutative</a>(Opcode) &amp;&amp; <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> != <a class="code" href="namespacellvm_1_1ARCCC.html#a9a81d9a1b379cf08150b22e81d7dd006aceb189306b941666e679bf556207c1e4">Z</a> &amp;&amp; <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a> != <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">W</a>)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shuf0, *Shuf1;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> == <a class="code" href="namespacellvm_1_1ARCCC.html#a9a81d9a1b379cf08150b22e81d7dd006aceb189306b941666e679bf556207c1e4">Z</a>) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">// shuf (bo X, Y), (bo X, W) --&gt; bo (shuf X), (shuf Y, W)</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    Shuf0 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, UnaryMask);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    Shuf1 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">W</a>, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a> == <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">W</a>) {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">// shuf (bo X, Y), (bo Z, Y) --&gt; bo (shuf X, Z), (shuf Y)</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    Shuf0 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <a class="code" href="namespacellvm_1_1ARCCC.html#a9a81d9a1b379cf08150b22e81d7dd006aceb189306b941666e679bf556207c1e4">Z</a>, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    Shuf1 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>, UnaryMask);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewBO = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp(Opcode, Shuf0, Shuf1);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="comment">// Intersect flags from the old binops.</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *NewInst = dyn_cast&lt;Instruction&gt;(NewBO)) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    NewInst-&gt;copyIRFlags(B0);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    NewInst-&gt;andIRFlags(B1);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  replaceValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *NewBO);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">/// Given a commutative reduction, the order of the input lanes does not alter</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">/// the results. We can use this to remove certain shuffles feeding the</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">/// reduction, removing the need to shuffle at all.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldShuffleFromReductions(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">if</span> (!II)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">switch</span> (II-&gt;getIntrinsicID()) {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_add:</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_mul:</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_and:</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_or:</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_xor:</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_smin:</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_smax:</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_umin:</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">case</span> Intrinsic::vector_reduce_umax:</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// Find all the inputs when looking through operations that do not alter the</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="comment">// lane order (binops, for example). Currently we look for a single shuffle,</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">// and can ignore splat values.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  std::queue&lt;Value *&gt; Worklist;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 4&gt;</a> Visited;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a> *<a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = dyn_cast&lt;Instruction&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)))</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    Worklist.push(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *CV = Worklist.front();</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    Worklist.pop();</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">if</span> (Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#af74676a3c7447be34bd2c1da76ec0c48">contains</a>(CV))</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">// Splats don&#39;t change the order, so can be safely ignored.</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a6339f2ad6701dc229c34ca4305596d3a">isSplatValue</a>(CV))</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(CV);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CI = dyn_cast&lt;Instruction&gt;(CV)) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">if</span> (CI-&gt;isBinaryOp()) {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : CI-&gt;operand_values())</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;          Worklist.push(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SV = dyn_cast&lt;ShuffleVectorInst&gt;(CI)) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">if</span> (Shuffle &amp;&amp; Shuffle != SV)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a> = SV;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// Anything else is currently an unknown node.</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">if</span> (!Shuffle)</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="comment">// Check all uses of the binary ops and shuffles are also included in the</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">// lane-invariant operations (Visited should be the list of lanewise</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">// instructions, including the shuffle that we found).</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *V : Visited)</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : V-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">if</span> (!Visited.contains(U) &amp;&amp; U != &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07c">VecType</a> =</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      dyn_cast&lt;FixedVectorType&gt;(II-&gt;getOperand(0)-&gt;getType());</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07c">VecType</a>)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *ShuffleInputType =</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      dyn_cast&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a>-&gt;getOperand(0)-&gt;getType());</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">if</span> (!ShuffleInputType)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keywordtype">int</span> NumInputElts = ShuffleInputType-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>();</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="comment">// Find the mask from sorting the lanes into order. This is most likely to</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="comment">// become a identity or concat mask. Undef elements are pushed to the end.</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> ConcatMask;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a>-&gt;getShuffleMask(ConcatMask);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">sort</a>(ConcatMask, [](<span class="keywordtype">int</span> <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <span class="keywordtype">int</span> <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>) { <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span>)<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> &lt; (<span class="keywordtype">unsigned</span>)<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>; });</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordtype">bool</span> UsesSecondVec =</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(ConcatMask, [&amp;](<span class="keywordtype">int</span> M) { <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> &gt;= NumInputElts; });</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OldCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      UsesSecondVec ? <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab4616961a3bfdaec42aedc4fc426ccfe">TTI::SK_PermuteTwoSrc</a> : <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TTI::SK_PermuteSingleSrc</a>, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07c">VecType</a>,</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a>-&gt;getShuffleMask());</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> NewCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      UsesSecondVec ? <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab4616961a3bfdaec42aedc4fc426ccfe">TTI::SK_PermuteTwoSrc</a> : <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TTI::SK_PermuteSingleSrc</a>, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07c">VecType</a>,</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      ConcatMask);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found a reduction feeding from a shuffle: &quot;</span> &lt;&lt; *Shuffle</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  OldCost: &quot;</span> &lt;&lt; OldCost &lt;&lt; <span class="stringliteral">&quot; vs NewCost: &quot;</span> &lt;&lt; NewCost</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keywordflow">if</span> (NewCost &lt; OldCost) {</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Shuffle);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewShuffle = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a>-&gt;getOperand(0), <a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a>-&gt;getOperand(1), ConcatMask);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Created new shuffle: &quot;</span> &lt;&lt; *NewShuffle &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    replaceValue(*Shuffle, *NewShuffle);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// See if we can re-use foldSelectShuffle, getting it to reduce the size of</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">// the shuffle into a nicer order, as it can ignore the order of the shuffles.</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">return</span> foldSelectShuffle(*Shuffle, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;}</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">/// This method looks for groups of shuffles acting on binops, of the form:</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">///  %x = shuffle ...</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">///  %y = shuffle ...</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">///  %a = binop %x, %y</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">///  %b = binop %x, %y</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">///  shuffle %a, %b, selectmask</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">/// We may, especially if the shuffle is wider than legal, be able to convert</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">/// the shuffle to a form where only parts of a and b need to be computed. On</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">/// architectures with no obvious &quot;select&quot; shuffle, this can reduce the total</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">/// number of operations if the target reports them as cheaper.</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> VectorCombine::foldSelectShuffle(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">bool</span> FromReduction) {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keyword">auto</span> *SVI = cast&lt;ShuffleVectorInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keyword">auto</span> *VT = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keyword">auto</span> *Op0 = dyn_cast&lt;Instruction&gt;(SVI-&gt;getOperand(0));</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keyword">auto</span> *Op1 = dyn_cast&lt;Instruction&gt;(SVI-&gt;getOperand(1));</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="keywordflow">if</span> (!Op0 || !Op1 || Op0 == Op1 || !Op0-&gt;isBinaryOp() || !Op1-&gt;isBinaryOp() ||</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      VT != Op0-&gt;getType())</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keyword">auto</span> *SVI0A = dyn_cast&lt;Instruction&gt;(Op0-&gt;getOperand(0));</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keyword">auto</span> *SVI0B = dyn_cast&lt;Instruction&gt;(Op0-&gt;getOperand(1));</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="keyword">auto</span> *SVI1A = dyn_cast&lt;Instruction&gt;(Op1-&gt;getOperand(0));</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keyword">auto</span> *SVI1B = dyn_cast&lt;Instruction&gt;(Op1-&gt;getOperand(1));</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> InputShuffles({SVI0A, SVI0B, SVI1A, SVI1B});</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="keyword">auto</span> checkSVNonOpUses = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0)-&gt;getType() != VT)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users(), [&amp;](<a class="code" href="classllvm_1_1User.html">User</a> *U) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      return U != Op0 &amp;&amp; U != Op1 &amp;&amp;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;             !(isa&lt;ShuffleVectorInst&gt;(U) &amp;&amp;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;               (InputShuffles.contains(cast&lt;Instruction&gt;(U)) ||</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                isInstructionTriviallyDead(cast&lt;Instruction&gt;(U))));</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    });</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  };</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordflow">if</span> (checkSVNonOpUses(SVI0A) || checkSVNonOpUses(SVI0B) ||</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      checkSVNonOpUses(SVI1A) || checkSVNonOpUses(SVI1B))</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="comment">// Collect all the uses that are shuffles that we can transform together. We</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="comment">// may not have a single shuffle, but a group that can all be transformed</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="comment">// together profitably.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ShuffleVectorInst *&gt;</a> Shuffles;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="keyword">auto</span> collectShuffles = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users()) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keyword">auto</span> *SV = dyn_cast&lt;ShuffleVectorInst&gt;(U);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordflow">if</span> (!SV || SV-&gt;getType() != VT)</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordflow">if</span> ((SV-&gt;getOperand(0) != Op0 &amp;&amp; SV-&gt;getOperand(0) != Op1) ||</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          (SV-&gt;getOperand(1) != Op0 &amp;&amp; SV-&gt;getOperand(1) != Op1))</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a>(Shuffles, SV))</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        Shuffles.push_back(SV);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  };</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="keywordflow">if</span> (!collectShuffles(Op0) || !collectShuffles(Op1))</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="comment">// From a reduction, we need to be processing a single shuffle, otherwise the</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="comment">// other uses will not be lane-invariant.</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keywordflow">if</span> (FromReduction &amp;&amp; Shuffles.size() &gt; 1)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="comment">// Add any shuffle uses for the shuffles we have found, to include them in our</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="comment">// cost calculations.</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordflow">if</span> (!FromReduction) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a> *SV : Shuffles) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : SV-&gt;users()) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a> *SSV = dyn_cast&lt;ShuffleVectorInst&gt;(U);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordflow">if</span> (SSV &amp;&amp; isa&lt;UndefValue&gt;(SSV-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1)) &amp;&amp; SSV-&gt;<a class="code" href="classllvm_1_1ShuffleVectorInst.html#a50fe6a61ea745fb71fa8403af6e7deed">getType</a>() == VT)</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;          Shuffles.push_back(SSV);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="comment">// For each of the output shuffles, we try to sort all the first vector</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="comment">// elements to the beginning, followed by the second array elements at the</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">// end. If the binops are legalized to smaller vectors, this may reduce total</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">// number of binops. We compute the ReconstructMask mask needed to convert</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="comment">// back to the original lane order.</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;int, int&gt;</a>&gt; V1, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SmallVector&lt;int&gt;</a>&gt; OrigReconstructMasks;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordtype">int</span> MaxV1Elt = 0, MaxV2Elt = 0;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = VT-&gt;getNumElements();</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ShuffleVectorInst.html">ShuffleVectorInst</a> *SVN : Shuffles) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    SVN-&gt;getShuffleMask(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">// Check the operands are the same as the original, or reversed (in which</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">// case we need to commute the mask).</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SVOp0 = SVN-&gt;getOperand(0);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SVOp1 = SVN-&gt;getOperand(1);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(SVOp1)) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keyword">auto</span> *SSV = cast&lt;ShuffleVectorInst&gt;(SVOp0);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      SVOp0 = SSV-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      SVOp1 = SSV-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(SSV-&gt;<a class="code" href="classllvm_1_1ShuffleVectorInst.html#a6eaff12d0d3ead952f2a2a2781df56ac">getShuffleMask</a>().size()))</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] &lt; 0 ? <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] : SSV-&gt;<a class="code" href="classllvm_1_1ShuffleVectorInst.html#a3fb8619f70f51242f81ef96da349c884">getMaskValue</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> (SVOp0 == Op1 &amp;&amp; SVOp1 == Op0) {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SVOp0, SVOp1);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      <a class="code" href="classllvm_1_1ShuffleVectorInst.html#a9874bec83353914ed1e9309d5d9ccea0">ShuffleVectorInst::commuteShuffleMask</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, NumElts);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> (SVOp0 != Op0 || SVOp1 != Op1)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">// Calculate the reconstruction mask for this shuffle, as the mask needed to</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">// take the packed values from Op0/Op1 and reconstructing to the original</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">// order.</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> ReconstructMask;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] &lt; 0) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        ReconstructMask.push_back(-1);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(NumElts)) {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        MaxV1Elt = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(MaxV1Elt, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keyword">auto</span> It = <a class="code" href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">find_if</a>(V1, [&amp;](<span class="keyword">const</span> std::pair&lt;int, int&gt; &amp;A) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] == <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.first;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        });</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="keywordflow">if</span> (It != V1.end())</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;          ReconstructMask.push_back(It - V1.begin());</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;          ReconstructMask.push_back(V1.size());</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;          V1.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], V1.size());</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        MaxV2Elt = std::max&lt;int&gt;(MaxV2Elt, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] - NumElts);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <span class="keyword">auto</span> It = <a class="code" href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">find_if</a>(<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>, [&amp;](<span class="keyword">const</span> std::pair&lt;int, int&gt; &amp;A) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] - <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(NumElts) == <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.first;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        });</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">if</span> (It != <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.end())</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;          ReconstructMask.push_back(NumElts + It - <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.begin());</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;          ReconstructMask.push_back(NumElts + <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.size());</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;          <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.emplace_back(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] - NumElts, NumElts + <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.size());</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">// For reductions, we know that the lane ordering out doesn&#39;t alter the</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// result. In-order can help simplify the shuffle away.</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">if</span> (FromReduction)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">sort</a>(ReconstructMask);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    OrigReconstructMasks.push_back(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(ReconstructMask));</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  }</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="comment">// If the Maximum element used from V1 and V2 are not larger than the new</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="comment">// vectors, the vectors are already packes and performing the optimization</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="comment">// again will likely not help any further. This also prevents us from getting</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">// stuck in a cycle in case the costs do not also rule it out.</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">if</span> (V1.empty() || <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.empty() ||</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      (MaxV1Elt == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(V1.size()) - 1 &amp;&amp;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;       MaxV2Elt == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.size()) - 1))</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="comment">// GetBaseMaskValue takes one of the inputs, which may either be a shuffle, a</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">// shuffle of another shuffle, or not a shuffle (that is treated like a</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">// identity shuffle).</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keyword">auto</span> GetBaseMaskValue = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">int</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keyword">auto</span> *SV = dyn_cast&lt;ShuffleVectorInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordflow">if</span> (!SV)</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(SV-&gt;getOperand(1)))</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SSV = dyn_cast&lt;ShuffleVectorInst&gt;(SV-&gt;getOperand(0)))</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="keywordflow">if</span> (InputShuffles.contains(SSV))</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="keywordflow">return</span> SSV-&gt;<a class="code" href="classllvm_1_1ShuffleVectorInst.html#a3fb8619f70f51242f81ef96da349c884">getMaskValue</a>(SV-&gt;getMaskValue(M));</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">return</span> SV-&gt;getMaskValue(M);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  };</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="comment">// Attempt to sort the inputs my ascending mask values to make simpler input</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="comment">// shuffles and push complex shuffles down to the uses. We sort on the first</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="comment">// of the two input shuffle orders, to try and get at least one input into a</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// nice order.</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keyword">auto</span> SortBase = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, std::pair&lt;int, int&gt; <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>,</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                      std::pair&lt;int, int&gt; <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>) {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordtype">int</span> MXA = GetBaseMaskValue(A, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>.first);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordtype">int</span> MYA = GetBaseMaskValue(A, <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>.first);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">return</span> MXA &lt; MYA;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  };</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(V1, [&amp;](std::pair&lt;int, int&gt; A, std::pair&lt;int, int&gt; <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">return</span> SortBase(SVI0A, A, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  });</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>, [&amp;](std::pair&lt;int, int&gt; A, std::pair&lt;int, int&gt; <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordflow">return</span> SortBase(SVI1A, A, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  });</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="comment">// Calculate our ReconstructMasks from the OrigReconstructMasks and the</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">// modified order of the input shuffles.</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SmallVector&lt;int&gt;</a>&gt; ReconstructMasks;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> : OrigReconstructMasks) {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> ReconstructMask;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> M : <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="keyword">auto</span> FindIndex = [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;int, int&gt;</a>&gt; &amp;V, <span class="keywordtype">int</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="keyword">auto</span> It = <a class="code" href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">find_if</a>(V, [M](<span class="keyword">auto</span> A) { <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.second == <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>; });</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != V.end() &amp;&amp; <span class="stringliteral">&quot;Expected all entries in Mask&quot;</span>);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="keywordflow">return</span> std::distance(V.begin(), It);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      };</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordflow">if</span> (M &lt; 0)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        ReconstructMask.push_back(-1);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (M &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(NumElts)) {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        ReconstructMask.push_back(FindIndex(V1, M));</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        ReconstructMask.push_back(NumElts + FindIndex(<a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>, M));</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    ReconstructMasks.push_back(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(ReconstructMask));</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="comment">// Calculate the masks needed for the new input shuffles, which get padded</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">// with undef</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int&gt;</a> V1A, V1B, V2A, V2B;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; V1.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    V1A.push_back(GetBaseMaskValue(SVI0A, V1[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].first));</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    V1B.push_back(GetBaseMaskValue(SVI0B, V1[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].first));</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    V2A.push_back(GetBaseMaskValue(SVI1A, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].first));</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    V2B.push_back(GetBaseMaskValue(SVI1B, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].first));</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">while</span> (V1A.size() &lt; NumElts) {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    V1A.push_back(<a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    V1B.push_back(<a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordflow">while</span> (V2A.size() &lt; NumElts) {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    V2A.push_back(<a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    V2B.push_back(<a class="code" href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">UndefMaskElem</a>);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keyword">auto</span> AddShuffleCost = [&amp;](<a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keyword">auto</span> *SV = dyn_cast&lt;ShuffleVectorInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">if</span> (!SV)</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> + <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(isa&lt;UndefValue&gt;(SV-&gt;getOperand(1))</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                                      ? <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">TTI::SK_PermuteSingleSrc</a></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                      : <a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab4616961a3bfdaec42aedc4fc426ccfe">TTI::SK_PermuteTwoSrc</a>,</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                  VT, SV-&gt;getShuffleMask());</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  };</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keyword">auto</span> AddShuffleMaskCost = [&amp;](<a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;int&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> + <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">getShuffleCost</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab4616961a3bfdaec42aedc4fc426ccfe">TTI::SK_PermuteTwoSrc</a>, VT, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  };</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// Get the costs of the shuffles + binops before and after with the new</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="comment">// shuffle masks.</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> CostBefore =</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Op0-&gt;getOpcode(), VT) +</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Op1-&gt;getOpcode(), VT);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  CostBefore += std::accumulate(Shuffles.begin(), Shuffles.end(),</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a>(0), AddShuffleCost);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  CostBefore += std::accumulate(InputShuffles.begin(), InputShuffles.end(),</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                                <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a>(0), AddShuffleCost);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="comment">// The new binops will be unused for lanes past the used shuffle lengths.</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">// These types attempt to get the correct cost for that from the target.</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Op0SmallVT =</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(VT-&gt;getScalarType(), V1.size());</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Op1SmallVT =</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(VT-&gt;getScalarType(), <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>.size());</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> CostAfter =</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Op0-&gt;getOpcode(), Op0SmallVT) +</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Op1-&gt;getOpcode(), Op1SmallVT);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  CostAfter += std::accumulate(ReconstructMasks.begin(), ReconstructMasks.end(),</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                               <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a>(0), AddShuffleMaskCost);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  std::set&lt;SmallVector&lt;int&gt;&gt; OutputShuffleMasks({V1A, V1B, V2A, V2B});</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  CostAfter +=</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      std::accumulate(OutputShuffleMasks.begin(), OutputShuffleMasks.end(),</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                      <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a>(0), AddShuffleMaskCost);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found a binop select shuffle pattern: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  CostBefore: &quot;</span> &lt;&lt; CostBefore</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; vs CostAfter: &quot;</span> &lt;&lt; CostAfter &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordflow">if</span> (CostBefore &lt;= CostAfter)</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// The cost model has passed, create the new instructions.</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keyword">auto</span> GetShuffleOperand = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) -&gt; <a class="code" href="classllvm_1_1Value.html">Value</a> * {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keyword">auto</span> *SV = dyn_cast&lt;ShuffleVectorInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (!SV)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(SV-&gt;getOperand(1)))</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SSV = dyn_cast&lt;ShuffleVectorInst&gt;(SV-&gt;getOperand(0)))</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">if</span> (InputShuffles.contains(SSV))</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          <span class="keywordflow">return</span> SSV-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">return</span> SV-&gt;getOperand(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  };</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(SVI0A-&gt;getInsertionPointAfterDef());</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NSV0A = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(GetShuffleOperand(SVI0A, 0),</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                                             GetShuffleOperand(SVI0A, 1), V1A);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(SVI0B-&gt;getInsertionPointAfterDef());</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NSV0B = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(GetShuffleOperand(SVI0B, 0),</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                                             GetShuffleOperand(SVI0B, 1), V1B);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(SVI1A-&gt;getInsertionPointAfterDef());</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NSV1A = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(GetShuffleOperand(SVI1A, 0),</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                                             GetShuffleOperand(SVI1A, 1), V2A);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(SVI1B-&gt;getInsertionPointAfterDef());</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NSV1B = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(GetShuffleOperand(SVI1B, 0),</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                                             GetShuffleOperand(SVI1B, 1), V2B);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Op0);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NOp0 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Op0-&gt;getOpcode(),</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                    NSV0A, NSV0B);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(NOp0))</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;copyIRFlags(Op0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Op1);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NOp1 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBinOp((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Op1-&gt;getOpcode(),</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                    NSV1A, NSV1B);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(NOp1))</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;copyIRFlags(Op1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = ReconstructMasks.size(); <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>++) {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Shuffles[<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>]);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NSV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(NOp0, NOp1, ReconstructMasks[<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>]);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    replaceValue(*Shuffles[<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>], *NSV);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  Worklist.pushValue(NSV0A);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  Worklist.pushValue(NSV0B);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  Worklist.pushValue(NSV1A);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  Worklist.pushValue(NSV1B);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Shuffles)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    Worklist.add(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;}</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">/// This is the entry point for all transforms. Pass manager differences are</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">/// handled in the callers of this function.</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">VectorCombine::run</a>() {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="VectorCombine_8cpp.html#acbc63323033a5a9de3d069827c51d3bf">DisableVectorCombine</a>)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">// Don&#39;t attempt vectorization if the target does not support vectors.</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aae0e8ca52658f54e5cc6214eb1a291ef">getNumberOfRegisters</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a623cced59353f83cc5eaba4068c57694">getRegisterClassForType</a>(<span class="comment">/*Vector*/</span> <span class="keyword">true</span>)))</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="keyword">auto</span> FoldInst = [<span class="keyword">this</span>, &amp;MadeChange](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordtype">bool</span> IsFixedVectorType = isa&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType());</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keyword">auto</span> Opcode = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode();</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">// These folds should be beneficial regardless of when this pass is run</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">// in the optimization pipeline.</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">// The type checking is for run-time efficiency. We can avoid wasting time</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="comment">// dispatching to folding functions if there&#39;s no chance of matching.</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keywordflow">if</span> (IsFixedVectorType) {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keywordflow">switch</span> (Opcode) {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">case</span> Instruction::InsertElement:</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        MadeChange |= vectorizeLoadInsert(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keywordflow">case</span> Instruction::ShuffleVector:</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        MadeChange |= widenSubvectorLoad(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>:</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        MadeChange |= scalarizeLoadExtract(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="comment">// This transform works with scalable and fixed vectors</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">// TODO: Identify and allow other scalable transforms</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> (isa&lt;VectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()))</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      MadeChange |= scalarizeBinopOrCmp(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">if</span> (Opcode == <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Instruction::Store</a>)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      MadeChange |= foldSingleElementStore(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">// If this is an early pipeline invocation of this pass, we are done.</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">if</span> (TryEarlyFoldsOnly)</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// Otherwise, try folds that improve codegen but may interfere with</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// early IR canonicalizations.</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// The type checking is for run-time efficiency. We can avoid wasting time</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="comment">// dispatching to folding functions if there&#39;s no chance of matching.</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">if</span> (IsFixedVectorType) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="keywordflow">switch</span> (Opcode) {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordflow">case</span> Instruction::InsertElement:</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        MadeChange |= foldInsExtFNeg(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="keywordflow">case</span> Instruction::ShuffleVector:</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        MadeChange |= foldShuffleOfBinops(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        MadeChange |= foldSelectShuffle(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keywordflow">case</span> Instruction::BitCast:</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        MadeChange |= foldBitcastShuf(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keywordflow">switch</span> (Opcode) {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Instruction::Call</a>:</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        MadeChange |= foldShuffleFromReductions(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keywordflow">case</span> Instruction::ICmp:</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="keywordflow">case</span> Instruction::FCmp:</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        MadeChange |= foldExtractExtract(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html#a5c88132322ca3f46f242f7c023a57010">Instruction::isBinaryOp</a>(Opcode)) {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;          MadeChange |= foldExtractExtract(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          MadeChange |= foldExtractedCmps(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    }</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  };</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="comment">// Ignore unreachable basic blocks.</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keywordflow">if</span> (!DT.<a class="code" href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">isReachableFromEntry</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// Use early increment range so that we can erase instructions in loop.</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">make_early_inc_range</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isDebugOrPseudoInst())</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      FoldInst(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">while</span> (!Worklist.isEmpty()) {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Worklist.removeOne();</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <a class="code" href="LICM_8cpp.html#ab0cfc793d55940eac67854827dd365e9">eraseInstruction</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    FoldInst(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;}</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"><a class="line" href="classllvm_1_1VectorCombinePass.html#a6a1e4cac923bd64f58cb782f1a5ba91a"> 1814</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1VectorCombinePass.html#a6a1e4cac923bd64f58cb782f1a5ba91a">VectorCombinePass::run</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                                         <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>) {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keyword">auto</span> &amp;AC = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AssumptionAnalysis.html">AssumptionAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1TargetIRAnalysis.html">TargetIRAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <a class="code" href="classllvm_1_1AAResults.html">AAResults</a> &amp;AA = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AAManager.html">AAManager</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  VectorCombine <a class="code" href="classllvm_1_1Combiner.html">Combiner</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, DT, AA, AC, TryEarlyFoldsOnly);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Combiner.html">Combiner</a>.run())</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> PA;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#a937c42f77e161349ce0f999e448c7027">preserveSet</a>&lt;<a class="code" href="classllvm_1_1CFGAnalyses.html">CFGAnalyses</a>&gt;();</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordflow">return</span> PA;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassllvm_1_1InstructionCost_html"><div class="ttname"><a href="classllvm_1_1InstructionCost.html">llvm::InstructionCost</a></div><div class="ttdef"><b>Definition:</b> <a href="InstructionCost_8h_source.html#l00029">InstructionCost.h:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aAssumptionCache_8h_html"><div class="ttname"><a href="AssumptionCache_8h.html">AssumptionCache.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAManager_html"><div class="ttname"><a href="classllvm_1_1AAManager.html">llvm::AAManager</a></div><div class="ttdoc">A manager for alias analyses.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00885">AliasAnalysis.h:885</a></div></div>
<div class="ttc" id="anamespacellvm_html_a423120c6a3bab0386276333090b574f8"><div class="ttname"><a href="namespacellvm.html#a423120c6a3bab0386276333090b574f8">llvm::mustSuppressSpeculation</a></div><div class="ttdeci">bool mustSuppressSpeculation(const LoadInst &amp;LI)</div><div class="ttdoc">Return true if speculation of the given load must be suppressed to avoid ordering or interfering with...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04788">ValueTracking.cpp:4788</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af46433d0e36d3f80afc3a8c67b5c53eca64d439485545faa793c20de7fbfd274c"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca64d439485545faa793c20de7fbfd274c">llvm::TargetTransformInfo::SK_Select</a></div><div class="ttdeci">@ SK_Select</div><div class="ttdoc">Selects elements from the corresponding lane of either source operand.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00913">TargetTransformInfo.h:913</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetIRAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetIRAnalysis.html">llvm::TargetIRAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetTransformInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l02626">TargetTransformInfo.h:2626</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bb"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">llvm::TargetTransformInfo::TargetCostKind</a></div><div class="ttdeci">TargetCostKind</div><div class="ttdoc">The kind of cost model.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00241">TargetTransformInfo.h:241</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html_a18e5a3f1d71ba10a624f2a8e5121cf1f"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">llvm::MemoryLocation::get</a></div><div class="ttdeci">static MemoryLocation get(const LoadInst *LI)</div><div class="ttdoc">Return a location with information about the memory reference by the given instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8cpp_source.html#l00036">MemoryLocation.cpp:36</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a078455f9a6da73bc84f24700a81d19d7"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a078455f9a6da73bc84f24700a81d19d7">llvm::ConstantExpr::getExtractElement</a></div><div class="ttdeci">static Constant * getExtractElement(Constant *Vec, Constant *Idx, Type *OnlyIfReducedTy=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02573">Constants.cpp:2573</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a47f5c74e1b14ba4a61db057400644acc"><div class="ttname"><a href="classllvm_1_1Value.html#a47f5c74e1b14ba4a61db057400644acc">llvm::Value::getPointerAlignment</a></div><div class="ttdeci">Align getPointerAlignment(const DataLayout &amp;DL) const</div><div class="ttdoc">Returns an alignment of the pointer value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00918">Value.cpp:918</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a8fa8b3631e74e836453f972aac6b4b65"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a8fa8b3631e74e836453f972aac6b4b65">llvm::TargetTransformInfo::getMinVectorRegisterBitWidth</a></div><div class="ttdeci">unsigned getMinVectorRegisterBitWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00662">TargetTransformInfo.cpp:662</a></div></div>
<div class="ttc" id="astructllvm_1_1PatternMatch_1_1m__Mask_html"><div class="ttname"><a href="structllvm_1_1PatternMatch_1_1m__Mask.html">llvm::PatternMatch::m_Mask</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01514">PatternMatch.h:1514</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_html_af048a5a215837b0272b22d5e7a0bc04aaa18c217c4f2a811afcaaf5052945e31b"><div class="ttname"><a href="namespacellvm_1_1dxil.html#af048a5a215837b0272b22d5e7a0bc04aaa18c217c4f2a811afcaaf5052945e31b">llvm::dxil::ParameterKind::I1</a></div><div class="ttdeci">@ I1</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html_aac5f27f8d0ff473183fff55780e5796c"><div class="ttname"><a href="classllvm_1_1ConstantRange.html#aac5f27f8d0ff473183fff55780e5796c">llvm::ConstantRange::binaryAnd</a></div><div class="ttdeci">ConstantRange binaryAnd(const ConstantRange &amp;Other) const</div><div class="ttdoc">Return a new range representing the possible values resulting from a binary-and of a value in this ra...</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8cpp_source.html#l01397">ConstantRange.cpp:1397</a></div></div>
<div class="ttc" id="aREADME__P9_8txt_html_aa793083a95c48c23abfa352d4335685a"><div class="ttname"><a href="README__P9_8txt.html#aa793083a95c48c23abfa352d4335685a">Insert</a></div><div class="ttdeci">Vector Rotate Left Mask Mask Insert</div><div class="ttdef"><b>Definition:</b> <a href="README__P9_8txt_source.html#l00112">README_P9.txt:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdoc">This enumeration lists the possible predicates for CmpInst subclasses.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00718">InstrTypes.h:718</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a0b931781aa589c6ebe64a76c1447e5b2"><div class="ttname"><a href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">llvm::User::operands</a></div><div class="ttdeci">op_range operands()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00242">User.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1ShuffleVectorInst_html_a6eaff12d0d3ead952f2a2a2781df56ac"><div class="ttname"><a href="classllvm_1_1ShuffleVectorInst.html#a6eaff12d0d3ead952f2a2a2781df56ac">llvm::ShuffleVectorInst::getShuffleMask</a></div><div class="ttdeci">static void getShuffleMask(const Constant *Mask, SmallVectorImpl&lt; int &gt; &amp;Result)</div><div class="ttdoc">Convert the input shuffle mask operand to a vector of integers.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02225">Instructions.cpp:2225</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af89277d8bd76d6348291e29b6076796a"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">llvm::TargetTransformInfo::getCmpSelInstrCost</a></div><div class="ttdeci">InstructionCost getCmpSelInstrCost(unsigned Opcode, Type *ValTy, Type *CondTy, CmpInst::Predicate VecPred, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, const Instruction *I=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00897">TargetTransformInfo.cpp:897</a></div></div>
<div class="ttc" id="aLoads_8h_html"><div class="ttname"><a href="Loads_8h.html">Loads.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ExtractElementInst_html"><div class="ttname"><a href="classllvm_1_1ExtractElementInst.html">llvm::ExtractElementInst</a></div><div class="ttdoc">This instruction extracts a single (scalar) element from a VectorType value.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01881">Instructions.h:1881</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_a52e65b088a444dafdf68214186f7ad08"><div class="ttname"><a href="VectorCombine_8cpp.html#a52e65b088a444dafdf68214186f7ad08">canScalarizeAccess</a></div><div class="ttdeci">static ScalarizationResult canScalarizeAccess(FixedVectorType *VecTy, Value *Idx, Instruction *CtxI, AssumptionCache &amp;AC, const DominatorTree &amp;DT)</div><div class="ttdoc">Check if it is legal to scalarize a memory access to VecTy at index Idx.</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l01019">VectorCombine.cpp:1019</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00263">README.txt:263</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4abb39a66573f61fda80469faa5d861d"><div class="ttname"><a href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">llvm::Type::getScalarType</a></div><div class="ttdeci">Type * getScalarType() const</div><div class="ttdoc">If this is a vector type, return the element type, otherwise return 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00341">Type.h:341</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a9cae528bdb66086aa6c06da36fc6fa24"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a9cae528bdb66086aa6c06da36fc6fa24">llvm::PatternMatch::m_InsertElt</a></div><div class="ttdeci">ThreeOps_match&lt; Val_t, Elt_t, Idx_t, Instruction::InsertElement &gt; m_InsertElt(const Val_t &amp;Val, const Elt_t &amp;Elt, const Idx_t &amp;Idx)</div><div class="ttdoc">Matches InsertElementInst.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01484">PatternMatch.h:1484</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a4b001d9b458035fbbfc154d52d354ee9"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const</div><div class="ttdoc">Return the constant as an APInt value reference.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00132">Constants.h:132</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a246f298958a4a730bf7d3a64440dd47b"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a246f298958a4a730bf7d3a64440dd47b">llvm::TargetTransformInfo::getAddressComputationCost</a></div><div class="ttdeci">InstructionCost getAddressComputationCost(Type *Ty, ScalarEvolution *SE=nullptr, const SCEV *Ptr=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l01004">TargetTransformInfo.cpp:1004</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">llvm::RISCVFenceField::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00279">RISCVBaseInfo.h:279</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorCombinePass_html_a6a1e4cac923bd64f58cb782f1a5ba91a"><div class="ttname"><a href="classllvm_1_1VectorCombinePass.html#a6a1e4cac923bd64f58cb782f1a5ba91a">llvm::VectorCombinePass::run</a></div><div class="ttdeci">PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l01814">VectorCombine.cpp:1814</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a78cd22f497c1e81c4d8a5e9073ef5a24"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a78cd22f497c1e81c4d8a5e9073ef5a24">llvm::PatternMatch::m_Load</a></div><div class="ttdeci">OneOps_match&lt; OpTy, Instruction::Load &gt; m_Load(const OpTy &amp;Op)</div><div class="ttdoc">Matches LoadInst.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01563">PatternMatch.h:1563</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a4b5e1f50cb0890ec60d8c61a61241170"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a4b5e1f50cb0890ec60d8c61a61241170">llvm::CmpInst::makeCmpResultType</a></div><div class="ttdeci">static Type * makeCmpResultType(Type *opnd_type)</div><div class="ttdoc">Create a result type for fcmp/icmp.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01054">InstrTypes.h:1054</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="anamespacellvm_html_a728f79528ca8659e15d00c1e6818b316"><div class="ttname"><a href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">llvm::isModSet</a></div><div class="ttdeci">bool isModSet(const ModRefInfo MRI)</div><div class="ttdef"><b>Definition:</b> <a href="ModRef_8h_source.html#l00048">ModRef.h:48</a></div></div>
<div class="ttc" id="aLICM_8cpp_html_ab0cfc793d55940eac67854827dd365e9"><div class="ttname"><a href="LICM_8cpp.html#ab0cfc793d55940eac67854827dd365e9">eraseInstruction</a></div><div class="ttdeci">static void eraseInstruction(Instruction &amp;I, ICFLoopSafetyInfo &amp;SafetyInfo, MemorySSAUpdater &amp;MSSAU)</div><div class="ttdef"><b>Definition:</b> <a href="LICM_8cpp_source.html#l01475">LICM.cpp:1475</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="aGlobalsModRef_8h_html"><div class="ttname"><a href="GlobalsModRef_8h.html">GlobalsModRef.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ae7fe2d1bb4f708d68fe7a908ba675d1b"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ae7fe2d1bb4f708d68fe7a908ba675d1b">llvm::TargetTransformInfo::getScalarizationOverhead</a></div><div class="ttdeci">InstructionCost getScalarizationOverhead(VectorType *Ty, const APInt &amp;DemandedElts, bool Insert, bool Extract, TTI::TargetCostKind CostKind) const</div><div class="ttdoc">Estimate the overhead of scalarizing an instruction.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00523">TargetTransformInfo.cpp:523</a></div></div>
<div class="ttc" id="aVectorCombine_8h_html"><div class="ttname"><a href="VectorCombine_8h.html">VectorCombine.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af37b2842424eb63440bdcacca0af9820"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af37b2842424eb63440bdcacca0af9820">llvm::TargetTransformInfo::getVectorInstrCost</a></div><div class="ttdeci">InstructionCost getVectorInstrCost(unsigned Opcode, Type *Val, TTI::TargetCostKind CostKind, unsigned Index=-1, Value *Op0=nullptr, Value *Op1=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00908">TargetTransformInfo.cpp:908</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa91449ed55cd3c525a3438252573527a"><div class="ttname"><a href="namespacellvm.html#aa91449ed55cd3c525a3438252573527a">llvm::narrowShuffleMaskElts</a></div><div class="ttdeci">void narrowShuffleMaskElts(int Scale, ArrayRef&lt; int &gt; Mask, SmallVectorImpl&lt; int &gt; &amp;ScaledMask)</div><div class="ttdoc">Replace each shuffle mask index with the scaled sequential indices for an equivalent mask of narrowed...</div><div class="ttdef"><b>Definition:</b> <a href="VectorUtils_8cpp_source.html#l00469">VectorUtils.cpp:469</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_a78d37997d6b920824dbdec1ec1213bc5"><div class="ttname"><a href="VectorCombine_8cpp.html#a78d37997d6b920824dbdec1ec1213bc5">canWidenLoad</a></div><div class="ttdeci">static bool canWidenLoad(LoadInst *Load, const TargetTransformInfo &amp;TTI)</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l00134">VectorCombine.cpp:134</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_a55195fa18cf783fe74de0cced1ca6eb3"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a55195fa18cf783fe74de0cced1ca6eb3">llvm::StoreInst::setAlignment</a></div><div class="ttdeci">void setAlignment(Align Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00349">Instructions.h:349</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a784097fca76abad9e815cf1692de79c4"><div class="ttname"><a href="classllvm_1_1Instruction.html#a784097fca76abad9e815cf1692de79c4">llvm::Instruction::comesBefore</a></div><div class="ttdeci">bool comesBefore(const Instruction *Other) const</div><div class="ttdoc">Given an instruction Other in the same basic block as this instruction, return true if this instructi...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00122">Instruction.cpp:122</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2bea09503a438b76b5c9253327118af5"><div class="ttname"><a href="namespacellvm.html#a2bea09503a438b76b5c9253327118af5">llvm::createUnaryMask</a></div><div class="ttdeci">llvm::SmallVector&lt; int, 16 &gt; createUnaryMask(ArrayRef&lt; int &gt; Mask, unsigned NumElts)</div><div class="ttdoc">Given a shuffle mask for a binary shuffle, create the equivalent shuffle mask assuming both operands ...</div><div class="ttdef"><b>Definition:</b> <a href="VectorUtils_8cpp_source.html#l00996">VectorUtils.cpp:996</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a43ac4fbaaf63a88eb5ac05f6d3e5649c"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a43ac4fbaaf63a88eb5ac05f6d3e5649c">llvm::PatternMatch::m_BinOp</a></div><div class="ttdeci">class_match&lt; BinaryOperator &gt; m_BinOp()</div><div class="ttdoc">Match an arbitrary binary operation and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00084">PatternMatch.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aec6eaa1e49f48c178e0ab9c030b5971e"><div class="ttname"><a href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">llvm::Instruction::copyMetadata</a></div><div class="ttdeci">void copyMetadata(const Instruction &amp;SrcInst, ArrayRef&lt; unsigned &gt; WL=ArrayRef&lt; unsigned &gt;())</div><div class="ttdoc">Copy metadata from SrcInst to this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00882">Instruction.cpp:882</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_a935a117ebc18605ba99cdc14c80bdf0c"><div class="ttname"><a href="VectorCombine_8cpp.html#a935a117ebc18605ba99cdc14c80bdf0c">InvalidIndex</a></div><div class="ttdeci">static const unsigned InvalidIndex</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l00061">VectorCombine.cpp:61</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ac0467ca7fad871738b10db95feb40dad"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ac0467ca7fad871738b10db95feb40dad">llvm::PatternMatch::m_BitCast</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::BitCast &gt; m_BitCast(const OpTy &amp;Op)</div><div class="ttdoc">Matches BitCast.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01593">PatternMatch.h:1593</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_aac5759c83abd6a4af236401a7cfe7a0f"><div class="ttname"><a href="classllvm_1_1Type.html#aac5759c83abd6a4af236401a7cfe7a0f">llvm::Type::isFloatingPointTy</a></div><div class="ttdeci">bool isFloatingPointTy() const</div><div class="ttdoc">Return true if this is one of the floating-point types.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00185">Type.h:185</a></div></div>
<div class="ttc" id="aBasicAliasAnalysis_8h_html"><div class="ttname"><a href="BasicAliasAnalysis_8h.html">BasicAliasAnalysis.h</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_aa0a0dd3a69912556b16b034162a4ae19"><div class="ttname"><a href="VectorCombine_8cpp.html#aa0a0dd3a69912556b16b034162a4ae19">MaxInstrsToScan</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxInstrsToScan(&quot;vector-combine-max-scan-instrs&quot;, cl::init(30), cl::Hidden, cl::desc(&quot;Max number of instructions to scan for vector combining.&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html">llvm::FixedVectorType</a></div><div class="ttdoc">Class to represent fixed width SIMD vectors.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00525">DerivedTypes.h:525</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53eca7beec9815d0197f2d31fac9968e9205b">llvm::TargetTransformInfo::SK_PermuteSingleSrc</a></div><div class="ttdeci">@ SK_PermuteSingleSrc</div><div class="ttdoc">Shuffle elements of single source vector with any shuffle mask.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00921">TargetTransformInfo.h:921</a></div></div>
<div class="ttc" id="aSPIRVModuleAnalysis_8cpp_html_acaab1e2660e7055669741c9f485e26c5"><div class="ttname"><a href="SPIRVModuleAnalysis_8cpp.html#acaab1e2660e7055669741c9f485e26c5">OpIndex</a></div><div class="ttdeci">unsigned OpIndex</div><div class="ttdef"><b>Definition:</b> <a href="SPIRVModuleAnalysis_8cpp_source.html#l00046">SPIRVModuleAnalysis.cpp:46</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07c"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07c">llvm::NVPTX::PTXLdStInstCode::VecType</a></div><div class="ttdeci">VecType</div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00122">NVPTX.h:122</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd6aa057934751aaac54e5c18bcc18eb"><div class="ttname"><a href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">llvm::commonAlignment</a></div><div class="ttdeci">Align commonAlignment(Align A, uint64_t Offset)</div><div class="ttdoc">Returns the alignment that satisfies both alignments.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00212">Alignment.h:212</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4e09435caee07f636a47006fa08b9ec4"><div class="ttname"><a href="namespacellvm.html#a4e09435caee07f636a47006fa08b9ec4">llvm::UndefMaskElem</a></div><div class="ttdeci">constexpr int UndefMaskElem</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02005">Instructions.h:2005</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aca6428e7fec51ba0b55594f469eb9691"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">llvm::PatternMatch::m_OneUse</a></div><div class="ttdeci">OneUse_match&lt; T &gt; m_OneUse(const T &amp;SubPattern)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00067">PatternMatch.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9149819221d66953ac6c2938b87f0136"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9149819221d66953ac6c2938b87f0136">llvm::Instruction::mayReadFromMemory</a></div><div class="ttdeci">bool mayReadFromMemory() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction may read memory.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00626">Instruction.cpp:626</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a91efa71de05b0c2d00730a0279f58658"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">llvm::BitmaskEnumDetail::Mask</a></div><div class="ttdeci">constexpr std::underlying_type_t&lt; E &gt; Mask()</div><div class="ttdoc">Get a bitmask with 1s in all places up to the high-order bit of E's largest value.</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00080">BitmaskEnum.h:80</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html_a1893caf878859959ba6a3d5442ef1439"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">llvm::FixedVectorType::getNumElements</a></div><div class="ttdeci">unsigned getNumElements() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00568">DerivedTypes.h:568</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af46433d0e36d3f80afc3a8c67b5c53ecab4616961a3bfdaec42aedc4fc426ccfe"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af46433d0e36d3f80afc3a8c67b5c53ecab4616961a3bfdaec42aedc4fc426ccfe">llvm::TargetTransformInfo::SK_PermuteTwoSrc</a></div><div class="ttdeci">@ SK_PermuteTwoSrc</div><div class="ttdoc">Merge elements from two source vectors into one with any shuffle mask.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00919">TargetTransformInfo.h:919</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6339f2ad6701dc229c34ca4305596d3a"><div class="ttname"><a href="namespacellvm.html#a6339f2ad6701dc229c34ca4305596d3a">llvm::isSplatValue</a></div><div class="ttdeci">bool isSplatValue(const Value *V, int Index=-1, unsigned Depth=0)</div><div class="ttdoc">Return true if each element of the vector value V is poisoned or equal to every other non-poisoned el...</div><div class="ttdef"><b>Definition:</b> <a href="VectorUtils_8cpp_source.html#l00386">VectorUtils.cpp:386</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a9679969ae87f8a08d5f6948be6cf7210"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">llvm::TargetTransformInfo::getArithmeticInstrCost</a></div><div class="ttdeci">InstructionCost getArithmeticInstrCost(unsigned Opcode, Type *Ty, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, TTI::OperandValueInfo Opd1Info={TTI::OK_AnyValue, TTI::OP_None}, TTI::OperandValueInfo Opd2Info={TTI::OK_AnyValue, TTI::OP_None}, ArrayRef&lt; const Value * &gt; Args=ArrayRef&lt; const Value * &gt;(), const Instruction *CxtI=nullptr) const</div><div class="ttdoc">This is an approximation of reciprocal throughput of a math/logic op.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00803">TargetTransformInfo.cpp:803</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_addb87fe3f509b7803d3f5933ee24b560"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#addb87fe3f509b7803d3f5933ee24b560">llvm::PatternMatch::m_Select</a></div><div class="ttdeci">ThreeOps_match&lt; Cond, LHS, RHS, Instruction::Select &gt; m_Select(const Cond &amp;C, const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches SelectInst.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01462">PatternMatch.h:1462</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a7bd850492d35a34f0fe419e5555997a9"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a7bd850492d35a34f0fe419e5555997a9">llvm::CmpInst::isFPPredicate</a></div><div class="ttdeci">bool isFPPredicate() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00825">InstrTypes.h:825</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html"><div class="ttname"><a href="classllvm_1_1AAResults.html">llvm::AAResults</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00294">AliasAnalysis.h:294</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdeci">@ A</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00034">ARMBaseInfo.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html_a2205e49ace8bb2fd9934342ff6a25e13"><div class="ttname"><a href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">llvm::AAResults::getModRefInfo</a></div><div class="ttdeci">ModRefInfo getModRefInfo(const Instruction *I, const std::optional&lt; MemoryLocation &gt; &amp;OptLoc)</div><div class="ttdoc">Check whether or not an instruction may read or write the optionally specified memory location.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00488">AliasAnalysis.h:488</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_ae59c9684e490f1375deefa7acf973595"><div class="ttname"><a href="VectorCombine_8cpp.html#ae59c9684e490f1375deefa7acf973595">createShiftShuffle</a></div><div class="ttdeci">static Value * createShiftShuffle(Value *Vec, unsigned OldIndex, unsigned NewIndex, IRBuilder&lt;&gt; &amp;Builder)</div><div class="ttdoc">Create a shuffle that translates (shifts) 1 element from the input vector to a new element location.</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l00480">VectorCombine.cpp:480</a></div></div>
<div class="ttc" id="aOcamlGCPrinter_8cpp_html_afcf2f797ed287a723263583c9b1c1bce"><div class="ttname"><a href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; OcamlGCMetadataPrinter &gt; Y(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible collector&quot;)</div></div>
<div class="ttc" id="aInstructionWorklist_8h_html"><div class="ttname"><a href="InstructionWorklist_8h.html">InstructionWorklist.h</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aCanonicalizeFreezeInLoops_8cpp_html_a9680cc81ccaa4506cae9f5369cf5307e"><div class="ttname"><a href="CanonicalizeFreezeInLoops_8cpp.html#a9680cc81ccaa4506cae9f5369cf5307e">freeze</a></div><div class="ttdeci">canon freeze</div><div class="ttdef"><b>Definition:</b> <a href="CanonicalizeFreezeInLoops_8cpp_source.html#l00241">CanonicalizeFreezeInLoops.cpp:241</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a1bc022868b23918efa44df511f4d5b61"><div class="ttname"><a href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const</div><div class="ttdoc">True if this is an instance of VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00258">Type.h:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionWorklist_html_abfbfe7ff58105b170ca57742a9d378ee"><div class="ttname"><a href="classllvm_1_1InstructionWorklist.html#abfbfe7ff58105b170ca57742a9d378ee">llvm::InstructionWorklist::remove</a></div><div class="ttdeci">void remove(Instruction *I)</div><div class="ttdoc">Remove I from the worklist if it exists.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionWorklist_8h_source.html#l00085">InstructionWorklist.h:85</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a04353aa48874f9bda89ff9059cd1a5a6"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">llvm::PatternMatch::m_Instruction</a></div><div class="ttdeci">bind_ty&lt; Instruction &gt; m_Instruction(Instruction *&amp;I)</div><div class="ttdoc">Match an instruction, capturing it if we match.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00716">PatternMatch.h:716</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdeci">@ Store</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00033">SparcInstrInfo.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1ShuffleVectorInst_html_a3fb8619f70f51242f81ef96da349c884"><div class="ttname"><a href="classllvm_1_1ShuffleVectorInst.html#a3fb8619f70f51242f81ef96da349c884">llvm::ShuffleVectorInst::getMaskValue</a></div><div class="ttdeci">int getMaskValue(unsigned Elt) const</div><div class="ttdoc">Return the shuffle mask value of this instruction for the given element index.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02072">Instructions.h:2072</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_af431ec215bba8bb9c56e7541d99920f2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">llvm::PatternMatch::m_FNeg</a></div><div class="ttdeci">FNeg_match&lt; OpTy &gt; m_FNeg(const OpTy &amp;X)</div><div class="ttdoc">Match 'fneg X' as 'fsub -0.0, X'.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01033">PatternMatch.h:1033</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a31bf07f3f61525486633bc1d0bbaf029"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00391">InstrTypes.h:391</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a677ac8d99ff3c2d32a95c21de9ed372c"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a677ac8d99ff3c2d32a95c21de9ed372c">llvm::PatternMatch::m_ConstantInt</a></div><div class="ttdeci">class_match&lt; ConstantInt &gt; m_ConstantInt()</div><div class="ttdoc">Match an arbitrary ConstantInt and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00147">PatternMatch.h:147</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a9f382207d841377156d4c7868b66b9a5"><div class="ttname"><a href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits() const LLVM_READONLY</div><div class="ttdoc">If this is a vector type, return the getPrimitiveSizeInBits value for the element type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00188">Type.cpp:188</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01740">Constants.cpp:1740</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_af430e1420ae91582114e512b797e4964"><div class="ttname"><a href="VectorCombine_8cpp.html#af430e1420ae91582114e512b797e4964">DisableBinopExtractShuffle</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableBinopExtractShuffle(&quot;disable-binop-extract-shuffle&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Disable binop extract to shuffle transforms&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ae1a04895305aaea96e5e82d95c39bbe0"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ae1a04895305aaea96e5e82d95c39bbe0">llvm::PatternMatch::m_URem</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::URem &gt; m_URem(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01075">PatternMatch.h:1075</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a043cdaf7b89aaeeb127be5d93411637f"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a></div><div class="ttdeci">uint64_t Align</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00082">ELFObjHandler.cpp:82</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html_af9a870d5df50fe0133a410b7c9114c80"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">llvm::FixedVectorType::get</a></div><div class="ttdeci">static FixedVectorType * get(Type *ElementType, unsigned NumElts)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00686">Type.cpp:686</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">llvm::MCID::Call</a></div><div class="ttdeci">@ Call</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00156">MCInstrDesc.h:156</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">llvm::NVPTX::PTXLdStInstCode::Scalar</a></div><div class="ttdeci">@ Scalar</div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00123">NVPTX.h:123</a></div></div>
<div class="ttc" id="aclassllvm_1_1ShuffleVectorInst_html_a50fe6a61ea745fb71fa8403af6e7deed"><div class="ttname"><a href="classllvm_1_1ShuffleVectorInst.html#a50fe6a61ea745fb71fa8403af6e7deed">llvm::ShuffleVectorInst::getType</a></div><div class="ttdeci">VectorType * getType() const</div><div class="ttdoc">Overload to return most specific vector type.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02063">Instructions.h:2063</a></div></div>
<div class="ttc" id="aErlangGCPrinter_8cpp_html_a74b474c0616ab55c1d9487f11fd31d26"><div class="ttname"><a href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; ErlangGCPrinter &gt; X(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a55743bd32282bf6f87aeb49237b1fb68"><div class="ttname"><a href="classllvm_1_1Instruction.html#a55743bd32282bf6f87aeb49237b1fb68">llvm::Instruction::isCommutative</a></div><div class="ttdeci">bool isCommutative() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction is commutative:</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00816">Instruction.cpp:816</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_1_1PointerTypeAnalysis_html_ae574a4c1d84b9e67bc94489f356805b4"><div class="ttname"><a href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">llvm::dxil::PointerTypeAnalysis::run</a></div><div class="ttdeci">PointerTypeMap run(const Module &amp;M)</div><div class="ttdoc">Compute the PointerTypeMap for the module M.</div><div class="ttdef"><b>Definition:</b> <a href="PointerTypeAnalysis_8cpp_source.html#l00189">PointerTypeAnalysis.cpp:189</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_adf0290c7c322f0bf8b275d6b26410b52"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#adf0290c7c322f0bf8b275d6b26410b52">llvm::PatternMatch::m_ExtractElt</a></div><div class="ttdeci">TwoOps_match&lt; Val_t, Idx_t, Instruction::ExtractElement &gt; m_ExtractElt(const Val_t &amp;Val, const Idx_t &amp;Idx)</div><div class="ttdoc">Matches ExtractElementInst.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01492">PatternMatch.h:1492</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="anamespacellvm_html_a74cdbd1e4f731e7d7cd83461b8b1de0b"><div class="ttname"><a href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a></div><div class="ttdeci">void sort(IteratorTy Start, IteratorTy End)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01683">STLExtras.h:1683</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_aec662ee6ab1490a4cabebf2812e5b9ca"><div class="ttname"><a href="classllvm_1_1APInt.html#aec662ee6ab1490a4cabebf2812e5b9ca">llvm::APInt::getOneBitSet</a></div><div class="ttdeci">static APInt getOneBitSet(unsigned numBits, unsigned BitNo)</div><div class="ttdoc">Return an APInt with exactly one bit set in the result.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00222">APInt.h:222</a></div></div>
<div class="ttc" id="aVectorUtils_8h_html"><div class="ttname"><a href="VectorUtils_8h.html">VectorUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1ShuffleVectorInst_html_a9874bec83353914ed1e9309d5d9ccea0"><div class="ttname"><a href="classllvm_1_1ShuffleVectorInst.html#a9874bec83353914ed1e9309d5d9ccea0">llvm::ShuffleVectorInst::commuteShuffleMask</a></div><div class="ttdeci">static void commuteShuffleMask(MutableArrayRef&lt; int &gt; Mask, unsigned InVecNumElts)</div><div class="ttdoc">Change values in a shuffle permute mask assuming the two vector operands of length InVecNumElts have ...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02422">Instructions.h:2422</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6110fc30bc7311a6cf99814530362e21"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">llvm::AMDGPU::Hwreg::Offset</a></div><div class="ttdeci">Offset</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00432">SIDefines.h:432</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_aef61945034b9431b804748fc317c5548"><div class="ttname"><a href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a></div><div class="ttdeci">uint32_t Index</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00083">ELFObjHandler.cpp:83</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad2ea0f3a55cc5ac23db1d53c12f656f9"><div class="ttname"><a href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">llvm::isSafeToLoadUnconditionally</a></div><div class="ttdeci">bool isSafeToLoadUnconditionally(Value *V, Align Alignment, APInt &amp;Size, const DataLayout &amp;DL, Instruction *ScanFrom=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if we know that executing a load from this value cannot trap.</div><div class="ttdef"><b>Definition:</b> <a href="Loads_8cpp_source.html#l00325">Loads.cpp:325</a></div></div>
<div class="ttc" id="aclassllvm_1_1Combiner_html"><div class="ttname"><a href="classllvm_1_1Combiner.html">llvm::Combiner</a></div><div class="ttdef"><b>Definition:</b> <a href="Combiner_8h_source.html#l00026">Combiner.h:26</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionWorklist_html_a87029746a970dab9ed9f32a106d86370"><div class="ttname"><a href="classllvm_1_1InstructionWorklist.html#a87029746a970dab9ed9f32a106d86370">llvm::InstructionWorklist::push</a></div><div class="ttdeci">void push(Instruction *I)</div><div class="ttdoc">Push the instruction onto the worklist stack.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionWorklist_8h_source.html#l00058">InstructionWorklist.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionAnalysis_html"><div class="ttname"><a href="classllvm_1_1AssumptionAnalysis.html">llvm::AssumptionAnalysis</a></div><div class="ttdoc">A function analysis which provides an AssumptionCache.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00173">AssumptionCache.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a623cced59353f83cc5eaba4068c57694"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a623cced59353f83cc5eaba4068c57694">llvm::TargetTransformInfo::getRegisterClassForType</a></div><div class="ttdeci">unsigned getRegisterClassForType(bool Vector, Type *Ty=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00648">TargetTransformInfo.cpp:648</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_acbc63323033a5a9de3d069827c51d3bf"><div class="ttname"><a href="VectorCombine_8cpp.html#acbc63323033a5a9de3d069827c51d3bf">DisableVectorCombine</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableVectorCombine(&quot;disable-vector-combine&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Disable all vector combine transforms&quot;))</div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a427435d4da769ae680a8e77ef89520aa"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">llvm::PatternMatch::m_And</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::And &gt; m_And(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01093">PatternMatch.h:1093</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd1cd968cb420c82d70926920fcdc7d7"><div class="ttname"><a href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a></div><div class="ttdeci">bool is_contained(R &amp;&amp;Range, const E &amp;Element)</div><div class="ttdoc">Wrapper function around std::find to detect if an element exists in a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01869">STLExtras.h:1869</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_aa1743eec4f65f26420488de7cf4d5d63"><div class="ttname"><a href="VectorCombine_8cpp.html#aa1743eec4f65f26420488de7cf4d5d63">translateExtract</a></div><div class="ttdeci">static ExtractElementInst * translateExtract(ExtractElementInst *ExtElt, unsigned NewIndex, IRBuilder&lt;&gt; &amp;Builder)</div><div class="ttdoc">Given an extract element instruction with constant index operand, shuffle the source vector (shift th...</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l00495">VectorCombine.cpp:495</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a1a70f2c359aadd76a72aaaede16aca4a"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">llvm::DominatorTree::isReachableFromEntry</a></div><div class="ttdeci">bool isReachableFromEntry(const Use &amp;U) const</div><div class="ttdoc">Provide an overload for a Use.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00335">Dominators.cpp:335</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">llvm::CmpInst::BAD_ICMP_PREDICATE</a></div><div class="ttdeci">@ BAD_ICMP_PREDICATE</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00751">InstrTypes.h:751</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0d69e81725c10fa5407f0bf34462068"><div class="ttname"><a href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">llvm::TTI</a></div><div class="ttdeci">TargetTransformInfo TTI</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00191">TargetTransformInfo.h:191</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a5c88132322ca3f46f242f7c023a57010"><div class="ttname"><a href="classllvm_1_1Instruction.html#a5c88132322ca3f46f242f7c023a57010">llvm::Instruction::isBinaryOp</a></div><div class="ttdeci">bool isBinaryOp() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00173">Instruction.h:173</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aadd209ba7e1bfa8113a609e09a7fe62f"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aadd209ba7e1bfa8113a609e09a7fe62f">llvm::PatternMatch::m_Constant</a></div><div class="ttdeci">class_match&lt; Constant &gt; m_Constant()</div><div class="ttdoc">Match an arbitrary Constant and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00144">PatternMatch.h:144</a></div></div>
<div class="ttc" id="aVPlanSLP_8cpp_html_af04704e906a9654777e92a4612c58c13"><div class="ttname"><a href="VPlanSLP_8cpp.html#af04704e906a9654777e92a4612c58c13">getOpcode</a></div><div class="ttdeci">static std::optional&lt; unsigned &gt; getOpcode(ArrayRef&lt; VPValue * &gt; Values)</div><div class="ttdoc">Returns the opcode of Values or ~0 if they do not all agree.</div><div class="ttdef"><b>Definition:</b> <a href="VPlanSLP_8cpp_source.html#l00191">VPlanSLP.cpp:191</a></div></div>
<div class="ttc" id="astructStatus_html"><div class="ttname"><a href="structStatus.html">Status</a></div><div class="ttdef"><b>Definition:</b> <a href="SIModeRegister_8cpp_source.html#l00029">SIModeRegister.cpp:29</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a3acbd0be97863e3e03e3b85641254018"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a3acbd0be97863e3e03e3b85641254018">llvm::PatternMatch::m_SpecificInt</a></div><div class="ttdeci">specific_intval&lt; false &gt; m_SpecificInt(APInt V)</div><div class="ttdoc">Match a specific integer value or vector with all elements equal to the value.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00854">PatternMatch.h:854</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a575c2299c6f145ba3a12efa20829db43"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a575c2299c6f145ba3a12efa20829db43">llvm::PatternMatch::m_CombineAnd</a></div><div class="ttdeci">match_combine_and&lt; LTy, RTy &gt; m_CombineAnd(const LTy &amp;L, const RTy &amp;R)</div><div class="ttdoc">Combine two pattern matchers matching L &amp;&amp; R.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00224">PatternMatch.h:224</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Sched_html_ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9"><div class="ttname"><a href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">llvm::Sched::Source</a></div><div class="ttdeci">@ Source</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00100">TargetLowering.h:100</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef&lt; int &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_html_a627b2f86ac433d829482d5a5a0f50668"><div class="ttname"><a href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">llvm::isInstructionTriviallyDead</a></div><div class="ttdeci">bool isInstructionTriviallyDead(Instruction *I, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if the result produced by the instruction is not used, and the instruction will return.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00398">Local.cpp:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00187">InstrTypes.h:187</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionWorklist_html_a1f3230f90474f0528f094d946f4ccc95"><div class="ttname"><a href="classllvm_1_1InstructionWorklist.html#a1f3230f90474f0528f094d946f4ccc95">llvm::InstructionWorklist::pushValue</a></div><div class="ttdeci">void pushValue(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="InstructionWorklist_8h_source.html#l00068">InstructionWorklist.h:68</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_adea6dc2e42baa345b97be48b0370313d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#adea6dc2e42baa345b97be48b0370313d">llvm::PatternMatch::m_Undef</a></div><div class="ttdeci">auto m_Undef()</div><div class="ttdoc">Match an arbitrary undef constant.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00136">PatternMatch.h:136</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCache_html"><div class="ttname"><a href="classllvm_1_1AssumptionCache.html">llvm::AssumptionCache</a></div><div class="ttdoc">A cache of @llvm.assume calls within a function.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00042">AssumptionCache.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1ExtractElementInst_html_aaeb8650ea4319878fc7529daaaf0a9be"><div class="ttname"><a href="classllvm_1_1ExtractElementInst.html#aaeb8650ea4319878fc7529daaaf0a9be">llvm::ExtractElementInst::getVectorOperand</a></div><div class="ttdeci">Value * getVectorOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01910">Instructions.h:1910</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1CFGAnalyses_html"><div class="ttname"><a href="classllvm_1_1CFGAnalyses.html">llvm::CFGAnalyses</a></div><div class="ttdoc">Represents analyses that only rely on functions' control flow.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00113">PassManager.h:113</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_afd3e8a6706810fef8cdbaf1f9f40dfbd"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#afd3e8a6706810fef8cdbaf1f9f40dfbd">llvm::PatternMatch::m_Shuffle</a></div><div class="ttdeci">TwoOps_match&lt; V1_t, V2_t, Instruction::ShuffleVector &gt; m_Shuffle(const V1_t &amp;v1, const V2_t &amp;v2)</div><div class="ttdoc">Matches ShuffleVectorInst independently of mask value.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01551">PatternMatch.h:1551</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aCostModel_8cpp_html_a263d4048026a7c0a91393b998181f16e"><div class="ttname"><a href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a></div><div class="ttdeci">static cl::opt&lt; TargetTransformInfo::TargetCostKind &gt; CostKind(&quot;cost-kind&quot;, cl::desc(&quot;Target cost kind&quot;), cl::init(TargetTransformInfo::TCK_RecipThroughput), cl::values(clEnumValN(TargetTransformInfo::TCK_RecipThroughput, &quot;throughput&quot;, &quot;Reciprocal throughput&quot;), clEnumValN(TargetTransformInfo::TCK_Latency, &quot;latency&quot;, &quot;Instruction latency&quot;), clEnumValN(TargetTransformInfo::TCK_CodeSize, &quot;code-size&quot;, &quot;Code size&quot;), clEnumValN(TargetTransformInfo::TCK_SizeAndLatency, &quot;size-latency&quot;, &quot;Code size and latency&quot;)))</div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">llvm::ms_demangle::IntrinsicFunctionKind::New</a></div><div class="ttdeci">@ New</div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="anamespacellvm_html_a546e6f5ba8f510c3e7ed2e20013548d9"><div class="ttname"><a href="namespacellvm.html#a546e6f5ba8f510c3e7ed2e20013548d9">llvm::computeConstantRange</a></div><div class="ttdeci">ConstantRange computeConstantRange(const Value *V, bool ForSigned, bool UseInstrInfo=true, AssumptionCache *AC=nullptr, const Instruction *CtxI=nullptr, const DominatorTree *DT=nullptr, unsigned Depth=0)</div><div class="ttdoc">Determine the possible constant range of an integer or vector of integer value.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l07404">ValueTracking.cpp:7404</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_aae0e8ca52658f54e5cc6214eb1a291ef"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#aae0e8ca52658f54e5cc6214eb1a291ef">llvm::TargetTransformInfo::getNumberOfRegisters</a></div><div class="ttdeci">unsigned getNumberOfRegisters(unsigned ClassID) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00644">TargetTransformInfo.cpp:644</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantVector_html_ade9fa017ca3aa82f7694a47090547bc1"><div class="ttname"><a href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">llvm::ConstantVector::get</a></div><div class="ttdeci">static Constant * get(ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01356">Constants.cpp:1356</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionCost_html_ae01c5ced9fe2fe50f421ae121483ef04"><div class="ttname"><a href="classllvm_1_1InstructionCost.html#ae01c5ced9fe2fe50f421ae121483ef04">llvm::InstructionCost::isValid</a></div><div class="ttdeci">bool isValid() const</div><div class="ttdef"><b>Definition:</b> <a href="InstructionCost_8h_source.html#l00079">InstructionCost.h:79</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="anamespacellvm_html_a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083"><div class="ttname"><a href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">llvm::ComplexDeinterleavingOperation::Shuffle</a></div><div class="ttdeci">@ Shuffle</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae7a4de5d3c7d0f2ba56e3933fb2007bf"><div class="ttname"><a href="classllvm_1_1Value.html#ae7a4de5d3c7d0f2ba56e3933fb2007bf">llvm::Value::stripAndAccumulateInBoundsConstantOffsets</a></div><div class="ttdeci">const Value * stripAndAccumulateInBoundsConstantOffsets(const DataLayout &amp;DL, APInt &amp;Offset) const</div><div class="ttdoc">This is a wrapper around stripAndAccumulateConstantOffsets with the in-bounds requirement set to fals...</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00724">Value.h:724</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac78c09ae232b2ce188ff590d51e3c268"><div class="ttname"><a href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">llvm::find_if</a></div><div class="ttdeci">auto find_if(R &amp;&amp;Range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::find_if which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01762">STLExtras.h:1762</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4373d3025961c2c2eeca56b02d7d009d"><div class="ttname"><a href="namespacellvm.html#a4373d3025961c2c2eeca56b02d7d009d">llvm::widenShuffleMaskElts</a></div><div class="ttdeci">bool widenShuffleMaskElts(int Scale, ArrayRef&lt; int &gt; Mask, SmallVectorImpl&lt; int &gt; &amp;ScaledMask)</div><div class="ttdoc">Try to transform a shuffle mask by replacing elements with the scaled index for an equivalent mask of...</div><div class="ttdef"><b>Definition:</b> <a href="VectorUtils_8cpp_source.html#l00490">VectorUtils.cpp:490</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">llvm::NVPTX::PTXLdStInstCode::V2</a></div><div class="ttdeci">@ V2</div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00124">NVPTX.h:124</a></div></div>
<div class="ttc" id="anamespacellvm_html_a076f93c387f454f0db13d4bc7d4e7f9c"><div class="ttname"><a href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a></div><div class="ttdeci">void stable_sort(R &amp;&amp;Range)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01948">STLExtras.h:1948</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_aa0519f26bcb15c25ac0ff557061fa7af"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#aa0519f26bcb15c25ac0ff557061fa7af">llvm::TargetTransformInfo::getShuffleCost</a></div><div class="ttdeci">InstructionCost getShuffleCost(ShuffleKind Kind, VectorType *Tp, ArrayRef&lt; int &gt; Mask=std::nullopt, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, int Index=0, VectorType *SubTp=nullptr, ArrayRef&lt; const Value * &gt; Args=std::nullopt) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00815">TargetTransformInfo.cpp:815</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a7c779ce2ba55bc94f52014fc25f3d520"><div class="ttname"><a href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">llvm::Value::hasNUses</a></div><div class="ttdeci">bool hasNUses(unsigned N) const</div><div class="ttdoc">Return true if this Value has exactly N uses.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00148">Value.cpp:148</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARCCC_html_a9a81d9a1b379cf08150b22e81d7dd006aceb189306b941666e679bf556207c1e4"><div class="ttname"><a href="namespacellvm_1_1ARCCC.html#a9a81d9a1b379cf08150b22e81d7dd006aceb189306b941666e679bf556207c1e4">llvm::ARCCC::Z</a></div><div class="ttdeci">@ Z</div><div class="ttdef"><b>Definition:</b> <a href="ARCInfo_8h_source.html#l00041">ARCInfo.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a34c987c590db0e5cff66d9869a34c556"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">llvm::TargetTransformInfo::getMemoryOpCost</a></div><div class="ttdeci">InstructionCost getMemoryOpCost(unsigned Opcode, Type *Src, Align Alignment, unsigned AddressSpace, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, OperandValueInfo OpdInfo={OK_AnyValue, OP_None}, const Instruction *I=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00941">TargetTransformInfo.cpp:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionWorklist_html"><div class="ttname"><a href="classllvm_1_1InstructionWorklist.html">llvm::InstructionWorklist</a></div><div class="ttdoc">InstructionWorklist - This is the worklist management logic for InstCombine and other simplification ...</div><div class="ttdef"><b>Definition:</b> <a href="InstructionWorklist_8h_source.html#l00025">InstructionWorklist.h:25</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a874d53817a4923de8e58af6b278c09b0"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a874d53817a4923de8e58af6b278c09b0">llvm::PatternMatch::m_ZeroInt</a></div><div class="ttdeci">cst_pred_ty&lt; is_zero_int &gt; m_ZeroInt()</div><div class="ttdoc">Match an integer 0 or a vector with all elements equal to 0.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00524">PatternMatch.h:524</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html_aaca3a4d2b25c24b11179cbd01079b73c"><div class="ttname"><a href="classllvm_1_1ConstantRange.html#aaca3a4d2b25c24b11179cbd01079b73c">llvm::ConstantRange::contains</a></div><div class="ttdeci">bool contains(const APInt &amp;Val) const</div><div class="ttdoc">Return true if the specified value is in the set.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8cpp_source.html#l00446">ConstantRange.cpp:446</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html"><div class="ttname"><a href="classllvm_1_1ConstantRange.html">llvm::ConstantRange</a></div><div class="ttdoc">This class represents a range of values.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8h_source.html#l00047">ConstantRange.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html_a336e2050c47c9d72b2cb4b13726fbba3"><div class="ttname"><a href="classllvm_1_1ConstantRange.html#a336e2050c47c9d72b2cb4b13726fbba3">llvm::ConstantRange::urem</a></div><div class="ttdeci">ConstantRange urem(const ConstantRange &amp;Other) const</div><div class="ttdoc">Return a new range representing the possible values resulting from an unsigned remainder operation of...</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8cpp_source.html#l01320">ConstantRange.cpp:1320</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ac26154a24f393f523c87cc5f8239f36c"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">llvm::Instruction::BinaryOps</a></div><div class="ttdeci">BinaryOps</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00809">Instruction.h:809</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeAnalysis_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeAnalysis.html">llvm::DominatorTreeAnalysis</a></div><div class="ttdoc">Analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00279">Dominators.h:279</a></div></div>
<div class="ttc" id="aclassllvm_1_1ShuffleVectorInst_html"><div class="ttname"><a href="classllvm_1_1ShuffleVectorInst.html">llvm::ShuffleVectorInst</a></div><div class="ttdoc">This instruction constructs a fixed permutation of two input vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02017">Instructions.h:2017</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a937c42f77e161349ce0f999e448c7027"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a937c42f77e161349ce0f999e448c7027">llvm::PreservedAnalyses::preserveSet</a></div><div class="ttdeci">void preserveSet()</div><div class="ttdoc">Mark an analysis set as preserved.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00188">PassManager.h:188</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a2d9861feadd3a09792967a012559e7b2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">llvm::PatternMatch::m_Specific</a></div><div class="ttdeci">specificval_ty m_Specific(const Value *V)</div><div class="ttdoc">Match if we have a specific specified value.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00772">PatternMatch.h:772</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00047">PatternMatch.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1ExtractElementInst_html_a5c70cc08cbcb4490ef7a9b4cf7766db6"><div class="ttname"><a href="classllvm_1_1ExtractElementInst.html#a5c70cc08cbcb4490ef7a9b4cf7766db6">llvm::ExtractElementInst::getIndexOperand</a></div><div class="ttdeci">Value * getIndexOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01911">Instructions.h:1911</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionWorklist_html_a3cc9848611dc0c92d60735f5de94b03f"><div class="ttname"><a href="classllvm_1_1InstructionWorklist.html#a3cc9848611dc0c92d60735f5de94b03f">llvm::InstructionWorklist::pushUsersToWorkList</a></div><div class="ttdeci">void pushUsersToWorkList(Instruction &amp;I)</div><div class="ttdoc">When an instruction is simplified, add all users of the instruction to the work lists because they mi...</div><div class="ttdef"><b>Definition:</b> <a href="InstructionWorklist_8h_source.html#l00106">InstructionWorklist.h:106</a></div></div>
<div class="ttc" id="aTransforms_2Vectorize_8h_html"><div class="ttname"><a href="Transforms_2Vectorize_8h.html">Vectorize.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae058c4750de2c85f12a1f96841ac9ae3"><div class="ttname"><a href="namespacellvm.html#ae058c4750de2c85f12a1f96841ac9ae3">llvm::isGuaranteedNotToBePoison</a></div><div class="ttdeci">bool isGuaranteedNotToBePoison(const Value *V, AssumptionCache *AC=nullptr, const Instruction *CtxI=nullptr, const DominatorTree *DT=nullptr, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l05588">ValueTracking.cpp:5588</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_af74676a3c7447be34bd2c1da76ec0c48"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#af74676a3c7447be34bd2c1da76ec0c48">llvm::SmallPtrSetImpl::contains</a></div><div class="ttdeci">bool contains(ConstPtrType Ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00389">SmallPtrSet.h:389</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a753e1338645ec04d045211b8a46d968d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a753e1338645ec04d045211b8a46d968d">llvm::PatternMatch::m_Cmp</a></div><div class="ttdeci">class_match&lt; CmpInst &gt; m_Cmp()</div><div class="ttdoc">Matches any compare instruction and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00089">PatternMatch.h:89</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_a52ed36081b67923e2f71ace41dee161b"><div class="ttname"><a href="VectorCombine_8cpp.html#a52ed36081b67923e2f71ace41dee161b">computeAlignmentAfterScalarization</a></div><div class="ttdeci">static Align computeAlignmentAfterScalarization(Align VectorAlignment, Type *ScalarType, Value *Idx, const DataLayout &amp;DL)</div><div class="ttdoc">The memory operation on a vector of ScalarType had alignment of VectorAlignment.</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l01061">VectorCombine.cpp:1061</a></div></div>
<div class="ttc" id="anamespacellvm_html_abe76d72cda6b2b4562c72accb510040b"><div class="ttname"><a href="namespacellvm.html#abe76d72cda6b2b4562c72accb510040b">llvm::isSafeToSpeculativelyExecute</a></div><div class="ttdeci">bool isSafeToSpeculativelyExecute(const Instruction *I, const Instruction *CtxI=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if the instruction does not have any effects besides calculating the result and does not ...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04799">ValueTracking.cpp:4799</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba59b32ea7b6f10564abd40ad90602ca5b">llvm::TargetTransformInfo::TCK_RecipThroughput</a></div><div class="ttdeci">@ TCK_RecipThroughput</div><div class="ttdoc">Reciprocal throughput.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00242">TargetTransformInfo.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html_a8c90e6c50e795b17466482a04947690e"><div class="ttname"><a href="classllvm_1_1VectorType.html#a8c90e6c50e795b17466482a04947690e">llvm::VectorType::get</a></div><div class="ttdeci">static VectorType * get(Type *ElementType, ElementCount EC)</div><div class="ttdoc">This static method is the primary way to construct an VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00670">Type.cpp:670</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html">llvm::MemoryLocation</a></div><div class="ttdoc">Representation for a specific memory location.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00211">MemoryLocation.h:211</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a833daf718a49c5cd637d8c9ddeaebe07"><div class="ttname"><a href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">TypeSize getPrimitiveSizeInBits() const LLVM_READONLY</div><div class="ttdoc">Return the basic size of this type if it is a primitive type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00163">Type.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="aVectorCombine_8cpp_html_ae76b679e73faaa60b69b4f4bafc0e456"><div class="ttname"><a href="VectorCombine_8cpp.html#ae76b679e73faaa60b69b4f4bafc0e456">isMemModifiedBetween</a></div><div class="ttdeci">static bool isMemModifiedBetween(BasicBlock::iterator Begin, BasicBlock::iterator End, const MemoryLocation &amp;Loc, AAResults &amp;AA)</div><div class="ttdef"><b>Definition:</b> <a href="VectorCombine_8cpp_source.html#l00950">VectorCombine.cpp:950</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:39:04 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
