<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/ARM/MVEGatherScatterLowering.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_4394675d1fa84070817ace1e93b57e8a.html">ARM</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MVEGatherScatterLowering.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MVEGatherScatterLowering_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- MVEGatherScatterLowering.cpp - Gather/Scatter lowering -------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// This pass custom lowers llvm.gather and llvm.scatter instructions to</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// arm.mve.gather and arm.mve.scatter intrinsics, optimising the code to</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// produce a better final result as we go.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ARM_8h.html">ARM.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ARMBaseInstrInfo_8h.html">ARMBaseInstrInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ARMSubtarget_8h.html">ARMSubtarget.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLowering_8h.html">llvm/CodeGen/TargetLowering.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetPassConfig_8h.html">llvm/CodeGen/TargetPassConfig.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetSubtargetInfo_8h.html">llvm/CodeGen/TargetSubtargetInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constant_8h.html">llvm/IR/Constant.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Intrinsics_8h.html">llvm/IR/Intrinsics.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsARM.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="MVEGatherScatterLowering_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   48</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;arm-mve-gather-scatter-lowering&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="MVEGatherScatterLowering_8cpp.html#a4d8ea5e78a2380c08cfe10c085dcc068">EnableMaskedGatherScatters</a>(</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="stringliteral">&quot;enable-arm-maskedgatscat&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable the generation of masked gathers and scatters&quot;</span>));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">class </span>MVEGatherScatterLowering : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; <span class="comment">// Pass identification, replacement for typeid</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">explicit</span> MVEGatherScatterLowering() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="namespacellvm.html#ad01d5e31fa9109df49f57e1e5e5a45f7">initializeMVEGatherScatterLoweringPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> getPassName()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;MVE gather/scatter lowering&quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a>&gt;();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classllvm_1_1Pass.html#a6590d0486104165ca40c7df0707f7b9e">FunctionPass::getAnalysisUsage</a>(AU);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// Check this is a valid gather with correct alignment</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">bool</span> isLegalTypeAndAlignment(<span class="keywordtype">unsigned</span> NumElements, <span class="keywordtype">unsigned</span> ElemSize,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                               <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// Check whether Ptr is hidden behind a bitcast and look through it</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">void</span> lookThroughBitcast(<a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// Decompose a ptr into Base and Offsets, potentially using a GEP to return a</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// scalar base and vector offsets, or else fallback to using a base of 0 and</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// offset of Ptr where possible.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *decomposePtr(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <span class="keywordtype">int</span> &amp;Scale,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                      <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Ty, <a class="code" href="classllvm_1_1Type.html">Type</a> *MemoryTy,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// Check for a getelementptr and deduce base and offsets from it, on success</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// returning the base directly and the offsets indirectly using the Offsets</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// argument</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ConstraintElimination_8cpp.html#adece4dea0830b97f6864d58df9d56273">decomposeGEP</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Ty,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                      <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// Compute the scale of this gather/scatter instruction</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">int</span> computeScale(<span class="keywordtype">unsigned</span> GEPElemSize, <span class="keywordtype">unsigned</span> MemoryElemSize);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// If the value is a constant, or derived from constants via additions</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// and multilications, return its numeric value</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  std::optional&lt;int64_t&gt; getIfConst(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// If Inst is an add instruction, check whether one summand is a</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// constant. If so, scale this constant and return it together with</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// the other summand.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  std::pair&lt;Value *, int64_t&gt; getVarAndConst(<a class="code" href="classllvm_1_1Value.html">Value</a> *Inst, <span class="keywordtype">int</span> TypeScale);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *lowerGather(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// Create a gather from a base + vector of offsets</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateMaskedGatherOffset(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                           <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;Root,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                           <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// Create a gather from a vector of pointers</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateMaskedGatherBase(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                         <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                         int64_t Increment = 0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// Create an incrementing gather from a vector of pointers</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateMaskedGatherBaseWB(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                           <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                           int64_t Increment = 0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *lowerScatter(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// Create a scatter to a base + vector of offsets</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateMaskedScatterOffset(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                            <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// Create a scatter to a vector of pointers</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateMaskedScatterBase(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                          <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                          int64_t Increment = 0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// Create an incrementing scatter from a vector of pointers</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateMaskedScatterBaseWB(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                            <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                            int64_t Increment = 0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// QI gathers and scatters can increment their offsets on their own if</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// the increment is a constant value (digit)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateIncrementingGatScat(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                            <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// QI gathers/scatters can increment their offsets on their own if the</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// increment is a constant value (digit) - this creates a writeback QI</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// gather/scatter</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *tryCreateIncrementingWBGatScat(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                              <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <span class="keywordtype">unsigned</span> TypeScale,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                              <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// Optimise the base and offsets of the given address</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordtype">bool</span> optimiseAddress(<a class="code" href="classllvm_1_1Value.html">Value</a> *Address, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// Try to fold consecutive geps together into one</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *foldGEP(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <span class="keywordtype">unsigned</span> &amp;Scale,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                 <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Check whether these offsets could be moved out of the loop they&#39;re in</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">bool</span> optimiseOffsets(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// Pushes the given add out of the loop</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">void</span> pushOutAdd(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *&amp;Phi, <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsSecondOperand, <span class="keywordtype">unsigned</span> StartIndex);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Pushes the given mul or shl out of the loop</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">void</span> pushOutMulShl(<span class="keywordtype">unsigned</span> Opc, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *&amp;Phi, <a class="code" href="classllvm_1_1Value.html">Value</a> *IncrementPerRound,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                     <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsSecondOperand, <span class="keywordtype">unsigned</span> LoopIncrement,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                     <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;};</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">MVEGatherScatterLowering::ID</a> = 0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="MVEGatherScatterLowering_8cpp.html#a406e579af71539f6cd194b1962139d36">  164</a></span>&#160;<a class="code" href="MVEGatherScatterLowering_8cpp.html#a406e579af71539f6cd194b1962139d36">INITIALIZE_PASS</a>(MVEGatherScatterLowering, <a class="code" href="MVEGatherScatterLowering_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="stringliteral">&quot;MVE gather/scattering lowering pass&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<a class="code" href="classllvm_1_1Pass.html">Pass</a> *<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#af0100e524cbcbdbfe92127865e21b049">createMVEGatherScatterLoweringPass</a>() {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> MVEGatherScatterLowering();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordtype">bool</span> MVEGatherScatterLowering::isLegalTypeAndAlignment(<span class="keywordtype">unsigned</span> NumElements,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                       <span class="keywordtype">unsigned</span> ElemSize,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                       <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (((NumElements == 4 &amp;&amp;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        (ElemSize == 32 || ElemSize == 16 || ElemSize == 8)) ||</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;       (NumElements == 8 &amp;&amp; (ElemSize == 16 || ElemSize == 8)) ||</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;       (NumElements == 16 &amp;&amp; ElemSize == 8)) &amp;&amp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      Alignment &gt;= ElemSize / 8)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: instruction does not have &quot;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;valid alignment or vector type \n&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="MVEGatherScatterLowering_8cpp.html#a7381b9def2e711b7f83115e43247768d">  185</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MVEGatherScatterLowering_8cpp.html#a7381b9def2e711b7f83115e43247768d">checkOffsetSize</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <span class="keywordtype">unsigned</span> TargetElemCount) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// Offsets that are not of type &lt;N x i32&gt; are sign extended by the</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// getelementptr instruction, and MVE gathers/scatters treat the offset as</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// unsigned. Thus, if the element size is smaller than 32, we can only allow</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// positive offsets - i.e., the offsets are not allowed to be variables we</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// can&#39;t look into.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// Additionally, &lt;N x i32&gt; offsets have to either originate from a zext of a</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// vector with element types smaller or equal the type of the gather we&#39;re</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// looking at, or consist of constants that we can check are small enough</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// to fit into the gather type.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// Thus we check that 0 &lt; value &lt; 2^TargetElemSize.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">unsigned</span> TargetElemSize = 128 / TargetElemCount;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">unsigned</span> OffsetElemSize = cast&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType())</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                -&gt;getElementType()</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                -&gt;getScalarSizeInBits();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">if</span> (OffsetElemSize != TargetElemSize || OffsetElemSize != 32) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ConstOff = dyn_cast&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (!ConstOff)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    int64_t TargetElemMaxSize = (1ULL &lt;&lt; TargetElemSize);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">auto</span> CheckValueSize = [TargetElemMaxSize](<a class="code" href="classllvm_1_1Value.html">Value</a> *OffsetElem) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *OConst = dyn_cast&lt;ConstantInt&gt;(OffsetElem);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> (!OConst)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordtype">int</span> SExtValue = OConst-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> (SExtValue &gt;= TargetElemMaxSize || SExtValue &lt; 0)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    };</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (isa&lt;FixedVectorType&gt;(ConstOff-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; TargetElemCount; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">if</span> (!CheckValueSize(ConstOff-&gt;<a class="code" href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">getAggregateElement</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)))</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">if</span> (!CheckValueSize(ConstOff))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *MVEGatherScatterLowering::decomposePtr(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                              <span class="keywordtype">int</span> &amp;Scale, <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Ty,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                              <a class="code" href="classllvm_1_1Type.html">Type</a> *MemoryTy,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                              <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>)) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="ConstraintElimination_8cpp.html#adece4dea0830b97f6864d58df9d56273">decomposeGEP</a>(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Ty, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>)) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      Scale =</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          computeScale(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getSourceElementType()-&gt;getPrimitiveSizeInBits(),</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                       MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">return</span> Scale == -1 ? nullptr : V;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// If we couldn&#39;t use the GEP (or it doesn&#39;t exist), attempt to use a</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// BasePtr of 0 with Ptr as the Offsets, so long as there are only 4</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// elements.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *PtrTy = cast&lt;FixedVectorType&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (PtrTy-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() != 4 || MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() == 32)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a> = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32Ty(), 0);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntToPtr(Zero, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePtrToInt(</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32Ty(), 4));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  Scale = 0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ConstraintElimination_8cpp.html#adece4dea0830b97f6864d58df9d56273">MVEGatherScatterLowering::decomposeGEP</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                              <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Ty,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                              <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                              <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: no getelementpointer &quot;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;found\n&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: getelementpointer found.&quot;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; Looking at intrinsic for base + vector of offsets\n&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *GEPPtr = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (GEPPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>() ||</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      !isa&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType()))</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getNumOperands() != 2) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: getelementptr with too many&quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; operands. Expanding.\n&quot;</span>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">unsigned</span> OffsetsElemCount =</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      cast&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType())-&gt;getNumElements();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Paranoid check whether the number of parallel lanes is the same</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() == OffsetsElemCount);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classllvm_1_1ZExtInst.html">ZExtInst</a> *ZextOffs = dyn_cast&lt;ZExtInst&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (ZextOffs)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = ZextOffs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *OffsetType = cast&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// If the offsets are already being zext-ed to &lt;N x i32&gt;, that relieves us of</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// having to make sure that they won&#39;t overflow.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">if</span> (!ZextOffs || cast&lt;FixedVectorType&gt;(ZextOffs-&gt;<a class="code" href="classllvm_1_1CastInst.html#a7cf02ab81e7b0774ebf78e13f89dabfc">getDestTy</a>())</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                           -&gt;getElementType()</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                           -&gt;getScalarSizeInBits() != 32)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MVEGatherScatterLowering_8cpp.html#a7381b9def2e711b7f83115e43247768d">checkOffsetSize</a>(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, OffsetsElemCount))</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// The offset sizes have been checked; if any truncating or zext-ing is</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// required to fix them, do that now</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span> (Ty != <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType()) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> ((Ty-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() &lt;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         OffsetType-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>())) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Ty);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <a class="code" href="classllvm_1_1VectorType.html#a7fdb2317662e3e901e47544a40190f12">VectorType::getInteger</a>(Ty));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// If none of the checks failed, return the gep&#39;s base pointer</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: found correct offsets\n&quot;</span>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">return</span> GEPPtr;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordtype">void</span> MVEGatherScatterLowering::lookThroughBitcast(<a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// Look through bitcast instruction if #elements is the same</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BitCast = dyn_cast&lt;BitCastInst&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>)) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">auto</span> *BCTy = cast&lt;FixedVectorType&gt;(BitCast-&gt;getType());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">auto</span> *BCSrcTy = cast&lt;FixedVectorType&gt;(BitCast-&gt;getOperand(0)-&gt;getType());</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (BCTy-&gt;getNumElements() == BCSrcTy-&gt;getNumElements()) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: looking through &quot;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;bitcast\n&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = BitCast-&gt;getOperand(0);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">int</span> MVEGatherScatterLowering::computeScale(<span class="keywordtype">unsigned</span> GEPElemSize,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                           <span class="keywordtype">unsigned</span> MemoryElemSize) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// This can be a 32bit load/store scaled by 4, a 16bit load/store scaled by 2,</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// or a 8bit, 16bit or 32bit load/store scaled by 1</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span> (GEPElemSize == 32 &amp;&amp; MemoryElemSize == 32)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (GEPElemSize == 16 &amp;&amp; MemoryElemSize == 16)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (GEPElemSize == 8)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: incorrect scale. Can&#39;t &quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;create intrinsic\n&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;std::optional&lt;int64_t&gt; MVEGatherScatterLowering::getIfConst(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getSplatValue())</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getUniqueInteger().getSExtValue()};</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;Instruction&gt;(V))</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{};</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Or ||</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a> ||</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Shl) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    std::optional&lt;int64_t&gt; Op0 = getIfConst(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    std::optional&lt;int64_t&gt; Op1 = getIfConst(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1));</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (!Op0 || !Op1)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{};</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{*Op0 + *Op1};</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a>)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{*Op0 * *Op1};</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Shl)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{*Op0 &lt;&lt; *Op1};</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Or)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{*Op0 | *Op1};</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">return</span> std::optional&lt;int64_t&gt;{};</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">// Return true if I is an Or instruction that is equivalent to an add, due to</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">// the operands having no common bits set.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="MVEGatherScatterLowering_8cpp.html#a2f53ee33a9c995883a402de4129a6cfe">  367</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MVEGatherScatterLowering_8cpp.html#a2f53ee33a9c995883a402de4129a6cfe">isAddLikeOr</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() == Instruction::Or &amp;&amp;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;         <a class="code" href="namespacellvm.html#aa0f28bd61d319f9fd170e9ffee1ec7ba">haveNoCommonBitsSet</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;std::pair&lt;Value *, int64_t&gt;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;MVEGatherScatterLowering::getVarAndConst(<a class="code" href="classllvm_1_1Value.html">Value</a> *Inst, <span class="keywordtype">int</span> TypeScale) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  std::pair&lt;Value *, int64_t&gt; ReturnFalse =</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      std::pair&lt;Value *, int64_t&gt;(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// At this point, the instruction we&#39;re looking at must be an add or an</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// add-like-or.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a> = dyn_cast&lt;Instruction&gt;(Inst);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (Add == <span class="keyword">nullptr</span> ||</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      (<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>-&gt;getOpcode() != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> &amp;&amp; !<a class="code" href="MVEGatherScatterLowering_8cpp.html#a2f53ee33a9c995883a402de4129a6cfe">isAddLikeOr</a>(Add, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)))</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> ReturnFalse;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Summand;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  std::optional&lt;int64_t&gt; <a class="code" href="namespacellvm_1_1codeview.html#acf5c2920c8a10eeb1d8c5d3a9c2adfb6a79ceee9f8e3c1f0cc74223e05d2448bf">Const</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// Find out which operand the value that is increased is</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">if</span> ((Const = getIfConst(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>-&gt;getOperand(0))))</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    Summand = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Const = getIfConst(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>-&gt;getOperand(1))))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    Summand = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span> ReturnFalse;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// Check that the constant is small enough for an incrementing gather</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  int64_t Immediate = *<a class="code" href="namespacellvm_1_1codeview.html#acf5c2920c8a10eeb1d8c5d3a9c2adfb6a79ceee9f8e3c1f0cc74223e05d2448bf">Const</a> &lt;&lt; TypeScale;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span> (Immediate &gt; 512 || Immediate &lt; -512 || Immediate % 4 != 0)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">return</span> ReturnFalse;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordflow">return</span> std::pair&lt;Value *, int64_t&gt;(Summand, Immediate);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::lowerGather(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: checking transform preconditions\n&quot;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// @llvm.masked.gather.*(Ptrs, alignment, Mask, Src0)</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// Attempt to turn the masked gather in I into a MVE intrinsic</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// Potentially optimising the addressing modes as we do so.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType());</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = cast&lt;ConstantInt&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(1))-&gt;getAlignValue();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(2);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *PassThru = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(3);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span> (!isLegalTypeAndAlignment(Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(), Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>(),</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                               Alignment))</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  lookThroughBitcast(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()-&gt;isVectorTy() &amp;&amp; <span class="stringliteral">&quot;Unexpected pointer type&quot;</span>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getContext());</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Root = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = tryCreateIncrementingGatScat(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = tryCreateMaskedGatherOffset(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, Root, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = tryCreateMaskedGatherBase(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;UndefValue&gt;(PassThru) &amp;&amp; !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(PassThru, <a class="code" href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">m_Zero</a>())) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: found non-trivial passthru - &quot;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;creating select\n&quot;</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = <a class="code" href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">SelectInst::Create</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, PassThru);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  Root-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  Root-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span> (Root != <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// If this was an extending gather, we need to get rid of the sext/zext</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// sext/zext as well as of the gather itself</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: successfully built masked gather\n&quot;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateMaskedGatherBase(</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, int64_t Increment) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType());</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: loading from vector of pointers\n&quot;</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() != 4 || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() != 32)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// Can&#39;t build an intrinsic for this</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(2);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::arm_mve_vldr_gather_base,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                   {Ty, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()},</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                   {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment)});</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        Intrinsic::arm_mve_vldr_gather_base_predicated,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        {Ty, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()},</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>});</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateMaskedGatherBaseWB(</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, int64_t Increment) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: loading from vector of pointers with &quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;writeback\n&quot;</span>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() != 4 || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() != 32)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Can&#39;t build an intrinsic for this</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(2);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::arm_mve_vldr_gather_base_wb,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                   {Ty, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()},</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                   {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment)});</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        Intrinsic::arm_mve_vldr_gather_base_wb_predicated,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        {Ty, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()},</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>});</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateMaskedGatherOffset(</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;Root, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *MemoryTy = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ResultTy = MemoryTy;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="NVPTXISelLowering_8cpp.html#ae1a90b5d85643644483b2ca70da4d13fac837bff23a12c3735d463020f37979de">Unsigned</a> = 1;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// The size of the gather was already checked in isLegalTypeAndAlignment;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// if it was not a full vector width an appropriate extend should follow.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">auto</span> *Extend = Root;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">bool</span> TruncResult = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() &lt; 128) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasOneUse()) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">// If the gather has a single extend of the correct type, use an extending</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">// gather and replace the ext. In which case the correct root to replace</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">// is not the CallInst itself, but the instruction which extends it.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a>* <a class="code" href="classllvm_1_1User.html">User</a> = cast&lt;Instruction&gt;(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users().begin());</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">if</span> (isa&lt;SExtInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>) &amp;&amp;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: Incorporating extend: &quot;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                          &lt;&lt; *<a class="code" href="classllvm_1_1User.html">User</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        Extend = <a class="code" href="classllvm_1_1User.html">User</a>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        ResultTy = <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="NVPTXISelLowering_8cpp.html#ae1a90b5d85643644483b2ca70da4d13fac837bff23a12c3735d463020f37979de">Unsigned</a> = 0;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;ZExtInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>) &amp;&amp;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                 <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: Incorporating extend: &quot;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                          &lt;&lt; *ResultTy &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        Extend = <a class="code" href="classllvm_1_1User.html">User</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        ResultTy = <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// If an extend hasn&#39;t been found and the type is an integer, create an</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// extending gather and truncate back to the original type.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (ResultTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() &lt; 128 &amp;&amp;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        ResultTy-&gt;<a class="code" href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">isIntOrIntVectorTy</a>()) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      ResultTy = ResultTy-&gt;<a class="code" href="classllvm_1_1Type.html#a83725435ece9bc12c40ceb34dbd1727c">getWithNewBitWidth</a>(</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          128 / cast&lt;FixedVectorType&gt;(ResultTy)-&gt;getNumElements());</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      TruncResult = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: Small input type, truncing to: &quot;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        &lt;&lt; *ResultTy &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// The final size of the gather must be a full vector width</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (ResultTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() != 128) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers: Extend needed but not provided &quot;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                           <span class="stringliteral">&quot;from the correct type. Expanding\n&quot;</span>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">int</span> Scale;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> = decomposePtr(</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Scale, cast&lt;FixedVectorType&gt;(ResultTy), MemoryTy, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (!BasePtr)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  Root = Extend;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(2);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        Intrinsic::arm_mve_vldr_gather_offset_predicated,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        {ResultTy, <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()},</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>()),</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Scale), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(<a class="code" href="NVPTXISelLowering_8cpp.html#ae1a90b5d85643644483b2ca70da4d13fac837bff23a12c3735d463020f37979de">Unsigned</a>), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>});</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        Intrinsic::arm_mve_vldr_gather_offset,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        {ResultTy, <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType()},</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>()),</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;         <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Scale), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(<a class="code" href="NVPTXISelLowering_8cpp.html#ae1a90b5d85643644483b2ca70da4d13fac837bff23a12c3735d463020f37979de">Unsigned</a>)});</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">if</span> (TruncResult) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = <a class="code" href="classllvm_1_1CastInst.html#a643fe5a9e7042f032dae78109c2b1e72">TruncInst::Create</a>(Instruction::Trunc, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, MemoryTy);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::lowerScatter(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: checking transform preconditions\n&quot;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">// @llvm.masked.scatter.*(data, ptrs, alignment, mask)</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">// Attempt to turn the masked scatter in I into a MVE intrinsic</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// Potentially optimising the addressing modes as we do so.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(1);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = cast&lt;ConstantInt&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(2))-&gt;getAlignValue();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">if</span> (!isLegalTypeAndAlignment(Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(), Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>(),</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                               Alignment))</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  lookThroughBitcast(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()-&gt;isVectorTy() &amp;&amp; <span class="stringliteral">&quot;Unexpected pointer type&quot;</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getContext());</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = tryCreateIncrementingGatScat(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = tryCreateMaskedScatterOffset(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = tryCreateMaskedScatterBase(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: successfully built masked scatter\n&quot;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateMaskedScatterBase(</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, int64_t Increment) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="comment">// Only QR variants allow truncating</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span> (!(Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() == 4 &amp;&amp; Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() == 32)) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// Can&#39;t build an intrinsic for this</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(3);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">//  int_arm_mve_vstr_scatter_base(_predicated) addr, offset, data(, mask)</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: storing to a vector of pointers\n&quot;</span>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::arm_mve_vstr_scatter_base,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                   {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()},</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                   {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment), Input});</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        Intrinsic::arm_mve_vstr_scatter_base_predicated,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()},</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment), Input, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>});</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateMaskedScatterBaseWB(</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, int64_t Increment) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keyword">auto</span> *Ty = cast&lt;FixedVectorType&gt;(Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: storing to a vector of pointers &quot;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;with writeback\n&quot;</span>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() != 4 || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() != 32)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// Can&#39;t build an intrinsic for this</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(3);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::arm_mve_vstr_scatter_base_wb,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                   {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()},</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                   {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment), Input});</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        Intrinsic::arm_mve_vstr_scatter_base_wb_predicated,</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()},</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Increment), Input, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>});</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateMaskedScatterOffset(</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(3);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *InputTy = Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *MemoryTy = InputTy;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: getelementpointer found. Storing&quot;</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; to base + vector of offsets\n&quot;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">// If the input has been truncated, try to integrate that trunc into the</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// scatter instruction (we don&#39;t care about alignment here)</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *Trunc = dyn_cast&lt;TruncInst&gt;(Input)) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PreTrunc = Trunc-&gt;getOperand(0);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *PreTruncTy = PreTrunc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (PreTruncTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      Input = PreTrunc;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      InputTy = PreTruncTy;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordtype">bool</span> ExtendInput = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">if</span> (InputTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() &lt; 128 &amp;&amp;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      InputTy-&gt;<a class="code" href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">isIntOrIntVectorTy</a>()) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// If we can&#39;t find a trunc to incorporate into the instruction, create an</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// implicit one with a zext, so that we can still create a scatter. We know</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// that the input type is 4x/8x/16x and of type i8/i16/i32, so any type</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// smaller than 128 bits will divide evenly into a 128bit vector.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    InputTy = InputTy-&gt;<a class="code" href="classllvm_1_1Type.html#a83725435ece9bc12c40ceb34dbd1727c">getWithNewBitWidth</a>(</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        128 / cast&lt;FixedVectorType&gt;(InputTy)-&gt;getNumElements());</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    ExtendInput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: Small input type, will extend:\n&quot;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                      &lt;&lt; *Input &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (InputTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() != 128) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked scatters: cannot create scatters for &quot;</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                         <span class="stringliteral">&quot;non-standard input types. Expanding.\n&quot;</span>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">int</span> Scale;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> = decomposePtr(</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Scale, cast&lt;FixedVectorType&gt;(InputTy), MemoryTy, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">if</span> (!BasePtr)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">if</span> (ExtendInput)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    Input = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(Input, InputTy);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        Intrinsic::arm_mve_vstr_scatter_offset_predicated,</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType(), Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;         <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()},</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Input,</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;         <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>()),</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Scale), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>});</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        Intrinsic::arm_mve_vstr_scatter_offset,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>-&gt;getType(), Input-&gt;getType()},</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Input,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(MemoryTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>()),</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Scale)});</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateIncrementingGatScat(</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *Ty;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIntrinsicID() == Intrinsic::masked_gather)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType());</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    Ty = cast&lt;FixedVectorType&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getArgOperand(0)-&gt;getType());</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// Incrementing gathers only exist for v4i32</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>() != 4 || Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() != 32)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// Incrementing gathers are not beneficial outside of a loop</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;getLoopFor(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent());</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (L == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="comment">// Decompose the GEP into Base and Offsets</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> = <a class="code" href="ConstraintElimination_8cpp.html#adece4dea0830b97f6864d58df9d56273">decomposeGEP</a>(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Ty, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">if</span> (!BasePtr)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: trying to build incrementing &quot;</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                       <span class="stringliteral">&quot;wb gather/scatter\n&quot;</span>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// The gep was in charge of making sure the offsets are scaled correctly</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// - calculate that factor so it can be applied by hand</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordtype">int</span> TypeScale =</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      computeScale(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeSizeInBits(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(0)-&gt;getType()),</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                   <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeSizeInBits(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getType()) /</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                       cast&lt;FixedVectorType&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getType())-&gt;getNumElements());</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (TypeScale == -1)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasOneUse()) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// Only in this case do we want to build a wb gather, because the wb will</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// change the phi which does affect other users of the gep (which will still</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// be using the phi in the old way)</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = tryCreateIncrementingWBGatScat(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BasePtr, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>,</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                                    TypeScale, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>))</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: trying to build incrementing &quot;</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                       <span class="stringliteral">&quot;non-wb gather/scatter\n&quot;</span>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  std::pair&lt;Value *, int64_t&gt; <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a> = getVarAndConst(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, TypeScale);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>.first == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsetsIncoming = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>.first;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  int64_t Immediate = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>.second;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// Make sure the offsets are scaled correctly</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ScaledOffsets = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      Instruction::Shl, OffsetsIncoming,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(TypeScale)),</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="stringliteral">&quot;ScaledIndex&quot;</span>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="comment">// Add the base to the offsets</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  OffsetsIncoming = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>, ScaledOffsets,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          Ty-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(),</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePtrToInt(</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;              BasePtr,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;              cast&lt;VectorType&gt;(ScaledOffsets-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getElementType())),</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="stringliteral">&quot;StartIndex&quot;</span>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIntrinsicID() == Intrinsic::masked_gather)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">return</span> tryCreateMaskedGatherBase(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, OffsetsIncoming, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Immediate);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">return</span> tryCreateMaskedScatterBase(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, OffsetsIncoming, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Immediate);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MVEGatherScatterLowering::tryCreateIncrementingWBGatScat(</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <span class="keywordtype">unsigned</span> TypeScale,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">// Check whether this gather&#39;s offset is incremented by a constant - if so,</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">// and the load is of the right type, we can merge this into a QI gather</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;getLoopFor(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent());</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// Offsets that are worth merging into this instruction will be incremented</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">// by a constant, thus we&#39;re looking for an add of a phi and a constant</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = dyn_cast&lt;PHINode&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordflow">if</span> (Phi == <span class="keyword">nullptr</span> || Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>() != 2 ||</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      Phi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() || Phi-&gt;<a class="code" href="classllvm_1_1Value.html#aba0055050d741f60b6e0523507a2c79f">getNumUses</a>() != 2)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// No phi means no IV to write back to; if there is a phi, we expect it</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// to have exactly two incoming values; the only phis we are interested in</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// will be loop IV&#39;s and have exactly two uses, one in their increment and</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// one in the gather&#39;s gep</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordtype">unsigned</span> IncrementIndex =</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0) == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>() ? 0 : 1;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// Look through the phi to the phi increment</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(IncrementIndex);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  std::pair&lt;Value *, int64_t&gt; <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a> = getVarAndConst(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, TypeScale);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>.first == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsetsIncoming = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>.first;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  int64_t Immediate = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Add</a>.second;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="keywordflow">if</span> (OffsetsIncoming != Phi)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// Then the increment we are looking at is not an increment of the</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// induction variable, and we don&#39;t want to do a writeback</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(1 - IncrementIndex)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>());</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordtype">unsigned</span> NumElems =</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      cast&lt;FixedVectorType&gt;(OffsetsIncoming-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// Make sure the offsets are scaled correctly</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ScaledOffsets = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      Instruction::Shl, Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(1 - IncrementIndex),</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(NumElems, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(TypeScale)),</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="stringliteral">&quot;ScaledIndex&quot;</span>, &amp;Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(1 - IncrementIndex)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>());</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">// Add the base to the offsets</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  OffsetsIncoming = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>, ScaledOffsets,</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          NumElems,</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePtrToInt(</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;              BasePtr,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;              cast&lt;VectorType&gt;(ScaledOffsets-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getElementType())),</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="stringliteral">&quot;StartIndex&quot;</span>, &amp;Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(1 - IncrementIndex)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>());</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// The gather is pre-incrementing</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  OffsetsIncoming = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      Instruction::Sub, OffsetsIncoming,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(NumElems, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(Immediate)),</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="stringliteral">&quot;PreIncrementStartIndex&quot;</span>,</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      &amp;Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(1 - IncrementIndex)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>());</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(1 - IncrementIndex, OffsetsIncoming);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *EndResult;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewInduction;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIntrinsicID() == Intrinsic::masked_gather) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// Build the incrementing gather</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = tryCreateMaskedGatherBaseWB(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Phi, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Immediate);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// One value to be handed to whoever uses the gather, one is the loop</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// increment</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    EndResult = <a class="code" href="classllvm_1_1ExtractValueInst.html#a1cccf41f6be0351ccceed2c6447ff04a">ExtractValueInst::Create</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, 0, <span class="stringliteral">&quot;Gather&quot;</span>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    NewInduction = <a class="code" href="classllvm_1_1ExtractValueInst.html#a1cccf41f6be0351ccceed2c6447ff04a">ExtractValueInst::Create</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, 1, <span class="stringliteral">&quot;GatherIncrement&quot;</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(EndResult);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(NewInduction);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">// Build the incrementing scatter</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    EndResult = NewInduction =</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        tryCreateMaskedScatterBaseWB(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Phi, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Immediate);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *AddInst = cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  AddInst-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewInduction);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  AddInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(IncrementIndex, NewInduction);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">return</span> EndResult;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordtype">void</span> MVEGatherScatterLowering::pushOutAdd(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *&amp;Phi,</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                          <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsSecondOperand,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                          <span class="keywordtype">unsigned</span> StartIndex) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: optimising add instruction\n&quot;</span>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertionPoint =</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        &amp;cast&lt;Instruction&gt;(Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(StartIndex)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>());</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">// Initialize the phi with a vector that contains a sum of the constants</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewIndex = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>, Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(StartIndex), OffsSecondOperand,</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="stringliteral">&quot;PushedOutAdd&quot;</span>, InsertionPoint);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordtype">unsigned</span> IncrementIndex = StartIndex == 0 ? 1 : 0;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// Order such that start index comes first (this reduces mov&#39;s)</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewIndex, Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(StartIndex));</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(IncrementIndex),</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                   Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(IncrementIndex));</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a6f01dbe965b38186b1a78378689d4105">removeIncomingValue</a>(IncrementIndex);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a6f01dbe965b38186b1a78378689d4105">removeIncomingValue</a>(StartIndex);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="keywordtype">void</span> MVEGatherScatterLowering::pushOutMulShl(<span class="keywordtype">unsigned</span> Opcode, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *&amp;Phi,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                             <a class="code" href="classllvm_1_1Value.html">Value</a> *IncrementPerRound,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                             <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsSecondOperand,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                             <span class="keywordtype">unsigned</span> LoopIncrement,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                             <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: optimising mul instruction\n&quot;</span>);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// Create a new scalar add outside of the loop and transform it to a splat</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">// by which loop variable can be incremented</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertionPoint = &amp;cast&lt;Instruction&gt;(</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(LoopIncrement == 1 ? 0 : 1)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>());</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">// Create a new index</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StartIndex =</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Opcode,</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                             Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(LoopIncrement == 1 ? 0 : 1),</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                             OffsSecondOperand, <span class="stringliteral">&quot;PushedOutMul&quot;</span>, InsertionPoint);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Product =</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>((<a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>)Opcode, IncrementPerRound,</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                             OffsSecondOperand, <span class="stringliteral">&quot;Product&quot;</span>, InsertionPoint);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">// Increment NewIndex by Product instead of the multiplication</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewIncrement = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>, Phi, Product, <span class="stringliteral">&quot;IncrementPushedOutMul&quot;</span>,</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      cast&lt;Instruction&gt;(Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(LoopIncrement)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">back</a>())</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          .getPrevNode());</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(StartIndex,</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                   Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(LoopIncrement == 1 ? 0 : 1));</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewIncrement, Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(LoopIncrement));</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a6f01dbe965b38186b1a78378689d4105">removeIncomingValue</a>((<span class="keywordtype">unsigned</span>)0);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a6f01dbe965b38186b1a78378689d4105">removeIncomingValue</a>((<span class="keywordtype">unsigned</span>)0);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;}</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">// Check whether all usages of this instruction are as offsets of</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">// gathers/scatters or simple arithmetics only used by gathers/scatters</span></div>
<div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="MVEGatherScatterLowering_8cpp.html#a620b2298522bcf8811498aeb4a8201d0">  941</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MVEGatherScatterLowering_8cpp.html#a620b2298522bcf8811498aeb4a8201d0">hasAllGatScatUsers</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasNUses(0)) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordtype">bool</span> Gatscat = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users()) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;Instruction&gt;(U))</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">if</span> (isa&lt;GetElementPtrInst&gt;(U) ||</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <a class="code" href="namespacellvm.html#a63b3dad6a535ba499a5f9cc8b41fedd9">isGatherScatter</a>(dyn_cast&lt;IntrinsicInst&gt;(U))) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">return</span> Gatscat;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordtype">unsigned</span> OpCode = cast&lt;Instruction&gt;(U)-&gt;getOpcode();</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">if</span> ((OpCode == <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> || OpCode == <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a> ||</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;           OpCode == Instruction::Shl ||</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;           <a class="code" href="MVEGatherScatterLowering_8cpp.html#a2f53ee33a9c995883a402de4129a6cfe">isAddLikeOr</a>(cast&lt;Instruction&gt;(U), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) &amp;&amp;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;          <a class="code" href="MVEGatherScatterLowering_8cpp.html#a620b2298522bcf8811498aeb4a8201d0">hasAllGatScatUsers</a>(cast&lt;Instruction&gt;(U), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">return</span> Gatscat;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordtype">bool</span> MVEGatherScatterLowering::optimiseOffsets(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                               <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: trying to optimize: &quot;</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    &lt;&lt; *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">// Optimise the addresses of gathers/scatters by moving invariant</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="comment">// calculations out of the loop</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>))</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Offs = cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">if</span> (Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> &amp;&amp; !<a class="code" href="MVEGatherScatterLowering_8cpp.html#a2f53ee33a9c995883a402de4129a6cfe">isAddLikeOr</a>(Offs, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) &amp;&amp;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a> &amp;&amp;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != Instruction::Shl)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">if</span> (L == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> (!Offs-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>()) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MVEGatherScatterLowering_8cpp.html#a620b2298522bcf8811498aeb4a8201d0">hasAllGatScatUsers</a>(Offs, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="comment">// Find out which, if any, operand of the instruction</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="comment">// is a phi node</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordtype">int</span> OffsSecondOp;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0))) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    Phi = cast&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    OffsSecondOp = 1;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    Phi = cast&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    OffsSecondOp = 0;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">if</span> (isa&lt;Instruction&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)) &amp;&amp;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(cast&lt;Instruction&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0))))</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      Changed |= optimiseOffsets(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, LI);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">if</span> (isa&lt;Instruction&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1)) &amp;&amp;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(cast&lt;Instruction&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))))</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      Changed |= optimiseOffsets(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, LI);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">if</span> (!Changed)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0))) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      Phi = cast&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      OffsSecondOp = 1;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      Phi = cast&lt;PHINode&gt;(Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      OffsSecondOp = 0;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">// A phi node we want to perform this function on should be from the</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="comment">// loop header.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">if</span> (Phi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// We&#39;re looking for a simple add recurrence.</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *IncInstruction;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Start, *IncrementPerRound;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a5be4877e6cc76e0fe6f8a005c69aa7c2">matchSimpleRecurrence</a>(Phi, IncInstruction, Start, IncrementPerRound) ||</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      IncInstruction-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordtype">int</span> IncrementingBlock = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0) == IncInstruction ? 0 : 1;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// Get the value that is added to/multiplied with the phi</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsSecondOperand = Offs-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(OffsSecondOp);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">if</span> (IncrementPerRound-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != OffsSecondOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() ||</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      !L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(OffsSecondOperand))</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// Something has gone wrong, abort</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="comment">// Only proceed if the increment per round is a constant or an instruction</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">// which does not originate from within the loop</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;Constant&gt;(IncrementPerRound) &amp;&amp;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      !(isa&lt;Instruction&gt;(IncrementPerRound) &amp;&amp;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        !L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(cast&lt;Instruction&gt;(IncrementPerRound))))</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="comment">// If the phi is not used by anything else, we can just adapt it when</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="comment">// replacing the instruction; if it is, we&#39;ll have to duplicate it</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPhi;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">if</span> (Phi-&gt;<a class="code" href="classllvm_1_1Value.html#aba0055050d741f60b6e0523507a2c79f">getNumUses</a>() == 2) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">// No other users -&gt; reuse existing phi (One user is the instruction</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">// we&#39;re looking at, the other is the phi increment)</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">if</span> (IncInstruction-&gt;<a class="code" href="classllvm_1_1Value.html#aba0055050d741f60b6e0523507a2c79f">getNumUses</a>() != 1) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="comment">// If the incrementing instruction does have more users than</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="comment">// our phi, we need to copy it</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      IncInstruction = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          <a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>(IncInstruction-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>()), Phi,</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          IncrementPerRound, <span class="stringliteral">&quot;LoopIncrement&quot;</span>, IncInstruction);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(IncrementingBlock, IncInstruction);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    NewPhi = Phi;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">// There are other users -&gt; create a new phi</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    NewPhi = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(Phi-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 2, <span class="stringliteral">&quot;NewPhi&quot;</span>, Phi);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">// Copy the incoming values of the old phi</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(IncrementingBlock == 1 ? 0 : 1),</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(IncrementingBlock == 1 ? 0 : 1));</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    IncInstruction = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">Instruction::BinaryOps</a>(IncInstruction-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>()), NewPhi,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        IncrementPerRound, <span class="stringliteral">&quot;LoopIncrement&quot;</span>, IncInstruction);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(IncInstruction,</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(IncrementingBlock));</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    IncrementingBlock = 1;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getContext());</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Phi);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keywordflow">switch</span> (Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>()) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>:</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">case</span> Instruction::Or:</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    pushOutAdd(NewPhi, OffsSecondOperand, IncrementingBlock == 1 ? 0 : 1);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a>:</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    pushOutMulShl(Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>(), NewPhi, IncrementPerRound,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                  OffsSecondOperand, IncrementingBlock, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: simplified loop variable &quot;</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;add/mul\n&quot;</span>);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// The instruction has now been &quot;absorbed&quot; into the phi value</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  Offs-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewPhi);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordflow">if</span> (Offs-&gt;<a class="code" href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">hasNUses</a>(0))</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    Offs-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// Clean up the old increment in case it&#39;s unused because we built a new</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// one</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">if</span> (IncInstruction-&gt;<a class="code" href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">hasNUses</a>(0))</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    IncInstruction-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;}</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"><a class="line" href="MVEGatherScatterLowering_8cpp.html#af9606a4c24bb36e0b5cd02a9e4029c77"> 1107</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="MVEGatherScatterLowering_8cpp.html#af9606a4c24bb36e0b5cd02a9e4029c77">CheckAndCreateOffsetAdd</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <span class="keywordtype">unsigned</span> ScaleX, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>,</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                                      <span class="keywordtype">unsigned</span> ScaleY, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="comment">// Splat the non-vector value to a vector of the given type - if the value is</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="comment">// a constant (and its value isn&#39;t too big), we can even use this opportunity</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="comment">// to scale it to the size of the vector elements</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keyword">auto</span> FixSummands = [&amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>](<a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *&amp;VT, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;NonVectorVal) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Const;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordflow">if</span> ((Const = dyn_cast&lt;ConstantInt&gt;(NonVectorVal)) &amp;&amp;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        VT-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>() != NonVectorVal-&gt;getType()) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordtype">unsigned</span> TargetElemSize = VT-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>();</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = Const-&gt;getZExtValue();</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &lt; (<span class="keywordtype">unsigned</span>)(1 &lt;&lt; (TargetElemSize - 1))) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        NonVectorVal = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            VT-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getIntN(TargetElemSize, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>));</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    NonVectorVal =</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(VT-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(), NonVectorVal);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  };</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *XElType = dyn_cast&lt;FixedVectorType&gt;(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType());</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="classllvm_1_1FixedVectorType.html">FixedVectorType</a> *YElType = dyn_cast&lt;FixedVectorType&gt;(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>-&gt;getType());</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="comment">// If one of X, Y is not a vector, we have to splat it in order</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">// to add the two of them.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">if</span> (XElType &amp;&amp; !YElType) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    FixSummands(XElType, <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    YElType = cast&lt;FixedVectorType&gt;(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>-&gt;getType());</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (YElType &amp;&amp; !XElType) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    FixSummands(YElType, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    XElType = cast&lt;FixedVectorType&gt;(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType());</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(XElType &amp;&amp; YElType &amp;&amp; <span class="stringliteral">&quot;Unknown vector types&quot;</span>);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="comment">// Check that the summands are of compatible types</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">if</span> (XElType != YElType) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;masked gathers/scatters: incompatible gep offsets\n&quot;</span>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">if</span> (XElType-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() != 32) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">// Check that by adding the vectors we do not accidentally</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// create an overflow</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ConstX = dyn_cast&lt;Constant&gt;(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ConstY = dyn_cast&lt;Constant&gt;(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (!ConstX || !ConstY)</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordtype">unsigned</span> TargetElemSize = 128 / XElType-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>();</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; XElType-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ConstXEl =</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          dyn_cast&lt;ConstantInt&gt;(ConstX-&gt;<a class="code" href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">getAggregateElement</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ConstYEl =</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          dyn_cast&lt;ConstantInt&gt;(ConstY-&gt;<a class="code" href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">getAggregateElement</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">if</span> (!ConstXEl || !ConstYEl ||</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          ConstXEl-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>() * ScaleX +</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                  ConstYEl-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>() * ScaleY &gt;=</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;              (<span class="keywordtype">unsigned</span>)(1 &lt;&lt; (TargetElemSize - 1)))</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *XScale = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      XElType-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(),</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getIntN(XElType-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>(), ScaleX));</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *YScale = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      YElType-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>(),</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getIntN(YElType-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>(), ScaleY));</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Add = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMul(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, XScale),</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                 <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMul(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>, YScale));</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MVEGatherScatterLowering_8cpp.html#a7381b9def2e711b7f83115e43247768d">checkOffsetSize</a>(Add, XElType-&gt;<a class="code" href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">getNumElements</a>()))</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">return</span> Add;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;}</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *MVEGatherScatterLowering::foldGEP(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                         <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, <span class="keywordtype">unsigned</span> &amp;Scale,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                         <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *GEPPtr = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  Scale = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeAllocSize(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getSourceElementType());</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">// We only merge geps with constant offsets, because only for those</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">// we can make sure that we do not cause an overflow</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getNumIndices() != 1 || !isa&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>))</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *BaseGEP = dyn_cast&lt;GetElementPtrInst&gt;(GEPPtr)) {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">// Merge the two geps into one</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *BaseBasePtr = foldGEP(BaseGEP, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Scale, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">if</span> (!BaseBasePtr)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = <a class="code" href="MVEGatherScatterLowering_8cpp.html#af9606a4c24bb36e0b5cd02a9e4029c77">CheckAndCreateOffsetAdd</a>(</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Scale, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(1),</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeAllocSize(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getSourceElementType()), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    Scale = 1; <span class="comment">// Scale is always an i8 at this point.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">return</span> BaseBasePtr;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">return</span> GEPPtr;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keywordtype">bool</span> MVEGatherScatterLowering::optimiseAddress(<a class="code" href="classllvm_1_1Value.html">Value</a> *Address, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                               <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(Address);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasOneUse() &amp;&amp; isa&lt;GetElementPtrInst&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getPointerOperand())) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getContext());</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordtype">unsigned</span> Scale;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = foldGEP(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>, Scale, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">// We only want to merge the geps if there is a real chance that they can be</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">// used by an MVE gather; thus the offset has to have the correct size</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">// (always i32 if it is not of vector type) and the base has to be a</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">// pointer.</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> &amp;&amp; Base &amp;&amp; Base != <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Scale == 1 &amp;&amp; <span class="stringliteral">&quot;Expected to fold GEP to a scale of 1&quot;</span>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *BaseTy = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy();</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *VecTy = dyn_cast&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>-&gt;getType()))</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        BaseTy = <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(BaseTy, VecTy);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *NewAddress = <a class="code" href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">GetElementPtrInst::Create</a>(</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8Ty(), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(Base, BaseTy), <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>,</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          <span class="stringliteral">&quot;gep.merged&quot;</span>, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Folded GEP: &quot;</span> &lt;&lt; *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n      new :  &quot;</span> &lt;&lt; *NewAddress &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;replaceAllUsesWith(</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(NewAddress, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getType()));</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = NewAddress;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  Changed |= optimiseOffsets(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(1), <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getParent(), LI);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;}</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">MVEGatherScatterLowering::runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MVEGatherScatterLowering_8cpp.html#a4d8ea5e78a2380c08cfe10c085dcc068">EnableMaskedGatherScatters</a>)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keyword">auto</span> &amp;TPC = getAnalysis&lt;TargetPassConfig&gt;();</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> = TPC.getTM&lt;<a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a>&gt;();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> = &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>.getSubtarget&lt;<a class="code" href="classllvm_1_1ARMSubtarget.html">ARMSubtarget</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>-&gt;hasMVEIntegerOps())</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  LI = &amp;getAnalysis&lt;LoopInfoWrapperPass&gt;().getLoopInfo();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;IntrinsicInst *, 4&gt;</a> Gathers;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;IntrinsicInst *, 4&gt;</a> Scatters;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    Changed |= <a class="code" href="namespacellvm.html#a42108fe3c2695cb429e6fe312908fa0d">SimplifyInstructionsInBlock</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">if</span> (II &amp;&amp; II-&gt;<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::masked_gather &amp;&amp;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;          isa&lt;FixedVectorType&gt;(II-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        Gathers.push_back(II);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        Changed |= optimiseAddress(II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), LI);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (II &amp;&amp; II-&gt;<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::masked_scatter &amp;&amp;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                 isa&lt;FixedVectorType&gt;(II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())) {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        Scatters.push_back(II);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        Changed |= optimiseAddress(II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), LI);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Gathers.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Gathers[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *L = lowerGather(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (L == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="comment">// Get rid of any now dead instructions</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="namespacellvm.html#a42108fe3c2695cb429e6fe312908fa0d">SimplifyInstructionsInBlock</a>(L-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Scatters.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Scatters[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = lowerScatter(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// Get rid of any now dead instructions</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <a class="code" href="namespacellvm.html#a42108fe3c2695cb429e6fe312908fa0d">SimplifyInstructionsInBlock</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getParent());</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aARMSubtarget_8h_html"><div class="ttname"><a href="ARMSubtarget_8h.html">ARMSubtarget.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a6cb6a58fb0ded82b4c7755fc4c27c86d"><div class="ttname"><a href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">llvm::Loop::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const Value *V) const</div><div class="ttdoc">Return true if the specified value is loop invariant.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00060">LoopInfo.cpp:60</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0f28bd61d319f9fd170e9ffee1ec7ba"><div class="ttname"><a href="namespacellvm.html#aa0f28bd61d319f9fd170e9ffee1ec7ba">llvm::haveNoCommonBitsSet</a></div><div class="ttdeci">bool haveNoCommonBitsSet(const Value *LHS, const Value *RHS, const DataLayout &amp;DL, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr, bool UseInstrInfo=true)</div><div class="ttdoc">Return true if LHS and RHS have no common bits set.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00231">ValueTracking.cpp:231</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ARMSubtarget_html"><div class="ttname"><a href="classllvm_1_1ARMSubtarget.html">llvm::ARMSubtarget</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMSubtarget_8h_source.html#l00047">ARMSubtarget.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a04337b572d34ea413c35dbac5d75530b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const</div><div class="ttdoc">Return true if the specified loop is contained within in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html_a7ff64b3625b6f9020556ed05a5f72af4"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">llvm::IntrinsicInst::getIntrinsicID</a></div><div class="ttdeci">Intrinsic::ID getIntrinsicID() const</div><div class="ttdoc">Return the intrinsic ID of this intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00054">IntrinsicInst.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5be4877e6cc76e0fe6f8a005c69aa7c2"><div class="ttname"><a href="namespacellvm.html#a5be4877e6cc76e0fe6f8a005c69aa7c2">llvm::matchSimpleRecurrence</a></div><div class="ttdeci">bool matchSimpleRecurrence(const PHINode *P, BinaryOperator *&amp;BO, Value *&amp;Start, Value *&amp;Step)</div><div class="ttdoc">Attempt to match a simple first order recurrence cycle of the form: iv = phi Ty [Start,...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l06674">ValueTracking.cpp:6674</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a643fe5a9e7042f032dae78109c2b1e72"><div class="ttname"><a href="classllvm_1_1CastInst.html#a643fe5a9e7042f032dae78109c2b1e72">llvm::CastInst::Create</a></div><div class="ttdeci">static CastInst * Create(Instruction::CastOps, Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Provides a way to construct any of the CastInst subclasses using an opcode instead of the subclass's ...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03354">Instructions.cpp:3354</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a6f01dbe965b38186b1a78378689d4105"><div class="ttname"><a href="classllvm_1_1PHINode.html#a6f01dbe965b38186b1a78378689d4105">llvm::PHINode::removeIncomingValue</a></div><div class="ttdeci">Value * removeIncomingValue(unsigned Idx, bool DeletePHIIfEmpty=true)</div><div class="ttdoc">Remove an incoming value.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00124">Instructions.cpp:124</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1LoopInfoWrapperPass.html">llvm::LoopInfoWrapperPass</a></div><div class="ttdoc">The legacy pass manager's analysis pass to compute loop information.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01293">LoopInfo.h:1293</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html_a12e23c3d619db313388fe11dc76eb23f"><div class="ttname"><a href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">llvm::VectorType::getElementType</a></div><div class="ttdeci">Type * getElementType() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00422">DerivedTypes.h:422</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html">llvm::FixedVectorType</a></div><div class="ttdoc">Class to represent fixed width SIMD vectors.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00525">DerivedTypes.h:525</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a88cdefb709309eddc6e5daca0be6a7b4"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">llvm::PHINode::setIncomingValue</a></div><div class="ttdeci">void setIncomingValue(unsigned i, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02797">Instructions.h:2797</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a7cf02ab81e7b0774ebf78e13f89dabfc"><div class="ttname"><a href="classllvm_1_1CastInst.html#a7cf02ab81e7b0774ebf78e13f89dabfc">llvm::CastInst::getDestTy</a></div><div class="ttdeci">Type * getDestTy() const</div><div class="ttdoc">Return the destination type, as a convenience.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00682">InstrTypes.h:682</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a91efa71de05b0c2d00730a0279f58658"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">llvm::BitmaskEnumDetail::Mask</a></div><div class="ttdeci">constexpr std::underlying_type_t&lt; E &gt; Mask()</div><div class="ttdoc">Get a bitmask with 1s in all places up to the high-order bit of E's largest value.</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00080">BitmaskEnum.h:80</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html_a1893caf878859959ba6a3d5442ef1439"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html#a1893caf878859959ba6a3d5442ef1439">llvm::FixedVectorType::getNumElements</a></div><div class="ttdeci">unsigned getNumElements() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00568">DerivedTypes.h:568</a></div></div>
<div class="ttc" id="aTargetLowering_8h_html"><div class="ttname"><a href="TargetLowering_8h.html">TargetLowering.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="anamespacellvm_html_a42108fe3c2695cb429e6fe312908fa0d"><div class="ttname"><a href="namespacellvm.html#a42108fe3c2695cb429e6fe312908fa0d">llvm::SimplifyInstructionsInBlock</a></div><div class="ttdeci">bool SimplifyInstructionsInBlock(BasicBlock *BB, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Scan the specified basic block and try to simplify any instructions in it and recursively delete dead...</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00725">Local.cpp:725</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_aa55fb74dd22008fdcc26a63f44576022"><div class="ttname"><a href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">llvm::SelectInst::Create</a></div><div class="ttdeci">static SelectInst * Create(Value *C, Value *S1, Value *S2, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr, Instruction *MDFrom=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01777">Instructions.h:1777</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a16c39eb6e60b42a40c399d8d65347bb6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const</div><div class="ttdoc">Return incoming value number x.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02794">Instructions.h:2794</a></div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_a406e579af71539f6cd194b1962139d36"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#a406e579af71539f6cd194b1962139d36">INITIALIZE_PASS</a></div><div class="ttdeci">INITIALIZE_PASS(MVEGatherScatterLowering, DEBUG_TYPE, &quot;MVE gather/scattering lowering pass&quot;, false, false) Pass *llvm</div><div class="ttdef"><b>Definition:</b> <a href="MVEGatherScatterLowering_8cpp_source.html#l00164">MVEGatherScatterLowering.cpp:164</a></div></div>
<div class="ttc" id="anamespacellvm_html_a63b3dad6a535ba499a5f9cc8b41fedd9"><div class="ttname"><a href="namespacellvm.html#a63b3dad6a535ba499a5f9cc8b41fedd9">llvm::isGatherScatter</a></div><div class="ttdeci">bool isGatherScatter(IntrinsicInst *IntInst)</div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInstrInfo_8h_source.html#l00953">ARMBaseInstrInfo.h:953</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aIntrinsics_8h_html"><div class="ttname"><a href="Intrinsics_8h.html">Intrinsics.h</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html_a7fdb2317662e3e901e47544a40190f12"><div class="ttname"><a href="classllvm_1_1VectorType.html#a7fdb2317662e3e901e47544a40190f12">llvm::VectorType::getInteger</a></div><div class="ttdeci">static VectorType * getInteger(VectorType *VTy)</div><div class="ttdoc">This static method gets a VectorType with the same number of elements as the input type,...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00440">DerivedTypes.h:440</a></div></div>
<div class="ttc" id="aOcamlGCPrinter_8cpp_html_afcf2f797ed287a723263583c9b1c1bce"><div class="ttname"><a href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; OcamlGCMetadataPrinter &gt; Y(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible collector&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a1bc022868b23918efa44df511f4d5b61"><div class="ttname"><a href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const</div><div class="ttdoc">True if this is an instance of VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00258">Type.h:258</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdeci">@ Store</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00033">SparcInstrInfo.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a31bf07f3f61525486633bc1d0bbaf029"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00391">InstrTypes.h:391</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a9f382207d841377156d4c7868b66b9a5"><div class="ttname"><a href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits() const LLVM_READONLY</div><div class="ttdoc">If this is a vector type, return the getPrimitiveSizeInBits value for the element type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00188">Type.cpp:188</a></div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="MVEGatherScatterLowering_8cpp_source.html#l00048">MVEGatherScatterLowering.cpp:48</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d"><div class="ttname"><a href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">llvm::codeview::EncodedFramePtrReg::BasePtr</a></div><div class="ttdeci">@ BasePtr</div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_a620b2298522bcf8811498aeb4a8201d0"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#a620b2298522bcf8811498aeb4a8201d0">hasAllGatScatUsers</a></div><div class="ttdeci">static bool hasAllGatScatUsers(Instruction *I, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="MVEGatherScatterLowering_8cpp_source.html#l00941">MVEGatherScatterLowering.cpp:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html_af9a870d5df50fe0133a410b7c9114c80"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">llvm::FixedVectorType::get</a></div><div class="ttdeci">static FixedVectorType * get(Type *ElementType, unsigned NumElts)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00686">Type.cpp:686</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aef51af4b490af6b3bf2dfbc8737a8f9f"><div class="ttname"><a href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const</div><div class="ttdoc">Return the number of incoming edges.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02790">Instructions.h:2790</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="aErlangGCPrinter_8cpp_html_a74b474c0616ab55c1d9487f11fd31d26"><div class="ttname"><a href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; ErlangGCPrinter &gt; X(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aebdb2700a77d10ae6f0ce115e23d9f77"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">llvm::PatternMatch::m_One</a></div><div class="ttdeci">cst_pred_ty&lt; is_one &gt; m_One()</div><div class="ttdoc">Match an integer 1 or a vector with all elements equal to 1.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00517">PatternMatch.h:517</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetPassConfig_html"><div class="ttname"><a href="classllvm_1_1TargetPassConfig.html">llvm::TargetPassConfig</a></div><div class="ttdoc">Target-Independent Code Generator Pass Configuration Options.</div><div class="ttdef"><b>Definition:</b> <a href="TargetPassConfig_8h_source.html#l00084">TargetPassConfig.h:84</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ae77be336e228cf9aa00709a8606dfb98"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">llvm::PatternMatch::m_Zero</a></div><div class="ttdeci">is_zero m_Zero()</div><div class="ttdoc">Match any null constant or a vector with all elements equal to 0.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00537">PatternMatch.h:537</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1ExtractValueInst_html_a1cccf41f6be0351ccceed2c6447ff04a"><div class="ttname"><a href="classllvm_1_1ExtractValueInst.html#a1cccf41f6be0351ccceed2c6447ff04a">llvm::ExtractValueInst::Create</a></div><div class="ttdeci">static ExtractValueInst * Create(Value *Agg, ArrayRef&lt; unsigned &gt; Idxs, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02481">Instructions.h:2481</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a83725435ece9bc12c40ceb34dbd1727c"><div class="ttname"><a href="classllvm_1_1Type.html#a83725435ece9bc12c40ceb34dbd1727c">llvm::Type::getWithNewBitWidth</a></div><div class="ttdeci">Type * getWithNewBitWidth(unsigned NewBitWidth) const</div><div class="ttdoc">Given an integer or vector type, change the lane bitwidth to NewBitwidth, whilst keeping the old numb...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00722">DerivedTypes.h:722</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__MB_html_ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2"><div class="ttname"><a href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">llvm::ARM_MB::ST</a></div><div class="ttdeci">@ ST</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00073">ARMBaseInfo.h:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1TruncInst_html"><div class="ttname"><a href="classllvm_1_1TruncInst.html">llvm::TruncInst</a></div><div class="ttdoc">This class represents a truncation of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04813">Instructions.h:4813</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a7a7c8e0e4f836c13c015b62e18f386bd"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">llvm::LoopInfoBase::getLoopFor</a></div><div class="ttdeci">LoopT * getLoopFor(const BlockT *BB) const</div><div class="ttdoc">Return the inner most loop that BB lives in.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00992">LoopInfo.h:992</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="anamespacellvm_html_af0100e524cbcbdbfe92127865e21b049"><div class="ttname"><a href="namespacellvm.html#af0100e524cbcbdbfe92127865e21b049">llvm::createMVEGatherScatterLoweringPass</a></div><div class="ttdeci">Pass * createMVEGatherScatterLoweringPass()</div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_af9606a4c24bb36e0b5cd02a9e4029c77"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#af9606a4c24bb36e0b5cd02a9e4029c77">CheckAndCreateOffsetAdd</a></div><div class="ttdeci">static Value * CheckAndCreateOffsetAdd(Value *X, unsigned ScaleX, Value *Y, unsigned ScaleY, IRBuilder&lt;&gt; &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="MVEGatherScatterLowering_8cpp_source.html#l01107">MVEGatherScatterLowering.cpp:1107</a></div></div>
<div class="ttc" id="aTargetPassConfig_8h_html"><div class="ttname"><a href="TargetPassConfig_8h.html">TargetPassConfig.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1230fd674d2609b96527fe65eaf40b1b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const</div><div class="ttdoc">If there is a single latch block for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00232">LoopInfoImpl.h:232</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1TargetMachine_html"><div class="ttname"><a href="classllvm_1_1TargetMachine.html">llvm::TargetMachine</a></div><div class="ttdoc">Primary interface to the complete machine description for the target machine.</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00078">TargetMachine.h:78</a></div></div>
<div class="ttc" id="aARMBaseInstrInfo_8h_html"><div class="ttname"><a href="ARMBaseInstrInfo_8h.html">ARMBaseInstrInfo.h</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aARM_8h_html"><div class="ttname"><a href="ARM_8h.html">ARM.h</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1ZExtInst_html"><div class="ttname"><a href="classllvm_1_1ZExtInst.html">llvm::ZExtInst</a></div><div class="ttdoc">This class represents zero extension of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04852">Instructions.h:4852</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a74c47d18ecd4ca3399785e6ae07134dc"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">llvm::GetElementPtrInst::Create</a></div><div class="ttdeci">static GetElementPtrInst * Create(Type *PointeeType, Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00966">Instructions.h:966</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00187">InstrTypes.h:187</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_ae0f503db91504a3f3440ab81260e4134"><div class="ttname"><a href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Mul</a></div><div class="ttdeci">BinaryOperator * Mul</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00070">X86PartialReduction.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdoc">This function should be called by the pass, iff they do not:</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00265">Pass.cpp:265</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">llvm::logicalview::LVAttributeKind::Zero</a></div><div class="ttdeci">@ Zero</div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_acd530d0571f320d47d37e7ae51cf70ff"><div class="ttname"><a href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">llvm::Constant::getAggregateElement</a></div><div class="ttdeci">Constant * getAggregateElement(unsigned Elt) const</div><div class="ttdoc">For aggregates (struct/array/vector) return the constant that corresponds to the specified element if...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00418">Constants.cpp:418</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_aba0055050d741f60b6e0523507a2c79f"><div class="ttname"><a href="classllvm_1_1Value.html#aba0055050d741f60b6e0523507a2c79f">llvm::Value::getNumUses</a></div><div class="ttdeci">unsigned getNumUses() const</div><div class="ttdoc">This method computes the number of uses of this Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00254">Value.cpp:254</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad01d5e31fa9109df49f57e1e5e5a45f7"><div class="ttname"><a href="namespacellvm.html#ad01d5e31fa9109df49f57e1e5e5a45f7">llvm::initializeMVEGatherScatterLoweringPass</a></div><div class="ttdeci">void initializeMVEGatherScatterLoweringPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aTargetSubtargetInfo_8h_html"><div class="ttname"><a href="TargetSubtargetInfo_8h.html">TargetSubtargetInfo.h</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aNVPTXISelLowering_8cpp_html_ae1a90b5d85643644483b2ca70da4d13fac837bff23a12c3735d463020f37979de"><div class="ttname"><a href="NVPTXISelLowering_8cpp.html#ae1a90b5d85643644483b2ca70da4d13fac837bff23a12c3735d463020f37979de">Unsigned</a></div><div class="ttdeci">@ Unsigned</div><div class="ttdef"><b>Definition:</b> <a href="NVPTXISelLowering_8cpp_source.html#l04885">NVPTXISelLowering.cpp:4885</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa8f4be0661aa64f5b1f20b15e93bb403"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">llvm::ConstantInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit integer value after it has been sign extended as appropriate for the ...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00147">Constants.h:147</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition:</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00085">EntryExitInstrumenter.cpp:85</a></div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_a2f53ee33a9c995883a402de4129a6cfe"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#a2f53ee33a9c995883a402de4129a6cfe">isAddLikeOr</a></div><div class="ttdeci">static bool isAddLikeOr(Instruction *I, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="MVEGatherScatterLowering_8cpp_source.html#l00367">MVEGatherScatterLowering.cpp:367</a></div></div>
<div class="ttc" id="aConstant_8h_html"><div class="ttname"><a href="Constant_8h.html">Constant.h</a></div></div>
<div class="ttc" id="aConstraintElimination_8cpp_html_adece4dea0830b97f6864d58df9d56273"><div class="ttname"><a href="ConstraintElimination_8cpp.html#adece4dea0830b97f6864d58df9d56273">decomposeGEP</a></div><div class="ttdeci">static Decomposition decomposeGEP(GetElementPtrInst &amp;GEP, SmallVectorImpl&lt; PreconditionTy &gt; &amp;Preconditions, bool IsSigned, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="ConstraintElimination_8cpp_source.html#l00244">ConstraintElimination.cpp:244</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a34ee40bb2f4f5ece47ef19e5f1f57e3c"><div class="ttname"><a href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">llvm::Type::isIntOrIntVectorTy</a></div><div class="ttdeci">bool isIntOrIntVectorTy() const</div><div class="ttdoc">Return true if this is an integer type or a vector of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00228">Type.h:228</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a7c779ce2ba55bc94f52014fc25f3d520"><div class="ttname"><a href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">llvm::Value::hasNUses</a></div><div class="ttdeci">bool hasNUses(unsigned N) const</div><div class="ttdoc">Return true if this Value has exactly N uses.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00148">Value.cpp:148</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_a7381b9def2e711b7f83115e43247768d"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#a7381b9def2e711b7f83115e43247768d">checkOffsetSize</a></div><div class="ttdeci">static bool checkOffsetSize(Value *Offsets, unsigned TargetElemCount)</div><div class="ttdef"><b>Definition:</b> <a href="MVEGatherScatterLowering_8cpp_source.html#l00185">MVEGatherScatterLowering.cpp:185</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">llvm::MCID::Add</a></div><div class="ttdeci">@ Add</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00186">MCInstrDesc.h:186</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_acf5c2920c8a10eeb1d8c5d3a9c2adfb6a79ceee9f8e3c1f0cc74223e05d2448bf"><div class="ttname"><a href="namespacellvm_1_1codeview.html#acf5c2920c8a10eeb1d8c5d3a9c2adfb6a79ceee9f8e3c1f0cc74223e05d2448bf">llvm::codeview::ModifierOptions::Const</a></div><div class="ttdeci">@ Const</div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ac26154a24f393f523c87cc5f8239f36c"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac26154a24f393f523c87cc5f8239f36c">llvm::Instruction::BinaryOps</a></div><div class="ttdeci">BinaryOps</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00809">Instruction.h:809</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8f6f9b4a94dc0907499c03a9e1b6918b"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8f6f9b4a94dc0907499c03a9e1b6918b">llvm::BasicBlock::back</a></div><div class="ttdeci">const Instruction &amp; back() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00328">BasicBlock.h:328</a></div></div>
<div class="ttc" id="aclassllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdoc">Pass interface - Implemented by all 'passes'.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00091">Pass.h:91</a></div></div>
<div class="ttc" id="aMVEGatherScatterLowering_8cpp_html_a4d8ea5e78a2380c08cfe10c085dcc068"><div class="ttname"><a href="MVEGatherScatterLowering_8cpp.html#a4d8ea5e78a2380c08cfe10c085dcc068">EnableMaskedGatherScatters</a></div><div class="ttdeci">cl::opt&lt; bool &gt; EnableMaskedGatherScatters(&quot;enable-arm-maskedgatscat&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Enable the generation of masked gathers and scatters&quot;))</div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a8ce0c4746a1ec805e66409d20ae93922"><div class="ttname"><a href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const</div><div class="ttdoc">Return incoming basic block number i.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02814">Instructions.h:2814</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1Pass_html_a6590d0486104165ca40c7df0707f7b9e"><div class="ttname"><a href="classllvm_1_1Pass.html#a6590d0486104165ca40c7df0707f7b9e">llvm::Pass::getAnalysisUsage</a></div><div class="ttdeci">virtual void getAnalysisUsage(AnalysisUsage &amp;) const</div><div class="ttdoc">getAnalysisUsage - This function should be overriden by passes that need analysis information to do t...</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00098">Pass.cpp:98</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ab76052bb166c65901edb603a3e1f03ab"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a></div><div class="ttdeci">const char LLVMTargetMachineRef TM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00047">PassBuilderBindings.cpp:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SI_1_1KernelInputOffsets_html_a58b4eae4b0a45d478c7c0f3959b04612"><div class="ttname"><a href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">llvm::SI::KernelInputOffsets::Offsets</a></div><div class="ttdeci">Offsets</div><div class="ttdoc">Offsets in bytes from the start of the input buffer.</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8h_source.html#l01335">SIInstrInfo.h:1335</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a02ce9966395063ac501ecbc1623deda4"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Construct a binary instruction, given the opcode and the two operands.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02950">Instructions.cpp:2950</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a833daf718a49c5cd637d8c9ddeaebe07"><div class="ttname"><a href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">TypeSize getPrimitiveSizeInBits() const LLVM_READONLY</div><div class="ttdoc">Return the basic size of this type if it is a primitive type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00163">Type.cpp:163</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:11:26 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
