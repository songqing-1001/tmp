<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Utils/SimplifyIndVar.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_f75c00afeb315f44d76556a7c675e6e8.html">Utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SimplifyIndVar.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SimplifyIndVar_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- SimplifyIndVar.cpp - Induction variable simplification ------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements induction variable simplification. It does</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// not define any actual pass or policy, but provides a single function to</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// simplify a loop&#39;s induction variables based on ScalarEvolution.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SimplifyIndVar_8h.html">llvm/Transforms/Utils/SimplifyIndVar.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpander_8h.html">llvm/Transforms/Utils/ScalarEvolutionExpander.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   31</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;indvars&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumElimIdentity, <span class="stringliteral">&quot;Number of IV identities eliminated&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumElimOperand,  <span class="stringliteral">&quot;Number of IV operands folded into a use&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumFoldedUser, <span class="stringliteral">&quot;Number of IV users folded into a constant&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumElimRem     , <span class="stringliteral">&quot;Number of IV remainder operations eliminated&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    NumSimplifiedSDiv,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="stringliteral">&quot;Number of IV signed division operations converted to unsigned division&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    NumSimplifiedSRem,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="stringliteral">&quot;Number of IV signed remainder operations converted to unsigned remainder&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumElimCmp     , <span class="stringliteral">&quot;Number of IV comparisons eliminated&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">  /// This is a utility for simplifying induction variables</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">  /// based on ScalarEvolution. It is the primary instrument of the</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">  /// IndvarSimplify pass, but it may also be directly invoked to cleanup after</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">  /// other loop passes that preserve SCEV.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span>  <span class="keyword">class </span>SimplifyIndvar {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a>             *L;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>         *LI;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a>  *SE;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>    *DT;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">TTI</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a>     &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    SimplifyIndvar(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *<a class="code" href="classllvm_1_1Loop.html">Loop</a>, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                   <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                   <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                   <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        : L(<a class="code" href="classllvm_1_1Loop.html">Loop</a>), LI(LI), SE(SE), DT(DT), <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>), <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          DeadInsts(<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI &amp;&amp; <span class="stringliteral">&quot;IV simplification requires LoopInfo&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">bool</span> hasChanged()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Changed; }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">    /// Iteratively perform simplification on a worklist of users of the</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">    /// specified induction variable. This is the top-level driver that applies</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">    /// all simplifications to users of an IV.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> simplifyUsers(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurrIV, <a class="code" href="classllvm_1_1IVVisitor.html">IVVisitor</a> *V = <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *foldIVUser(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">bool</span> eliminateIdentitySCEV(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">bool</span> replaceIVUserWithLoopInvariant(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">bool</span> replaceFloatIVWithIntegerIV(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">bool</span> eliminateOverflowIntrinsic(<a class="code" href="classllvm_1_1WithOverflowInst.html">WithOverflowInst</a> *WO);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">bool</span> eliminateSaturatingIntrinsic(<a class="code" href="classllvm_1_1SaturatingInst.html">SaturatingInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">bool</span> eliminateTrunc(<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *TI);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">bool</span> eliminateIVUser(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">bool</span> makeIVComparisonInvariant(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">void</span> eliminateIVComparison(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">void</span> simplifyIVRemainder(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                             <span class="keywordtype">bool</span> IsSigned);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">void</span> replaceRemWithNumerator(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">void</span> replaceRemWithNumeratorOrZero(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">void</span> replaceSRemWithURem(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">bool</span> eliminateSDiv(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *SDiv);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">bool</span> strengthenBinaryOp(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">bool</span> strengthenOverflowingOperation(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *OBO,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">bool</span> strengthenRightShift(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  };</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">/// Find a point in code which dominates all given instructions. We can safely</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/// assume that, whatever fact we can prove at the found point, this fact is</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/// also true for each of the given instructions.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#a59f39a75e16788ecd95f9fb94c918c4d">  106</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SimplifyIndVar_8cpp.html#a59f39a75e16788ecd95f9fb94c918c4d">findCommonDominator</a>(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Instruction *&gt;</a> Instructions,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                        <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CommonDom = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a96d5dc120196819fbfbc257cba09b2aa">Insn</a> : <a class="code" href="MSA_8txt.html#ab49a28dbe60da0a607449e5308b1ec3f">Instructions</a>)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    CommonDom =</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        CommonDom ? DT.<a class="code" href="classllvm_1_1DominatorTree.html#a2ec50ab2c78eff965caf3da71cd08be4">findNearestCommonDominator</a>(CommonDom, <a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a96d5dc120196819fbfbc257cba09b2aa">Insn</a>) : <a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a96d5dc120196819fbfbc257cba09b2aa">Insn</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CommonDom &amp;&amp; <span class="stringliteral">&quot;Common dominator not found?&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">return</span> CommonDom;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/// Fold an IV operand into its use.  This removes increments of an</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/// aligned IV when used by a instruction that ignores the low bits.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/// IVOperand is guaranteed SCEVable, but UseInst may not be.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/// Return the operand of IVOperand for this induction variable if IVOperand can</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/// be folded (in case more folding opportunities have been exposed).</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/// Otherwise return null.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Value.html">Value</a> *SimplifyIndvar::foldIVUser(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IVSrc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OperIdx = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *FoldedExpr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">bool</span> MustDropExactFlag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">switch</span> (UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>()) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// We&#39;re only interested in the case where we know something about</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// the numerator and have a constant denominator.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (IVOperand != UseInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(OperIdx) ||</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        !isa&lt;ConstantInt&gt;(UseInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1)))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Attempt to fold a binary operator with constant operand.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// e.g. ((I + 1) &gt;&gt; 2) =&gt; I &gt;&gt; 2</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;BinaryOperator&gt;(IVOperand)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        || !isa&lt;ConstantInt&gt;(IVOperand-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1)))</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    IVSrc = IVOperand-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// IVSrc must be the (SCEVable) IV, since the other operand is const.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE-&gt;isSCEVable(IVSrc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp; <span class="stringliteral">&quot;Expect SCEVable IV operand&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = cast&lt;ConstantInt&gt;(UseInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::LShr) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">// Get a constant for the divisor. See createSCEV.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = cast&lt;IntegerType&gt;(UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getBitWidth();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;getValue().uge(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>))</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(),</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                           <a class="code" href="classllvm_1_1APInt.html#aec662ee6ab1490a4cabebf2812e5b9ca">APInt::getOneBitSet</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>, <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;getZExtValue()));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = SE-&gt;getSCEV(IVSrc);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = SE-&gt;getSCEV(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    FoldedExpr = SE-&gt;getUDivExpr(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// We might have &#39;exact&#39; flag set at this point which will no longer be</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// correct after we make the replacement.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a689a03df5b4ae094d6a3a1bd13dac574">isExact</a>() &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> != SE-&gt;getMulExpr(FoldedExpr, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      MustDropExactFlag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// We have something that might fold it&#39;s operand. Compare SCEVs.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;isSCEVable(UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// Bypass the operand if SCEV can prove it has no effect.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">if</span> (SE-&gt;getSCEV(UseInst) != FoldedExpr)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Eliminated IV operand: &quot;</span> &lt;&lt; *IVOperand</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; *UseInst &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  UseInst-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(OperIdx, IVSrc);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE-&gt;getSCEV(UseInst) == FoldedExpr &amp;&amp; <span class="stringliteral">&quot;bad SCEV with folded oper&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (MustDropExactFlag)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ad4613def4002aa69721553e567ca4187">dropPoisonGeneratingFlags</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  ++NumElimOperand;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    DeadInsts.emplace_back(IVOperand);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">return</span> IVSrc;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordtype">bool</span> SimplifyIndvar::makeIVComparisonInvariant(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                               <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">auto</span> *Preheader = L-&gt;getLoopPreheader();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">if</span> (!Preheader)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">unsigned</span> IVOperIdx = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred = ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">if</span> (IVOperand != ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Swapped</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVOperand == ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) &amp;&amp; <span class="stringliteral">&quot;Can&#39;t find IVOperand&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    IVOperIdx = 1;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    Pred = <a class="code" href="classllvm_1_1CmpInst.html#a49a2d8f483ea08a3d6ea75f90c640d76">ICmpInst::getSwappedPredicate</a>(Pred);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// Get the SCEVs for the ICmp operands (in the specific context of the</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// current loop)</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ICmpLoop = LI-&gt;getLoopFor(ICmp-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = SE-&gt;getSCEVAtScope(ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(IVOperIdx), ICmpLoop);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> = SE-&gt;getSCEVAtScope(ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1 - IVOperIdx), ICmpLoop);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">auto</span> LIP = SE-&gt;getLoopInvariantPredicate(Pred, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, L, ICmp);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span> (!LIP)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> InvariantPredicate = LIP-&gt;Pred;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *InvariantLHS = LIP-&gt;LHS;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *InvariantRHS = LIP-&gt;RHS;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// Do not generate something ridiculous.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keyword">auto</span> *PHTerm = Preheader-&gt;getTerminator();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isHighCostExpansion({ InvariantLHS, InvariantRHS }, L,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                   2 * <a class="code" href="namespacellvm.html#a837209d51e75f7afcfdf457b20e59493">SCEVCheapExpansionBudget</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, PHTerm))</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keyword">auto</span> *NewLHS =</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(InvariantLHS, IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), PHTerm);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keyword">auto</span> *NewRHS =</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(InvariantRHS, IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), PHTerm);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Simplified comparison: &quot;</span> &lt;&lt; *ICmp &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">setPredicate</a>(InvariantPredicate);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  ICmp-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, NewLHS);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  ICmp-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, NewRHS);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/// SimplifyIVUsers helper for eliminating useless</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">/// comparisons against an induction variable.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> SimplifyIndvar::eliminateIVComparison(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                           <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">unsigned</span> IVOperIdx = 0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred = ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> OriginalPred = Pred;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">if</span> (IVOperand != ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Swapped</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVOperand == ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) &amp;&amp; <span class="stringliteral">&quot;Can&#39;t find IVOperand&quot;</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    IVOperIdx = 1;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    Pred = <a class="code" href="classllvm_1_1CmpInst.html#a49a2d8f483ea08a3d6ea75f90c640d76">ICmpInst::getSwappedPredicate</a>(Pred);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// Get the SCEVs for the ICmp operands (in the specific context of the</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// current loop)</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ICmpLoop = LI-&gt;getLoopFor(ICmp-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = SE-&gt;getSCEVAtScope(ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(IVOperIdx), ICmpLoop);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> = SE-&gt;getSCEVAtScope(ICmp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1 - IVOperIdx), ICmpLoop);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// If the condition is always true or always false in the given context,</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// replace it with a constant value.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : ICmp-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CtxI = <a class="code" href="SimplifyIndVar_8cpp.html#a59f39a75e16788ecd95f9fb94c918c4d">findCommonDominator</a>(<a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>, *DT);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Ev = SE-&gt;evaluatePredicateAt(Pred, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, CtxI)) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    SE-&gt;forgetValue(ICmp);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    ICmp-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code" href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">ConstantInt::getBool</a>(ICmp-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), *Ev));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    DeadInsts.emplace_back(ICmp);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Eliminated comparison: &quot;</span> &lt;&lt; *ICmp &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (makeIVComparisonInvariant(ICmp, IVOperand)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// fallthrough to end of function</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html#a3712279d70deeec90a93db09deb12d02">ICmpInst::isSigned</a>(OriginalPred) &amp;&amp;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;             SE-&gt;isKnownNonNegative(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) &amp;&amp; SE-&gt;isKnownNonNegative(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>)) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// If we were unable to make anything above, all we can is to canonicalize</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// the comparison hoping that it will open the doors for other</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// optimizations. If we find out that we compare two non-negative values,</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// we turn the instruction&#39;s predicate to its unsigned version. Note that</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// we cannot rely on Pred here unless we check if we have swapped it.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>() == OriginalPred &amp;&amp; <span class="stringliteral">&quot;Predicate changed?&quot;</span>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Turn to unsigned comparison: &quot;</span> &lt;&lt; *ICmp</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                      &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">setPredicate</a>(<a class="code" href="classllvm_1_1ICmpInst.html#af07a09f1cda33d984cc725dc9e856d40">ICmpInst::getUnsignedPredicate</a>(OriginalPred));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  ++NumElimCmp;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">bool</span> SimplifyIndvar::eliminateSDiv(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *SDiv) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// Get the SCEVs for the ICmp operands.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = SE-&gt;getSCEV(SDiv-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = SE-&gt;getSCEV(SDiv-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// Simplify unnecessary loops away.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;getLoopFor(SDiv-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = SE-&gt;getSCEVAtScope(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, L);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = SE-&gt;getSCEVAtScope(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>, L);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// Replace sdiv by udiv if both of the operands are non-negative</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (SE-&gt;isKnownNonNegative(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) &amp;&amp; SE-&gt;isKnownNonNegative(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>)) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">auto</span> *UDiv = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        BinaryOperator::UDiv, SDiv-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), SDiv-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1),</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        SDiv-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.udiv&quot;</span>, SDiv);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    UDiv-&gt;setIsExact(SDiv-&gt;<a class="code" href="classllvm_1_1Instruction.html#a689a03df5b4ae094d6a3a1bd13dac574">isExact</a>());</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    SDiv-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(UDiv);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Simplified sdiv: &quot;</span> &lt;&lt; *SDiv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    ++NumSimplifiedSDiv;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    DeadInsts.push_back(SDiv);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">// i %s n -&gt; i %u n if i &gt;= 0 and n &gt;= 0</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">void</span> SimplifyIndvar::replaceSRemWithURem(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">auto</span> *URem = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(BinaryOperator::URem, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                      Rem-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.urem&quot;</span>, Rem);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  Rem-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(URem);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Simplified srem: &quot;</span> &lt;&lt; *Rem &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  ++NumSimplifiedSRem;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  DeadInsts.emplace_back(Rem);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">// i % n  --&gt;  i  if i is in [0,n).</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">void</span> SimplifyIndvar::replaceRemWithNumerator(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  Rem-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Simplified rem: &quot;</span> &lt;&lt; *Rem &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  ++NumElimRem;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  DeadInsts.emplace_back(Rem);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">// (i+1) % n  --&gt;  (i+1)==n?0:(i+1)  if i is in [0,n).</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">void</span> SimplifyIndvar::replaceRemWithNumeratorOrZero(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="classT.html">T</a> = Rem-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp = <span class="keyword">new</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>(Rem, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a>, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *Sel =</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <a class="code" href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">SelectInst::Create</a>(ICmp, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classT.html">T</a>, 0), <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <span class="stringliteral">&quot;iv.rem&quot;</span>, Rem);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  Rem-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Sel);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Simplified rem: &quot;</span> &lt;&lt; *Rem &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  ++NumElimRem;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  DeadInsts.emplace_back(Rem);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/// SimplifyIVUsers helper for eliminating useless remainder operations</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">/// operating on an induction variable or replacing srem by urem.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> SimplifyIndvar::simplifyIVRemainder(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Rem,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                         <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                         <span class="keywordtype">bool</span> IsSigned) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">auto</span> *NValue = Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keyword">auto</span> *DValue = Rem-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// We&#39;re only interested in the case where we know something about</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// the numerator, unless it is a srem, because we want to replace srem by urem</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// in general.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">bool</span> UsedAsNumerator = IVOperand == NValue;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">if</span> (!UsedAsNumerator &amp;&amp; !IsSigned)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = SE-&gt;getSCEV(NValue);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// Simplify unnecessary loops away.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ICmpLoop = LI-&gt;getLoopFor(Rem-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = SE-&gt;getSCEVAtScope(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, ICmpLoop);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">bool</span> IsNumeratorNonNegative = !IsSigned || SE-&gt;isKnownNonNegative(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// Do not proceed if the Numerator may be negative</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span> (!IsNumeratorNonNegative)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = SE-&gt;getSCEV(DValue);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = SE-&gt;getSCEVAtScope(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>, ICmpLoop);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> (UsedAsNumerator) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">LT</a> = IsSigned ? <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP_SLT</a> : <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP_ULT</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (SE-&gt;isKnownPredicate(<a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">LT</a>, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>)) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      replaceRemWithNumerator(Rem);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="classT.html">T</a> = Rem-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *NLessOne = SE-&gt;getMinusSCEV(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, SE-&gt;getOne(<a class="code" href="classT.html">T</a>));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (SE-&gt;isKnownPredicate(<a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">LT</a>, NLessOne, <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>)) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      replaceRemWithNumeratorOrZero(Rem);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// Try to replace SRem with URem, if both N and D are known non-negative.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// Since we had already check N, we only need to check D now</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (!IsSigned || !SE-&gt;isKnownNonNegative(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>))</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  replaceSRemWithURem(Rem);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordtype">bool</span> SimplifyIndvar::eliminateOverflowIntrinsic(<a class="code" href="classllvm_1_1WithOverflowInst.html">WithOverflowInst</a> *WO) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = SE-&gt;getSCEV(WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#a8818b44063f9f3339d4ced72bd76b107">getLHS</a>());</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = SE-&gt;getSCEV(WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#a6822c506d77c8ba56e85bee5cd1ed01b">getRHS</a>());</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;willNotOverflow(WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#aa73e62aac1753cb7b3c3aaccef3df8b1">getBinaryOp</a>(), WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#a814f3097eebe0236748fcc2ab5ce59d5">isSigned</a>(), <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Proved no overflow, nuke the overflow check and, if possible, the overflow</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// intrinsic as well.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *NewResult = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#aa73e62aac1753cb7b3c3aaccef3df8b1">getBinaryOp</a>(), WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#a8818b44063f9f3339d4ced72bd76b107">getLHS</a>(), WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#a6822c506d77c8ba56e85bee5cd1ed01b">getRHS</a>(), <span class="stringliteral">&quot;&quot;</span>, WO);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">if</span> (WO-&gt;<a class="code" href="classllvm_1_1BinaryOpIntrinsic.html#a814f3097eebe0236748fcc2ab5ce59d5">isSigned</a>())</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    NewResult-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4166b451a572b1e5d3fea7250af53653">setHasNoSignedWrap</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    NewResult-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0c03b71c79206ec41270dc3788183e0d">setHasNoUnsignedWrap</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ExtractValueInst *, 4&gt;</a> ToDelete;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : WO-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *EVI = dyn_cast&lt;ExtractValueInst&gt;(U)) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">if</span> (EVI-&gt;getIndices()[0] == 1)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        EVI-&gt;replaceAllUsesWith(<a class="code" href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(WO-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()));</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EVI-&gt;getIndices()[0] == 0 &amp;&amp; <span class="stringliteral">&quot;Only two possibilities!&quot;</span>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        EVI-&gt;replaceAllUsesWith(NewResult);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      ToDelete.push_back(EVI);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *EVI : ToDelete)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    EVI-&gt;eraseFromParent();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span> (WO-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    WO-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordtype">bool</span> SimplifyIndvar::eliminateSaturatingIntrinsic(<a class="code" href="classllvm_1_1SaturatingInst.html">SaturatingInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = SE-&gt;getSCEV(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getLHS());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = SE-&gt;getSCEV(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getRHS());</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;willNotOverflow(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getBinaryOp(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isSigned(), <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getBinaryOp(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getLHS(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getRHS(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getName(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isSigned())</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    BO-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4166b451a572b1e5d3fea7250af53653">setHasNoSignedWrap</a>();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    BO-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0c03b71c79206ec41270dc3788183e0d">setHasNoUnsignedWrap</a>();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;replaceAllUsesWith(BO);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  DeadInsts.emplace_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">bool</span> SimplifyIndvar::eliminateTrunc(<a class="code" href="classllvm_1_1TruncInst.html">TruncInst</a> *TI) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// It is always legal to replace</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">//   icmp &lt;pred&gt; i32 trunc(iv), n</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// with</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">//   icmp &lt;pred&gt; i64 sext(trunc(iv)), sext(n), if pred is signed predicate.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// Or with</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">//   icmp &lt;pred&gt; i64 zext(trunc(iv)), zext(n), if pred is unsigned predicate.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// Or with either of these if pred is an equality predicate.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// If we can prove that iv == sext(trunc(iv)) or iv == zext(trunc(iv)) for</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">// every comparison which uses trunc, it means that we can replace each of</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// them with comparison of iv against sext/zext(n). We no longer need trunc</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// after that.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// TODO: Should we do this if we can widen *some* comparisons, but not all</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// of them? Sometimes it is enough to enable other optimizations, but the</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">// trunc instruction will stay in the loop.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a> = TI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IVTy = <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;getType();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *IVSCEV = SE-&gt;getSCEV(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *TISCEV = SE-&gt;getSCEV(TI);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">// Check if iv == zext(trunc(iv)) and if iv == sext(trunc(iv)). If so, we can</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// get rid of trunc</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">bool</span> DoesSExtCollapse = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordtype">bool</span> DoesZExtCollapse = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">if</span> (IVSCEV == SE-&gt;getSignExtendExpr(TISCEV, IVTy))</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    DoesSExtCollapse = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (IVSCEV == SE-&gt;getZeroExtendExpr(TISCEV, IVTy))</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    DoesZExtCollapse = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// If neither sext nor zext does collapse, it is not profitable to do any</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// transform. Bail.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (!DoesSExtCollapse &amp;&amp; !DoesZExtCollapse)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Collect users of the trunc that look like comparisons against invariants.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Bail if we find something different.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ICmpInst *, 4&gt;</a> ICmpUsers;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : TI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// We don&#39;t care about users in unreachable blocks.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (isa&lt;Instruction&gt;(U) &amp;&amp;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        !DT-&gt;isReachableFromEntry(cast&lt;Instruction&gt;(U)-&gt;getParent()))</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI = dyn_cast&lt;ICmpInst&gt;(U);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span> (!ICI) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(ICI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) &amp;&amp; <span class="stringliteral">&quot;LCSSA form broken?&quot;</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> (!(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == TI &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))) &amp;&amp;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        !(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) == TI &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0))))</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// If we cannot get rid of trunc, bail.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a3712279d70deeec90a93db09deb12d02">isSigned</a>() &amp;&amp; !DoesSExtCollapse)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#af206a3d6f58d9e53b074460f0d1ecb86">isUnsigned</a>() &amp;&amp; !DoesZExtCollapse)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// For equality, either signed or unsigned works.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    ICmpUsers.push_back(ICI);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">auto</span> CanUseZExt = [&amp;](<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICI) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// Unsigned comparison can be widened as unsigned.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#af206a3d6f58d9e53b074460f0d1ecb86">isUnsigned</a>())</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// Is it profitable to do zext?</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (!DoesZExtCollapse)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// For equality, we can safely zext both parts.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (ICI-&gt;<a class="code" href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">isEquality</a>())</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Otherwise we can only use zext when comparing two non-negative or two</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// negative values. But in practice, we will never pass DoesZExtCollapse</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// check for a negative value, because zext(trunc(x)) is non-negative. So</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// it only make sense to check for non-negativity here.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *SCEVOP1 = SE-&gt;getSCEV(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *SCEVOP2 = SE-&gt;getSCEV(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> SE-&gt;isKnownNonNegative(SCEVOP1) &amp;&amp; SE-&gt;isKnownNonNegative(SCEVOP2);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  };</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// Replace all comparisons against trunc with comparisons against IV.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *ICI : ICmpUsers) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">bool</span> IsSwapped = L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">auto</span> *Op1 = IsSwapped ? ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) : ICI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// For signed/unsigned predicate, replace the old comparison with comparison</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// of immediate IV against sext/zext of the invariant argument. If we can</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// use either sext or zext (i.e. we are dealing with equality predicate),</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// then prefer zext as a more canonical form.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// TODO: If we see a signed comparison which can be turned into unsigned,</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// we can do it here for canonicalization purposes.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred = ICI-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (IsSwapped) Pred = <a class="code" href="classllvm_1_1CmpInst.html#a49a2d8f483ea08a3d6ea75f90c640d76">ICmpInst::getSwappedPredicate</a>(Pred);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (CanUseZExt(ICI)) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DoesZExtCollapse &amp;&amp; <span class="stringliteral">&quot;Unprofitable zext?&quot;</span>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> = <span class="keyword">new</span> <a class="code" href="classllvm_1_1ZExtInst.html">ZExtInst</a>(Op1, IVTy, <span class="stringliteral">&quot;zext&quot;</span>, ICI);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      Pred = <a class="code" href="classllvm_1_1ICmpInst.html#af07a09f1cda33d984cc725dc9e856d40">ICmpInst::getUnsignedPredicate</a>(Pred);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DoesSExtCollapse &amp;&amp; <span class="stringliteral">&quot;Unprofitable sext?&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> = <span class="keyword">new</span> <a class="code" href="classllvm_1_1SExtInst.html">SExtInst</a>(Op1, IVTy, <span class="stringliteral">&quot;sext&quot;</span>, ICI);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Pred == <a class="code" href="classllvm_1_1ICmpInst.html#a9d5f70171d811078c4d263811f13c121">ICmpInst::getSignedPredicate</a>(Pred) &amp;&amp; <span class="stringliteral">&quot;Must be signed!&quot;</span>);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">bool</span> Changed;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    L-&gt;<a class="code" href="classllvm_1_1Loop.html#ae58027d845fb948a63a8ff44851699d5">makeLoopInvariant</a>(<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a>, Changed);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    (void)Changed;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *NewICI = <span class="keyword">new</span> <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a>(ICI, Pred, <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>, <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    ICI-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewICI);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    DeadInsts.emplace_back(ICI);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// Trunc no longer needed.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  TI-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(TI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  DeadInsts.emplace_back(TI);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">/// Eliminate an operation that consumes a simple IV and has no observable</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">/// side-effect given the range of IV values.  IVOperand is guaranteed SCEVable,</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">/// but UseInst may not be.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SimplifyIndvar::eliminateIVUser(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                     <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp = dyn_cast&lt;ICmpInst&gt;(UseInst)) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    eliminateIVComparison(ICmp, IVOperand);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Bin = dyn_cast&lt;BinaryOperator&gt;(UseInst)) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">bool</span> IsSRem = <a class="code" href="namespacellvm.html#a372f87e2cac1c83389c98554dc44806da807dbe7d1c25a633894d4a231b1c76d3">Bin</a>-&gt;getOpcode() == Instruction::SRem;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> (IsSRem || <a class="code" href="namespacellvm.html#a372f87e2cac1c83389c98554dc44806da807dbe7d1c25a633894d4a231b1c76d3">Bin</a>-&gt;getOpcode() == Instruction::URem) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      simplifyIVRemainder(Bin, IVOperand, IsSRem);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a372f87e2cac1c83389c98554dc44806da807dbe7d1c25a633894d4a231b1c76d3">Bin</a>-&gt;getOpcode() == Instruction::SDiv)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordflow">return</span> eliminateSDiv(Bin);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *WO = dyn_cast&lt;WithOverflowInst&gt;(UseInst))</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (eliminateOverflowIntrinsic(WO))</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SaturatingInst&gt;(UseInst))</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (eliminateSaturatingIntrinsic(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *TI = dyn_cast&lt;TruncInst&gt;(UseInst))</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (eliminateTrunc(TI))</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (eliminateIdentitySCEV(UseInst, IVOperand))</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#ad070b1d2a764cc2585ed9b892b48b632">  610</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SimplifyIndVar_8cpp.html#ad070b1d2a764cc2585ed9b892b48b632">GetLoopInvariantInsertPosition</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Hint) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>())</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">return</span> Hint;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">/// Replace the UseInst with a loop invariant expression if it is safe.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SimplifyIndvar::replaceIVUserWithLoopInvariant(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;isSCEVable(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType()))</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="comment">// Get the symbolic expression for this instruction.</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = SE-&gt;getSCEV(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;isLoopInvariant(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, L))</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// Do not generate something ridiculous even if S is loop invariant.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isHighCostExpansion(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, L, <a class="code" href="namespacellvm.html#a837209d51e75f7afcfdf457b20e59493">SCEVCheapExpansionBudget</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keyword">auto</span> *IP = <a class="code" href="SimplifyIndVar_8cpp.html#ad070b1d2a764cc2585ed9b892b48b632">GetLoopInvariantInsertPosition</a>(L, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isSafeToExpandAt(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, IP)) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Can not replace IV user: &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; with non-speculable loop invariant: &quot;</span> &lt;&lt; *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keyword">auto</span> *Invariant = <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType(), IP);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;replaceAllUsesWith(Invariant);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Replace IV user: &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; with loop invariant: &quot;</span> &lt;&lt; *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  ++NumFoldedUser;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  DeadInsts.emplace_back(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">/// Eliminate redundant type cast between integer and float.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SimplifyIndvar::replaceFloatIVWithIntegerIV(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != CastInst::SIToFP &amp;&amp;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != CastInst::UIToFP)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand = cast&lt;Instruction&gt;(UseInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// Get the symbolic expression for this instruction.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a> = SE-&gt;getSCEV(IVOperand);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">unsigned</span> MaskBits;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == CastInst::SIToFP)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    MaskBits = SE-&gt;getSignedRange(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>).getMinSignedBits();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    MaskBits = SE-&gt;getUnsignedRange(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>).getActiveBits();</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordtype">unsigned</span> DestNumSigBits = UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ad9b99a13e459cb18bb386ddd610ecf8c">getFPMantissaWidth</a>();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">if</span> (MaskBits &lt;= DestNumSigBits) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="comment">// Match for fptosi/fptoui of sitofp and with same type.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keyword">auto</span> *CI = dyn_cast&lt;CastInst&gt;(U);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">if</span> (!CI)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">CastInst::CastOps</a> Opcode = CI-&gt;getOpcode();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">if</span> (Opcode != CastInst::FPToSI &amp;&amp; Opcode != CastInst::FPToUI)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Conv = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keywordflow">if</span> (IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != CI-&gt;getType()) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(CI);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// To match InstCombine logic, we only need sext if both fptosi and</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">// sitofp are used. If one of them is unsigned, then we can use zext.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">if</span> (SE-&gt;getTypeSizeInBits(IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &gt;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            SE-&gt;getTypeSizeInBits(CI-&gt;getType())) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          Conv = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(IVOperand, CI-&gt;getType(), Name + <span class="stringliteral">&quot;.trunc&quot;</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Opcode == CastInst::FPToUI ||</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                   UseInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == CastInst::UIToFP) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          Conv = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(IVOperand, CI-&gt;getType(), Name + <span class="stringliteral">&quot;.zext&quot;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          Conv = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSExt(IVOperand, CI-&gt;getType(), Name + <span class="stringliteral">&quot;.sext&quot;</span>);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        Conv = IVOperand;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Conv);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      DeadInsts.push_back(CI);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Replace IV user: &quot;</span> &lt;&lt; *CI</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; with: &quot;</span> &lt;&lt; *Conv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      ++NumFoldedUser;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">/// Eliminate any operation that SCEV can prove is an identity function.</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SimplifyIndvar::eliminateIdentitySCEV(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst,</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                           <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;isSCEVable(UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) ||</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      (UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != IVOperand-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) ||</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      (SE-&gt;getSCEV(UseInst) != SE-&gt;getSCEV(IVOperand)))</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// getSCEV(X) == getSCEV(Y) does not guarantee that X and Y are related in the</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">// dominator tree, even if X is an operand to Y.  For instance, in</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">//     %iv = phi i32 {0,+,1}</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">//     br %cond, label %left, label %merge</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">//   left:</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">//     %X = add i32 %iv, 0</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">//     br label %merge</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">//   merge:</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">//     %M = phi (%X, %iv)</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// getSCEV(%M) == getSCEV(%X) == {0,+,1}, but %X does not dominate %M, and</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// %M.replaceAllUsesWith(%X) would be incorrect.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(UseInst))</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// If UseInst is not a PHI node then we know that IVOperand dominates</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// UseInst directly from the legality of SSA.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (!DT || !DT-&gt;dominates(IVOperand, UseInst))</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">if</span> (!LI-&gt;replacementPreservesLCSSAForm(UseInst, IVOperand))</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Eliminated identity: &quot;</span> &lt;&lt; *UseInst &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  SE-&gt;forgetValue(UseInst);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  UseInst-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(IVOperand);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  ++NumElimIdentity;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  DeadInsts.emplace_back(UseInst);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;}</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keywordtype">bool</span> SimplifyIndvar::strengthenBinaryOp(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">return</span> (isa&lt;OverflowingBinaryOperator&gt;(BO) &amp;&amp;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          strengthenOverflowingOperation(BO, IVOperand)) ||</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;         (isa&lt;ShlOperator&gt;(BO) &amp;&amp; strengthenRightShift(BO, IVOperand));</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;}</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">/// Annotate BO with nsw / nuw if it provably does not signed-overflow /</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">/// unsigned-overflow.  Returns true if anything changed, false otherwise.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SimplifyIndvar::strengthenOverflowingOperation(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                                    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = SE-&gt;getStrengthenedNoWrapFlagsFromBinOp(</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      cast&lt;OverflowingBinaryOperator&gt;(BO));</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">if</span> (!Flags)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  BO-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0c03b71c79206ec41270dc3788183e0d">setHasNoUnsignedWrap</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html#adfe987ba0fa56ab9ecdb606c2462b6b9">ScalarEvolution::maskFlags</a>(*Flags, <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">SCEV::FlagNUW</a>) ==</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                           <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">SCEV::FlagNUW</a>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  BO-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4166b451a572b1e5d3fea7250af53653">setHasNoSignedWrap</a>(<a class="code" href="classllvm_1_1ScalarEvolution.html#adfe987ba0fa56ab9ecdb606c2462b6b9">ScalarEvolution::maskFlags</a>(*Flags, <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6fa2f7a8775a783f7ea3ad24b3f9cb5d949">SCEV::FlagNSW</a>) ==</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                         <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6fa2f7a8775a783f7ea3ad24b3f9cb5d949">SCEV::FlagNSW</a>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">// The getStrengthenedNoWrapFlagsFromBinOp() check inferred additional nowrap</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">// flags on addrecs while performing zero/sign extensions. We could call</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// forgetValue() here to make sure those flags also propagate to any other</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">// SCEV expressions based on the addrec. However, this can have pathological</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// compile-time impact, see https://bugs.llvm.org/show_bug.cgi?id=50384.</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">/// Annotate the Shr in (X &lt;&lt; IVOperand) &gt;&gt; C as exact using the</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">/// information from the IV&#39;s range. Returns true if anything changed, false</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">/// otherwise.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SimplifyIndvar::strengthenRightShift(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() == Instruction::Shl) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="classllvm_1_1ConstantRange.html">ConstantRange</a> IVRange = SE-&gt;getUnsignedRange(SE-&gt;getSCEV(IVOperand));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : BO-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(U,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <a class="code" href="namespacellvm_1_1PatternMatch.html#a64153676e101a130bbbaaf91635d253a">m_AShr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">m_Shl</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(IVOperand)), <a class="code" href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">m_APInt</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))) ||</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(U,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <a class="code" href="namespacellvm_1_1PatternMatch.html#aa08fee11e8a5ec10c0cc2a7abbbd799a">m_LShr</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">m_Shl</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(IVOperand)), <a class="code" href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">m_APInt</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)))) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *Shr = cast&lt;BinaryOperator&gt;(U);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span> (!Shr-&gt;<a class="code" href="classllvm_1_1Instruction.html#a689a03df5b4ae094d6a3a1bd13dac574">isExact</a>() &amp;&amp; IVRange.<a class="code" href="classllvm_1_1ConstantRange.html#a4d69e164b5fb0f73a15a07119c4302f7">getUnsignedMin</a>().<a class="code" href="classllvm_1_1APInt.html#af4b1ccc0b78f9da9f3f3944e06007f1d">uge</a>(*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          Shr-&gt;<a class="code" href="classllvm_1_1Instruction.html#ac01940f561517355e394911c203bcedf">setIsExact</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">/// Add all uses of Def to the current IV&#39;s worklist.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">  811</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a>(</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction*,16&gt;</a> &amp;<a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>,</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl</a>&lt; std::pair&lt;Instruction*,Instruction*&gt; &gt; &amp;SimpleIVUsers) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>-&gt;users()) {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UI = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// Avoid infinite or exponential worklist processing.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// Also ensure unique worklist users.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// If Def is a LoopPhi, it may not be in the Simplified set, so check for</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// self edges first.</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">if</span> (UI == <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">// Only change the current Loop, do not change the other parts (e.g. other</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">// Loops).</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(UI))</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// Do not push the same instruction more than once.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>.insert(UI).second)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    SimpleIVUsers.push_back(std::make_pair(UI, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>));</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">/// Return true if this instruction generates a simple SCEV</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">/// expression in terms of that IV.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">/// This is similar to IVUsers&#39; isInteresting() but processes each instruction</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">/// non-recursively when the operand is already known to be a simpleIVUser.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00845"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#a3e219df8a1368668aa0aac77616a4ce9">  845</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyIndVar_8cpp.html#a3e219df8a1368668aa0aac77616a4ce9">isSimpleIVUser</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType()))</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// Get the symbolic expression for this instruction.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// Only consider affine recurrences.</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = dyn_cast&lt;SCEVAddRecExpr&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">if</span> (AR &amp;&amp; AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() == L)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">/// Iteratively perform simplification on a worklist of users</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">/// of the specified induction variable. Each successive simplification may push</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">/// more users which may themselves be candidates for simplification.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">/// This algorithm does not require IVUsers analysis. Instead, it simplifies</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">/// instructions in-place during analysis. Rather than rewriting induction</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">/// variables bottom-up from their users, it transforms a chain of IVUsers</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">/// top-down, updating the IR only when it encounters a clear optimization</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">/// opportunity.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">/// Once DisableIVRewrite is default, LSR will be the only client of IVUsers.</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> SimplifyIndvar::simplifyUsers(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurrIV, <a class="code" href="classllvm_1_1IVVisitor.html">IVVisitor</a> *V) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;isSCEVable(CurrIV-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()))</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// Instructions processed by SimplifyIndvar for CurrIV.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction*,16&gt;</a> <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// Use-def pairs if IV users waiting to be processed for CurrIV.</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;Instruction*, Instruction*&gt;</a>, 8&gt; SimpleIVUsers;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// Push users of the current LoopPhi. In rare cases, pushIVUsers may be</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// called multiple times for the same LoopPhi. This is the proper thing to</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">// do for loop header phis that use each other.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a>(CurrIV, L, <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>, SimpleIVUsers);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">while</span> (!SimpleIVUsers.empty()) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    std::pair&lt;Instruction*, Instruction*&gt; UseOper =</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      SimpleIVUsers.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseInst = UseOper.first;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// If a user of the IndVar is trivially dead, we prefer just to mark it dead</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// rather than try to do some complex analysis or transformation (such as</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// widening) basing on it.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// TODO: Propagate TLI and pass it here to handle more cases.</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(UseInst, <span class="comment">/* TLI */</span> <span class="keyword">nullptr</span>)) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      DeadInsts.emplace_back(UseInst);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// Bypass back edges to avoid extra work.</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">if</span> (UseInst == CurrIV) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">// Try to replace UseInst with a loop invariant before any other</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// simplifications.</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (replaceIVUserWithLoopInvariant(UseInst))</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IVOperand = UseOper.second;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = 0; IVOperand; ++<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &lt;= <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>.size() &amp;&amp; <span class="stringliteral">&quot;runaway iteration&quot;</span>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      (void) <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewOper = foldIVUser(UseInst, IVOperand);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">if</span> (!NewOper)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">break</span>; <span class="comment">// done folding</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      IVOperand = dyn_cast&lt;Instruction&gt;(NewOper);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (!IVOperand)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (eliminateIVUser(UseInst, IVOperand)) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <a class="code" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a>(IVOperand, L, <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>, SimpleIVUsers);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = dyn_cast&lt;BinaryOperator&gt;(UseInst)) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">if</span> (strengthenBinaryOp(BO, IVOperand)) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">// re-queue uses of the now modified binary operator and fall</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">// through to the checks that remain.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <a class="code" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a>(IVOperand, L, <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>, SimpleIVUsers);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// Try to use integer induction for FPToSI of float induction directly.</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span> (replaceFloatIVWithIntegerIV(UseInst)) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="comment">// Re-queue the potentially new direct uses of IVOperand.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <a class="code" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a>(IVOperand, L, <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>, SimpleIVUsers);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *Cast = dyn_cast&lt;CastInst&gt;(UseInst);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">if</span> (V &amp;&amp; Cast) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      V-&gt;<a class="code" href="classllvm_1_1IVVisitor.html#a366cbb9ce621c37ddb186c0813e60f22">visitCast</a>(Cast);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyIndVar_8cpp.html#a3e219df8a1368668aa0aac77616a4ce9">isSimpleIVUser</a>(UseInst, L, SE)) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <a class="code" href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a>(UseInst, L, <a class="code" href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">Simplified</a>, SimpleIVUsers);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;}</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno"><a class="line" href="classllvm_1_1IVVisitor.html#adc922a312c925e0c0a180105b60bab10">  955</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1IVVisitor.html#adc922a312c925e0c0a180105b60bab10">IVVisitor::anchor</a>() { }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">/// Simplify instructions that use this induction variable</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">/// by using ScalarEvolution to analyze the IV&#39;s recurrence.</span></div>
<div class="line"><a name="l00959"></a><span class="lineno"><a class="line" href="namespacellvm.html#a85635b30e25b4f5742866a8b074e3684">  959</a></span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a85635b30e25b4f5742866a8b074e3684">simplifyUsersOfIV</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurrIV, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                       <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                       <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>,</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                       <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>, <a class="code" href="classllvm_1_1IVVisitor.html">IVVisitor</a> *V) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  SimplifyIndvar SIV(LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(CurrIV-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()), SE, DT, LI, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                     <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>, <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  SIV.simplifyUsers(CurrIV, V);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">return</span> SIV.hasChanged();</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;}</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">/// Simplify users of induction variables within this</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">/// loop. This does not actually change or add IVs.</span></div>
<div class="line"><a name="l00971"></a><span class="lineno"><a class="line" href="namespacellvm.html#a8413a9136fa25e3dfdebc5cb8c111002">  971</a></span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a8413a9136fa25e3dfdebc5cb8c111002">simplifyLoopIVs</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                     <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                     <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(*SE, SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a51d9710fffc66dd4c9aab84af5978e1e">getDataLayout</a>(), <span class="stringliteral">&quot;indvars&quot;</span>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setDebugType(<a class="code" href="SimplifyIndVar_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(); isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    Changed |=</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="namespacellvm.html#a85635b30e25b4f5742866a8b074e3684">simplifyUsersOfIV</a>(cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), SE, DT, LI, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>, <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;}</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;} <span class="comment">// namespace llvm</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">// Widen Induction Variables - Extend the width of an IV to cover its</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">// widest uses.</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="keyword">class </span><a class="code" href="LoopFlatten_8cpp.html#a4aa9efb1877c0a4aa735be1395c60637">WidenIV</a> {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="comment">// Parameters</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OrigPhi;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *WideType;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// Context</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a>        *LI;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a>            *L;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a>   *DT;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// Does the module have any calls to the llvm.experimental.guard intrinsic</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="comment">// at all? If not we can avoid scanning instructions looking for guards.</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordtype">bool</span> HasGuards;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="comment">// Statistics</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordtype">unsigned</span> NumElimExt = 0;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordtype">unsigned</span> NumWidened = 0;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="comment">// Result</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *WidePhi = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideInc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideIncExpr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *,16&gt;</a> Widened;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keyword">enum class</span> ExtendKind { <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>, Sign, <a class="code" href="CorrelatedValuePropagation_8cpp.html#aad75d6f4f14a7b791076c6785aa59be4a88183b946cc5f0e8c96b2e66e1c74a7e">Unknown</a> };</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="comment">// A map tracking the kind of extension used to widen each narrow IV</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">// and narrow IV user.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">// Key: pointer to a narrow IV or IV user.</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">// Value: the kind of extension used to widen this Instruction.</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;AssertingVH&lt;Instruction&gt;</a>, ExtendKind&gt; ExtendKindMap;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keyword">using</span> DefUserPair = std::pair&lt;AssertingVH&lt;Value&gt;, <a class="code" href="classllvm_1_1AssertingVH.html">AssertingVH&lt;Instruction&gt;</a>&gt;;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">// A map with control-dependent ranges for post increment IV uses. The key is</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">// a pair of IV def and a use of this def denoting the context. The value is</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="comment">// a ConstantRange representing possible values of the def at the given</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="comment">// context.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;DefUserPair, ConstantRange&gt;</a> PostIncRangeInfos;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  std::optional&lt;ConstantRange&gt; getPostIncRangeInfo(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>,</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                                   <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseI) {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    DefUserPair <a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, UseI);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keyword">auto</span> It = PostIncRangeInfos.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">return</span> It == PostIncRangeInfos.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;               ? std::optional&lt;ConstantRange&gt;(std::nullopt)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;               : <a class="code" href="namespacestd.html">std</a>::optional&lt;<a class="code" href="classllvm_1_1ConstantRange.html">ConstantRange</a>&gt;(It-&gt;second);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">void</span> calculatePostIncRanges(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OrigPhi);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordtype">void</span> calculatePostIncRange(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUser);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordtype">void</span> updatePostIncRangeInfo(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UseI, <a class="code" href="classllvm_1_1ConstantRange.html">ConstantRange</a> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    DefUserPair <a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, UseI);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keyword">auto</span> It = PostIncRangeInfos.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (It == PostIncRangeInfos.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      PostIncRangeInfos.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>});</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      It-&gt;second = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.intersectWith(It-&gt;second);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">  /// Record a link in the Narrow IV def-use chain along with the WideIV that</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">  /// computes the same value as the Narrow IV def.  This avoids caching Use*</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">  /// pointers.</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>NarrowIVDefUse {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">// True if the narrow def is never negative.  Tracking this information lets</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// us use a sign extension instead of a zero extension or vice versa, when</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// profitable and legal.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordtype">bool</span> NeverNegative = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    NarrowIVDefUse(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ND, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NU, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WD,</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                   <span class="keywordtype">bool</span> NeverNegative)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        : NarrowDef(ND), NarrowUse(NU), WideDef(WD),</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          NeverNegative(NeverNegative) {}</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  };</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <a class="code" href="LoopFlatten_8cpp.html#a4aa9efb1877c0a4aa735be1395c60637">WidenIV</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1WideIVInfo.html">WideIVInfo</a> &amp;WI, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LInfo, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SEv,</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DTree, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DI,</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          <span class="keywordtype">bool</span> HasGuards, <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a> = <span class="keyword">true</span>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="namespacellvm.html#a35edc71a3e9b62bcfa5b80ae369515d9">createWideIV</a>(<a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordtype">unsigned</span> getNumElimExt() { <span class="keywordflow">return</span> NumElimExt; };</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordtype">unsigned</span> getNumWidened() { <span class="keywordflow">return</span> NumWidened; };</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *createExtendInst(<a class="code" href="classllvm_1_1Value.html">Value</a> *NarrowOper, <a class="code" href="classllvm_1_1Type.html">Type</a> *WideType, <span class="keywordtype">bool</span> IsSigned,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1Use.html">Use</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *cloneIVUser(NarrowIVDefUse DU, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *WideAR);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *cloneArithmeticIVUser(NarrowIVDefUse DU,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *WideAR);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *cloneBitwiseIVUser(NarrowIVDefUse DU);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  ExtendKind getExtendKind(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keyword">using</span> WidenedRecTy = std::pair&lt;const SCEVAddRecExpr *, ExtendKind&gt;;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  WidenedRecTy getWideRecurrence(NarrowIVDefUse DU);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  WidenedRecTy getExtendedOperandRecurrence(NarrowIVDefUse DU);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *getSCEVByOpCode(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                              <span class="keywordtype">unsigned</span> OpCode) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *widenIVUse(NarrowIVDefUse DU, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordtype">bool</span> widenLoopCompare(NarrowIVDefUse DU);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordtype">bool</span> widenWithVariantUse(NarrowIVDefUse DU);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordtype">void</span> pushNarrowIVUsers(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;NarrowIVDefUse, 8&gt;</a> NarrowIVUsers;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;};</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">/// Determine the insertion point for this user. By default, insert immediately</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">/// before the user. SCEVExpander or LICM will hoist loop invariants out of the</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">/// loop. For PHI nodes, there may be multiple uses, so compute the nearest</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">/// common dominator for the incoming blocks. A nullptr can be returned if no</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">/// viable location is found: it may happen if User is a PHI and Def only comes</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">/// to this PHI from unreachable blocks.</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#a13e91d69fbcc25b109648b284e241418"> 1127</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SimplifyIndVar_8cpp.html#a13e91d69fbcc25b109648b284e241418">getInsertPointForUses</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1User.html">User</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>,</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                          <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = dyn_cast&lt;PHINode&gt;(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1User.html">User</a>;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getNumIncomingValues(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getIncomingValue(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) != <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InsertBB = <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getIncomingBlock(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">if</span> (!DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">isReachableFromEntry</a>(InsertBB))</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">if</span> (!InsertPt) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      InsertPt = InsertBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    InsertBB = DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a2ec50ab2c78eff965caf3da71cd08be4">findNearestCommonDominator</a>(InsertPt-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), InsertBB);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    InsertPt = InsertBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">// If we have skipped all inputs, it means that Def only comes to Phi from</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">// unreachable blocks.</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">if</span> (!InsertPt)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keyword">auto</span> *DefI = dyn_cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordflow">if</span> (!DefI)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">return</span> InsertPt;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(DefI, InsertPt) &amp;&amp; <span class="stringliteral">&quot;def does not dominate all uses&quot;</span>);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keyword">auto</span> *L = LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(DefI-&gt;getParent());</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!L || L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(InsertPt-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>())));</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DTN = (*DT)[InsertPt-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()]; DTN; DTN = DTN-&gt;getIDom())</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(DTN-&gt;getBlock()) == L)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">return</span> DTN-&gt;getBlock()-&gt;getTerminator();</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;DefI dominates InsertPt!&quot;</span>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;}</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="LoopFlatten_8cpp.html#a4aa9efb1877c0a4aa735be1395c60637"> 1172</a></span>&#160;<a class="code" href="LoopFlatten_8cpp.html#a4aa9efb1877c0a4aa735be1395c60637">WidenIV::WidenIV</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1WideIVInfo.html">WideIVInfo</a> &amp;WI, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LInfo, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SEv,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DTree, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DI,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          <span class="keywordtype">bool</span> HasGuards, <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      : OrigPhi(WI.NarrowIV), WideType(WI.WidestNativeType), LI(LInfo),</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        L(LI-&gt;getLoopFor(OrigPhi-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>())), SE(SEv), DT(DTree),</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        HasGuards(HasGuards), <a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>(<a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>),</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        DeadInsts(DI) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() == OrigPhi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() &amp;&amp; <span class="stringliteral">&quot;Phi must be an IV&quot;</span>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    ExtendKindMap[OrigPhi] = WI.<a class="code" href="structllvm_1_1WideIVInfo.html#a45b4503c5e229503d60cc68c034286ab">IsSigned</a> ? ExtendKind::Sign : ExtendKind::Zero;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;}</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *WidenIV::createExtendInst(<a class="code" href="classllvm_1_1Value.html">Value</a> *NarrowOper, <a class="code" href="classllvm_1_1Type.html">Type</a> *WideType,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                 <span class="keywordtype">bool</span> IsSigned, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1Use.html">Use</a>) {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">// Set the debug location and conservative insertion point.</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="classllvm_1_1Use.html">Use</a>);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">// Hoist the insertion point into loop preheaders as far as possible.</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L = LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="classllvm_1_1Use.html">Use</a>-&gt;getParent());</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;       L &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>() &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(NarrowOper);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;       L = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a62733c3335a87750623dbfc5b3ae4f6c">getParentLoop</a>())</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">return</span> IsSigned ? <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSExt(NarrowOper, WideType) :</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(NarrowOper, WideType);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">/// Instantiate a wide operation to replace a narrow operation. This only needs</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">/// to handle operations that can evaluation to SCEVAddRec. It can safely return</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">/// 0 for any operation we decide not to clone.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIV::cloneIVUser(WidenIV::NarrowIVDefUse DU,</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *WideAR) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = DU.NarrowUse-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>();</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>:</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a>:</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">return</span> cloneArithmeticIVUser(DU, WideAR);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">case</span> Instruction::And:</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordflow">case</span> Instruction::Or:</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">case</span> Instruction::Xor:</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">case</span> Instruction::Shl:</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">case</span> Instruction::LShr:</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">case</span> Instruction::AShr:</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">return</span> cloneBitwiseIVUser(DU);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIV::cloneBitwiseIVUser(WidenIV::NarrowIVDefUse DU) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse = DU.NarrowUse;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef = DU.NarrowDef;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef = DU.WideDef;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cloning bitwise IVUser: &quot;</span> &lt;&lt; *NarrowUse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="comment">// Replace NarrowDef operands with WideDef. Otherwise, we don&#39;t know anything</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment">// about the narrow operand yet so must insert a [sz]ext. It is probably loop</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// invariant and will be folded or hoisted. If it actually comes from a</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">// widened IV, it should be removed during a future call to widenIVUse.</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keywordtype">bool</span> IsSigned = getExtendKind(NarrowDef) == ExtendKind::Sign;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == NarrowDef)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                   ? WideDef</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                   : createExtendInst(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), WideType,</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                      IsSigned, NarrowUse);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) == NarrowDef)</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                   ? WideDef</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                   : createExtendInst(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), WideType,</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                      IsSigned, NarrowUse);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keyword">auto</span> *NarrowBO = cast&lt;BinaryOperator&gt;(NarrowUse);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keyword">auto</span> *WideBO = BinaryOperator::Create(NarrowBO-&gt;getOpcode(), <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                        NarrowBO-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(NarrowUse);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(WideBO);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  WideBO-&gt;copyIRFlags(NarrowBO);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">return</span> WideBO;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIV::cloneArithmeticIVUser(WidenIV::NarrowIVDefUse DU,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *WideAR) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse = DU.NarrowUse;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef = DU.NarrowDef;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef = DU.WideDef;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cloning arithmetic IVUser: &quot;</span> &lt;&lt; *NarrowUse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="keywordtype">unsigned</span> IVOpIdx = (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == NarrowDef) ? 0 : 1;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">// We&#39;re trying to find X such that</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">//  Widen(NarrowDef `op` NonIVNarrowDef) == WideAR == WideDef `op.wide` X</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="comment">// We guess two solutions to X, sext(NonIVNarrowDef) and zext(NonIVNarrowDef),</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// and check using SCEV if any of them are correct.</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// Returns true if extending NonIVNarrowDef according to `SignExt` is a</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// correct solution to X.</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keyword">auto</span> GuessNonIVOperand = [&amp;](<span class="keywordtype">bool</span> SignExt) {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideLHS;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideRHS;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keyword">auto</span> GetExtend = [<span class="keyword">this</span>, SignExt](<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="keywordflow">if</span> (SignExt)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, Ty);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">getZeroExtendExpr</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, Ty);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    };</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">if</span> (IVOpIdx == 0) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      WideLHS = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideDef);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NarrowRHS = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      WideRHS = GetExtend(NarrowRHS, WideType);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NarrowLHS = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      WideLHS = GetExtend(NarrowLHS, WideType);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      WideRHS = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideDef);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">// WideUse is &quot;WideDef `op.wide` X&quot; as described in the comment.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideUse =</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      getSCEVByOpCode(WideLHS, WideRHS, NarrowUse-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>());</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">return</span> WideUse == WideAR;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  };</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordtype">bool</span> SignExtend = getExtendKind(NarrowDef) == ExtendKind::Sign;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span> (!GuessNonIVOperand(SignExtend)) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    SignExtend = !SignExtend;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">if</span> (!GuessNonIVOperand(SignExtend))</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == NarrowDef)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                   ? WideDef</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                   : createExtendInst(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), WideType,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                      SignExtend, NarrowUse);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) == NarrowDef)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                   ? WideDef</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                   : createExtendInst(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), WideType,</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                      SignExtend, NarrowUse);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keyword">auto</span> *NarrowBO = cast&lt;BinaryOperator&gt;(NarrowUse);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keyword">auto</span> *WideBO = BinaryOperator::Create(NarrowBO-&gt;getOpcode(), <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                        NarrowBO-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(NarrowUse);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(WideBO);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  WideBO-&gt;copyIRFlags(NarrowBO);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">return</span> WideBO;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;WidenIV::ExtendKind WidenIV::getExtendKind(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keyword">auto</span> It = ExtendKindMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != ExtendKindMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp; <span class="stringliteral">&quot;Instruction not yet extended!&quot;</span>);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">return</span> It-&gt;second;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;}</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WidenIV::getSCEVByOpCode(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                     <span class="keywordtype">unsigned</span> OpCode)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">switch</span> (OpCode) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>:</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">case</span> Instruction::Sub:</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a>:</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">case</span> Instruction::UDiv:</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6c03d18ed744dc3b34829ec5485a68b0">getUDivExpr</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unsupported opcode.&quot;</span>);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  };</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">/// No-wrap operations can transfer sign extension of their result to their</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">/// operands. Generate the SCEV value for the widened operation without</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">/// actually modifying the IR yet. If the expression after extending the</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">/// operands is an AddRec for this loop, return the AddRec and the kind of</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">/// extension used.</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment"></span>WidenIV::WidenedRecTy</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;WidenIV::getExtendedOperandRecurrence(WidenIV::NarrowIVDefUse DU) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="comment">// Handle the common case of add&lt;nsw/nuw&gt;</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpCode = DU.NarrowUse-&gt;getOpcode();</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">// Only Add/Sub/Mul instructions supported yet.</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordflow">if</span> (OpCode != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> &amp;&amp; OpCode != Instruction::Sub &amp;&amp;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      OpCode != <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>};</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="comment">// One operand (NarrowDef) has already been extended to WideDef. Now determine</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="comment">// if extending the other will lead to a recurrence.</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ExtendOperIdx =</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      DU.NarrowUse-&gt;getOperand(0) == DU.NarrowDef ? 1 : 0;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DU.NarrowUse-&gt;getOperand(1-ExtendOperIdx) == DU.NarrowDef &amp;&amp; <span class="stringliteral">&quot;bad DU&quot;</span>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExtendOperExpr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1OverflowingBinaryOperator.html">OverflowingBinaryOperator</a> *OBO =</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    cast&lt;OverflowingBinaryOperator&gt;(DU.NarrowUse);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  ExtendKind ExtKind = getExtendKind(DU.NarrowDef);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">if</span> (ExtKind == ExtendKind::Sign &amp;&amp; OBO-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#a7876c618729b8764493aa340b53b574f">hasNoSignedWrap</a>())</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    ExtendOperExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.NarrowUse-&gt;getOperand(ExtendOperIdx)), WideType);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ExtKind == ExtendKind::Zero &amp;&amp; OBO-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#a95474ea140862464db7ea0580f01eae9">hasNoUnsignedWrap</a>())</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    ExtendOperExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">getZeroExtendExpr</a>(</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.NarrowUse-&gt;getOperand(ExtendOperIdx)), WideType);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>};</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="comment">// When creating this SCEV expr, don&#39;t apply the current operations NSW or NUW</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">// flags. This instruction may be guarded by control flow that the no-wrap</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="comment">// behavior depends on. Non-control-equivalent instructions can be mapped to</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">// the same SCEV expression, and it would be incorrect to transfer NSW/NUW</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="comment">// semantics to those operations.</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *lhs = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.WideDef);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *rhs = ExtendOperExpr;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="comment">// Let&#39;s swap operands to the initial order for the case of non-commutative</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="comment">// operations, like SUB. See PR21014.</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="keywordflow">if</span> (ExtendOperIdx == 0)</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(lhs, rhs);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec =</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      dyn_cast&lt;SCEVAddRecExpr&gt;(getSCEVByOpCode(lhs, rhs, OpCode));</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="keywordflow">if</span> (!AddRec || AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != L)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>};</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="keywordflow">return</span> {AddRec, ExtKind};</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;}</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">/// Is this instruction potentially interesting for further simplification after</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">/// widening it&#39;s type? In other words, can the extend be safely hoisted out of</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">/// the loop with SCEV reducing the value to a recurrence on the same loop. If</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">/// so, return the extended recurrence and the kind of extension used. Otherwise</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">/// return {nullptr, ExtendKind::Unknown}.</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment"></span>WidenIV::WidenedRecTy WidenIV::getWideRecurrence(WidenIV::NarrowIVDefUse DU) {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordflow">if</span> (!DU.NarrowUse-&gt;getType()-&gt;isIntegerTy())</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>};</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NarrowExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(DU.NarrowUse);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(NarrowExpr-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) &gt;=</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(WideType)) {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">// NarrowUse implicitly widens its operand. e.g. a gep with a narrow</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">// index. So don&#39;t follow this use.</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>};</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideExpr;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  ExtendKind ExtKind;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="keywordflow">if</span> (DU.NeverNegative) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    WideExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(NarrowExpr, WideType);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVAddRecExpr&gt;(WideExpr))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      ExtKind = ExtendKind::Sign;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      WideExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">getZeroExtendExpr</a>(NarrowExpr, WideType);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      ExtKind = ExtendKind::Zero;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (getExtendKind(DU.NarrowDef) == ExtendKind::Sign) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    WideExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(NarrowExpr, WideType);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    ExtKind = ExtendKind::Sign;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    WideExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">getZeroExtendExpr</a>(NarrowExpr, WideType);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    ExtKind = ExtendKind::Zero;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = dyn_cast&lt;SCEVAddRecExpr&gt;(WideExpr);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">if</span> (!AddRec || AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != L)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">nullptr</span>, <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>};</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="keywordflow">return</span> {AddRec, ExtKind};</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;}</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">/// This IV user cannot be widened. Replace this use of the original narrow IV</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">/// with a truncation of the new wide IV to isolate and eliminate the narrow IV.</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"><a class="line" href="SimplifyIndVar_8cpp.html#a123c351fc07a1cb31db89e554dd6e911"> 1442</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SimplifyIndVar_8cpp.html#a123c351fc07a1cb31db89e554dd6e911">truncateIVUse</a>(WidenIV::NarrowIVDefUse DU, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT,</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                          <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="keyword">auto</span> *InsertPt = <a class="code" href="SimplifyIndVar_8cpp.html#a13e91d69fbcc25b109648b284e241418">getInsertPointForUses</a>(DU.NarrowUse, DU.NarrowDef, DT, LI);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">if</span> (!InsertPt)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Truncate IV &quot;</span> &lt;&lt; *DU.WideDef &lt;&lt; <span class="stringliteral">&quot; for user &quot;</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    &lt;&lt; *DU.NarrowUse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(InsertPt);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Trunc = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(DU.WideDef, DU.NarrowDef-&gt;getType());</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  DU.NarrowUse-&gt;replaceUsesOfWith(DU.NarrowDef, Trunc);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">/// If the narrow use is a compare instruction, then widen the compare</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment"></span><span class="comment">//  (and possibly the other operand).  The extend operation is hoisted into the</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">// loop preheader as far as possible.</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="keywordtype">bool</span> WidenIV::widenLoopCompare(WidenIV::NarrowIVDefUse DU) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = dyn_cast&lt;ICmpInst&gt;(DU.NarrowUse);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">if</span> (!Cmp)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="comment">// We can legally widen the comparison in the following two cases:</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="comment">//  - The signedness of the IV extension and comparison match</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">//  - The narrow IV is always positive (and thus its sign extension is equal</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">//    to its zero extension).  For instance, let&#39;s say we&#39;re zero extending</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">//    %narrow for the following use</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="comment">//      icmp slt i32 %narrow, %val   ... (A)</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="comment">//    and %narrow is always positive.  Then</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="comment">//      (A) == icmp slt i32 sext(%narrow), sext(%val)</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="comment">//          == icmp slt i32 zext(%narrow), sext(%val)</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="keywordtype">bool</span> IsSigned = getExtendKind(DU.NarrowDef) == ExtendKind::Sign;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordflow">if</span> (!(DU.NeverNegative || IsSigned == <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;isSigned()))</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(0) == DU.NarrowDef ? 1 : 0);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordtype">unsigned</span> CastWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType());</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordtype">unsigned</span> IVWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(WideType);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CastWidth &lt;= IVWidth &amp;&amp; <span class="stringliteral">&quot;Unexpected width while widening compare.&quot;</span>);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="comment">// Widen the compare instruction.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="keyword">auto</span> *InsertPt = <a class="code" href="SimplifyIndVar_8cpp.html#a13e91d69fbcc25b109648b284e241418">getInsertPointForUses</a>(DU.NarrowUse, DU.NarrowDef, DT, LI);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="keywordflow">if</span> (!InsertPt)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(InsertPt);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  DU.NarrowUse-&gt;replaceUsesOfWith(DU.NarrowDef, DU.WideDef);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="comment">// Widen the other operand of the compare, if necessary.</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keywordflow">if</span> (CastWidth &lt; IVWidth) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ExtOp = createExtendInst(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, WideType, <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;isSigned(), Cmp);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    DU.NarrowUse-&gt;replaceUsesOfWith(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, ExtOp);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;}</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">// The widenIVUse avoids generating trunc by evaluating the use as AddRec, this</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">// will not work when:</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">//    1) SCEV traces back to an instruction inside the loop that SCEV can not</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">// expand, eg. add %indvar, (load %addr)</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">//    2) SCEV finds a loop variant, eg. add %indvar, %loopvariant</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">// While SCEV fails to avoid trunc, we can still try to use instruction</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">// combining approach to prove trunc is not required. This can be further</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">// extended with other instruction combining checks, but for now we handle the</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">// following case (sub can be &quot;add&quot; and &quot;mul&quot;, &quot;nsw + sext&quot; can be &quot;nus + zext&quot;)</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">// Src:</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">//   %c = sub nsw %b, %indvar</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">//   %d = sext %c to i64</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">// Dst:</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">//   %indvar.ext1 = sext %indvar to i64</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">//   %m = sext %b to i64</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">//   %d = sub nsw i64 %m, %indvar.ext1</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">// Therefore, as long as the result of add/sub/mul is extended to wide type, no</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">// trunc is required regardless of how %b is generated. This pattern is common</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">// when calculating address in 64 bit architecture</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="keywordtype">bool</span> WidenIV::widenWithVariantUse(WidenIV::NarrowIVDefUse DU) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUse = DU.NarrowUse;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef = DU.NarrowDef;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef = DU.WideDef;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="comment">// Handle the common case of add&lt;nsw/nuw&gt;</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpCode = NarrowUse-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>();</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="comment">// Only Add/Sub/Mul instructions are supported.</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordflow">if</span> (OpCode != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> &amp;&amp; OpCode != Instruction::Sub &amp;&amp;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      OpCode != <a class="code" href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Instruction::Mul</a>)</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// The operand that is not defined by NarrowDef of DU. Let&#39;s call it the</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="comment">// other operand.</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == NarrowDef ||</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) == NarrowDef) &amp;&amp;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;         <span class="stringliteral">&quot;bad DU&quot;</span>);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1OverflowingBinaryOperator.html">OverflowingBinaryOperator</a> *OBO =</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    cast&lt;OverflowingBinaryOperator&gt;(NarrowUse);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  ExtendKind ExtKind = getExtendKind(NarrowDef);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordtype">bool</span> CanSignExtend = ExtKind == ExtendKind::Sign &amp;&amp; OBO-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#a7876c618729b8764493aa340b53b574f">hasNoSignedWrap</a>();</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordtype">bool</span> CanZeroExtend = ExtKind == ExtendKind::Zero &amp;&amp; OBO-&gt;<a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#a95474ea140862464db7ea0580f01eae9">hasNoUnsignedWrap</a>();</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keyword">auto</span> AnotherOpExtKind = ExtKind;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">// Check that all uses are either:</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="comment">// - narrow def (in case of we are widening the IV increment);</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="comment">// - single-input LCSSA Phis;</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="comment">// - comparison of the chosen type;</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="comment">// - extend of the chosen type (raison d&#39;etre).</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> ExtUsers;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 4&gt;</a> LCSSAPhiUsers;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ICmpInst *, 4&gt;</a> ICmpUsers;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : NarrowUse-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>()) {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1User.html">User</a> = cast&lt;Instruction&gt;(U.getUser());</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1User.html">User</a> == NarrowDef)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(<a class="code" href="classllvm_1_1User.html">User</a>)) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="keyword">auto</span> *LCSSAPhi = cast&lt;PHINode&gt;(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="comment">// Make sure there is only 1 input, so that we don&#39;t have to split</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="comment">// critical edges.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">if</span> (LCSSAPhi-&gt;getNumOperands() != 1)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      LCSSAPhiUsers.push_back(LCSSAPhi);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ICmp = dyn_cast&lt;ICmpInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>)) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="keyword">auto</span> Pred = ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>();</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="comment">// We have 3 types of predicates: signed, unsigned and equality</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="comment">// predicates. For equality, it&#39;s legal to widen icmp for either sign and</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <span class="comment">// zero extend. For sign extend, we can also do so for signed predicates,</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="comment">// likeweise for zero extend we can widen icmp for unsigned predicates.</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">if</span> (ExtKind == ExtendKind::Zero &amp;&amp; <a class="code" href="ExpandLargeDivRem_8cpp.html#a49b2092a066cfbc24bc6925bdea9682a">ICmpInst::isSigned</a>(Pred))</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="keywordflow">if</span> (ExtKind == ExtendKind::Sign &amp;&amp; ICmpInst::isUnsigned(Pred))</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      ICmpUsers.push_back(ICmp);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">if</span> (ExtKind == ExtendKind::Sign)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <a class="code" href="classllvm_1_1User.html">User</a> = dyn_cast&lt;SExtInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <a class="code" href="classllvm_1_1User.html">User</a> = dyn_cast&lt;ZExtInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1User.html">User</a> || <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != WideType)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    ExtUsers.push_back(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">if</span> (ExtUsers.empty()) {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(NarrowUse);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="comment">// We&#39;ll prove some facts that should be true in the context of ext users. If</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">// there is no users, we are done now. If there are some, pick their common</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">// dominator as context.</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CtxI = <a class="code" href="SimplifyIndVar_8cpp.html#a59f39a75e16788ecd95f9fb94c918c4d">findCommonDominator</a>(ExtUsers, *DT);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordflow">if</span> (!CanSignExtend &amp;&amp; !CanZeroExtend) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">// Because InstCombine turns &#39;sub nuw&#39; to &#39;add&#39; losing the no-wrap flag, we</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// will most likely not see it. Let&#39;s try to prove it.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">if</span> (OpCode != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>)</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">if</span> (ExtKind != ExtendKind::Zero)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(OBO-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(OBO-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">// TODO: Support case for NarrowDef = NarrowUse-&gt;getOperand(1).</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">if</span> (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) != NarrowDef)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a1b9806d21518ef7fb4d5c4299e21411f">isKnownNegative</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordtype">bool</span> ProvedSubNUW = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a4daf873f99d8d423c92a951331de5185">isKnownPredicateAt</a>(ICmpInst::ICMP_UGE, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                                               SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">getNegativeSCEV</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>), CtxI);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordflow">if</span> (!ProvedSubNUW)</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">// In fact, our &#39;add&#39; is &#39;sub nuw&#39;. We will need to widen the 2nd operand as</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">// neg(zext(neg(op))), which is basically sext(op).</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    AnotherOpExtKind = ExtendKind::Sign;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// Verifying that Defining operand is an AddRec</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Op1 = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideDef);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRecOp1 = dyn_cast&lt;SCEVAddRecExpr&gt;(Op1);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keywordflow">if</span> (!AddRecOp1 || AddRecOp1-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != L)</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cloning arithmetic IVUser: &quot;</span> &lt;&lt; *NarrowUse &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">// Generating a widening use instruction.</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> =</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) == NarrowDef)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;          ? WideDef</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;          : createExtendInst(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), WideType,</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                             AnotherOpExtKind == ExtendKind::Sign, NarrowUse);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> =</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      (NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) == NarrowDef)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          ? WideDef</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          : createExtendInst(NarrowUse-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), WideType,</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                             AnotherOpExtKind == ExtendKind::Sign, NarrowUse);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="keyword">auto</span> *NarrowBO = cast&lt;BinaryOperator&gt;(NarrowUse);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keyword">auto</span> *WideBO = BinaryOperator::Create(NarrowBO-&gt;getOpcode(), <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                        NarrowBO-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(NarrowUse);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.Insert(WideBO);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  WideBO-&gt;copyIRFlags(NarrowBO);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  ExtendKindMap[NarrowUse] = ExtKind;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1User.html">User</a> : ExtUsers) {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == WideType &amp;&amp; <span class="stringliteral">&quot;Checked before!&quot;</span>);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: eliminating &quot;</span> &lt;&lt; *<a class="code" href="classllvm_1_1User.html">User</a> &lt;&lt; <span class="stringliteral">&quot; replaced by &quot;</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                      &lt;&lt; *WideBO &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    ++NumElimExt;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(WideBO);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="classllvm_1_1User.html">User</a> : LCSSAPhiUsers) {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">getNumOperands</a>() == 1 &amp;&amp; <span class="stringliteral">&quot;Checked before!&quot;</span>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keyword">auto</span> *WidePN =</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(WideBO-&gt;getType(), 1, <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.wide&quot;</span>);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopExitingBlock = <a class="code" href="classllvm_1_1User.html">User</a>-&gt;getParent()-&gt;getSinglePredecessor();</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopExitingBlock &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(LoopExitingBlock) &amp;&amp;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;           <span class="stringliteral">&quot;Not a LCSSA Phi?&quot;</span>);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    WidePN-&gt;addIncoming(WideBO, LoopExitingBlock);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;*<a class="code" href="classllvm_1_1User.html">User</a>-&gt;getParent()-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keyword">auto</span> *TruncPN = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(WidePN, <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(TruncPN);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *<a class="code" href="classllvm_1_1User.html">User</a> : ICmpUsers) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keyword">auto</span> ExtendedOp = [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> * V)-&gt;<a class="code" href="classllvm_1_1Value.html">Value</a> * {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">if</span> (V == NarrowUse)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="keywordflow">return</span> WideBO;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">if</span> (ExtKind == ExtendKind::Zero)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(V, WideBO-&gt;getType());</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSExt(V, WideBO-&gt;getType());</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    };</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keyword">auto</span> Pred = <a class="code" href="classllvm_1_1User.html">User</a>-&gt;getPredicate();</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = ExtendedOp(<a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0));</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = ExtendedOp(<a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keyword">auto</span> *WideCmp =</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmp(Pred, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.wide&quot;</span>);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(WideCmp);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;}</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">/// Determine whether an individual user of the narrow IV can be widened. If so,</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">/// return the wide clone of the user.</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WidenIV::widenIVUse(WidenIV::NarrowIVDefUse DU, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>) {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ExtendKindMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(DU.NarrowDef) &amp;&amp;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;         <span class="stringliteral">&quot;Should already know the kind of extension used to widen NarrowDef&quot;</span>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="comment">// Stop traversing the def-use chain at inner-loop phis or post-loop phis.</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *UsePhi = dyn_cast&lt;PHINode&gt;(DU.NarrowUse)) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(UsePhi-&gt;getParent()) != L) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="comment">// For LCSSA phis, sink the truncate outside the loop.</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="comment">// After SimplifyCFG most loop exit targets have a single predecessor.</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <span class="comment">// Otherwise fall back to a truncate within the loop.</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="keywordflow">if</span> (UsePhi-&gt;getNumOperands() != 1)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <a class="code" href="SimplifyIndVar_8cpp.html#a123c351fc07a1cb31db89e554dd6e911">truncateIVUse</a>(DU, DT, LI);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="comment">// Widening the PHI requires us to insert a trunc.  The logical place</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="comment">// for this trunc is in the same BB as the PHI.  This is not possible if</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="comment">// the BB is terminated by a catchswitch.</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">if</span> (isa&lt;CatchSwitchInst&gt;(UsePhi-&gt;getParent()-&gt;getTerminator()))</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *WidePhi =</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          PHINode::Create(DU.WideDef-&gt;getType(), 1, UsePhi-&gt;getName() + <span class="stringliteral">&quot;.wide&quot;</span>,</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                          UsePhi);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        WidePhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(DU.WideDef, UsePhi-&gt;getIncomingBlock(0));</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(&amp;*WidePhi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Trunc = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(WidePhi, DU.NarrowDef-&gt;getType());</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        UsePhi-&gt;replaceAllUsesWith(Trunc);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(UsePhi);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: Widen lcssa phi &quot;</span> &lt;&lt; *UsePhi &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                          &lt;&lt; *WidePhi &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// This narrow use can be widened by a sext if it&#39;s non-negative or its narrow</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="comment">// def was widended by a sext. Same for zext.</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keyword">auto</span> canWidenBySExt = [&amp;]() {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordflow">return</span> DU.NeverNegative || getExtendKind(DU.NarrowDef) == ExtendKind::Sign;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  };</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keyword">auto</span> canWidenByZExt = [&amp;]() {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">return</span> DU.NeverNegative || getExtendKind(DU.NarrowDef) == ExtendKind::Zero;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  };</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="comment">// Our raison d&#39;etre! Eliminate sign and zero extension.</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keywordflow">if</span> ((isa&lt;SExtInst&gt;(DU.NarrowUse) &amp;&amp; canWidenBySExt()) ||</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      (isa&lt;ZExtInst&gt;(DU.NarrowUse) &amp;&amp; canWidenByZExt())) {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewDef = DU.WideDef;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">if</span> (DU.NarrowUse-&gt;getType() != WideType) {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keywordtype">unsigned</span> CastWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(DU.NarrowUse-&gt;getType());</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordtype">unsigned</span> IVWidth = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(WideType);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keywordflow">if</span> (CastWidth &lt; IVWidth) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="comment">// The cast isn&#39;t as wide as the IV, so insert a Trunc.</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(DU.NarrowUse);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        NewDef = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(DU.WideDef, DU.NarrowUse-&gt;getType());</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="comment">// A wider extend was hidden behind a narrower one. This may induce</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="comment">// another round of IV widening in which the intermediate IV becomes</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="comment">// dead. It should be very rare.</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: New IV &quot;</span> &lt;&lt; *WidePhi</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; not wide enough to subsume &quot;</span> &lt;&lt; *DU.NarrowUse</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        DU.NarrowUse-&gt;replaceUsesOfWith(DU.NarrowDef, DU.WideDef);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        NewDef = DU.NarrowUse;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">if</span> (NewDef != DU.NarrowUse) {</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;INDVARS: eliminating &quot;</span> &lt;&lt; *DU.NarrowUse</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; replaced by &quot;</span> &lt;&lt; *DU.WideDef &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      ++NumElimExt;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      DU.NarrowUse-&gt;replaceAllUsesWith(NewDef);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(DU.NarrowUse);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// Now that the extend is gone, we want to expose it&#39;s uses for potential</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// further simplification. We don&#39;t need to directly inform SimplifyIVUsers</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">// of the new users, because their parent IV will be processed later as a</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="comment">// new loop phi. If we preserved IVUsers analysis, we would also want to</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="comment">// push the uses of WideDef here.</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// No further widening is needed. The deceased [sz]ext had done it for us.</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">// Does this user itself evaluate to a recurrence after widening?</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  WidenedRecTy WideAddRec = getExtendedOperandRecurrence(DU);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="keywordflow">if</span> (!WideAddRec.first)</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    WideAddRec = getWideRecurrence(DU);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((WideAddRec.first == <span class="keyword">nullptr</span>) ==</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;         (WideAddRec.second == <a class="code" href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">ExtendKind::Unknown</a>));</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">if</span> (!WideAddRec.first) {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="comment">// If use is a loop condition, try to promote the condition instead of</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">// truncating the IV first.</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordflow">if</span> (widenLoopCompare(DU))</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">// We are here about to generate a truncate instruction that may hurt</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="comment">// performance because the scalar evolution expression computed earlier</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">// in WideAddRec.first does not indicate a polynomial induction expression.</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">// In that case, look at the operands of the use instruction to determine</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">// if we can still widen the use instead of truncating its operand.</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">if</span> (widenWithVariantUse(DU))</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">// This user does not evaluate to a recurrence after widening, so don&#39;t</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="comment">// follow it. Instead insert a Trunc to kill off the original use,</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">// eventually isolating the original narrow IV so it can be removed.</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <a class="code" href="SimplifyIndVar_8cpp.html#a123c351fc07a1cb31db89e554dd6e911">truncateIVUse</a>(DU, DT, LI);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="comment">// Reuse the IV increment that SCEVExpander created as long as it dominates</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="comment">// NarrowUse.</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideUse = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordflow">if</span> (WideAddRec.first == WideIncExpr &amp;&amp;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.hoistIVInc(WideInc, DU.NarrowUse))</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    WideUse = WideInc;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    WideUse = cloneIVUser(DU, WideAddRec.first);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordflow">if</span> (!WideUse)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  }</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="comment">// Evaluation of WideAddRec ensured that the narrow expression could be</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="comment">// extended outside the loop without overflow. This suggests that the wide use</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">// evaluates to the same expression as the extended narrow use, but doesn&#39;t</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="comment">// absolutely guarantee it. Hence the following failsafe check. In rare cases</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="comment">// where it fails, we simply throw away the newly created wide use.</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">if</span> (WideAddRec.first != SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideUse)) {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Wide use expression mismatch: &quot;</span> &lt;&lt; *WideUse &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                      &lt;&lt; *SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideUse) &lt;&lt; <span class="stringliteral">&quot; != &quot;</span> &lt;&lt; *WideAddRec.first</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(WideUse);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">// if we reached this point then we are going to replace</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">// DU.NarrowUse with WideUse. Reattach DbgValue then.</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <a class="code" href="namespacellvm.html#a9784a018b2dd6a85ee8a70f5f5ab3d02">replaceAllDbgUsesWith</a>(*DU.NarrowUse, *WideUse, *WideUse, *DT);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  ExtendKindMap[DU.NarrowUse] = WideAddRec.second;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="comment">// Returning WideUse pushes it on the worklist.</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="keywordflow">return</span> WideUse;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;}</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">/// Add eligible users of NarrowDef to NarrowIVUsers.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> WidenIV::pushNarrowIVUsers(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideDef) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NarrowSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(NarrowDef);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="keywordtype">bool</span> NonNegativeDef =</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a60a56343d06195ae01b61d087e672afd">isKnownPredicate</a>(ICmpInst::ICMP_SGE, NarrowSCEV,</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                           SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a4d5ee57f499d862572c863b9e190884f">getZero</a>(NarrowSCEV-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : NarrowDef-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUser = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; </div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// Handle data flow merges and bizarre phi cycles.</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">if</span> (!Widened.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NarrowUser).second)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordtype">bool</span> NonNegativeUse = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordflow">if</span> (!NonNegativeDef) {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <span class="comment">// We might have a control-dependent range information for this context.</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> RangeInfo = getPostIncRangeInfo(NarrowDef, NarrowUser))</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        NonNegativeUse = RangeInfo-&gt;getSignedMin().isNonNegative();</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    NarrowIVUsers.emplace_back(NarrowDef, NarrowUser, WideDef,</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                               NonNegativeDef || NonNegativeUse);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;}</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">/// Process a single induction variable. First use the SCEVExpander to create a</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">/// wide induction variable that evaluates to the same recurrence as the</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">/// original narrow IV. Then use a worklist to forward traverse the narrow IV&#39;s</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">/// def-use chain. After widenIVUse has processed all interesting IV users, the</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">/// narrow IV will be isolated for removal by DeleteDeadPHIs.</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">/// It would be simpler to delete uses as they are processed, but we must avoid</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">/// invalidating SCEV expressions.</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="namespacellvm.html#a35edc71a3e9b62bcfa5b80ae369515d9">WidenIV::createWideIV</a>(<a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="comment">// Is this phi an induction variable?</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = dyn_cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(OrigPhi));</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="keywordflow">if</span> (!AddRec)</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="comment">// Widen the induction variable expression.</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *WideIVExpr = getExtendKind(OrigPhi) == ExtendKind::Sign</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                               ? SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(AddRec, WideType)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                               : SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">getZeroExtendExpr</a>(AddRec, WideType);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(WideIVExpr-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) == WideType &amp;&amp;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;         <span class="stringliteral">&quot;Expect the new IV expression to preserve its type&quot;</span>);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="comment">// Can the IV be extended outside the loop without overflow?</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  AddRec = dyn_cast&lt;SCEVAddRecExpr&gt;(WideIVExpr);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keywordflow">if</span> (!AddRec || AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != L)</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <span class="comment">// An AddRec must have loop-invariant operands. Since this AddRec is</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="comment">// materialized by a loop header phi, the expression cannot have any post-loop</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="comment">// operands, so they must dominate the loop header.</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ae0d036af111b8aafe90db0771b8e9ce3">properlyDominates</a>(AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>(), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()) &amp;&amp;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ae0d036af111b8aafe90db0771b8e9ce3">properlyDominates</a>(AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()) &amp;&amp;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="stringliteral">&quot;Loop header phi recurrence inputs do not dominate the loop&quot;</span>);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <span class="comment">// Iterate over IV uses (including transitive ones) looking for IV increments</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="comment">// of the form &#39;add nsw %iv, &lt;const&gt;&#39;. For each increment and each use of</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <span class="comment">// the increment calculate control-dependent range information basing on</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="comment">// dominating conditions inside of the loop (e.g. a range check inside of the</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="comment">// loop). Calculated ranges are stored in PostIncRangeInfos map.</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="comment">// Control-dependent range information is later used to prove that a narrow</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  <span class="comment">// definition is not negative (see pushNarrowIVUsers). It&#39;s difficult to do</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="comment">// this on demand because when pushNarrowIVUsers needs this information some</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <span class="comment">// of the dominating conditions might be already widened.</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>)</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    calculatePostIncRanges(OrigPhi);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <span class="comment">// The rewriter provides a value for the desired IV expression. This may</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="comment">// either find an existing phi or materialize a new one. Either way, we</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <span class="comment">// expect a well-formed cyclic phi-with-increments. i.e. any operand not part</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="comment">// of the phi-SCC dominates the loop entry.</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = &amp;*L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>();</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ExpandInst = <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(AddRec, WideType, InsertPt);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <span class="comment">// If the wide phi is not a phi node, for example a cast node, like bitcast,</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="comment">// inttoptr, ptrtoint, just skip for now.</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">if</span> (!(WidePhi = dyn_cast&lt;PHINode&gt;(ExpandInst))) {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="comment">// if the cast node is an inserted instruction without any user, we should</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="comment">// remove it to make sure the pass don&#39;t touch the function as we can not</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="comment">// wide the phi.</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">if</span> (ExpandInst-&gt;<a class="code" href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">hasNUses</a>(0) &amp;&amp;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isInsertedInstruction(cast&lt;Instruction&gt;(ExpandInst)))</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(ExpandInst);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="comment">// Remembering the WideIV increment generated by SCEVExpander allows</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="comment">// widenIVUse to reuse it when widening the narrow IV&#39;s increment. We don&#39;t</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">// employ a general reuse mechanism because the call above is the only call to</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">// SCEVExpander. Henceforth, we produce 1-to-1 narrow to wide uses.</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()) {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    WideInc =</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      cast&lt;Instruction&gt;(WidePhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">getIncomingValueForBlock</a>(LatchBlock));</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    WideIncExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(WideInc);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="comment">// Propagate the debug location associated with the original loop increment</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">// to the new (widened) increment.</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keyword">auto</span> *OrigInc =</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      cast&lt;Instruction&gt;(OrigPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">getIncomingValueForBlock</a>(LatchBlock));</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    WideInc-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(OrigInc-&gt;getDebugLoc());</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  }</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Wide IV: &quot;</span> &lt;&lt; *WidePhi &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  ++NumWidened;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="comment">// Traverse the def-use chain using a worklist starting at the original IV.</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Widened.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">empty</a>() &amp;&amp; NarrowIVUsers.empty() &amp;&amp; <span class="stringliteral">&quot;expect initial state&quot;</span> );</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  Widened.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(OrigPhi);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  pushNarrowIVUsers(OrigPhi, WidePhi);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">while</span> (!NarrowIVUsers.empty()) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    WidenIV::NarrowIVDefUse DU = NarrowIVUsers.pop_back_val();</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">// Process a def-use edge. This may replace the use, so don&#39;t hold a</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">// use_iterator across it.</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WideUse = widenIVUse(DU, <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">// Follow all def-use edges from the previous narrow use.</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">if</span> (WideUse)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      pushNarrowIVUsers(DU.NarrowUse, WideUse);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">// widenIVUse may have removed the def-use edge.</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">if</span> (DU.NarrowDef-&gt;use_empty())</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      DeadInsts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(DU.NarrowDef);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="comment">// Attach any debug information to the new PHI.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <a class="code" href="namespacellvm.html#a9784a018b2dd6a85ee8a70f5f5ab3d02">replaceAllDbgUsesWith</a>(*OrigPhi, *WidePhi, *WidePhi, *DT);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="keywordflow">return</span> WidePhi;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;}</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">/// Calculates control-dependent range for the given def at the given context</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">/// by looking at dominating conditions inside of the loop</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> WidenIV::calculatePostIncRange(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef,</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                                    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowUser) {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NarrowDefLHS;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> *NarrowDefRHS;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(NarrowDef, <a class="code" href="namespacellvm_1_1PatternMatch.html#a321b8e5bfbda0da1e621822399fe3960">m_NSWAdd</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(NarrowDefLHS),</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                                 <a class="code" href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">m_APInt</a>(NarrowDefRHS))) ||</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      !NarrowDefRHS-&gt;<a class="code" href="classllvm_1_1APInt.html#ac8c0157adbe12649beac0009c2f6ad8d">isNonNegative</a>())</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <span class="keyword">auto</span> UpdateRangeFromCondition = [&amp;] (<a class="code" href="classllvm_1_1Value.html">Value</a> *Condition,</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                       <span class="keywordtype">bool</span> TrueDest) {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpRHS;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Condition, <a class="code" href="namespacellvm_1_1PatternMatch.html#a3fe9b3ddb71b9fb53d9fc74b3a0710bf">m_ICmp</a>(Pred, <a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(NarrowDefLHS),</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                                 <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRHS))))</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> =</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            TrueDest ? Pred : <a class="code" href="classllvm_1_1CmpInst.html#aa2a54b545d237ecfe450fd1292f7675e">CmpInst::getInversePredicate</a>(Pred);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keyword">auto</span> CmpRHSRange = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a3498df9755182f44e759fd3eeb688e9f">getSignedRange</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(CmpRHS));</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keyword">auto</span> CmpConstrainedLHSRange =</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            <a class="code" href="classllvm_1_1ConstantRange.html#aa0830ec6778859b4abb3e8bf0b9e0e38">ConstantRange::makeAllowedICmpRegion</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, CmpRHSRange);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="keyword">auto</span> NarrowDefRange = CmpConstrainedLHSRange.addWithNoWrap(</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        *NarrowDefRHS, <a class="code" href="classllvm_1_1OverflowingBinaryOperator.html#af74f626787972439fae0df8f2021ad71ac3172f238278728e355fc9a87c439dd5">OverflowingBinaryOperator::NoSignedWrap</a>);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    updatePostIncRangeInfo(NarrowDef, NarrowUser, NarrowDefRange);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  };</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="keyword">auto</span> UpdateRangeFromGuards = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Ctx) {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordflow">if</span> (!HasGuards)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(Ctx-&gt;getIterator().getReverse(),</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                                     Ctx-&gt;getParent()-&gt;rend())) {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, m_Intrinsic&lt;Intrinsic::experimental_guard&gt;(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))))</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        UpdateRangeFromCondition(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <span class="comment">/*TrueDest=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  };</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  UpdateRangeFromGuards(NarrowUser);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NarrowUserBB = NarrowUser-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="comment">// If NarrowUserBB is statically unreachable asking dominator queries may</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="comment">// yield surprising results. (e.g. the block may not have a dom tree node)</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="keywordflow">if</span> (!DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">isReachableFromEntry</a>(NarrowUserBB))</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DTB = (*DT)[NarrowUserBB]-&gt;getIDom();</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;       L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(DTB-&gt;getBlock());</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;       DTB = DTB-&gt;getIDom()) {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = DTB-&gt;getBlock();</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keyword">auto</span> *TI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    UpdateRangeFromGuards(TI);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keyword">auto</span> *BI = dyn_cast&lt;BranchInst&gt;(TI);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">if</span> (!BI || !BI-&gt;isConditional())</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keyword">auto</span> *TrueSuccessor = BI-&gt;getSuccessor(0);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keyword">auto</span> *FalseSuccessor = BI-&gt;getSuccessor(1);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keyword">auto</span> DominatesNarrowUser = [<span class="keyword">this</span>, NarrowUser] (<a class="code" href="classllvm_1_1BasicBlockEdge.html">BasicBlockEdge</a> BBE) {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">return</span> BBE.isSingleEdge() &amp;&amp;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;             DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(BBE, NarrowUser-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>());</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    };</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span> (DominatesNarrowUser(<a class="code" href="classllvm_1_1BasicBlockEdge.html">BasicBlockEdge</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, TrueSuccessor)))</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      UpdateRangeFromCondition(BI-&gt;getCondition(), <span class="comment">/*TrueDest=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">if</span> (DominatesNarrowUser(<a class="code" href="classllvm_1_1BasicBlockEdge.html">BasicBlockEdge</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, FalseSuccessor)))</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      UpdateRangeFromCondition(BI-&gt;getCondition(), <span class="comment">/*TrueDest=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  }</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;}</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">/// Calculates PostIncRangeInfos map for the given IV</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> WidenIV::calculatePostIncRanges(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OrigPhi) {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 16&gt;</a> Visited;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 6&gt;</a> Worklist;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  Worklist.push_back(OrigPhi);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(OrigPhi);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NarrowDef = Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : NarrowDef-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>()) {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keyword">auto</span> *NarrowUser = cast&lt;Instruction&gt;(U.getUser());</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="comment">// Don&#39;t go looking outside the current loop.</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="keyword">auto</span> *NarrowUserLoop = (*LI)[NarrowUser-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()];</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keywordflow">if</span> (!NarrowUserLoop || !L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(NarrowUserLoop))</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <span class="keywordflow">if</span> (!Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NarrowUser).second)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      Worklist.push_back(NarrowUser);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      calculatePostIncRange(NarrowDef, NarrowUser);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;}</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"><a class="line" href="namespacellvm.html#a35edc71a3e9b62bcfa5b80ae369515d9"> 2085</a></span>&#160;<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="namespacellvm.html#a35edc71a3e9b62bcfa5b80ae369515d9">llvm::createWideIV</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1WideIVInfo.html">WideIVInfo</a> &amp;WI,</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>,</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts,</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keywordtype">unsigned</span> &amp;NumElimExt, <span class="keywordtype">unsigned</span> &amp;NumWidened,</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordtype">bool</span> HasGuards, <span class="keywordtype">bool</span> <a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <a class="code" href="LoopFlatten_8cpp.html#a4aa9efb1877c0a4aa735be1395c60637">WidenIV</a> Widener(WI, LI, SE, DT, DeadInsts, HasGuards, <a class="code" href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a>);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *WidePHI = Widener.createWideIV(<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  NumElimExt = Widener.getNumElimExt();</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  NumWidened = Widener.getNumWidened();</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">return</span> WidePHI;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOpIntrinsic_html_aa73e62aac1753cb7b3c3aaccef3df8b1"><div class="ttname"><a href="classllvm_1_1BinaryOpIntrinsic.html#aa73e62aac1753cb7b3c3aaccef3df8b1">llvm::BinaryOpIntrinsic::getBinaryOp</a></div><div class="ttdeci">Instruction::BinaryOps getBinaryOp() const</div><div class="ttdoc">Returns the binary operation underlying the intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8cpp_source.html#l00752">IntrinsicInst.cpp:752</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a6cb6a58fb0ded82b4c7755fc4c27c86d"><div class="ttname"><a href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">llvm::Loop::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const Value *V) const</div><div class="ttdoc">Return true if the specified value is loop invariant.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00060">LoopInfo.cpp:60</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a49a2d8f483ea08a3d6ea75f90c640d76"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a49a2d8f483ea08a3d6ea75f90c640d76">llvm::CmpInst::getSwappedPredicate</a></div><div class="ttdeci">Predicate getSwappedPredicate() const</div><div class="ttdoc">For example, EQ-&gt;EQ, SLE-&gt;SGE, ULT-&gt;UGT, OEQ-&gt;OEQ, ULE-&gt;UGE, OLT-&gt;OGT, etc.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00859">InstrTypes.h:859</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a083bb1deb1d2ba244a99ceae9e734bc1"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">llvm::ScalarEvolution::getNegativeSCEV</a></div><div class="ttdeci">const SCEV * getNegativeSCEV(const SCEV *V, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdoc">Return the SCEV object corresponding to -V.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04556">ScalarEvolution.cpp:4556</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_html_a35edc71a3e9b62bcfa5b80ae369515d9"><div class="ttname"><a href="namespacellvm.html#a35edc71a3e9b62bcfa5b80ae369515d9">llvm::createWideIV</a></div><div class="ttdeci">PHINode * createWideIV(const WideIVInfo &amp;WI, LoopInfo *LI, ScalarEvolution *SE, SCEVExpander &amp;Rewriter, DominatorTree *DT, SmallVectorImpl&lt; WeakTrackingVH &gt; &amp;DeadInsts, unsigned &amp;NumElimExt, unsigned &amp;NumWidened, bool HasGuards, bool UsePostIncrementRanges)</div><div class="ttdoc">Widen Induction Variables - Extend the width of an IV to cover its widest uses.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l02085">SimplifyIndVar.cpp:2085</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdeci">@ Def</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdeci">@ ICMP_EQ</div><div class="ttdoc">equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00739">InstrTypes.h:739</a></div></div>
<div class="ttc" id="aclassllvm_1_1IVVisitor_html_a366cbb9ce621c37ddb186c0813e60f22"><div class="ttname"><a href="classllvm_1_1IVVisitor.html#a366cbb9ce621c37ddb186c0813e60f22">llvm::IVVisitor::visitCast</a></div><div class="ttdeci">virtual void visitCast(CastInst *Cast)=0</div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6dcfa69ce27cf214caaf50f21bfe1f2f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6dcfa69ce27cf214caaf50f21bfe1f2f">llvm::ScalarEvolution::getEffectiveSCEVType</a></div><div class="ttdeci">Type * getEffectiveSCEVType(Type *Ty) const</div><div class="ttdoc">Return a type with the same bitwidth as the given type and which represents how SCEV will treat the g...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04437">ScalarEvolution.cpp:4437</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdoc">This enumeration lists the possible predicates for CmpInst subclasses.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00718">InstrTypes.h:718</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aAMDGPURewriteUndefForPHI_8cpp_html_a2e83cb1bc3f5e8986cbd14575755a134"><div class="ttname"><a href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div><div class="ttdeci">Rewrite undef for PHI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURewriteUndefForPHI_8cpp_source.html#l00101">AMDGPURewriteUndefForPHI.cpp:101</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_a59f39a75e16788ecd95f9fb94c918c4d"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#a59f39a75e16788ecd95f9fb94c918c4d">findCommonDominator</a></div><div class="ttdeci">static Instruction * findCommonDominator(ArrayRef&lt; Instruction * &gt; Instructions, DominatorTree &amp;DT)</div><div class="ttdoc">Find a point in code which dominates all given instructions.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00106">SimplifyIndVar.cpp:106</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aScalarEvolutionExpander_8h_html"><div class="ttname"><a href="ScalarEvolutionExpander_8h.html">ScalarEvolutionExpander.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a1d3a0e869e478018c481a577ed9d25ee"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">llvm::SCEVAddRecExpr::getStart</a></div><div class="ttdeci">const SCEV * getStart() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00341">ScalarEvolutionExpressions.h:341</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a04337b572d34ea413c35dbac5d75530b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const</div><div class="ttdoc">Return true if the specified loop is contained within in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aa08fee11e8a5ec10c0cc2a7abbbd799a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aa08fee11e8a5ec10c0cc2a7abbbd799a">llvm::PatternMatch::m_LShr</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::LShr &gt; m_LShr(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01117">PatternMatch.h:1117</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpander_html"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html">llvm::SCEVExpander</a></div><div class="ttdoc">This class uses information about analyze scalars to rewrite expressions in canonical form.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00050">ScalarEvolutionExpander.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOpIntrinsic_html_a6822c506d77c8ba56e85bee5cd1ed01b"><div class="ttname"><a href="classllvm_1_1BinaryOpIntrinsic.html#a6822c506d77c8ba56e85bee5cd1ed01b">llvm::BinaryOpIntrinsic::getRHS</a></div><div class="ttdeci">Value * getRHS() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00757">IntrinsicInst.h:757</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_a123c351fc07a1cb31db89e554dd6e911"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#a123c351fc07a1cb31db89e554dd6e911">truncateIVUse</a></div><div class="ttdeci">static void truncateIVUse(WidenIV::NarrowIVDefUse DU, DominatorTree *DT, LoopInfo *LI)</div><div class="ttdoc">This IV user cannot be widened.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l01442">SimplifyIndVar.cpp:1442</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOpIntrinsic_html_a8818b44063f9f3339d4ced72bd76b107"><div class="ttname"><a href="classllvm_1_1BinaryOpIntrinsic.html#a8818b44063f9f3339d4ced72bd76b107">llvm::BinaryOpIntrinsic::getLHS</a></div><div class="ttdeci">Value * getLHS() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00756">IntrinsicInst.h:756</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdoc">The main scalar evolution driver.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00452">ScalarEvolution.h:452</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa2a54b545d237ecfe450fd1292f7675e"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa2a54b545d237ecfe450fd1292f7675e">llvm::CmpInst::getInversePredicate</a></div><div class="ttdeci">Predicate getInversePredicate() const</div><div class="ttdoc">For example, EQ -&gt; NE, UGT -&gt; ULE, SLT -&gt; SGE, OEQ -&gt; UNE, UGT -&gt; OLE, OLT -&gt; UGE,...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00832">InstrTypes.h:832</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a2c96114e89e8cf2122ebe8bc4d929c7c"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a2c96114e89e8cf2122ebe8bc4d929c7c">llvm::ScalarEvolution::getTypeSizeInBits</a></div><div class="ttdeci">uint64_t getTypeSizeInBits(Type *Ty) const</div><div class="ttdoc">Return the size in bits of the specified type, for which isSCEVable must return true.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04427">ScalarEvolution.cpp:4427</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html_a9d5f70171d811078c4d263811f13c121"><div class="ttname"><a href="classllvm_1_1ICmpInst.html#a9d5f70171d811078c4d263811f13c121">llvm::ICmpInst::getSignedPredicate</a></div><div class="ttdeci">Predicate getSignedPredicate() const</div><div class="ttdoc">For example, EQ-&gt;EQ, SLE-&gt;SLE, UGT-&gt;SGT, etc.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01264">Instructions.h:1264</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aMSA_8txt_html_ab49a28dbe60da0a607449e5308b1ec3f"><div class="ttname"><a href="MSA_8txt.html#ab49a28dbe60da0a607449e5308b1ec3f">Instructions</a></div><div class="ttdeci">Code Generation Notes for reduce the size of the ISel and reduce repetition in the implementation In a small number of this can cause even when no optimisation has taken place Instructions</div><div class="ttdef"><b>Definition:</b> <a href="MSA_8txt_source.html#l00011">MSA.txt:11</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlockEdge_html"><div class="ttname"><a href="classllvm_1_1BasicBlockEdge.html">llvm::BasicBlockEdge</a></div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00098">Dominators.h:98</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0c03b71c79206ec41270dc3788183e0d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0c03b71c79206ec41270dc3788183e0d">llvm::Instruction::setHasNoUnsignedWrap</a></div><div class="ttdeci">void setHasNoUnsignedWrap(bool b=true)</div><div class="ttdoc">Set or clear the nuw flag on this instruction, which must be an operator which supports this flag.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00161">Instruction.cpp:161</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a53408c95a7bfb5443b43fb2134c3eb23"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">Return 1 if the specified key is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00145">DenseMap.h:145</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a64153676e101a130bbbaaf91635d253a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a64153676e101a130bbbaaf91635d253a">llvm::PatternMatch::m_AShr</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::AShr &gt; m_AShr(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01123">PatternMatch.h:1123</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1OverflowingBinaryOperator_html_a95474ea140862464db7ea0580f01eae9"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#a95474ea140862464db7ea0580f01eae9">llvm::OverflowingBinaryOperator::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const</div><div class="ttdoc">Test whether this operation is known to never undergo unsigned overflow, aka the nuw property.</div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00099">Operator.h:99</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ac01940f561517355e394911c203bcedf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac01940f561517355e394911c203bcedf">llvm::Instruction::setIsExact</a></div><div class="ttdeci">void setIsExact(bool b=true)</div><div class="ttdoc">Set or clear the exact flag on this instruction, which must be an operator which supports this flag.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00169">Instruction.cpp:169</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html_aa0830ec6778859b4abb3e8bf0b9e0e38"><div class="ttname"><a href="classllvm_1_1ConstantRange.html#aa0830ec6778859b4abb3e8bf0b9e0e38">llvm::ConstantRange::makeAllowedICmpRegion</a></div><div class="ttdeci">static ConstantRange makeAllowedICmpRegion(CmpInst::Predicate Pred, const ConstantRange &amp;Other)</div><div class="ttdoc">Produce the smallest range such that all values that may satisfy the given predicate with any value c...</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8cpp_source.html#l00097">ConstantRange.cpp:97</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="astructllvm_1_1WideIVInfo_html"><div class="ttname"><a href="structllvm_1_1WideIVInfo.html">llvm::WideIVInfo</a></div><div class="ttdoc">Collect information about induction variables that are used by sign/zero extend operations.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8h_source.html#l00064">SimplifyIndVar.h:64</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a372f87e2cac1c83389c98554dc44806da807dbe7d1c25a633894d4a231b1c76d3"><div class="ttname"><a href="namespacellvm.html#a372f87e2cac1c83389c98554dc44806da807dbe7d1c25a633894d4a231b1c76d3">llvm::SubDirectoryType::Bin</a></div><div class="ttdeci">@ Bin</div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">llvm::AArch64CC::LT</a></div><div class="ttdeci">@ LT</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00266">AArch64BaseInfo.h:266</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ad299b0f4378f644f67168c72c763716f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ad299b0f4378f644f67168c72c763716f">llvm::ScalarEvolution::getMulExpr</a></div><div class="ttdeci">const SCEV * getMulExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Get a canonical multiply expression, or something simpler if possible.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l03132">ScalarEvolution.cpp:3132</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ae0d036af111b8aafe90db0771b8e9ce3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ae0d036af111b8aafe90db0771b8e9ce3">llvm::ScalarEvolution::properlyDominates</a></div><div class="ttdeci">bool properlyDominates(const SCEV *S, const BasicBlock *BB)</div><div class="ttdoc">Return true if elements that makes up the given SCEV properly dominate the specified basic block.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l13861">ScalarEvolution.cpp:13861</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aac9e78b3aa02ec087c4621358f506718"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">llvm::PatternMatch::m_APInt</a></div><div class="ttdeci">apint_match m_APInt(const APInt *&amp;Res)</div><div class="ttdoc">Match a ConstantInt or splatted ConstantVector, binding the specified pointer to the contained APInt.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00278">PatternMatch.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_af4b1ccc0b78f9da9f3f3944e06007f1d"><div class="ttname"><a href="classllvm_1_1APInt.html#af4b1ccc0b78f9da9f3f3944e06007f1d">llvm::APInt::uge</a></div><div class="ttdeci">bool uge(const APInt &amp;RHS) const</div><div class="ttdoc">Unsigned greater or equal comparison.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01199">APInt.h:1199</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a62733c3335a87750623dbfc5b3ae4f6c"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a62733c3335a87750623dbfc5b3ae4f6c">llvm::LoopBase::getParentLoop</a></div><div class="ttdeci">LoopT * getParentLoop() const</div><div class="ttdoc">Return the parent loop if it exists or nullptr for top level loops.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00114">LoopInfo.h:114</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_ac8c0157adbe12649beac0009c2f6ad8d"><div class="ttname"><a href="classllvm_1_1APInt.html#ac8c0157adbe12649beac0009c2f6ad8d">llvm::APInt::isNonNegative</a></div><div class="ttdeci">bool isNonNegative() const</div><div class="ttdoc">Determine if this APInt Value is non-negative (&gt;= 0)</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00317">APInt.h:317</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_aa55fb74dd22008fdcc26a63f44576022"><div class="ttname"><a href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">llvm::SelectInst::Create</a></div><div class="ttdeci">static SelectInst * Create(Value *C, Value *S1, Value *S2, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr, Instruction *MDFrom=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01777">Instructions.h:1777</a></div></div>
<div class="ttc" id="aVirtRegMap_8cpp_html_a1ad52109a2ff430460c8776286b97b2e"><div class="ttname"><a href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a></div><div class="ttdeci">Virtual Register Rewriter</div><div class="ttdef"><b>Definition:</b> <a href="VirtRegMap_8cpp_source.html#l00237">VirtRegMap.cpp:237</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4166b451a572b1e5d3fea7250af53653"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4166b451a572b1e5d3fea7250af53653">llvm::Instruction::setHasNoSignedWrap</a></div><div class="ttdeci">void setHasNoSignedWrap(bool b=true)</div><div class="ttdoc">Set or clear the nsw flag on this instruction, which must be an operator which supports this flag.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00165">Instruction.cpp:165</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html_a4d69e164b5fb0f73a15a07119c4302f7"><div class="ttname"><a href="classllvm_1_1ConstantRange.html#a4d69e164b5fb0f73a15a07119c4302f7">llvm::ConstantRange::getUnsignedMin</a></div><div class="ttdeci">APInt getUnsignedMin() const</div><div class="ttdoc">Return the smallest unsigned value contained in the ConstantRange.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8cpp_source.html#l00428">ConstantRange.cpp:428</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_1_1JumpTable_html_ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a"><div class="ttname"><a href="namespacellvm_1_1JumpTable.html#ae69658c09df17591f8b1c3e95b879b5ca99c267524f12efe8cf927389e02d506a">llvm::JumpTable::Simplified</a></div><div class="ttdeci">@ Simplified</div><div class="ttdef"><b>Definition:</b> <a href="TargetOptions_8h_source.html#l00047">TargetOptions.h:47</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6c03d18ed744dc3b34829ec5485a68b0"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6c03d18ed744dc3b34829ec5485a68b0">llvm::ScalarEvolution::getUDivExpr</a></div><div class="ttdeci">const SCEV * getUDivExpr(const SCEV *LHS, const SCEV *RHS)</div><div class="ttdoc">Get a canonical unsigned division expression, or something simpler if possible.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l03427">ScalarEvolution.cpp:3427</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1PALMD_html_af892c75285b0f64d58ca76cb73059adf"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">llvm::AMDGPU::PALMD::Key</a></div><div class="ttdeci">Key</div><div class="ttdoc">PAL metadata keys.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00486">AMDGPUMetadata.h:486</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_aecb93439702247fe5353a9966f7cefcd"><div class="ttname"><a href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">llvm::Value::uses</a></div><div class="ttdeci">iterator_range&lt; use_iterator &gt; uses()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00376">Value.h:376</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_adfb61ffe25c950c75c86310245b3ef39"><div class="ttname"><a href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">llvm::PHINode::getIncomingValueForBlock</a></div><div class="ttdeci">Value * getIncomingValueForBlock(const BasicBlock *BB) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02889">Instructions.h:2889</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_afa0b2fa29ba074f2b6ec9ac11163f2d9"><div class="ttname"><a href="classllvm_1_1Instruction.html#afa0b2fa29ba074f2b6ec9ac11163f2d9">llvm::Instruction::CastOps</a></div><div class="ttdeci">CastOps</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00823">Instruction.h:823</a></div></div>
<div class="ttc" id="aclassllvm_1_1SaturatingInst_html"><div class="ttname"><a href="classllvm_1_1SaturatingInst.html">llvm::SaturatingInst</a></div><div class="ttdoc">Represents a saturating add/sub intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00791">IntrinsicInst.h:791</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a31bf07f3f61525486633bc1d0bbaf029"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00391">InstrTypes.h:391</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a60a56343d06195ae01b61d087e672afd"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a60a56343d06195ae01b61d087e672afd">llvm::ScalarEvolution::isKnownPredicate</a></div><div class="ttdeci">bool isKnownPredicate(ICmpInst::Predicate Pred, const SCEV *LHS, const SCEV *RHS)</div><div class="ttdoc">Test if the given expression is known to satisfy the condition described by Pred, LHS,...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l10904">ScalarEvolution.cpp:10904</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="astructllvm_1_1WideIVInfo_html_a45b4503c5e229503d60cc68c034286ab"><div class="ttname"><a href="structllvm_1_1WideIVInfo.html#a45b4503c5e229503d60cc68c034286ab">llvm::WideIVInfo::IsSigned</a></div><div class="ttdeci">bool IsSigned</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8h_source.html#l00071">SimplifyIndVar.h:71</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a9d7de807ebdfe1819df3ff6cb0f16158"><div class="ttname"><a href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00344">Value.h:344</a></div></div>
<div class="ttc" id="aErlangGCPrinter_8cpp_html_a74b474c0616ab55c1d9487f11fd31d26"><div class="ttname"><a href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; ErlangGCPrinter &gt; X(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a321b8e5bfbda0da1e621822399fe3960"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a321b8e5bfbda0da1e621822399fe3960">llvm::PatternMatch::m_NSWAdd</a></div><div class="ttdeci">OverflowingBinaryOp_match&lt; LHS, RHS, Instruction::Add, OverflowingBinaryOperator::NoSignedWrap &gt; m_NSWAdd(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01156">PatternMatch.h:1156</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a30bd18ac905eacf3601bc6a553a9ff49"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">llvm::ScalarEvolution::getSCEV</a></div><div class="ttdeci">const SCEV * getSCEV(Value *V)</div><div class="ttdoc">Return a SCEV expression for the full generality of the specified expression.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04534">ScalarEvolution.cpp:4534</a></div></div>
<div class="ttc" id="anamespacellvm_html_a85635b30e25b4f5742866a8b074e3684"><div class="ttname"><a href="namespacellvm.html#a85635b30e25b4f5742866a8b074e3684">llvm::simplifyUsersOfIV</a></div><div class="ttdeci">bool simplifyUsersOfIV(PHINode *CurrIV, ScalarEvolution *SE, DominatorTree *DT, LoopInfo *LI, const TargetTransformInfo *TTI, SmallVectorImpl&lt; WeakTrackingVH &gt; &amp;Dead, SCEVExpander &amp;Rewriter, IVVisitor *V=nullptr)</div><div class="ttdoc">simplifyUsersOfIV - Simplify instructions that use this induction variable by using ScalarEvolution t...</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00959">SimplifyIndVar.cpp:959</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_aec662ee6ab1490a4cabebf2812e5b9ca"><div class="ttname"><a href="classllvm_1_1APInt.html#aec662ee6ab1490a4cabebf2812e5b9ca">llvm::APInt::getOneBitSet</a></div><div class="ttdeci">static APInt getOneBitSet(unsigned numBits, unsigned BitNo)</div><div class="ttdoc">Return an APInt with exactly one bit set in the result.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00222">APInt.h:222</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_af8a50544090e81ac83601aff8f4b0142"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">llvm::SmallPtrSetImplBase::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00092">SmallPtrSet.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdoc">This class represents an analyzed expression in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00075">ScalarEvolution.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ad9b99a13e459cb18bb386ddd610ecf8c"><div class="ttname"><a href="classllvm_1_1Type.html#ad9b99a13e459cb18bb386ddd610ecf8c">llvm::Type::getFPMantissaWidth</a></div><div class="ttdeci">int getFPMantissaWidth() const</div><div class="ttdoc">Return the width of the mantissa of this type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00193">Type.cpp:193</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html_af07a09f1cda33d984cc725dc9e856d40"><div class="ttname"><a href="classllvm_1_1ICmpInst.html#af07a09f1cda33d984cc725dc9e856d40">llvm::ICmpInst::getUnsignedPredicate</a></div><div class="ttdeci">Predicate getUnsignedPredicate() const</div><div class="ttdoc">For example, EQ-&gt;EQ, SLE-&gt;ULE, UGT-&gt;UGT, etc.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01276">Instructions.h:1276</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">llvm::MipsISD::Ext</a></div><div class="ttdeci">@ Ext</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00159">MipsISelLowering.h:159</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_a792469fbe5b7107d9e230d2874a8015a"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#a792469fbe5b7107d9e230d2874a8015a">pushIVUsers</a></div><div class="ttdeci">static void pushIVUsers(Instruction *Def, Loop *L, SmallPtrSet&lt; Instruction *, 16 &gt; &amp;Simplified, SmallVectorImpl&lt; std::pair&lt; Instruction *, Instruction * &gt; &gt; &amp;SimpleIVUsers)</div><div class="ttdoc">Add all uses of Def to the current IV's worklist.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00811">SimplifyIndVar.cpp:811</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">This instruction compares its operands according to the predicate given to the constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01197">Instructions.h:1197</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOpIntrinsic_html_a814f3097eebe0236748fcc2ab5ce59d5"><div class="ttname"><a href="classllvm_1_1BinaryOpIntrinsic.html#a814f3097eebe0236748fcc2ab5ce59d5">llvm::BinaryOpIntrinsic::isSigned</a></div><div class="ttdeci">bool isSigned() const</div><div class="ttdoc">Whether the intrinsic is signed or unsigned.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8cpp_source.html#l00772">IntrinsicInst.cpp:772</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a434cfa04e4ed34b7a901378557d4ca9eab5923ebc864d1679cf1c3a929c122037">llvm::pdb::Unknown</a></div><div class="ttdeci">@ Unknown</div><div class="ttdef"><b>Definition:</b> <a href="PDBTypes_8h_source.html#l00396">PDBTypes.h:396</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a9bf617fd3367180fb96cebccfaae8dfa"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a></div><div class="ttdeci">static GCRegistry::Add&lt; StatepointGC &gt; D(&quot;statepoint-example&quot;, &quot;an example strategy for statepoint&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1TruncInst_html"><div class="ttname"><a href="classllvm_1_1TruncInst.html">llvm::TruncInst</a></div><div class="ttdoc">This class represents a truncation of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04813">Instructions.h:4813</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aCorrelatedValuePropagation_8cpp_html_aad75d6f4f14a7b791076c6785aa59be4a88183b946cc5f0e8c96b2e66e1c74a7e"><div class="ttname"><a href="CorrelatedValuePropagation_8cpp.html#aad75d6f4f14a7b791076c6785aa59be4a88183b946cc5f0e8c96b2e66e1c74a7e">Domain::Unknown</a></div><div class="ttdeci">@ Unknown</div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_af43000d4dcb7d6d63cb6e36933ed3f6fa2f7a8775a783f7ea3ad24b3f9cb5d949"><div class="ttname"><a href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6fa2f7a8775a783f7ea3ad24b3f9cb5d949">llvm::SCEV::FlagNSW</a></div><div class="ttdeci">@ FlagNSW</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00134">ScalarEvolution.h:134</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a7a7c8e0e4f836c13c015b62e18f386bd"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">llvm::LoopInfoBase::getLoopFor</a></div><div class="ttdeci">LoopT * getLoopFor(const BlockT *BB) const</div><div class="ttdoc">Return the inner most loop that BB lives in.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00992">LoopInfo.h:992</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ac3280e7f76f955403fe17eacf126b90d"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const</div><div class="ttdoc">If there is a preheader for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00183">LoopInfoImpl.h:183</a></div></div>
<div class="ttc" id="anamespacellvm_html_a837209d51e75f7afcfdf457b20e59493"><div class="ttname"><a href="namespacellvm.html#a837209d51e75f7afcfdf457b20e59493">llvm::SCEVCheapExpansionBudget</a></div><div class="ttdeci">cl::opt&lt; unsigned &gt; SCEVCheapExpansionBudget</div></div>
<div class="ttc" id="aclassllvm_1_1IVVisitor_html"><div class="ttname"><a href="classllvm_1_1IVVisitor.html">llvm::IVVisitor</a></div><div class="ttdoc">Interface for visiting interesting IV users that are recognized but not simplified by this utility.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8h_source.html#l00034">SimplifyIndVar.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html_abe8988eef2e6fc2baba032cb22afedd7"><div class="ttname"><a href="classllvm_1_1ICmpInst.html#abe8988eef2e6fc2baba032cb22afedd7">llvm::ICmpInst::isEquality</a></div><div class="ttdeci">static bool isEquality(Predicate P)</div><div class="ttdoc">Return true if this predicate is either EQ or NE.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01286">Instructions.h:1286</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1230fd674d2609b96527fe65eaf40b1b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const</div><div class="ttdoc">If there is a single latch block for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00232">LoopInfoImpl.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a1a70f2c359aadd76a72aaaede16aca4a"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">llvm::DominatorTree::isReachableFromEntry</a></div><div class="ttdeci">bool isReachableFromEntry(const Use &amp;U) const</div><div class="ttdoc">Provide an overload for a Use.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00335">Dominators.cpp:335</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0d69e81725c10fa5407f0bf34462068"><div class="ttname"><a href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">llvm::TTI</a></div><div class="ttdeci">TargetTransformInfo TTI</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00191">TargetTransformInfo.h:191</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9784a018b2dd6a85ee8a70f5f5ab3d02"><div class="ttname"><a href="namespacellvm.html#a9784a018b2dd6a85ee8a70f5f5ab3d02">llvm::replaceAllDbgUsesWith</a></div><div class="ttdeci">bool replaceAllDbgUsesWith(Instruction &amp;From, Value &amp;To, Instruction &amp;DomPoint, DominatorTree &amp;DT)</div><div class="ttdoc">Point debug users of From to To or salvage them.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02171">Local.cpp:2171</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a51d9710fffc66dd4c9aab84af5978e1e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a51d9710fffc66dd4c9aab84af5978e1e">llvm::ScalarEvolution::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Return the DataLayout associated with the module this SCEV instance is operating on.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l01248">ScalarEvolution.h:1248</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ZExtInst_html"><div class="ttname"><a href="classllvm_1_1ZExtInst.html">llvm::ZExtInst</a></div><div class="ttdoc">This class represents zero extension of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04852">Instructions.h:4852</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00174">User.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">llvm::CmpInst::ICMP_SLT</a></div><div class="ttdeci">@ ICMP_SLT</div><div class="ttdoc">signed less than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00747">InstrTypes.h:747</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a627b2f86ac433d829482d5a5a0f50668"><div class="ttname"><a href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">llvm::isInstructionTriviallyDead</a></div><div class="ttdeci">bool isInstructionTriviallyDead(Instruction *I, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if the result produced by the instruction is not used, and the instruction will return.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00398">Local.cpp:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00187">InstrTypes.h:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ab26bea71791cf347c631d2072e41cfb5"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ab26bea71791cf347c631d2072e41cfb5">llvm::ScalarEvolution::getSignExtendExpr</a></div><div class="ttdeci">const SCEV * getSignExtendExpr(const SCEV *Op, Type *Ty, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l01931">ScalarEvolution.cpp:1931</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_ae0f503db91504a3f3440ab81260e4134"><div class="ttname"><a href="X86PartialReduction_8cpp.html#ae0f503db91504a3f3440ab81260e4134">Mul</a></div><div class="ttdeci">BinaryOperator * Mul</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00070">X86PartialReduction.cpp:70</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_a13e91d69fbcc25b109648b284e241418"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#a13e91d69fbcc25b109648b284e241418">getInsertPointForUses</a></div><div class="ttdeci">static Instruction * getInsertPointForUses(Instruction *User, Value *Def, DominatorTree *DT, LoopInfo *LI)</div><div class="ttdoc">Determine the insertion point for this user.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l01127">SimplifyIndVar.cpp:1127</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">llvm::CmpInst::ICMP_ULT</a></div><div class="ttdeci">@ ICMP_ULT</div><div class="ttdoc">unsigned less than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00743">InstrTypes.h:743</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">llvm::logicalview::LVAttributeKind::Zero</a></div><div class="ttdeci">@ Zero</div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_a3e219df8a1368668aa0aac77616a4ce9"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#a3e219df8a1368668aa0aac77616a4ce9">isSimpleIVUser</a></div><div class="ttdeci">static bool isSimpleIVUser(Instruction *I, const Loop *L, ScalarEvolution *SE)</div><div class="ttdoc">Return true if this instruction generates a simple SCEV expression in terms of that IV.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00845">SimplifyIndVar.cpp:845</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aBasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00806">BasicAliasAnalysis.cpp:806</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382"><div class="ttname"><a href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">llvm::SCEV::FlagNUW</a></div><div class="ttdeci">@ FlagNUW</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00133">ScalarEvolution.h:133</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_ae58027d845fb948a63a8ff44851699d5"><div class="ttname"><a href="classllvm_1_1Loop.html#ae58027d845fb948a63a8ff44851699d5">llvm::Loop::makeLoopInvariant</a></div><div class="ttdeci">bool makeLoopInvariant(Value *V, bool &amp;Changed, Instruction *InsertPt=nullptr, MemorySSAUpdater *MSSAU=nullptr, ScalarEvolution *SE=nullptr) const</div><div class="ttdoc">If the given value is an instruction inside of the loop and it can be hoisted, do so to make it trivi...</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00070">LoopInfo.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1OverflowingBinaryOperator_html"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html">llvm::OverflowingBinaryOperator</a></div><div class="ttdoc">Utility class for integer operators which may exhibit overflow - Add, Sub, Mul, and Shl.</div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00075">Operator.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">This is the base class for all instructions that perform data casts.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00428">InstrTypes.h:428</a></div></div>
<div class="ttc" id="aclassllvm_1_1WithOverflowInst_html"><div class="ttname"><a href="classllvm_1_1WithOverflowInst.html">llvm::WithOverflowInst</a></div><div class="ttdoc">Represents an op.with.overflow intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00770">IntrinsicInst.h:770</a></div></div>
<div class="ttc" id="aclassllvm_1_1SExtInst_html"><div class="ttname"><a href="classllvm_1_1SExtInst.html">llvm::SExtInst</a></div><div class="ttdoc">This class represents a sign extension of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04891">Instructions.h:4891</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a99f811d53704275b4158c62a2dd138d9"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00207">DenseMap.h:207</a></div></div>
<div class="ttc" id="aLoopFlatten_8cpp_html_a4aa9efb1877c0a4aa735be1395c60637"><div class="ttname"><a href="LoopFlatten_8cpp.html#a4aa9efb1877c0a4aa735be1395c60637">WidenIV</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; WidenIV(&quot;loop-flatten-widen-iv&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Widen the loop induction variables, if possible, so &quot; &quot;overflow checks won't reject flattening&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l01172">SimplifyIndVar.cpp:1172</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa7cce62ac5cc6df09cce0535874336b7"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">llvm::ConstantInt::getFalse</a></div><div class="ttdeci">static ConstantInt * getFalse(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00842">Constants.cpp:842</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_ad070b1d2a764cc2585ed9b892b48b632"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#ad070b1d2a764cc2585ed9b892b48b632">GetLoopInvariantInsertPosition</a></div><div class="ttdeci">static Instruction * GetLoopInvariantInsertPosition(Loop *L, Instruction *Hint)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00610">SimplifyIndVar.cpp:610</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_adfe987ba0fa56ab9ecdb606c2462b6b9"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#adfe987ba0fa56ab9ecdb606c2462b6b9">llvm::ScalarEvolution::maskFlags</a></div><div class="ttdeci">static SCEV::NoWrapFlags maskFlags(SCEV::NoWrapFlags Flags, int Mask)</div><div class="ttdoc">Convenient NoWrapFlags manipulation that hides enum casts and is visible in the ScalarEvolution name ...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00472">ScalarEvolution.h:472</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_af6314c51a3cc5a619beb697246177bf0"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00342">ScalarEvolutionExpressions.h:342</a></div></div>
<div class="ttc" id="aAArch64MIPeepholeOpt_8cpp_html_a96d5dc120196819fbfbc257cba09b2aa"><div class="ttname"><a href="AArch64MIPeepholeOpt_8cpp.html#a96d5dc120196819fbfbc257cba09b2aa">Insn</a></div><div class="ttdeci">SmallVector&lt; AArch64_IMM::ImmInsnModel, 4 &gt; Insn</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MIPeepholeOpt_8cpp_source.html#l00129">AArch64MIPeepholeOpt.cpp:129</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a4daf873f99d8d423c92a951331de5185"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a4daf873f99d8d423c92a951331de5185">llvm::ScalarEvolution::isKnownPredicateAt</a></div><div class="ttdeci">bool isKnownPredicateAt(ICmpInst::Predicate Pred, const SCEV *LHS, const SCEV *RHS, const Instruction *CtxI)</div><div class="ttdoc">Test if the given expression is known to satisfy the condition described by Pred, LHS,...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l10929">ScalarEvolution.cpp:10929</a></div></div>
<div class="ttc" id="anamespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00050">GraphWriter.h:50</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00851">BitVector.h:851</a></div></div>
<div class="ttc" id="aclassllvm_1_1OverflowingBinaryOperator_html_a7876c618729b8764493aa340b53b574f"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#a7876c618729b8764493aa340b53b574f">llvm::OverflowingBinaryOperator::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const</div><div class="ttdoc">Test whether this operation is known to never undergo signed overflow, aka the nsw property.</div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00105">Operator.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a8bcb86d8d126d95b0dc05f09e8f3df96"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">llvm::ScalarEvolution::getMinusSCEV</a></div><div class="ttdeci">const SCEV * getMinusSCEV(const SCEV *LHS, const SCEV *RHS, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Return LHS-RHS.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04642">ScalarEvolution.cpp:4642</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="SimplifyIndVar_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00031">SimplifyIndVar.cpp:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8413a9136fa25e3dfdebc5cb8c111002"><div class="ttname"><a href="namespacellvm.html#a8413a9136fa25e3dfdebc5cb8c111002">llvm::simplifyLoopIVs</a></div><div class="ttdeci">bool simplifyLoopIVs(Loop *L, ScalarEvolution *SE, DominatorTree *DT, LoopInfo *LI, const TargetTransformInfo *TTI, SmallVectorImpl&lt; WeakTrackingVH &gt; &amp;Dead)</div><div class="ttdoc">SimplifyLoopIVs - Simplify users of induction variables within this loop.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00971">SimplifyIndVar.cpp:971</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86_html_a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e"><div class="ttname"><a href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">llvm::X86::FirstMacroFusionInstKind::Cmp</a></div><div class="ttdeci">@ Cmp</div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_afe7d477c6022fe7123b90e3b39c58e69"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">llvm::ConstantInt::getBool</a></div><div class="ttdeci">static ConstantInt * getBool(LLVMContext &amp;Context, bool V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00849">Constants.cpp:849</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_af206a3d6f58d9e53b074460f0d1ecb86"><div class="ttname"><a href="classllvm_1_1CmpInst.html#af206a3d6f58d9e53b074460f0d1ecb86">llvm::CmpInst::isUnsigned</a></div><div class="ttdeci">bool isUnsigned() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00963">InstrTypes.h:963</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdoc">This node represents a polynomial recurrence on the trip count of the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00330">ScalarEvolutionExpressions.h:330</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a7c779ce2ba55bc94f52014fc25f3d520"><div class="ttname"><a href="classllvm_1_1Value.html#a7c779ce2ba55bc94f52014fc25f3d520">llvm::Value::hasNUses</a></div><div class="ttdeci">bool hasNUses(unsigned N) const</div><div class="ttdoc">Return true if this Value has exactly N uses.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00148">Value.cpp:148</a></div></div>
<div class="ttc" id="anamespacellvm_html_abee0df5f7f703bb4462aba260ba0a60f"><div class="ttname"><a href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">llvm::BitWidth</a></div><div class="ttdeci">constexpr unsigned BitWidth</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00147">BitmaskEnum.h:147</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6d8769a72303e2b06ef63129cb231855"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">llvm::ScalarEvolution::isSCEVable</a></div><div class="ttdeci">bool isSCEVable(Type *Ty) const</div><div class="ttdoc">Test if values of the given type are analyzable within the SCEV framework.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04420">ScalarEvolution.cpp:4420</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a3712279d70deeec90a93db09deb12d02"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a3712279d70deeec90a93db09deb12d02">llvm::CmpInst::isSigned</a></div><div class="ttdeci">bool isSigned() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00957">InstrTypes.h:957</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a2ec50ab2c78eff965caf3da71cd08be4"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a2ec50ab2c78eff965caf3da71cd08be4">llvm::DominatorTree::findNearestCommonDominator</a></div><div class="ttdeci">Instruction * findNearestCommonDominator(Instruction *I1, Instruction *I2) const</div><div class="ttdoc">Find the nearest instruction I that dominates both I1 and I2, in the sense that a result produced bef...</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00358">Dominators.cpp:358</a></div></div>
<div class="ttc" id="aclassllvm_1_1IVVisitor_html_adc922a312c925e0c0a180105b60bab10"><div class="ttname"><a href="classllvm_1_1IVVisitor.html#adc922a312c925e0c0a180105b60bab10">llvm::IVVisitor::anchor</a></div><div class="ttdeci">virtual void anchor()</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyIndVar_8cpp_source.html#l00955">SimplifyIndVar.cpp:955</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">llvm::MCID::Add</a></div><div class="ttdeci">@ Add</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00186">MCInstrDesc.h:186</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a126a12b67fa620ad28ec0c919ca7a3e8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">llvm::CmpInst::setPredicate</a></div><div class="ttdeci">void setPredicate(Predicate P)</div><div class="ttdoc">Set the predicate for this instruction to the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00811">InstrTypes.h:811</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html"><div class="ttname"><a href="classllvm_1_1ConstantRange.html">llvm::ConstantRange</a></div><div class="ttdoc">This class represents a range of values.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8h_source.html#l00047">ConstantRange.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1OverflowingBinaryOperator_html_af74f626787972439fae0df8f2021ad71ac3172f238278728e355fc9a87c439dd5"><div class="ttname"><a href="classllvm_1_1OverflowingBinaryOperator.html#af74f626787972439fae0df8f2021ad71ac3172f238278728e355fc9a87c439dd5">llvm::OverflowingBinaryOperator::NoSignedWrap</a></div><div class="ttdeci">@ NoSignedWrap</div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00080">Operator.h:80</a></div></div>
<div class="ttc" id="aExpandLargeDivRem_8cpp_html_a49b2092a066cfbc24bc6925bdea9682a"><div class="ttname"><a href="ExpandLargeDivRem_8cpp.html#a49b2092a066cfbc24bc6925bdea9682a">isSigned</a></div><div class="ttdeci">static bool isSigned(unsigned int Opcode)</div><div class="ttdef"><b>Definition:</b> <a href="ExpandLargeDivRem_8cpp_source.html#l00052">ExpandLargeDivRem.cpp:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6d745b25efdc69435508f1e936919f8b"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">llvm::ScalarEvolution::getZeroExtendExpr</a></div><div class="ttdeci">const SCEV * getZeroExtendExpr(const SCEV *Op, Type *Ty, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l01609">ScalarEvolution.cpp:1609</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_addec638786f763d967811b45cb662f1f"><div class="ttname"><a href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00191">User.h:191</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a2d9861feadd3a09792967a012559e7b2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">llvm::PatternMatch::m_Specific</a></div><div class="ttdeci">specificval_ty m_Specific(const Value *V)</div><div class="ttdoc">Match if we have a specific specified value.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00772">PatternMatch.h:772</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a3498df9755182f44e759fd3eeb688e9f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a3498df9755182f44e759fd3eeb688e9f">llvm::ScalarEvolution::getSignedRange</a></div><div class="ttdeci">ConstantRange getSignedRange(const SCEV *S)</div><div class="ttdoc">Determine the signed range for a particular SCEV.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00980">ScalarEvolution.h:980</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a3fe9b3ddb71b9fb53d9fc74b3a0710bf"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a3fe9b3ddb71b9fb53d9fc74b3a0710bf">llvm::PatternMatch::m_ICmp</a></div><div class="ttdeci">CmpClass_match&lt; LHS, RHS, ICmpInst, ICmpInst::Predicate &gt; m_ICmp(ICmpInst::Predicate &amp;Pred, const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01394">PatternMatch.h:1394</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="aclassllvm_1_1AssertingVH_html"><div class="ttname"><a href="classllvm_1_1AssertingVH.html">llvm::AssertingVH</a></div><div class="ttdoc">Value handle that asserts if the Value is deleted.</div><div class="ttdef"><b>Definition:</b> <a href="ValueHandle_8h_source.html#l00260">ValueHandle.h:260</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa7414ba9f658ff1287d22a4b8fe81bcb"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const</div><div class="ttdoc">Return the predicate for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00808">InstrTypes.h:808</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a4d5ee57f499d862572c863b9e190884f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a4d5ee57f499d862572c863b9e190884f">llvm::ScalarEvolution::getZero</a></div><div class="ttdeci">const SCEV * getZero(Type *Ty)</div><div class="ttdoc">Return a SCEV for the constant 0 of a specific type.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00653">ScalarEvolution.h:653</a></div></div>
<div class="ttc" id="aIVUsers_8cpp_html_a4e5b9edb51eec9dbca592075eb64dfcb"><div class="ttname"><a href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a></div><div class="ttdeci">iv Induction Variable Users</div><div class="ttdef"><b>Definition:</b> <a href="IVUsers_8cpp_source.html#l00048">IVUsers.cpp:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00047">PatternMatch.h:47</a></div></div>
<div class="ttc" id="ablake3__impl_8h_html_a78823051d1dad34b9b3d8120112e674d"><div class="ttname"><a href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a></div><div class="ttdeci">static const uint32_t IV[8]</div><div class="ttdef"><b>Definition:</b> <a href="blake3__impl_8h_source.html#l00077">blake3_impl.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_aefeda9454a5e8dfcec3deb106964832a"><div class="ttname"><a href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">llvm::SCEV::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">Return the LLVM type of this SCEV expression.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00401">ScalarEvolution.cpp:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_aef6d2bea715d1793e956f41ddeea2320"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">llvm::ScalarEvolution::getAddExpr</a></div><div class="ttdeci">const SCEV * getAddExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Get a canonical add expression, or something simpler if possible.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02537">ScalarEvolution.cpp:2537</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443"><div class="ttname"><a href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">llvm::omp::RTLDependInfoFields::Flags</a></div><div class="ttdeci">@ Flags</div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RegState_html_aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013"><div class="ttname"><a href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">llvm::RegState::Dead</a></div><div class="ttdeci">@ Dead</div><div class="ttdoc">Unused definition.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00050">MachineInstrBuilder.h:50</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a02ce9966395063ac501ecbc1623deda4"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Construct a binary instruction, given the opcode and the two operands.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02950">Instructions.cpp:2950</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a1b9806d21518ef7fb4d5c4299e21411f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a1b9806d21518ef7fb4d5c4299e21411f">llvm::ScalarEvolution::isKnownNegative</a></div><div class="ttdeci">bool isKnownNegative(const SCEV *S)</div><div class="ttdoc">Test if the given expression is known to be negative.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l10821">ScalarEvolution.cpp:10821</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a689a03df5b4ae094d6a3a1bd13dac574"><div class="ttname"><a href="classllvm_1_1Instruction.html#a689a03df5b4ae094d6a3a1bd13dac574">llvm::Instruction::isExact</a></div><div class="ttdeci">bool isExact() const LLVM_READONLY</div><div class="ttdoc">Determine whether the exact flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00245">Instruction.cpp:245</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a37668d9884c78ac77254cf9fb8a4276a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">llvm::PatternMatch::m_Shl</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Shl &gt; m_Shl(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01111">PatternMatch.h:1111</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ad4613def4002aa69721553e567ca4187"><div class="ttname"><a href="classllvm_1_1Instruction.html#ad4613def4002aa69721553e567ca4187">llvm::Instruction::dropPoisonGeneratingFlags</a></div><div class="ttdeci">void dropPoisonGeneratingFlags()</div><div class="ttdoc">Drops flags that may cause this instruction to evaluate to poison despite having non-poison inputs.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00185">Instruction.cpp:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a7eec28400b00678b1fb2b5f55ef7ac1b"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">llvm::SCEVAddRecExpr::getStepRecurrence</a></div><div class="ttdeci">const SCEV * getStepRecurrence(ScalarEvolution &amp;SE) const</div><div class="ttdoc">Constructs and returns the recurrence indicating how much this expression steps by.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00348">ScalarEvolutionExpressions.h:348</a></div></div>
<div class="ttc" id="aSimplifyIndVar_8h_html"><div class="ttname"><a href="SimplifyIndVar_8h.html">SimplifyIndVar.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aIndVarSimplify_8cpp_html_a5d7375fac952d8aedb775a85fefc4423"><div class="ttname"><a href="IndVarSimplify_8cpp.html#a5d7375fac952d8aedb775a85fefc4423">UsePostIncrementRanges</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; UsePostIncrementRanges(&quot;indvars-post-increment-ranges&quot;, cl::Hidden, cl::desc(&quot;Use post increment control-dependent ranges in IndVarSimplify&quot;), cl::init(true))</div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="aclassllvm_1_1PoisonValue_html_a1bf08613fb664a2e377a9a72c59a6b66"><div class="ttname"><a href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">llvm::PoisonValue::get</a></div><div class="ttdeci">static PoisonValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'poison' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01759">Constants.cpp:1759</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:38:08 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
