<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Analysis/InlineCost.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a25db018342d3ae6c7e6779086c18378.html">Analysis</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">InlineCost.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="InlineCost_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- InlineCost.cpp - Cost analysis for inliner -------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements inline cost analysis.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InlineCost_8h.html">llvm/Analysis/InlineCost.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AssumptionCache_8h.html">llvm/Analysis/AssumptionCache.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BlockFrequencyInfo_8h.html">llvm/Analysis/BlockFrequencyInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeMetrics_8h.html">llvm/Analysis/CodeMetrics.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConstantFolding_8h.html">llvm/Analysis/ConstantFolding.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionSimplify_8h.html">llvm/Analysis/InstructionSimplify.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemoryBuiltins_8h.html">llvm/Analysis/MemoryBuiltins.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfileSummaryInfo_8h.html">llvm/Analysis/ProfileSummaryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AssemblyAnnotationWriter_8h.html">llvm/IR/AssemblyAnnotationWriter.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallingConv_8h.html">llvm/IR/CallingConv.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GetElementPtrTypeIterator_8h.html">llvm/IR/GetElementPtrTypeIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalAlias_8h.html">llvm/IR/GlobalAlias.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstVisitor_8h.html">llvm/IR/InstVisitor.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Operator_8h.html">llvm/IR/Operator.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FormattedStream_8h.html">llvm/Support/FormattedStream.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;climits&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="InlineCost_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   52</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;inline-cost&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumCallsAnalyzed, <span class="stringliteral">&quot;Number of call sites analyzed&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a88449ce28c2bd9290260794929242c0a">DefaultThreshold</a>(<span class="stringliteral">&quot;inlinedefault-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(225),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                     <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Default amount of inlining to perform&quot;</span>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// We introduce this option since there is a minor compile-time win by avoiding</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// addition of TTI attributes (target-features in particular) to inline</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// candidates when they are guaranteed to be the same as top level methods in</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// some use cases. If we avoid adding the attribute, we need an option to avoid</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">// checking these attributes.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineCost_8cpp.html#ab9082799f60c525cdaca5393dcd13894">IgnoreTTIInlineCompatible</a>(</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="stringliteral">&quot;ignore-tti-inline-compatible&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Ignore TTI attributes compatibility check between callee/caller &quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;             <span class="stringliteral">&quot;during inline cost calculation&quot;</span>));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineCost_8cpp.html#a44fcadf99c45d9e7231ceed9730487e7">PrintInstructionComments</a>(</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="stringliteral">&quot;print-instruction-comments&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Prints comments for instruction based on inline cost analysis&quot;</span>));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#a9ab3097ecb543e993b6a1ccd0cb03258">InlineThreshold</a>(</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="stringliteral">&quot;inline-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(225),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Control the amount of inlining to perform (default = 225)&quot;</span>));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#a155256dae9eff9b764b9d5eb5a10d8a9">HintThreshold</a>(</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="stringliteral">&quot;inlinehint-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(325),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Threshold for inlining functions with inline hint&quot;</span>));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a8ec73f89a2e044c3020319ba8f3e52c1">ColdCallSiteThreshold</a>(<span class="stringliteral">&quot;inline-cold-callsite-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                          <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(45),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                          <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Threshold for inlining cold callsites&quot;</span>));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineCost_8cpp.html#aecdf3f88e590cff2cf824f128934342d">InlineEnableCostBenefitAnalysis</a>(</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="stringliteral">&quot;inline-enable-cost-benefit-analysis&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable the cost-benefit analysis for the inliner&quot;</span>));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#aee1b90efc80e9ed2d7a7189e4570434b">InlineSavingsMultiplier</a>(</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="stringliteral">&quot;inline-savings-multiplier&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(8),</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Multiplier to multiply cycle savings by during inlining&quot;</span>));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a857f17b7aaa9452a4a5f231e836feefd">InlineSizeAllowance</a>(<span class="stringliteral">&quot;inline-size-allowance&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(100),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                        <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The maximum size of a callee that get&#39;s &quot;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                 <span class="stringliteral">&quot;inlined without sufficient cycle savings&quot;</span>));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// We introduce this threshold to help performance of instrumentation based</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// PGO before we actually hook up inliner with analysis passes such as BPI and</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// BFI.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#a3107234de6aa860244f4ee5d3009486f">ColdThreshold</a>(</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="stringliteral">&quot;inlinecold-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(45),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Threshold for inlining functions with cold attribute&quot;</span>));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a78324e64ee175c0703c3db3ce45943cc">HotCallSiteThreshold</a>(<span class="stringliteral">&quot;hot-callsite-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(3000),</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                         <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Threshold for hot callsites &quot;</span>));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#a6690aaae8b3d4f4ddc10d536d59eaa7c">LocallyHotCallSiteThreshold</a>(</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="stringliteral">&quot;locally-hot-callsite-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(525),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Threshold for locally hot callsites &quot;</span>));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#a201484c094c4d9ad96166714816b99c4">ColdCallSiteRelFreq</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="stringliteral">&quot;cold-callsite-rel-freq&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(2),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Maximum block frequency, expressed as a percentage of caller&#39;s &quot;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;             <span class="stringliteral">&quot;entry frequency, for a callsite to be cold in the absence of &quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;             <span class="stringliteral">&quot;profile information.&quot;</span>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#ad997850fcf588e85cfb6fe9642aa8ffa">HotCallSiteRelFreq</a>(</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="stringliteral">&quot;hot-callsite-rel-freq&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(60),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Minimum block frequency, expressed as a multiple of caller&#39;s &quot;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;             <span class="stringliteral">&quot;entry frequency, for a callsite to be hot in the absence of &quot;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;             <span class="stringliteral">&quot;profile information.&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>(<span class="stringliteral">&quot;inline-instr-cost&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(5),</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;              <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Cost of a single instruction when inlining&quot;</span>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a253ef51d8dd3799be029082f278b567a">MemAccessCost</a>(<span class="stringliteral">&quot;inline-memaccess-cost&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0),</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Cost of load/store instruction when inlining&quot;</span>));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">CallPenalty</a>(</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="stringliteral">&quot;inline-call-penalty&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(25),</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Call penalty that is applied per callsite when inlining&quot;</span>));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;size_t&gt;</a></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a0ac5b7c2981646d4f6a55fbc52feaeeb">StackSizeThreshold</a>(<span class="stringliteral">&quot;inline-max-stacksize&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                       <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;size_t&gt;::max</a>()),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                       <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Do not inline functions with a stack size &quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                <span class="stringliteral">&quot;that exceeds the specified limit&quot;</span>));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;size_t&gt;</a></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="InlineCost_8cpp.html#a7806408b2a0bab4436109e57881cf32b">RecurStackSizeThreshold</a>(<span class="stringliteral">&quot;recursive-inline-max-stacksize&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                       <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<a class="code" href="namespacellvm_1_1InlineConstants.html#ac331ecdb7100a8944856d0e27d4dfdd5">InlineConstants::TotalAllocaSizeRecursiveCaller</a>),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                       <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Do not inline recursive functions with a stack &quot;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                <span class="stringliteral">&quot;size that exceeds the specified limit&quot;</span>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineCost_8cpp.html#a1afb689cf73d254713061b112c900a72">OptComputeFullInlineCost</a>(</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="stringliteral">&quot;inline-cost-full&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Compute the full inline cost of a call site even when the cost &quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;             <span class="stringliteral">&quot;exceeds the threshold.&quot;</span>));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineCost_8cpp.html#ab95282573f276af5623b0b909f91d823">InlineCallerSupersetNoBuiltin</a>(</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="stringliteral">&quot;inline-caller-superset-nobuiltin&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>),</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Allow inlining when caller has a superset of callee&#39;s nobuiltin &quot;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;             <span class="stringliteral">&quot;attributes.&quot;</span>));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineCost_8cpp.html#ac2f898cba8bf13271ebe0d59369c85ff">DisableGEPConstOperand</a>(</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="stringliteral">&quot;disable-gep-const-evaluation&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disables evaluation of GetElementPtr with constant operands&quot;</span>));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespacellvm.html#a72780641674440cae11e17759f2f524a">  166</a></span>&#160;std::optional&lt;int&gt; <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Attribute.html">Attribute</a> &amp;Attr) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (Attr.<a class="code" href="classllvm_1_1Attribute.html#adf4d22686e85732b2fef71e3c45531c6">isValid</a>()) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">int</span> AttrValue = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (!Attr.<a class="code" href="classllvm_1_1Attribute.html#a968930aea9d9efa8d46dd890fce75643">getValueAsString</a>().<a class="code" href="classllvm_1_1StringRef.html#a1881146f2dcc2ca57c9c5f77f938db9d">getAsInteger</a>(10, AttrValue))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">return</span> AttrValue;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">  175</a></span>&#160;std::optional&lt;int&gt; <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> AttrKind) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(CB.<a class="code" href="classllvm_1_1CallBase.html#a9e46a3a4bf99f8dcea9cb9efb4d977a3">getFnAttr</a>(AttrKind));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespacellvm.html#a4133695a2961907c68b33e6dfef9b2e7">  179</a></span>&#160;std::optional&lt;int&gt; <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> AttrKind) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getFnAttribute(AttrKind));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword">namespace </span>InlineConstants {</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="namespacellvm_1_1InlineConstants.html#af5bf7228ae6efbaf626a0dcedf02d8c5">  184</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1InlineConstants.html#af5bf7228ae6efbaf626a0dcedf02d8c5">getInstrCost</a>() { <span class="keywordflow">return</span> <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>; }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;} <span class="comment">// namespace InlineConstants</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;} <span class="comment">// namespace llvm</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keyword">class </span>InlineCostCallAnalyzer;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">// This struct is used to store information about inline cost of a</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">// particular instruction</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword">struct </span>InstructionCostDetail {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">int</span> CostBefore = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">int</span> CostAfter = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">int</span> ThresholdBefore = 0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">int</span> ThresholdAfter = 0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">int</span> getThresholdDelta()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ThresholdAfter - ThresholdBefore; }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">int</span> getCostDelta()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> CostAfter - CostBefore; }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">bool</span> hasThresholdChanged()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ThresholdAfter != ThresholdBefore; }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;};</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">class </span>InlineCostAnnotationWriter : <span class="keyword">public</span> <a class="code" href="classllvm_1_1AssemblyAnnotationWriter.html">AssemblyAnnotationWriter</a> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  InlineCostCallAnalyzer *<span class="keyword">const</span> ICCA;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  InlineCostAnnotationWriter(InlineCostCallAnalyzer *ICCA) : ICCA(ICCA) {}</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">void</span> emitInstructionAnnot(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                            <a class="code" href="classllvm_1_1formatted__raw__ostream.html">formatted_raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;};</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">/// Carry out call site analysis, in order to evaluate inlinability.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">/// NOTE: the type is currently used as implementation detail of functions such</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">/// as llvm::getInlineCost. Note the function_ref constructor parameters - the</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">/// expectation is that they come from the outer scope, from the wrapper</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">/// functions. If we want to support constructing CallAnalyzer objects where</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/// lambdas are provided inline at construction, or where the object needs to</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/// otherwise survive past the scope of the provided functions, we need to</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">/// revisit the argument types.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span><span class="keyword">class </span>CallAnalyzer : <span class="keyword">public</span> <a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;CallAnalyzer, bool&gt; {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor&lt;CallAnalyzer, bool&gt;</a> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;CallAnalyzer, bool&gt;;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keyword">virtual</span> ~CallAnalyzer() = <span class="keywordflow">default</span>;<span class="comment"></span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">  /// The TargetTransformInfo available for this compilation.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">TTI</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">  /// Getter for the cache of @llvm.assume intrinsics.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  /// Getter for BlockFrequencyInfo</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  /// Profile summary information.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  /// The called function.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// Cache the DataLayout since we use it a lot.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  /// The OptimizationRemarkEmitter available for this compilation.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">  /// The candidate callsite being analyzed. Please do not use this to do</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// analysis in the caller function; we want the inline cost query to be</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  /// easily cacheable. Instead, use the cover function paramHasAttr.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CandidateCall;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  /// Extension points for handling callsite features.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span>  <span class="comment">// Called before a basic block was analyzed.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onBlockStart(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {}</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">  /// Called after a basic block was analyzed.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onBlockAnalyzed(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">  /// Called before an instruction was analyzed</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onInstructionAnalysisStart(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">  /// Called after an instruction was analyzed</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onInstructionAnalysisFinish(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {}</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  /// Called at the end of the analysis of the callsite. Return the outcome of</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">  /// the analysis, i.e. &#39;InlineResult(true)&#39; if the inlining may happen, or</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">  /// the reason it can&#39;t.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> finalizeAnalysis() { <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>(); }<span class="comment"></span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">  /// Called when we&#39;re about to start processing a basic block, and every time</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">  /// we are done processing an instruction. Return true if there is no point in</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  /// continuing the analysis (e.g. we&#39;ve determined already the call site is</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">  /// too expensive to inline)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> shouldStop() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  /// Called before the analysis of the callee body starts (with callsite</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">  /// contexts propagated).  It checks callsite-specific information. Return a</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  /// reason analysis can&#39;t continue if that&#39;s the case, or &#39;true&#39; if it may</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">  /// continue.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> onAnalysisStart() { <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>(); }<span class="comment"></span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">  /// Called if the analysis engine decides SROA cannot be done for the given</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">  /// alloca.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onDisableSROA(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>) {}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">  /// Called the analysis engine determines load elimination won&#39;t happen.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onDisableLoadElimination() {}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  /// Called when we visit a CallBase, before the analysis starts. Return false</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  /// to stop further processing of the instruction.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> onCallBaseVisitStart(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  /// Called to account for a call.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onCallPenalty() {}</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">  /// Called to account for a load or store.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onMemAccess(){};</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  /// Called to account for the expectation the inlining would result in a load</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">  /// elimination.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onLoadEliminationOpportunity() {}</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">  /// Called to account for the cost of argument setup for the Call in the</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">  /// callee&#39;s body (not the callsite currently under analysis).</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onCallArgumentSetup(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>) {}</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">  /// Called to account for a load relative intrinsic.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onLoadRelativeIntrinsic() {}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">  /// Called to account for a lowered call.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onLoweredCall(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>, <span class="keywordtype">bool</span> IsIndirectCall) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">  /// Account for a jump table of given size. Return false to stop further</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">  /// processing the switch instruction</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> onJumpTable(<span class="keywordtype">unsigned</span> JumpTableSize) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">  /// Account for a case cluster of given size. Return false to stop further</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">  /// processing of the instruction.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> onCaseCluster(<span class="keywordtype">unsigned</span> NumCaseCluster) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">  /// Called at the end of processing a switch instruction, with the given</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">  /// number of case clusters.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onFinalizeSwitch(<span class="keywordtype">unsigned</span> JumpTableSize,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                <span class="keywordtype">unsigned</span> NumCaseCluster) {}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">  /// Called to account for any other instruction not specifically accounted</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  /// for.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onMissedSimplification() {}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">  /// Start accounting potential benefits due to SROA for the given alloca.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onInitializeSROAArg(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>) {}</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">  /// Account SROA savings for the AllocaInst value.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> onAggregateSROAUse(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *V) {}</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">bool</span> handleSROA(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">bool</span> DoNotDisable) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Check for SROA candidates in comparisons.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(V)) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">if</span> (DoNotDisable) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        onAggregateSROAUse(SROAArg);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      disableSROAForArg(SROAArg);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">bool</span> IsCallerRecursive = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">bool</span> IsRecursiveCall = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">bool</span> ExposesReturnsTwice = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">bool</span> HasDynamicAlloca = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">bool</span> ContainsNoDuplicateCall = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">bool</span> HasReturn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">bool</span> HasIndirectBr = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">bool</span> HasUninlineableIntrinsic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">bool</span> InitsVargArgs = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  /// Number of bytes allocated statically by the callee.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocatedSize = 0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">unsigned</span> NumInstructions = 0;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">unsigned</span> NumVectorInstructions = 0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  /// While we walk the potentially-inlined instructions, we build up and</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">  /// maintain a mapping of simplified values specific to this callsite. The</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  /// idea is to propagate any special information we have about arguments to</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  /// this call through the inlinable section of the function, and account for</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">  /// likely simplifications post-inlining. The most important aspect we track</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">  /// is CFG altering simplifications -- when we prove a basic block dead, that</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">  /// can cause dramatic shifts in the cost of inlining a function.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Constant *&gt;</a> SimplifiedValues;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  /// Keep track of the values which map back (through function arguments) to</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">  /// allocas on the caller stack which could be simplified through SROA.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, AllocaInst *&gt;</a> SROAArgValues;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">  /// Keep track of Allocas for which we believe we may get SROA optimization.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;AllocaInst *&gt;</a> EnabledSROAAllocas;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">  /// Keep track of values which map to a pointer base and constant offset.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, std::pair&lt;Value *, APInt&gt;</a>&gt; ConstantOffsetPtrs;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">  /// Keep track of dead blocks due to the constant arguments.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 16&gt;</a> DeadBlocks;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">  /// The mapping of the blocks to their known unique successors due to the</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">  /// constant arguments.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;BasicBlock *, BasicBlock *&gt;</a> KnownSuccessors;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">  /// Model the elimination of repeated loads that is expected to happen</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">  /// whenever we simplify away the stores that would otherwise cause them to be</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">  /// loads.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> EnableLoadElimination = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">  /// Whether we allow inlining for recursive call.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> AllowRecursiveCall = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> LoadAddrSet;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *getSROAArgForValueOrNull(<a class="code" href="classllvm_1_1Value.html">Value</a> *V)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">auto</span> It = SROAArgValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(V);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (It == SROAArgValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() || EnabledSROAAllocas.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(It-&gt;second) == 0)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> It-&gt;second;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// Custom simplification helper routines.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">bool</span> isAllocaDerivedArg(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">void</span> disableSROAForArg(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *SROAArg);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">void</span> disableSROA(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">void</span> findDeadBlocks(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurrBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NextBB);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">void</span> disableLoadElimination();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">bool</span> isGEPFree(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">bool</span> canFoldInboundsGEP(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordtype">bool</span> accumulateGEPOffset(<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> &amp;<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">bool</span> simplifyCallSite(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordtype">bool</span> simplifyIntrinsicCallIsConstant(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordtype">bool</span> simplifyIntrinsicCallObjectSize(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *stripAndComputeInBoundsConstantOffsets(<a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;V);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  /// Return true if the given argument to the function being considered for</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  /// inlining has the given attribute set either at the call site or the</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">  /// function declaration.  Primarily used to inspect call site specific</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  /// attributes since these can be more precise than the ones on the callee</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  /// itself.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> paramHasAttr(<a class="code" href="classllvm_1_1Argument.html">Argument</a> *<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>, <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">Attribute::AttrKind</a> Attr);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  /// Return true if the given value is known non null within the callee if</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  /// inlined through this particular callsite.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isKnownNonNullInCallee(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  /// Return true if size growth is allowed when inlining the callee at \p Call.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> allowSizeGrowth(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// Custom analysis routines.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> analyzeBlock(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                            <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;const Value *&gt;</a> &amp;EphValues);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// Disable several entry points to the visitor so we don&#39;t accidentally use</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// them by declaring but not defining them here.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordtype">void</span> visit(<a class="code" href="classllvm_1_1Module.html">Module</a> *);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">void</span> visit(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordtype">void</span> visit(<a class="code" href="classllvm_1_1Function.html">Function</a> *);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">void</span> visit(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">void</span> visit(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">void</span> visit(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// Provide base case for our instruction visit.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordtype">bool</span> visitInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// Our visit overrides.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">bool</span> visitAlloca(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordtype">bool</span> visitPHI(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordtype">bool</span> visitGetElementPtr(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordtype">bool</span> visitBitCast(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">bool</span> visitPtrToInt(<a class="code" href="classllvm_1_1PtrToIntInst.html">PtrToIntInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">bool</span> visitIntToPtr(<a class="code" href="classllvm_1_1IntToPtrInst.html">IntToPtrInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">bool</span> visitCastInst(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">bool</span> visitCmpInst(<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">bool</span> visitSub(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordtype">bool</span> visitBinaryOperator(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">bool</span> visitFNeg(<a class="code" href="classllvm_1_1UnaryOperator.html">UnaryOperator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordtype">bool</span> visitLoad(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordtype">bool</span> visitStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordtype">bool</span> visitExtractValue(<a class="code" href="classllvm_1_1ExtractValueInst.html">ExtractValueInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">bool</span> visitInsertValue(<a class="code" href="classllvm_1_1InsertValueInst.html">InsertValueInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordtype">bool</span> visitCallBase(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordtype">bool</span> visitReturnInst(<a class="code" href="classllvm_1_1ReturnInst.html">ReturnInst</a> &amp;RI);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordtype">bool</span> visitBranchInst(<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> &amp;BI);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordtype">bool</span> visitSelectInst(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordtype">bool</span> visitSwitchInst(<a class="code" href="classllvm_1_1SwitchInst.html">SwitchInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">bool</span> visitIndirectBrInst(<a class="code" href="classllvm_1_1IndirectBrInst.html">IndirectBrInst</a> &amp;IBI);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordtype">bool</span> visitResumeInst(<a class="code" href="classllvm_1_1ResumeInst.html">ResumeInst</a> &amp;RI);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordtype">bool</span> visitCleanupReturnInst(<a class="code" href="classllvm_1_1CleanupReturnInst.html">CleanupReturnInst</a> &amp;RI);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">bool</span> visitCatchReturnInst(<a class="code" href="classllvm_1_1CatchReturnInst.html">CatchReturnInst</a> &amp;RI);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordtype">bool</span> visitUnreachableInst(<a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  CallAnalyzer(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;               <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;               <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;               <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;               <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE = <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      : <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>), GetAssumptionCache(GetAssumptionCache), GetBFI(GetBFI),</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        PSI(PSI), <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>()-&gt;getDataLayout()), ORE(ORE),</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        CandidateCall(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>) {}</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> analyze();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  std::optional&lt;Constant *&gt; getSimplifiedValue(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span> (SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) != SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">return</span> SimplifiedValues[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// Keep a bunch of stats about the cost savings found so we can print them</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// out when debugging.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordtype">unsigned</span> NumConstantArgs = 0;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordtype">unsigned</span> NumConstantOffsetPtrArgs = 0;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordtype">unsigned</span> NumAllocaArgs = 0;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">unsigned</span> NumConstantPtrCmps = 0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordtype">unsigned</span> NumConstantPtrDiffs = 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">unsigned</span> NumInstructionsSimplified = 0;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>();</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;};</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">// Considering forming a binary search, we should find the number of nodes</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">// which is same as the number of comparisons when lowered. For a given</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">// number of clusters, n, we can define a recursive function, f(n), to find</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">// the number of nodes in the tree. The recursion is :</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">// f(n) = 1 + f(n/2) + f (n - n/2), when n &gt; 3,</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">// and f(n) = n, when n &lt;= 3.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">// This will lead a binary tree where the leaf should be either f(2) or f(3)</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">// when n &gt; 3.  So, the number of comparisons from leaves should be n, while</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">// the number of non-leaf should be :</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">//   2^(log2(n) - 1) - 1</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">//   = 2^log2(n) * 2^-1 - 1</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//   = n / 2 - 1.</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">// Considering comparisons from leaf and non-leaf nodes, we can estimate the</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">// number of comparisons in a simple closed form :</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">//   n + n / 2 - 1 = n * 3 / 2 - 1</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;int64_t getExpectedNumberOfCompare(<span class="keywordtype">int</span> NumCaseCluster) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">return</span> 3 * <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(NumCaseCluster) / 2 - 1;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/// FIXME: if it is necessary to derive from InlineCostCallAnalyzer, note</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/// the FIXME in onLoweredCall, when instantiating an InlineCostCallAnalyzer</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"></span><span class="keyword">class </span>InlineCostCallAnalyzer final : <span class="keyword">public</span> CallAnalyzer {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> ComputeFullInlineCost;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordtype">int</span> LoadEliminationCost = 0;<span class="comment"></span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">  /// Bonus to be applied when percentage of vector instructions in callee is</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">  /// high (see more details in updateThreshold).</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> VectorBonus = 0;<span class="comment"></span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  /// Bonus to be applied when the callee has only one reachable basic block.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> SingleBBBonus = 0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  /// Tunable parameters that control the analysis.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> &amp;Params;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// This DenseMap stores the delta change in cost and threshold after</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// accounting for the given instruction. The map is filled only with the</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// flag PrintInstructionComments on.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Instruction *, InstructionCostDetail&gt;</a> InstructionCostDetailMap;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">  /// Upper bound for the inlining cost. Bonuses are being applied to account</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /// for speculative &quot;expected profit&quot; of the inlining decision.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> Threshold = 0;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">  /// The amount of StaticBonus applied.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> StaticBonusApplied = 0;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">  /// Attempt to evaluate indirect calls to boost its inline cost.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> BoostIndirectCalls;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  /// Ignore the threshold when finalizing analysis.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> IgnoreThreshold;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// True if the cost-benefit-analysis-based inliner is enabled.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> CostBenefitAnalysisEnabled;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">  /// Inlining cost measured in abstract units, accounts for all the</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  /// instructions expected to be executed for a given function invocation.</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  /// Instructions that are statically proven to be dead based on call-site</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">  /// arguments are not counted here.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = 0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// The cumulative cost at the beginning of the basic block being analyzed.  At</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// the end of analyzing each basic block, &quot;Cost - CostAtBBStart&quot; represents</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// the size of that basic block.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordtype">int</span> CostAtBBStart = 0;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// The static size of live but cold basic blocks.  This is &quot;static&quot; in the</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// sense that it&#39;s not weighted by profile counts at all.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordtype">int</span> ColdSize = 0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">// Whether inlining is decided by cost-threshold analysis.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordtype">bool</span> DecidedByCostThreshold = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// Whether inlining is decided by cost-benefit analysis.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordtype">bool</span> DecidedByCostBenefit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// The cost-benefit pair computed by cost-benefit analysis.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  std::optional&lt;CostBenefitPair&gt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a5785ff0d45e059b3d783c960d3ee3759">CostBenefit</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">bool</span> SingleBB = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">unsigned</span> SROACostSavings = 0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">unsigned</span> SROACostSavingsLost = 0;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  /// The mapping of caller Alloca values to their accumulated cost savings. If</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">  /// we have to disable SROA for one of the allocas, this tells us how much</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">  /// cost must be added.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;AllocaInst *, int&gt;</a> SROAArgCosts;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">  /// Return true if \p Call is a cold callsite.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="GlobalOpt_8cpp.html#a652ede21e988a4de569cdbc7863ea234">isColdCallSite</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">  /// Update Threshold based on callsite properties such as callee</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">  /// attributes and callee hotness for PGO builds. The Callee is explicitly</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">  /// passed to support analyzing indirect calls whose target is inferred by</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">  /// analysis.</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> updateThreshold(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Callee);<span class="comment"></span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">  /// Return a higher threshold if \p Call is a hot callsite.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span>  std::optional&lt;int&gt; getHotCallSiteThreshold(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                             <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">  /// Handle a capped &#39;int&#39; increment for Cost.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> addCost(int64_t Inc) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    Inc = std::max&lt;int64_t&gt;(std::min&lt;int64_t&gt;(INT_MAX, Inc), INT_MIN);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = std::max&lt;int64_t&gt;(std::min&lt;int64_t&gt;(INT_MAX, Inc + Cost), INT_MIN);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordtype">void</span> onDisableSROA(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keyword">auto</span> CostIt = SROAArgCosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (CostIt == SROAArgCosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    addCost(CostIt-&gt;second);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    SROACostSavings -= CostIt-&gt;second;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    SROACostSavingsLost += CostIt-&gt;second;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    SROAArgCosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">erase</a>(CostIt);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordtype">void</span> onDisableLoadElimination()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    addCost(LoadEliminationCost);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    LoadEliminationCost = 0;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordtype">bool</span> onCallBaseVisitStart(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;int&gt; AttrCallThresholdBonus =</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(Call, <span class="stringliteral">&quot;call-threshold-bonus&quot;</span>))</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      Threshold += *AttrCallThresholdBonus;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;int&gt; AttrCallCost =</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(Call, <span class="stringliteral">&quot;call-inline-cost&quot;</span>)) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      addCost(*AttrCallCost);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// Prevent further processing of the call since we want to override its</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">// inline cost, not just add to it.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">void</span> onCallPenalty()<span class="keyword"> override </span>{ addCost(<a class="code" href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">CallPenalty</a>); }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">void</span> onMemAccess()<span class="keyword"> override </span>{ addCost(<a class="code" href="InlineCost_8cpp.html#a253ef51d8dd3799be029082f278b567a">MemAccessCost</a>); }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">void</span> onCallArgumentSetup(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// Pay the price of the argument setup. We account for the average 1</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// instruction per call argument setup here.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    addCost(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.arg_size() * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">void</span> onLoadRelativeIntrinsic()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">// This is normally lowered to 4 LLVM instructions.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    addCost(3 * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordtype">void</span> onLoweredCall(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                     <span class="keywordtype">bool</span> IsIndirectCall)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// We account for the average 1 instruction per call argument setup here.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    addCost(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.arg_size() * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// If we have a constant that we are calling as a function, we can peer</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// through it and see the function target. This happens not infrequently</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// during devirtualization and so we want to give it a hefty bonus for</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">// inlining, but cap that bonus in the event that inlining wouldn&#39;t pan out.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">// Pretend to inline the function, with a custom threshold.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> (IsIndirectCall &amp;&amp; BoostIndirectCalls) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keyword">auto</span> IndirectCallParams = Params;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      IndirectCallParams.<a class="code" href="structllvm_1_1InlineParams.html#aaa559292e3d904012000b7e1b767db85">DefaultThreshold</a> =</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          <a class="code" href="namespacellvm_1_1InlineConstants.html#a6e878d84d424326fd6132b320f075c97">InlineConstants::IndirectCallThreshold</a>;<span class="comment"></span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">      /// FIXME: if InlineCostCallAnalyzer is derived from, this may need</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">      /// to instantiate the derived class.</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span>      InlineCostCallAnalyzer CA(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Call, IndirectCallParams, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                GetAssumptionCache, GetBFI, PSI, ORE, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">if</span> (CA.analyze().isSuccess()) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// We were able to inline the indirect call! Subtract the cost from the</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">// threshold to get the bonus we want to apply, but don&#39;t go below zero.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> -= <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(0, CA.getThreshold() - CA.getCost());</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="comment">// Otherwise simply add the cost for merely making the call.</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      addCost(<a class="code" href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">CallPenalty</a>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordtype">void</span> onFinalizeSwitch(<span class="keywordtype">unsigned</span> JumpTableSize,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                        <span class="keywordtype">unsigned</span> NumCaseCluster)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// If suitable for a jump table, consider the cost for the table size and</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">// branch to destination.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// Maximum valid cost increased in this function.</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">if</span> (JumpTableSize) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      int64_t JTCost =</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(JumpTableSize) * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a> + 4 * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      addCost(JTCost);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">if</span> (NumCaseCluster &lt;= 3) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="comment">// Suppose a comparison includes one compare and one conditional branch.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      addCost(NumCaseCluster * 2 * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    int64_t ExpectedNumberOfCompare =</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        getExpectedNumberOfCompare(NumCaseCluster);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    int64_t SwitchCost = ExpectedNumberOfCompare * 2 * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    addCost(SwitchCost);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">void</span> onMissedSimplification()<span class="keyword"> override </span>{ addCost(<a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>); }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordtype">void</span> onInitializeSROAArg(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;           <span class="stringliteral">&quot;Should not initialize SROA costs for null value.&quot;</span>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    SROAArgCosts[<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>] = 0;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">void</span> onAggregateSROAUse(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *SROAArg)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keyword">auto</span> CostIt = SROAArgCosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(SROAArg);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CostIt != SROAArgCosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;           <span class="stringliteral">&quot;expected this argument to have a cost&quot;</span>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    CostIt-&gt;second += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    SROACostSavings += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordtype">void</span> onBlockStart(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> override </span>{ CostAtBBStart = <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>; }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordtype">void</span> onBlockAnalyzed(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (CostBenefitAnalysisEnabled) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">// Keep track of the static size of live but cold basic blocks.  For now,</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">// we define a cold basic block to be one that&#39;s never executed.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GetBFI &amp;&amp; <span class="stringliteral">&quot;GetBFI must be available&quot;</span>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a> = &amp;(GetBFI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a> &amp;&amp; <span class="stringliteral">&quot;BFI must be available&quot;</span>);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keyword">auto</span> <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a> = <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>-&gt;getBlockProfileCount(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keywordflow">if</span> (*<a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a> == 0)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        ColdSize += <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> - CostAtBBStart;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keyword">auto</span> *TI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// If we had any successors at this point, than post-inlining is likely to</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// have them as well. Note that we assume any basic blocks which existed</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// due to branches or switches which folded above will also fold after</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// inlining.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (SingleBB &amp;&amp; TI-&gt;getNumSuccessors() &gt; 1) {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="comment">// Take off the bonus we applied to the threshold.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      Threshold -= SingleBBBonus;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      SingleBB = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordtype">void</span> onInstructionAnalysisStart(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// This function is called to store the initial cost of inlining before</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">// the given instruction was assessed.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InlineCost_8cpp.html#a44fcadf99c45d9e7231ceed9730487e7">PrintInstructionComments</a>)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    InstructionCostDetailMap[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].CostBefore = <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    InstructionCostDetailMap[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].ThresholdBefore = Threshold;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordtype">void</span> onInstructionAnalysisFinish(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// This function is called to find new values of cost and threshold after</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// the instruction has been assessed.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InlineCost_8cpp.html#a44fcadf99c45d9e7231ceed9730487e7">PrintInstructionComments</a>)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    InstructionCostDetailMap[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].CostAfter = <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    InstructionCostDetailMap[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].ThresholdAfter = Threshold;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordtype">bool</span> isCostBenefitAnalysisEnabled() {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span> (!PSI || !PSI-&gt;hasProfileSummary())</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (!GetBFI)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineCost_8cpp.html#aecdf3f88e590cff2cf824f128934342d">InlineEnableCostBenefitAnalysis</a>.<a class="code" href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">getNumOccurrences</a>()) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="comment">// Honor the explicit request from the user.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InlineCost_8cpp.html#aecdf3f88e590cff2cf824f128934342d">InlineEnableCostBenefitAnalysis</a>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="comment">// Otherwise, require instrumentation profile.</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">if</span> (!PSI-&gt;hasInstrumentationProfile())</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = CandidateCall.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;getEntryCount())</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI = &amp;(GetBFI(*Caller));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">if</span> (!CallerBFI)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// For now, limit to hot call site.</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (!PSI-&gt;isHotCallSite(CandidateCall, CallerBFI))</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// Make sure we have a nonzero entry count.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keyword">auto</span> EntryCount = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryCount();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (!EntryCount || !EntryCount-&gt;getCount())</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CalleeBFI = &amp;(GetBFI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (!CalleeBFI)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// Determine whether we should inline the given call site, taking into account</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// both the size cost and the cycle savings.  Return std::nullopt if we don&#39;t</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">// have suficient profiling information to determine.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  std::optional&lt;bool&gt; costBenefitAnalysis() {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span> (!CostBenefitAnalysisEnabled)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">// buildInlinerPipeline in the pass builder sets HotCallSiteThreshold to 0</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">// for the prelink phase of the AutoFDO + ThinLTO build.  Honor the logic by</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">// falling back to the cost-based metric.</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">// TODO: Improve this hacky condition.</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">if</span> (Threshold == 0)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GetBFI);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CalleeBFI = &amp;(GetBFI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CalleeBFI);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// The cycle savings expressed as the sum of InstrCost</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// multiplied by the estimated dynamic count of each instruction we can</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// avoid.  Savings come from the call site cost, such as argument setup and</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// the call instruction, as well as the instructions that are folded.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// We use 128-bit APInt here to avoid potential overflow.  This variable</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// should stay well below 10^^24 (or 2^^80) in practice.  This &quot;worst&quot; case</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="comment">// assumes that we can avoid or fold a billion instructions, each with a</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// profile count of 10^^15 -- roughly the number of cycles for a 24-hour</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// period on a 4GHz machine.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> CycleSavings(128, 0);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> CurrentSavings(128, 0);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = dyn_cast&lt;BranchInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          <span class="comment">// Count a conditional branch as savings if it becomes unconditional.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;          <span class="keywordflow">if</span> (BI-&gt;isConditional() &amp;&amp;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;              isa_and_nonnull&lt;ConstantInt&gt;(</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                  SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(BI-&gt;getCondition()))) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            CurrentSavings += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = dyn_cast&lt;Value&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          <span class="comment">// Count an instruction as savings if we can fold it.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          <span class="keywordflow">if</span> (SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(V)) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            CurrentSavings += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;          }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keyword">auto</span> <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a> = CalleeBFI-&gt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html#a45e6b2c5c4e59ddc05ad9a2685706e75">getBlockProfileCount</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      CurrentSavings *= *<a class="code" href="namespacellvm.html#a23d4c211faf80b8789923262b5b5ae77">ProfileCount</a>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      CycleSavings += CurrentSavings;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// Compute the cycle savings per call.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keyword">auto</span> EntryProfileCount = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryCount();</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EntryProfileCount &amp;&amp; EntryProfileCount-&gt;getCount());</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keyword">auto</span> EntryCount = EntryProfileCount-&gt;getCount();</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    CycleSavings += EntryCount / 2;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    CycleSavings = CycleSavings.udiv(EntryCount);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">// Compute the total savings for the call site.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keyword">auto</span> *CallerBB = CandidateCall.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI = &amp;(GetBFI(*(CallerBB-&gt;getParent())));</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    CycleSavings += <a class="code" href="namespacellvm.html#a2f5363235d78b46831e31ddbb498c982">getCallsiteCost</a>(this-&gt;CandidateCall, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    CycleSavings *= *CallerBFI-&gt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html#a45e6b2c5c4e59ddc05ad9a2685706e75">getBlockProfileCount</a>(CallerBB);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// Remove the cost of the cold basic blocks.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> - ColdSize;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">// Allow tiny callees to be inlined regardless of whether they meet the</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">// savings threshold.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> &gt; <a class="code" href="InlineCost_8cpp.html#a857f17b7aaa9452a4a5f231e836feefd">InlineSizeAllowance</a> ? <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> - <a class="code" href="InlineCost_8cpp.html#a857f17b7aaa9452a4a5f231e836feefd">InlineSizeAllowance</a> : 1;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a5785ff0d45e059b3d783c960d3ee3759">CostBenefit</a>.emplace(<a class="code" href="classllvm_1_1APInt.html">APInt</a>(128, Size), CycleSavings);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// Return true if the savings justify the cost of inlining.  Specifically,</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// we evaluate the following inequality:</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">//  CycleSavings      PSI-&gt;getOrCompHotCountThreshold()</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// -------------- &gt;= -----------------------------------</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">//       Size              InlineSavingsMultiplier</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// Note that the left hand side is specific to a call site.  The right hand</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// side is a constant for the entire executable.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = CycleSavings;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> *= <a class="code" href="InlineCost_8cpp.html#aee1b90efc80e9ed2d7a7189e4570434b">InlineSavingsMultiplier</a>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>(128, PSI-&gt;getOrCompHotCountThreshold());</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> *= <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.uge(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> finalizeAnalysis()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">// Loops generally act a lot like calls in that they act like barriers to</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// movement, require a certain amount of setup, etc. So when optimising for</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// size, we penalise any call sites that perform loops. We do this after all</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// other costs here, so will likely only be dealing with relatively small</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// functions (and hence DT and LI will hopefully be cheap).</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = CandidateCall.<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>();</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;hasMinSize()) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> LI(DT);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordtype">int</span> NumLoops = 0;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : LI) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="comment">// Ignore loops that will not be executed</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">if</span> (DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(L-&gt;getHeader()))</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        NumLoops++;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      addCost(NumLoops * <a class="code" href="namespacellvm_1_1InlineConstants.html#a52751d994299ef16256d21b118eaaf82">InlineConstants::LoopPenalty</a>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// We applied the maximum possible vector bonus at the beginning. Now,</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// subtract the excess bonus, if any, from the Threshold before</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// comparing against Cost.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span> (NumVectorInstructions &lt;= NumInstructions / 10)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      Threshold -= VectorBonus;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumVectorInstructions &lt;= NumInstructions / 2)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      Threshold -= VectorBonus / 2;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;int&gt; AttrCost =</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(CandidateCall, <span class="stringliteral">&quot;function-inline-cost&quot;</span>))</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = *AttrCost;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;int&gt; AttrCostMult = <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            CandidateCall,</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <a class="code" href="namespacellvm_1_1InlineConstants.html#a3291338e19fa837f7b98305025a7d6c5">InlineConstants::FunctionInlineCostMultiplierAttributeName</a>))</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> *= *AttrCostMult;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;int&gt; AttrThreshold =</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(CandidateCall, <span class="stringliteral">&quot;function-inline-threshold&quot;</span>))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      Threshold = *AttrThreshold;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> Result = costBenefitAnalysis()) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      DecidedByCostBenefit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">if</span> (*Result)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;Cost over threshold.&quot;</span>);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (IgnoreThreshold)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    DecidedByCostThreshold = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> &lt; <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(1, Threshold)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;               ? <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>()</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;               : <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a>::failure(<span class="stringliteral">&quot;Cost over threshold.&quot;</span>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordtype">bool</span> shouldStop()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">if</span> (IgnoreThreshold || ComputeFullInlineCost)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="comment">// Bail out the moment we cross the threshold. This means we&#39;ll under-count</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="comment">// the cost, but only when undercounting doesn&#39;t matter.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">if</span> (Cost &lt; Threshold)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    DecidedByCostThreshold = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordtype">void</span> onLoadEliminationOpportunity()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    LoadEliminationCost += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> onAnalysisStart()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// Perform some tweaks to the cost and threshold based on the direct</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// callsite information.</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">// We want to more aggressively inline vector-dense kernels, so up the</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// threshold, and we&#39;ll lower it if the % of vector instructions gets too</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// low. Note that these bonuses are some what arbitrary and evolved over</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// time by accident as much as because they are principled bonuses.</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">// FIXME: It would be nice to remove all such bonuses. At least it would be</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// nice to base the bonus values on something more scientific.</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumInstructions == 0);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumVectorInstructions == 0);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// Update the threshold based on callsite properties</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    updateThreshold(CandidateCall, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// While Threshold depends on commandline options that can take negative</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// values, we want to enforce the invariant that the computed threshold and</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// bonuses are non-negative.</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Threshold &gt;= 0);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SingleBBBonus &gt;= 0);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VectorBonus &gt;= 0);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">// Speculatively apply all possible bonuses to Threshold. If cost exceeds</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">// this Threshold any time, and cost cannot decrease, we can stop processing</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="comment">// the rest of the function body.</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    Threshold += (SingleBBBonus + VectorBonus);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">// Give out bonuses for the callsite, as the instructions setting them up</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">// will be gone after inlining.</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    addCost(-<a class="code" href="namespacellvm.html#a2f5363235d78b46831e31ddbb498c982">getCallsiteCost</a>(this-&gt;CandidateCall, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>));</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">// If this function uses the coldcc calling convention, prefer not to inline</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">// it.</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getCallingConv() == <a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">CallingConv::Cold</a>)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> += <a class="code" href="namespacellvm_1_1InlineConstants.html#a169b2b8289fb0aefc607ae29c8b95cc6">InlineConstants::ColdccPenalty</a>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;      Initial cost: &quot;</span> &lt;&lt; Cost &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">// Check if we&#39;re done. This can happen due to bonuses and penalties.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordflow">if</span> (Cost &gt;= Threshold &amp;&amp; !ComputeFullInlineCost)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;high cost&quot;</span>);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  InlineCostCallAnalyzer(</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Callee, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <span class="keyword">const</span> <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> &amp;Params,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE = <span class="keyword">nullptr</span>, <span class="keywordtype">bool</span> BoostIndirect = <span class="keyword">true</span>,</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordtype">bool</span> IgnoreThreshold = <span class="keyword">false</span>)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      : CallAnalyzer(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, GetAssumptionCache, GetBFI, PSI, ORE),</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        ComputeFullInlineCost(<a class="code" href="InlineCost_8cpp.html#a1afb689cf73d254713061b112c900a72">OptComputeFullInlineCost</a> ||</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                              Params.ComputeFullInlineCost || ORE ||</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                              isCostBenefitAnalysisEnabled()),</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        Params(Params), Threshold(Params.<a class="code" href="InlineCost_8cpp.html#a88449ce28c2bd9290260794929242c0a">DefaultThreshold</a>),</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        BoostIndirectCalls(BoostIndirect), IgnoreThreshold(IgnoreThreshold),</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        CostBenefitAnalysisEnabled(isCostBenefitAnalysisEnabled()),</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        Writer(<a class="code" href="lib_2Analysis_2README_8txt.html#ad5ccdce1179bbfb942a084b3005f360d">this</a>) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    AllowRecursiveCall = *Params.<a class="code" href="structllvm_1_1InlineParams.html#a9d17fae32cf8dbe9afa4043766b5592a">AllowRecursiveCall</a>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">  /// Annotation Writer for instruction details</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"></span>  InlineCostAnnotationWriter Writer;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// Prints the same analysis as dump(), but its definition is not dependent</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="comment">// on the build.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  std::optional&lt;InstructionCostDetail&gt; getCostDetails(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">if</span> (InstructionCostDetailMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) != InstructionCostDetailMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">return</span> InstructionCostDetailMap[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keyword">virtual</span> ~InlineCostCallAnalyzer() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordtype">int</span> getThreshold()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Threshold; }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordtype">int</span> getCost()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>; }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordtype">int</span> getStaticBonusApplied()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> StaticBonusApplied; }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  std::optional&lt;CostBenefitPair&gt; getCostBenefitPair() { <span class="keywordflow">return</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a5785ff0d45e059b3d783c960d3ee3759">CostBenefit</a>; }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordtype">bool</span> wasDecidedByCostBenefit()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> DecidedByCostBenefit; }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="keywordtype">bool</span> wasDecidedByCostThreshold()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> DecidedByCostThreshold; }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;};</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">// Return true if CB is the sole call to local function Callee.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> isSoleCallToLocalFunction(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Callee) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>.hasLocalLinkage() &amp;&amp; <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>.hasOneLiveUse() &amp;&amp;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;         &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> == CB.<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keyword">class </span>InlineCostFeaturesAnalyzer final : <span class="keyword">public</span> CallAnalyzer {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <a class="code" href="namespacellvm.html#a9703f1294f70a821b4ddfb90b5322ea1">InlineCostFeatures</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = {};</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="comment">// FIXME: These constants are taken from the heuristic-based cost visitor.</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">// These should be removed entirely in a later revision to avoid reliance on</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="comment">// heuristics in the ML inliner.</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> JTCostMultiplier = 4;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> CaseClusterCostMultiplier = 2;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> SwitchCostMultiplier = 2;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// FIXME: These are taken from the heuristic-based cost visitor: we should</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">// eventually abstract these to the CallAnalyzer to avoid duplication.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordtype">unsigned</span> SROACostSavingOpportunities = 0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordtype">int</span> VectorBonus = 0;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">int</span> SingleBBBonus = 0;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordtype">int</span> Threshold = 5;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;AllocaInst *, unsigned&gt;</a> SROACosts;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordtype">void</span> increment(<a class="code" href="namespacellvm.html#a7ef78f96e07a124af3b346d8df9010cc">InlineCostFeatureIndex</a> Feature, int64_t Delta = 1) {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(Feature)] += Delta;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(<a class="code" href="namespacellvm.html#a7ef78f96e07a124af3b346d8df9010cc">InlineCostFeatureIndex</a> Feature, int64_t <a class="code" href="classllvm_1_1Value.html">Value</a>) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(Feature)] = <a class="code" href="classllvm_1_1Value.html">Value</a>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordtype">void</span> onDisableSROA(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keyword">auto</span> CostIt = SROACosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (CostIt == SROACosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    increment(InlineCostFeatureIndex::SROALosses, CostIt-&gt;second);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    SROACostSavingOpportunities -= CostIt-&gt;second;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    SROACosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">erase</a>(CostIt);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordtype">void</span> onDisableLoadElimination()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::LoadElimination, 1);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordtype">void</span> onCallPenalty()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    increment(<a class="code" href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">InlineCostFeatureIndex::CallPenalty</a>, <a class="code" href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">CallPenalty</a>);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordtype">void</span> onCallArgumentSetup(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    increment(InlineCostFeatureIndex::CallArgumentSetup,</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;              <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.arg_size() * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keywordtype">void</span> onLoadRelativeIntrinsic()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    increment(InlineCostFeatureIndex::LoadRelativeIntrinsic, 3 * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordtype">void</span> onLoweredCall(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                     <span class="keywordtype">bool</span> IsIndirectCall)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    increment(InlineCostFeatureIndex::LoweredCallArgSetup,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;              <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.arg_size() * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">if</span> (IsIndirectCall) {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> IndirectCallParams = {<span class="comment">/* DefaultThreshold*/</span> 0,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                         <span class="comment">/*HintThreshold*/</span> {},</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                         <span class="comment">/*ColdThreshold*/</span> {},</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                         <span class="comment">/*OptSizeThreshold*/</span> {},</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                         <span class="comment">/*OptMinSizeThreshold*/</span> {},</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                         <span class="comment">/*HotCallSiteThreshold*/</span> {},</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                         <span class="comment">/*LocallyHotCallSiteThreshold*/</span> {},</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                         <span class="comment">/*ColdCallSiteThreshold*/</span> {},</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                         <span class="comment">/*ComputeFullInlineCost*/</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                         <span class="comment">/*EnableDeferral*/</span> <span class="keyword">true</span>};</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      IndirectCallParams.<a class="code" href="structllvm_1_1InlineParams.html#aaa559292e3d904012000b7e1b767db85">DefaultThreshold</a> =</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          <a class="code" href="namespacellvm_1_1InlineConstants.html#a6e878d84d424326fd6132b320f075c97">InlineConstants::IndirectCallThreshold</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      InlineCostCallAnalyzer CA(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Call, IndirectCallParams, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                GetAssumptionCache, GetBFI, PSI, ORE, <span class="keyword">false</span>,</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                <span class="keyword">true</span>);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">if</span> (CA.analyze().isSuccess()) {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        increment(InlineCostFeatureIndex::NestedInlineCostEstimate,</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                  CA.getCost());</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        increment(InlineCostFeatureIndex::NestedInlines, 1);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      onCallPenalty();</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordtype">void</span> onFinalizeSwitch(<span class="keywordtype">unsigned</span> JumpTableSize,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                        <span class="keywordtype">unsigned</span> NumCaseCluster)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">if</span> (JumpTableSize) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      int64_t JTCost = <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(JumpTableSize) * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a> +</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                       JTCostMultiplier * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      increment(InlineCostFeatureIndex::JumpTablePenalty, JTCost);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">if</span> (NumCaseCluster &lt;= 3) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      increment(InlineCostFeatureIndex::CaseClusterPenalty,</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                NumCaseCluster * CaseClusterCostMultiplier * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    int64_t ExpectedNumberOfCompare =</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        getExpectedNumberOfCompare(NumCaseCluster);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    int64_t SwitchCost =</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        ExpectedNumberOfCompare * SwitchCostMultiplier * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    increment(InlineCostFeatureIndex::SwitchPenalty, SwitchCost);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordtype">void</span> onMissedSimplification()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    increment(InlineCostFeatureIndex::UnsimplifiedCommonInstructions,</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;              <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordtype">void</span> onInitializeSROAArg(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)<span class="keyword"> override </span>{ SROACosts[<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>] = 0; }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keywordtype">void</span> onAggregateSROAUse(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    SROACosts.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)-&gt;second += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    SROACostSavingOpportunities += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordtype">void</span> onBlockAnalyzed(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator()-&gt;getNumSuccessors() &gt; 1)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::IsMultipleBlocks, 1);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    Threshold -= SingleBBBonus;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> finalizeAnalysis()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = CandidateCall.<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>();</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;hasMinSize()) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> LI(DT);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : LI) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="comment">// Ignore loops that will not be executed</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="keywordflow">if</span> (DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(L-&gt;getHeader()))</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        increment(InlineCostFeatureIndex::NumLoops,</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                  <a class="code" href="namespacellvm_1_1InlineConstants.html#a52751d994299ef16256d21b118eaaf82">InlineConstants::LoopPenalty</a>);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::DeadBlocks, DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>());</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::SimplifiedInstructions,</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        NumInstructionsSimplified);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::ConstantArgs, NumConstantArgs);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::ConstantOffsetPtrArgs,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        NumConstantOffsetPtrArgs);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::SROASavings, SROACostSavingOpportunities);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> (NumVectorInstructions &lt;= NumInstructions / 10)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      Threshold -= VectorBonus;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumVectorInstructions &lt;= NumInstructions / 2)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      Threshold -= VectorBonus / 2;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::Threshold, Threshold);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordtype">bool</span> shouldStop()<span class="keyword"> override </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="keywordtype">void</span> onLoadEliminationOpportunity()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    increment(InlineCostFeatureIndex::LoadElimination, 1);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> onAnalysisStart()<span class="keyword"> override </span>{</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    increment(InlineCostFeatureIndex::CallSiteCost,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;              -1 * <a class="code" href="namespacellvm.html#a2f5363235d78b46831e31ddbb498c982">getCallsiteCost</a>(this-&gt;CandidateCall, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(InlineCostFeatureIndex::ColdCcPenalty,</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getCallingConv() == <a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">CallingConv::Cold</a>));</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a>(<a class="code" href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">InlineCostFeatureIndex::LastCallToStaticBonus</a>,</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        isSoleCallToLocalFunction(CandidateCall, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">// FIXME: we shouldn&#39;t repeat this logic in both the Features and Cost</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">// analyzer - instead, we should abstract it to a common method in the</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">// CallAnalyzer</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordtype">int</span> SingleBBBonusPercent = 50;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordtype">int</span> VectorBonusPercent = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa30e16357eef0a6bb3dc98fb7fd67684">getInlinerVectorBonusPercent</a>();</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    Threshold += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a7e5dd9267d6c9b90b4daa6410be3da6a">adjustInliningThreshold</a>(&amp;CandidateCall);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    Threshold *= <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aab827381fb7034818435387572088683">getInliningThresholdMultiplier</a>();</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    SingleBBBonus = Threshold * SingleBBBonusPercent / 100;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    VectorBonus = Threshold * VectorBonusPercent / 100;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    Threshold += (SingleBBBonus + VectorBonus);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  InlineCostFeaturesAnalyzer(</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; &amp;GetAssumptionCache,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI, <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Callee,</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call)</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      : CallAnalyzer(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, GetAssumptionCache, GetBFI, PSI) {}</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacellvm.html#a9703f1294f70a821b4ddfb90b5322ea1">InlineCostFeatures</a> &amp;features()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>; }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;};</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">/// Test whether the given value is an Alloca-derived function argument.</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> CallAnalyzer::isAllocaDerivedArg(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">return</span> SROAArgValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(V);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;}</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="keywordtype">void</span> CallAnalyzer::disableSROAForArg(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *SROAArg) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  onDisableSROA(SROAArg);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  EnabledSROAAllocas.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">erase</a>(SROAArg);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  disableLoadElimination();</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;}</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordtype">void</span> InlineCostAnnotationWriter::emitInstructionAnnot(</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1formatted__raw__ostream.html">formatted_raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>) {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">// The cost of inlining of the given instruction is printed always.</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="comment">// The threshold delta is printed only when it is non-zero. It happens</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// when we decided to give a bonus at a particular instruction.</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  std::optional&lt;InstructionCostDetail&gt; <a class="code" href="classllvm_1_1Record.html">Record</a> = ICCA-&gt;getCostDetails(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Record.html">Record</a>)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;; No analysis for the instruction&quot;</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;; cost before = &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;CostBefore</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, cost after = &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;CostAfter</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, threshold before = &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;ThresholdBefore</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, threshold after = &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;ThresholdAfter &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;cost delta = &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;getCostDelta();</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;hasThresholdChanged())</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;, threshold delta = &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Record.html">Record</a>-&gt;getThresholdDelta();</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keyword">auto</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = ICCA-&gt;getSimplifiedValue(<span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<span class="keyword">&gt;</span>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;, simplified to &quot;</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    (*C)-&gt;print(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;}</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">/// If &#39;V&#39; maps to a SROA candidate, disable SROA for it.</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> CallAnalyzer::disableSROA(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(V)) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    disableSROAForArg(SROAArg);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="keywordtype">void</span> CallAnalyzer::disableLoadElimination() {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordflow">if</span> (EnableLoadElimination) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    onDisableLoadElimination();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    EnableLoadElimination = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;}</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">/// Accumulate a constant GEP offset into an APInt if possible.</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">/// Returns false if unable to compute the offset for any reason. Respects any</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">/// simplified values known during the analysis of this callsite.</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> CallAnalyzer::accumulateGEPOffset(<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> &amp;<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordtype">unsigned</span> IntPtrWidth = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexTypeSizeInBits(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>.getType());</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IntPtrWidth == <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getBitWidth());</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>), GTE = <a class="code" href="namespacellvm.html#a43c6ebb4fd35ebd815d66a2df4eed0b9">gep_type_end</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;       GTI != GTE; ++GTI) {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *OpC = dyn_cast&lt;ConstantInt&gt;(GTI.getOperand());</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">if</span> (!OpC)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *SimpleOp = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(GTI.getOperand()))</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        OpC = dyn_cast&lt;ConstantInt&gt;(SimpleOp);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (!OpC)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">if</span> (OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>())</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">// Handle a struct index, which adds its field offset to the pointer.</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = GTI.getStructTypeOrNull()) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="keywordtype">unsigned</span> ElementIdx = OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1StructLayout.html">StructLayout</a> *SL = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getStructLayout(STy);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> += <a class="code" href="classllvm_1_1APInt.html">APInt</a>(IntPtrWidth, SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9b53bc4ade993c638837c1344465c1f8">getElementOffset</a>(ElementIdx));</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a>(IntPtrWidth, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(GTI.getIndexedType()));</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> += OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a9b5fc98b47d44d1150d3610bdfab1430">sextOrTrunc</a>(IntPtrWidth) * <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;}</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">/// Use TTI to check whether a GEP is free.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">/// Respects any simplified values known during the analysis of this callsite.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> CallAnalyzer::isGEPFree(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>.push_back(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>.getOperand(0));</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>.indices())</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *SimpleOp = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>.push_back(SimpleOp);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>.push_back(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(&amp;<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>,</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>) ==</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;         <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717">TargetTransformInfo::TCC_Free</a>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;}</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitAlloca(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  disableSROA(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0));</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="comment">// Check whether inlining will turn a dynamic alloca into a static</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="comment">// alloca and handle that case.</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isArrayAllocation()) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getArraySize());</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AllocSize = dyn_cast_or_null&lt;ConstantInt&gt;(Size)) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="comment">// Sometimes a dynamic alloca could be converted into a static alloca</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="comment">// after this constant prop, and become a huge static alloca on an</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="comment">// unconditional CFG path. Avoid inlining if this is going to happen above</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="comment">// a threshold.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="comment">// FIXME: If the threshold is removed or lowered too much, we could end up</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="comment">// being too pessimistic and prevent inlining non-problematic code. This</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="comment">// could result in unintended perf regressions. A better overall strategy</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="comment">// is needed to track stack usage during inlining.</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getAllocatedType();</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      AllocatedSize = <a class="code" href="namespacellvm.html#a9cb2daa4b6729813d1f8d39b9e037a5a">SaturatingMultiplyAdd</a>(</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          AllocSize-&gt;getLimitedValue(),</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty).getKnownMinValue(), AllocatedSize);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordflow">if</span> (AllocatedSize &gt; <a class="code" href="namespacellvm_1_1InlineConstants.html#a63bd3eb481440ad11d4b4905d2372f5e">InlineConstants::MaxSimplifiedDynamicAllocaToInline</a>)</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        HasDynamicAlloca = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  }</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="comment">// Accumulate the allocated size.</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isStaticAlloca()) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getAllocatedType();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    AllocatedSize = <a class="code" href="namespacellvm.html#a161dfc647ffe156fe6f145e0fcff95ed">SaturatingAdd</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty).getKnownMinValue(),</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                  AllocatedSize);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="comment">// FIXME: This is overly conservative. Dynamic allocas are inefficient for</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="comment">// a variety of reasons, and so we would like to not inline them into</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="comment">// functions which don&#39;t currently have a dynamic alloca. This simply</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="comment">// disables inlining altogether in the presence of a dynamic alloca.</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isStaticAlloca())</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    HasDynamicAlloca = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;}</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitPHI(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="comment">// FIXME: We need to propagate SROA *disabling* through phi nodes, even</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="comment">// though we don&#39;t want to propagate it&#39;s bonuses. The idea is to disable</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="comment">// SROA if it *might* be used in an inappropriate manner.</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">// Phi nodes are always zero-cost.</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="comment">// FIXME: Pointer sizes may differ between different address spaces, so do we</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="comment">// need to use correct address space in the call to getPointerSizeInBits here?</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// Or could we skip the getPointerSizeInBits call completely? As far as I can</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">// see the ZeroOffset is used as a dummy value, so we can probably use any</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="comment">// bit width for the ZeroOffset?</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> ZeroOffset = <a class="code" href="classllvm_1_1APInt.html#add4e37b60ea64faafbc9a5bf3e27280f">APInt::getZero</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSizeInBits(0));</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordtype">bool</span> CheckSROA = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isPointerTy();</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="comment">// Track the constant or pointer with constant offset we&#39;ve seen so far.</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *FirstC = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  std::pair&lt;Value *, APInt&gt; FirstBaseAndOffset = {<span class="keyword">nullptr</span>, ZeroOffset};</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstV = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumIncomingValues(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIncomingBlock(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// If the incoming block is dead, skip the incoming block.</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">if</span> (DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(Pred))</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// If the parent block of phi is not the known successor of the incoming</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">// block, skip the incoming block.</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *KnownSuccessor = KnownSuccessors[Pred];</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">if</span> (KnownSuccessor &amp;&amp; KnownSuccessor != <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent())</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIncomingValue(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">// If the incoming value is this phi itself, skip the incoming value.</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">if</span> (&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == V)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(V);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    std::pair&lt;Value *, APInt&gt; BaseAndOffset = {<span class="keyword">nullptr</span>, ZeroOffset};</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; CheckSROA)</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      BaseAndOffset = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(V);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; !BaseAndOffset.first)</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="comment">// The incoming value is neither a constant nor a pointer with constant</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="comment">// offset, exit early.</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">if</span> (FirstC) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">if</span> (FirstC == <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="comment">// If we&#39;ve seen a constant incoming value before and it is the same</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="comment">// constant we see this time, continue checking the next incoming value.</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="comment">// Otherwise early exit because we either see a different constant or saw</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="comment">// a constant before but we have a pointer with constant offset this time.</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">if</span> (FirstV) {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      <span class="comment">// The same logic as above, but check pointer with constant offset here.</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordflow">if</span> (FirstBaseAndOffset == BaseAndOffset)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="comment">// This is the 1st time we&#39;ve seen a constant, record it.</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      FirstC = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="comment">// The remaining case is that this is the 1st time we&#39;ve seen a pointer with</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// constant offset, record it.</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    FirstV = V;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    FirstBaseAndOffset = BaseAndOffset;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">// Check if we can map phi to a constant.</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordflow">if</span> (FirstC) {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = FirstC;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">// Check if we can map phi to a pointer with constant offset.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keywordflow">if</span> (FirstBaseAndOffset.first) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    ConstantOffsetPtrs[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = FirstBaseAndOffset;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(FirstV))</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      SROAArgValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = SROAArg;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;}</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">/// Check we can fold GEPs of constant-offset call site argument pointers.</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">/// This requires target data and inbounds GEPs.</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">/// \return true if the specified GEP can be folded.</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> CallAnalyzer::canFoldInboundsGEP(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="comment">// Check if we have a base + offset for the pointer.</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  std::pair&lt;Value *, APInt&gt; BaseAndOffset =</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPointerOperand());</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keywordflow">if</span> (!BaseAndOffset.first)</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="comment">// Check if the offset of this GEP is constant, and if so accumulate it</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">// into Offset.</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">if</span> (!accumulateGEPOffset(cast&lt;GEPOperator&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), BaseAndOffset.second))</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="comment">// Add the result as a new mapping to Base + Offset.</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  ConstantOffsetPtrs[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = BaseAndOffset;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;}</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitGetElementPtr(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPointerOperand());</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="comment">// Lambda to check whether a GEP&#39;s indices are all constant.</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keyword">auto</span> IsGEPOffsetConstant = [&amp;](<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>.indices())</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) &amp;&amp; !SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  };</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="InlineCost_8cpp.html#ac2f898cba8bf13271ebe0d59369c85ff">DisableGEPConstOperand</a>)</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isInBounds() &amp;&amp; canFoldInboundsGEP(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) || IsGEPOffsetConstant(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (SROAArg)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      SROAArgValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = SROAArg;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="comment">// Constant GEPs are modeled as free.</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">// Variable GEPs will require math and will disable SROA.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">if</span> (SROAArg)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    disableSROAForArg(SROAArg);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordflow">return</span> isGEPFree(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;}</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">/// Simplify \p I if its operands are constants and update SimplifiedValues.</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">CallAnalyzer::simplifyInstruction</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *&gt;</a> COps;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands()) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *COp = dyn_cast&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordflow">if</span> (!COp)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      COp = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">if</span> (!COp)</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    COps.push_back(COp);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a72278be77e997abc4b0dbde1be280006">ConstantFoldInstOperands</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, COps, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;}</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">/// Try to simplify a call to llvm.is.constant.</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">/// Duplicate the argument checking from CallAnalyzer::simplifyCallSite since</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">/// we expect calls of this specific intrinsic to be infrequent.</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">/// FIXME: Given that we know CB&#39;s parent (F) caller</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">/// (CandidateCall-&gt;getParent()-&gt;getParent()), we might be able to determine</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">/// whether inlining F into F&#39;s caller would change how the call to</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">/// llvm.is.constant would evaluate.</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> CallAnalyzer::simplifyIntrinsicCallIsConstant(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast_or_null&lt;Constant&gt;(SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>));</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RT = CB.<a class="code" href="classllvm_1_1CallBase.html#a5e4a09f80c7cd5283dbbc7256d122d12">getFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1FunctionType.html#ac453ad79a3d50950bac79bc9dff85918">getReturnType</a>();</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  SimplifiedValues[&amp;CB] = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(RT, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> ? 1 : 0);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;}</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::simplifyIntrinsicCallObjectSize(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="comment">// As per the langref, &quot;The fourth argument to llvm.objectsize determines if</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="comment">// the value should be evaluated at runtime.&quot;</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keywordflow">if</span>(cast&lt;ConstantInt&gt;(CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3))-&gt;isOne())</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="namespacellvm.html#a2f635b6d5c5f74d0c2e359897a5e7498">lowerObjectSizeCall</a>(&amp;cast&lt;IntrinsicInst&gt;(CB), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                 <span class="comment">/*MustSucceed=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast_or_null&lt;Constant&gt;(V);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    SimplifiedValues[&amp;CB] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;}</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitBitCast(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">// Propagate constants through bitcasts.</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="comment">// Track base/offsets through casts</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  std::pair&lt;Value *, APInt&gt; BaseAndOffset =</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0));</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">// Casts don&#39;t change the offset, just wrap it up.</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="keywordflow">if</span> (BaseAndOffset.first)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    ConstantOffsetPtrs[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = BaseAndOffset;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="comment">// Also look for SROA candidates here.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)))</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    SROAArgValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = SROAArg;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="comment">// Bitcasts are always zero cost.</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;}</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitPtrToInt(<a class="code" href="classllvm_1_1PtrToIntInst.html">PtrToIntInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">// Propagate constants through ptrtoint.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="comment">// Track base/offset pairs when converted to a plain integer provided the</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="comment">// integer is large enough to represent the pointer.</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordtype">unsigned</span> IntegerSize = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;getScalarSizeInBits();</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordtype">unsigned</span> AS = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)-&gt;getType()-&gt;getPointerAddressSpace();</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">if</span> (IntegerSize == <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSizeInBits(AS)) {</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    std::pair&lt;Value *, APInt&gt; BaseAndOffset =</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0));</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">if</span> (BaseAndOffset.first)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      ConstantOffsetPtrs[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = BaseAndOffset;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="comment">// This is really weird. Technically, ptrtoint will disable SROA. However,</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <span class="comment">// unless that ptrtoint is *used* somewhere in the live basic blocks after</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="comment">// inlining, it will be nuked, and SROA should proceed. All of the uses which</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="comment">// would block SROA would also block SROA if applied directly to a pointer,</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">// and so we can just add the integer in here. The only places where SROA is</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="comment">// preserved either cannot fire on an integer, or won&#39;t in-and-of themselves</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="comment">// disable SROA (ext) w/o some later use that we would see and disable.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)))</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    SROAArgValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = SROAArg;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>) ==</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;         <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717">TargetTransformInfo::TCC_Free</a>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;}</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitIntToPtr(<a class="code" href="classllvm_1_1IntToPtrInst.html">IntToPtrInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="comment">// Propagate constants through ptrtoint.</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="comment">// Track base/offset pairs when round-tripped through a pointer without</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="comment">// modifications provided the integer is not too large.</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordtype">unsigned</span> IntegerSize = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;getScalarSizeInBits();</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">if</span> (IntegerSize &lt;= <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerTypeSizeInBits(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType())) {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    std::pair&lt;Value *, APInt&gt; BaseAndOffset = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">if</span> (BaseAndOffset.first)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      ConstantOffsetPtrs[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = BaseAndOffset;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="comment">// &quot;Propagate&quot; SROA here in the same manner as we do for ptrtoint above.</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    SROAArgValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = SROAArg;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>) ==</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;         <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717">TargetTransformInfo::TCC_Free</a>;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;}</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitCastInst(<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="comment">// Propagate constants through casts.</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="comment">// Disable SROA in the face of arbitrary casts we don&#39;t explicitly list</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="comment">// elsewhere.</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  disableSROA(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0));</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="comment">// If this is a floating-point cast, and the target says this operation</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">// is expensive, this may eventually become a library call. Treat the cost</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="comment">// as such.</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode()) {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordflow">case</span> Instruction::FPTrunc:</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">case</span> Instruction::FPExt:</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keywordflow">case</span> Instruction::UIToFP:</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">case</span> Instruction::SIToFP:</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordflow">case</span> Instruction::FPToUI:</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="keywordflow">case</span> Instruction::FPToSI:</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ad3b0e7df7704fa34e356e1178374b49e">getFPOpCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()) == <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8">TargetTransformInfo::TCC_Expensive</a>)</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      onCallPenalty();</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>) ==</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;         <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717">TargetTransformInfo::TCC_Free</a>;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;}</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::paramHasAttr(<a class="code" href="classllvm_1_1Argument.html">Argument</a> *A, <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">Attribute::AttrKind</a> Attr) {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="keywordflow">return</span> CandidateCall.<a class="code" href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">paramHasAttr</a>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>-&gt;getArgNo(), Attr);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;}</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::isKnownNonNullInCallee(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="comment">// Does the *call site* have the NonNull attribute set on an argument?  We</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// use the attribute on the call site to memoize any analysis done in the</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="comment">// caller. This will also trip if the callee function has a non-null</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="comment">// parameter attribute, but that&#39;s a less interesting case because hopefully</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="comment">// the callee would already have been simplified based on that.</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> *A = dyn_cast&lt;Argument&gt;(V))</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">if</span> (paramHasAttr(A, Attribute::NonNull))</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="comment">// Is this an alloca in the caller?  This is distinct from the attribute case</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="comment">// above because attributes aren&#39;t updated within the inliner itself and we</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="comment">// always want to catch the alloca derived case.</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keywordflow">if</span> (isAllocaDerivedArg(V))</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// We can actually predict the result of comparisons between an</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// alloca-derived value and null. Note that this fires regardless of</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="comment">// SROA firing.</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::allowSizeGrowth(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call) {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="comment">// If the normal destination of the invoke or the parent block of the call</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="comment">// site is unreachable-terminated, there is little point in inlining this</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="comment">// unless there is literally zero cost.</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// FIXME: Note that it is possible that an unreachable-terminated block has a</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="comment">// hot entry. For example, in below scenario inlining hot_call_X() may be</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="comment">// beneficial :</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">// main() {</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="comment">//   hot_call_1();</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="comment">//   ...</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="comment">//   hot_call_N()</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="comment">//   exit(0);</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">// For now, we are not handling this corner case here as it is rare in real</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">// code. In future, we should elaborate this based on BPI and BFI in more</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="comment">// general threshold adjusting heuristics in updateThreshold().</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1InvokeInst.html">InvokeInst</a> *II = dyn_cast&lt;InvokeInst&gt;(&amp;Call)) {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UnreachableInst&gt;(II-&gt;getNormalDest()-&gt;getTerminator()))</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;UnreachableInst&gt;(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getParent()-&gt;getTerminator()))</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;}</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="GlobalOpt_8cpp.html#a652ede21e988a4de569cdbc7863ea234">InlineCostCallAnalyzer::isColdCallSite</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call,</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                            <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI) {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">// If global profile summary is available, then callsite&#39;s coldness is</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">// determined based on that.</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="keywordflow">if</span> (PSI &amp;&amp; PSI-&gt;hasProfileSummary())</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">return</span> PSI-&gt;isColdCallSite(Call, CallerBFI);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// Otherwise we need BFI to be available.</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="keywordflow">if</span> (!CallerBFI)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">// Determine if the callsite is cold relative to caller&#39;s entry. We could</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="comment">// potentially cache the computation of scaled entry frequency, but the added</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="comment">// complexity is not worth it unless this scaling shows up high in the</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">// profiles.</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> ColdProb(<a class="code" href="InlineCost_8cpp.html#a201484c094c4d9ad96166714816b99c4">ColdCallSiteRelFreq</a>, 100);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="keyword">auto</span> CallSiteBB = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getParent();</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keyword">auto</span> CallSiteFreq = CallerBFI-&gt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html#ab8b72c18add22acd827f7a6cd1ff1bff">getBlockFreq</a>(CallSiteBB);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keyword">auto</span> CallerEntryFreq =</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      CallerBFI-&gt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html#ab8b72c18add22acd827f7a6cd1ff1bff">getBlockFreq</a>(&amp;(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getCaller()-&gt;getEntryBlock()));</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keywordflow">return</span> CallSiteFreq &lt; CallerEntryFreq * ColdProb;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;}</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;std::optional&lt;int&gt;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;InlineCostCallAnalyzer::getHotCallSiteThreshold(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call,</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                                <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI) {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="comment">// If global profile summary is available, then callsite&#39;s hotness is</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="comment">// determined based on that.</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">if</span> (PSI &amp;&amp; PSI-&gt;hasProfileSummary() &amp;&amp; PSI-&gt;isHotCallSite(Call, CallerBFI))</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordflow">return</span> Params.<a class="code" href="structllvm_1_1InlineParams.html#a75e7c36ed7f71d0c4afca48f835a098b">HotCallSiteThreshold</a>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="comment">// Otherwise we need BFI to be available and to have a locally hot callsite</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="comment">// threshold.</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="keywordflow">if</span> (!CallerBFI || !Params.<a class="code" href="structllvm_1_1InlineParams.html#ac905a11da0015923ced48e7d1565f46c">LocallyHotCallSiteThreshold</a>)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="comment">// Determine if the callsite is hot relative to caller&#39;s entry. We could</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="comment">// potentially cache the computation of scaled entry frequency, but the added</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">// complexity is not worth it unless this scaling shows up high in the</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="comment">// profiles.</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keyword">auto</span> CallSiteBB = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getParent();</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keyword">auto</span> CallSiteFreq = CallerBFI-&gt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html#ab8b72c18add22acd827f7a6cd1ff1bff">getBlockFreq</a>(CallSiteBB).<a class="code" href="classllvm_1_1BlockFrequency.html#a8e9ed6b20c2503f66f1fd0725297aedc">getFrequency</a>();</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="keyword">auto</span> CallerEntryFreq = CallerBFI-&gt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html#ab15a975a1c647356007e6b622ec99fb5">getEntryFreq</a>();</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">if</span> (CallSiteFreq &gt;= CallerEntryFreq * <a class="code" href="InlineCost_8cpp.html#ad997850fcf588e85cfb6fe9642aa8ffa">HotCallSiteRelFreq</a>)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">return</span> Params.<a class="code" href="structllvm_1_1InlineParams.html#ac905a11da0015923ced48e7d1565f46c">LocallyHotCallSiteThreshold</a>;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="comment">// Otherwise treat it normally.</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;}</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="keywordtype">void</span> InlineCostCallAnalyzer::updateThreshold(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Callee) {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <span class="comment">// If no size growth is allowed for this inlining, set Threshold to 0.</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="keywordflow">if</span> (!allowSizeGrowth(Call)) {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    Threshold = 0;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getCaller();</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="comment">// return min(A, B) if B is valid.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keyword">auto</span> MinIfValid = [](<span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, std::optional&lt;int&gt; <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> ? <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(A, *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) : <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  };</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">// return max(A, B) if B is valid.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keyword">auto</span> MaxIfValid = [](<span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>, std::optional&lt;int&gt; <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> ? <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(A, *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) : <a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  };</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="comment">// Various bonus percentages. These are multiplied by Threshold to get the</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="comment">// bonus values.</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <span class="comment">// SingleBBBonus: This bonus is applied if the callee has a single reachable</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="comment">// basic block at the given callsite context. This is speculatively applied</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="comment">// and withdrawn if more than one basic block is seen.</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="comment">// LstCallToStaticBonus: This large bonus is applied to ensure the inlining</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="comment">// of the last call to a static function as inlining such functions is</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <span class="comment">// guaranteed to reduce code size.</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="comment">// These bonus percentages may be set to 0 based on properties of the caller</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <span class="comment">// and the callsite.</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="keywordtype">int</span> SingleBBBonusPercent = 50;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="keywordtype">int</span> VectorBonusPercent = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa30e16357eef0a6bb3dc98fb7fd67684">getInlinerVectorBonusPercent</a>();</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">LastCallToStaticBonus</a> = <a class="code" href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">InlineConstants::LastCallToStaticBonus</a>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="comment">// Lambda to set all the above bonus and bonus percentages to 0.</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <span class="keyword">auto</span> DisallowAllBonuses = [&amp;]() {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    SingleBBBonusPercent = 0;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    VectorBonusPercent = 0;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <a class="code" href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">LastCallToStaticBonus</a> = 0;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  };</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="comment">// Use the OptMinSizeThreshold or OptSizeThreshold knob if they are available</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="comment">// and reduce the threshold if the caller has the necessary attribute.</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;hasMinSize()) {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    Threshold = MinIfValid(Threshold, Params.<a class="code" href="structllvm_1_1InlineParams.html#a28b79b1b8e1c2f68da272b1778504be0">OptMinSizeThreshold</a>);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="comment">// For minsize, we want to disable the single BB bonus and the vector</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="comment">// bonuses, but not the last-call-to-static bonus. Inlining the last call to</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="comment">// a static function will, at the minimum, eliminate the parameter setup and</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">// call/return instructions.</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    SingleBBBonusPercent = 0;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    VectorBonusPercent = 0;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;hasOptSize())</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    Threshold = MinIfValid(Threshold, Params.<a class="code" href="structllvm_1_1InlineParams.html#a38e17a3379fe0336330cda390fd23fea">OptSizeThreshold</a>);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="comment">// Adjust the threshold based on inlinehint attribute and profile based</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="comment">// hotness information if the caller does not have MinSize attribute.</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;hasMinSize()) {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>.hasFnAttribute(Attribute::InlineHint))</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      Threshold = MaxIfValid(Threshold, Params.<a class="code" href="structllvm_1_1InlineParams.html#ac5fa84316036c761096ad4f9a07ccca2">HintThreshold</a>);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">// FIXME: After switching to the new passmanager, simplify the logic below</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">// by checking only the callsite hotness/coldness as we will reliably</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// have local profile information.</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">// Callsite hotness and coldness can be determined if sample profile is</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">// used (which adds hotness metadata to calls) or if caller&#39;s</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">// BlockFrequencyInfo is available.</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *CallerBFI = GetBFI ? &amp;(GetBFI(*Caller)) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keyword">auto</span> <a class="code" href="InlineCost_8cpp.html#a78324e64ee175c0703c3db3ce45943cc">HotCallSiteThreshold</a> = getHotCallSiteThreshold(Call, CallerBFI);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;hasOptSize() &amp;&amp; <a class="code" href="InlineCost_8cpp.html#a78324e64ee175c0703c3db3ce45943cc">HotCallSiteThreshold</a>) {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Hot callsite.\n&quot;</span>);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="comment">// FIXME: This should update the threshold only if it exceeds the</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">// current threshold, but AutoFDO + ThinLTO currently relies on this</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="comment">// behavior to prevent inlining of hot callsites during ThinLTO</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="comment">// compile phase.</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      Threshold = *<a class="code" href="InlineCost_8cpp.html#a78324e64ee175c0703c3db3ce45943cc">HotCallSiteThreshold</a>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="GlobalOpt_8cpp.html#a652ede21e988a4de569cdbc7863ea234">isColdCallSite</a>(Call, CallerBFI)) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cold callsite.\n&quot;</span>);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="comment">// Do not apply bonuses for a cold callsite including the</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="comment">// LastCallToStatic bonus. While this bonus might result in code size</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="comment">// reduction, it can cause the size of a non-cold caller to increase</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="comment">// preventing it from being inlined.</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      DisallowAllBonuses();</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      Threshold = MinIfValid(Threshold, Params.<a class="code" href="structllvm_1_1InlineParams.html#a5be58f238f61d418cfa212e7768c8ea3">ColdCallSiteThreshold</a>);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSI) {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="comment">// Use callee&#39;s global profile information only if we have no way of</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="comment">// determining this via callsite information.</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <span class="keywordflow">if</span> (PSI-&gt;isFunctionEntryHot(&amp;Callee)) {</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Hot callee.\n&quot;</span>);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="comment">// If callsite hotness can not be determined, we may still know</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="comment">// that the callee is hot and treat it as a weaker hint for threshold</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="comment">// increase.</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        Threshold = MaxIfValid(Threshold, Params.<a class="code" href="structllvm_1_1InlineParams.html#ac5fa84316036c761096ad4f9a07ccca2">HintThreshold</a>);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSI-&gt;isFunctionEntryCold(&amp;Callee)) {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cold callee.\n&quot;</span>);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="comment">// Do not apply bonuses for a cold callee including the</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="comment">// LastCallToStatic bonus. While this bonus might result in code size</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="comment">// reduction, it can cause the size of a non-cold caller to increase</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">// preventing it from being inlined.</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        DisallowAllBonuses();</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        Threshold = MinIfValid(Threshold, Params.<a class="code" href="structllvm_1_1InlineParams.html#a709f2e88554f9b1dc20e16371813aa84">ColdThreshold</a>);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  Threshold += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a7e5dd9267d6c9b90b4daa6410be3da6a">adjustInliningThreshold</a>(&amp;Call);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">// Finally, take the target-specific inlining threshold multiplier into</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="comment">// account.</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  Threshold *= <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aab827381fb7034818435387572088683">getInliningThresholdMultiplier</a>();</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  SingleBBBonus = Threshold * SingleBBBonusPercent / 100;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  VectorBonus = Threshold * VectorBonusPercent / 100;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// If there is only one call of the function, and it has internal linkage,</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="comment">// the cost of inlining it drops dramatically. It may seem odd to update</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="comment">// Cost in updateThreshold, but the bonus depends on the logic in this method.</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">if</span> (isSoleCallToLocalFunction(Call, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> -= <a class="code" href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">LastCallToStaticBonus</a>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    StaticBonusApplied = <a class="code" href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">LastCallToStaticBonus</a>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitCmpInst(<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0), *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="comment">// First try to handle simplified comparisons.</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == Instruction::FCmp)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="comment">// Otherwise look for a comparison between constant offset pointers with</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="comment">// a common base.</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSBase, *RHSBase;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> LHSOffset, RHSOffset;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  std::tie(LHSBase, LHSOffset) = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="keywordflow">if</span> (LHSBase) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    std::tie(RHSBase, RHSOffset) = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span> (RHSBase &amp;&amp; LHSBase == RHSBase) {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="comment">// We have common bases, fold the icmp to a constant based on the</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="comment">// offsets.</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CLHS = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), LHSOffset);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CRHS = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), RHSOffset);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantExpr.html#a68fce0638c5ec7b96b8572cad9c20488">ConstantExpr::getICmp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPredicate(), CLHS, CRHS)) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        ++NumConstantPtrCmps;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      }</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="comment">// If the comparison is an equality comparison with null, we can simplify it</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="comment">// if we know the value (argument) can&#39;t be null</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isEquality() &amp;&amp; isa&lt;ConstantPointerNull&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1)) &amp;&amp;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      isKnownNonNullInCallee(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0))) {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="keywordtype">bool</span> IsNotEqual = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPredicate() == <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a>;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = IsNotEqual ? <a class="code" href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType())</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                                      : <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>::<a class="code" href="InstructionSimplify_8cpp.html#adb39181b87dffcd61082d08e02bf314e">getFalse</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.<a class="code" href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a>());</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordflow">return</span> handleSROA(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0), isa&lt;ConstantPointerNull&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1)));</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;}</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitSub(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="comment">// Try to handle a special case: we can fold computing the difference of two</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="comment">// constant-related pointers.</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0), *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSBase, *RHSBase;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> LHSOffset, RHSOffset;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  std::tie(LHSBase, LHSOffset) = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keywordflow">if</span> (LHSBase) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    std::tie(RHSBase, RHSOffset) = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">if</span> (RHSBase &amp;&amp; LHSBase == RHSBase) {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="comment">// We have common bases, fold the subtract to a constant based on the</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="comment">// offsets.</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CLHS = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), LHSOffset);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CRHS = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), RHSOffset);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantExpr.html#a554ab77949b0a16670a83ec3307501eb">ConstantExpr::getSub</a>(CLHS, CRHS)) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        ++NumConstantPtrDiffs;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">// Otherwise, fall back to the generic logic for simplifying and handling</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">// instructions.</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keywordflow">return</span> Base::visitSub(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;}</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160; </div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitBinaryOperator(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0), *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CLHS = dyn_cast&lt;Constant&gt;(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordflow">if</span> (!CLHS)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    CLHS = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CRHS = dyn_cast&lt;Constant&gt;(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keywordflow">if</span> (!CRHS)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    CRHS = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SimpleV = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> FI = dyn_cast&lt;FPMathOperator&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    SimpleV = <a class="code" href="namespacellvm.html#aa750395459fa1eb7130d6de8e3d074f6">simplifyBinOp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(), CLHS ? CLHS : <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, CRHS ? CRHS : <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                            FI-&gt;getFastMathFlags(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    SimpleV =</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <a class="code" href="namespacellvm.html#aa750395459fa1eb7130d6de8e3d074f6">simplifyBinOp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(), CLHS ? CLHS : <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, CRHS ? CRHS : <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast_or_null&lt;Constant&gt;(SimpleV))</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="keywordflow">if</span> (SimpleV)</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="comment">// Disable any SROA on arguments to arbitrary, unsimplified binary operators.</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  disableSROA(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  disableSROA(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">// If the instruction is floating point, and the target says this operation</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="comment">// is expensive, this may eventually become a library call. Treat the cost</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <span class="comment">// as such. Unless it&#39;s fneg which can be implemented with an xor.</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isFloatingPointTy() &amp;&amp;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ad3b0e7df7704fa34e356e1178374b49e">getFPOpCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()) == <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8">TargetTransformInfo::TCC_Expensive</a> &amp;&amp;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">m_FNeg</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>())))</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    onCallPenalty();</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;}</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitFNeg(<a class="code" href="classllvm_1_1UnaryOperator.html">UnaryOperator</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *COp = dyn_cast&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="keywordflow">if</span> (!COp)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    COp = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SimpleV = <a class="code" href="namespacellvm.html#a6e06e93488a2f32aeb56f86797a78c33">simplifyFNegInst</a>(</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      COp ? COp : <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, cast&lt;FPMathOperator&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).getFastMathFlags(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast_or_null&lt;Constant&gt;(SimpleV))</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    SimplifiedValues[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keywordflow">if</span> (SimpleV)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">// Disable any SROA on arguments to arbitrary, unsimplified fneg.</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  disableSROA(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;}</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitLoad(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="keywordflow">if</span> (handleSROA(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPointerOperand(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isSimple()))</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="comment">// If the data is already loaded from this address and hasn&#39;t been clobbered</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="comment">// by any stores or calls, this load is likely to be redundant and can be</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="comment">// eliminated.</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">if</span> (EnableLoadElimination &amp;&amp;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      !LoadAddrSet.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPointerOperand()).second &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isUnordered()) {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    onLoadEliminationOpportunity();</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  }</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  onMemAccess();</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;}</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="keywordflow">if</span> (handleSROA(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPointerOperand(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isSimple()))</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="comment">// The store can potentially clobber loads and prevent repeated loads from</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">// being eliminated.</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="comment">// FIXME:</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="comment">// 1. We can probably keep an initial set of eliminatable loads substracted</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="comment">// from the cost even when we finally see a store. We just need to disable</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <span class="comment">// *further* accumulation of elimination savings.</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="comment">// 2. We should probably at some point thread MemorySSA for the callee into</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="comment">// this and then use that to actually compute *really* precise savings.</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  disableLoadElimination();</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  onMemAccess();</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;}</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitExtractValue(<a class="code" href="classllvm_1_1ExtractValueInst.html">ExtractValueInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="comment">// Constant folding for extract value is trivial.</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="comment">// SROA can&#39;t look through these, but they may be free.</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordflow">return</span> Base::visitExtractValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;}</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitInsertValue(<a class="code" href="classllvm_1_1InsertValueInst.html">InsertValueInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="comment">// Constant folding for insert value is trivial.</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="comment">// SROA can&#39;t look through these, but they may be free.</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="keywordflow">return</span> Base::visitInsertValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;}</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">/// Try to simplify a call site.</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">/// Takes a concrete function and callsite and tries to actually simplify it by</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">/// analyzing the arguments and call itself with instsimplify. Returns true if</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">/// it has simplified the callsite to some other entity (a constant), making it</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">/// free.</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> CallAnalyzer::simplifyCallSite(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call) {</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="comment">// FIXME: Using the instsimplify logic directly for this is inefficient</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="comment">// because we have to continually rebuild the argument list even when no</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="comment">// simplifications can be performed. Until that is fixed with remapping</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="comment">// inside of instsimplify, directly constant fold calls here.</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a20f356124998d05f7e605549cc2dda91">canConstantFoldCallTo</a>(&amp;Call, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="comment">// Try to re-map the arguments to constants.</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 4&gt;</a> ConstantArgs;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  ConstantArgs.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.arg_size());</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.args()) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast_or_null&lt;Constant&gt;(SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// This argument doesn&#39;t map to a constant.</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    ConstantArgs.push_back(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#a57bbf83a870bd632acf3165c19da8f44">ConstantFoldCall</a>(&amp;Call, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ConstantArgs)) {</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    SimplifiedValues[&amp;<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitCallBase(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call) {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="keywordflow">if</span> (!onCallBaseVisitStart(Call))</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.hasFnAttr(Attribute::ReturnsTwice) &amp;&amp;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      !<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(Attribute::ReturnsTwice)) {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">// This aborts the entire analysis.</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    ExposesReturnsTwice = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keywordflow">if</span> (isa&lt;CallInst&gt;(Call) &amp;&amp; cast&lt;CallInst&gt;(Call).cannotDuplicate())</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    ContainsNoDuplicateCall = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getCalledFunction();</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <span class="keywordtype">bool</span> IsIndirectCall = !<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">if</span> (IsIndirectCall) {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">// Check if this happens to be an indirect function call to a known function</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// in this inline context. If not, we&#39;ve done all we can.</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getCalledOperand();</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = dyn_cast_or_null&lt;Function&gt;(SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(Callee));</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> || <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getFunctionType() != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getFunctionType()) {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      onCallArgumentSetup(Call);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.onlyReadsMemory())</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        disableLoadElimination();</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <span class="keywordflow">return</span> Base::visitCallBase(Call);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; <span class="stringliteral">&quot;Expected a call to a known function&quot;</span>);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">// When we have a concrete function, first try to simplify it directly.</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keywordflow">if</span> (simplifyCallSite(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Call))</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="comment">// Next check if it is an intrinsic we know about.</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="comment">// FIXME: Lift this into part of the InstVisitor.</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;Call)) {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordflow">switch</span> (II-&gt;getIntrinsicID()) {</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.onlyReadsMemory() &amp;&amp; !<a class="code" href="namespacellvm.html#a1f2f83d3af349e89d62c6277ba668b4f">isAssumeLikeIntrinsic</a>(II))</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        disableLoadElimination();</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      <span class="keywordflow">return</span> Base::visitCallBase(Call);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keywordflow">case</span> Intrinsic::load_relative:</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      onLoadRelativeIntrinsic();</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keywordflow">case</span> Intrinsic::memset:</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">Intrinsic::memcpy</a>:</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordflow">case</span> Intrinsic::memmove:</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      disableLoadElimination();</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="comment">// SROA can usually chew through these intrinsics, but they aren&#39;t free.</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordflow">case</span> Intrinsic::icall_branch_funnel:</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="keywordflow">case</span> Intrinsic::localescape:</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      HasUninlineableIntrinsic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">case</span> Intrinsic::vastart:</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      InitsVargArgs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keywordflow">case</span> Intrinsic::launder_invariant_group:</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">case</span> Intrinsic::strip_invariant_group:</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(II-&gt;getOperand(0)))</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        SROAArgValues[II] = SROAArg;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="keywordflow">case</span> Intrinsic::is_constant:</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <span class="keywordflow">return</span> simplifyIntrinsicCallIsConstant(Call);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">case</span> Intrinsic::objectsize:</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keywordflow">return</span> simplifyIntrinsicCallObjectSize(Call);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.getFunction()) {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="comment">// This flag will fully abort the analysis, so don&#39;t bother with anything</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">// else.</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    IsRecursiveCall = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">if</span> (!AllowRecursiveCall)</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#aa8b08fb48c8c58e63aa231a1099475d9">isLoweredToCall</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    onLoweredCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Call, IsIndirectCall);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>.onlyReadsMemory() || (IsIndirectCall &amp;&amp; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;onlyReadsMemory())))</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    disableLoadElimination();</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keywordflow">return</span> Base::visitCallBase(Call);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;}</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitReturnInst(<a class="code" href="classllvm_1_1ReturnInst.html">ReturnInst</a> &amp;RI) {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">// At least one return instruction will be free after inlining.</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a264176188c0aadccd3ca5b6929b5a2e1ab24ce0cd392a5b0b8dedc66c25213594">Free</a> = !HasReturn;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  HasReturn = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a264176188c0aadccd3ca5b6929b5a2e1ab24ce0cd392a5b0b8dedc66c25213594">Free</a>;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitBranchInst(<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> &amp;BI) {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="comment">// We model unconditional branches as essentially free -- they really</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="comment">// shouldn&#39;t exist at all, but handling them makes the behavior of the</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="comment">// inliner more regular and predictable. Interestingly, conditional branches</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  <span class="comment">// which will fold away are also free.</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="keywordflow">return</span> BI.<a class="code" href="classllvm_1_1BranchInst.html#ad56f6a9b5cd05940017c4544df48bc30">isUnconditional</a>() || isa&lt;ConstantInt&gt;(BI.<a class="code" href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">getCondition</a>()) ||</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;         isa_and_nonnull&lt;ConstantInt&gt;(</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;             SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(BI.<a class="code" href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">getCondition</a>()));</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;}</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitSelectInst(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <span class="keywordtype">bool</span> CheckSROA = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getType()-&gt;isPointerTy();</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">TrueVal</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getTrueValue();</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getFalseValue();</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *TrueC = dyn_cast&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">TrueVal</a>);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="keywordflow">if</span> (!TrueC)</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    TrueC = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">TrueVal</a>);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *FalseC = dyn_cast&lt;Constant&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a>);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <span class="keywordflow">if</span> (!FalseC)</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    FalseC = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CondC =</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      dyn_cast_or_null&lt;Constant&gt;(SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition()));</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="keywordflow">if</span> (!CondC) {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="comment">// Select C, X, X =&gt; X</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keywordflow">if</span> (TrueC == FalseC &amp;&amp; TrueC) {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      SimplifiedValues[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = TrueC;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    }</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">if</span> (!CheckSROA)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="keywordflow">return</span> Base::visitSelectInst(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    std::pair&lt;Value *, APInt&gt; TrueBaseAndOffset =</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">TrueVal</a>);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    std::pair&lt;Value *, APInt&gt; FalseBaseAndOffset =</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordflow">if</span> (TrueBaseAndOffset == FalseBaseAndOffset &amp;&amp; TrueBaseAndOffset.first) {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      ConstantOffsetPtrs[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = TrueBaseAndOffset;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">TrueVal</a>))</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        SROAArgValues[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = SROAArg;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">return</span> Base::visitSelectInst(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  <span class="comment">// Select condition is a constant.</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SelectedV = CondC-&gt;<a class="code" href="classllvm_1_1Constant.html#a662be1e66a5af621d46fa1c7a8aa1004">isAllOnesValue</a>()  ? <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">TrueVal</a></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                     : (CondC-&gt;<a class="code" href="classllvm_1_1Constant.html#ae4b6abe77abf42fb02081a6cc41a0132">isNullValue</a>()) ? <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                                              : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="keywordflow">if</span> (!SelectedV) {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="comment">// Condition is a vector constant that is not all 1s or all 0s.  If all</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">// operands are constants, ConstantExpr::getSelect() can handle the cases</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="comment">// such as select vectors.</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keywordflow">if</span> (TrueC &amp;&amp; FalseC) {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="classllvm_1_1ConstantExpr.html#a8683922a4b3d122c3b0d7d53b1cde2ad">ConstantExpr::getSelect</a>(CondC, TrueC, FalseC)) {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        SimplifiedValues[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keywordflow">return</span> Base::visitSelectInst(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  }</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="comment">// Condition is either all 1s or all 0s. SI can be simplified.</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *SelectedC = dyn_cast&lt;Constant&gt;(SelectedV)) {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    SimplifiedValues[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = SelectedC;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="keywordflow">if</span> (!CheckSROA)</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  std::pair&lt;Value *, APInt&gt; BaseAndOffset =</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(SelectedV);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">if</span> (BaseAndOffset.first) {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    ConstantOffsetPtrs[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = BaseAndOffset;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = getSROAArgForValueOrNull(SelectedV))</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      SROAArgValues[&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>] = SROAArg;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;}</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitSwitchInst(<a class="code" href="classllvm_1_1SwitchInst.html">SwitchInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="comment">// We model unconditional switches as free, see the comments on handling</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="comment">// branches.</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantInt&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition()))</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition()))</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantInt&gt;(V))</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160; </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="comment">// Assume the most general case where the switch is lowered into</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <span class="comment">// either a jump table, bit test, or a balanced binary tree consisting of</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <span class="comment">// case clusters without merging adjacent clusters with the same</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="comment">// destination. We do not consider the switches that are lowered with a mix</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="comment">// of jump table/bit test/binary search tree. The cost of the switch is</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="comment">// proportional to the size of the tree or the size of jump table range.</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  <span class="comment">// NB: We convert large switches which are just used to initialize large phi</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <span class="comment">// nodes to lookup tables instead in simplifycfg, so this shouldn&#39;t prevent</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <span class="comment">// inlining those. It will prevent inlining in cases where the optimization</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  <span class="comment">// does not (yet) fire.</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordtype">unsigned</span> JumpTableSize = 0;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a> = GetBFI ? &amp;(GetBFI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  <span class="keywordtype">unsigned</span> NumCaseCluster =</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a64b0a3c3724fe2cb1b335007c068179d">getEstimatedNumberOfCaseClusters</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, JumpTableSize, PSI, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; </div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  onFinalizeSwitch(JumpTableSize, NumCaseCluster);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;}</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitIndirectBrInst(<a class="code" href="classllvm_1_1IndirectBrInst.html">IndirectBrInst</a> &amp;IBI) {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="comment">// We never want to inline functions that contain an indirectbr.  This is</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="comment">// incorrect because all the blockaddress&#39;s (in static global initializers</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="comment">// for example) would be referring to the original function, and this</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="comment">// indirect jump would jump from the inlined copy of the function into the</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="comment">// original function which is extremely undefined behavior.</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="comment">// FIXME: This logic isn&#39;t really right; we can safely inline functions with</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="comment">// indirectbr&#39;s as long as no other function or global references the</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="comment">// blockaddress of a block within the current function.</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  HasIndirectBr = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;}</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitResumeInst(<a class="code" href="classllvm_1_1ResumeInst.html">ResumeInst</a> &amp;RI) {</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="comment">// FIXME: It&#39;s not clear that a single instruction is an accurate model for</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="comment">// the inline cost of a resume instruction.</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;}</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitCleanupReturnInst(<a class="code" href="classllvm_1_1CleanupReturnInst.html">CleanupReturnInst</a> &amp;CRI) {</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="comment">// FIXME: It&#39;s not clear that a single instruction is an accurate model for</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="comment">// the inline cost of a cleanupret instruction.</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;}</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitCatchReturnInst(<a class="code" href="classllvm_1_1CatchReturnInst.html">CatchReturnInst</a> &amp;CRI) {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <span class="comment">// FIXME: It&#39;s not clear that a single instruction is an accurate model for</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <span class="comment">// the inline cost of a catchret instruction.</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;}</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitUnreachableInst(<a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <span class="comment">// FIXME: It might be reasonably to discount the cost of instructions leading</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  <span class="comment">// to unreachable as they have the lowest possible impact on both runtime and</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="comment">// code size.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// No actual code is needed for unreachable.</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;}</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="keywordtype">bool</span> CallAnalyzer::visitInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="comment">// Some instructions are free. All of the free intrinsics can also be</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="comment">// handled by SROA, etc.</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>) ==</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717">TargetTransformInfo::TCC_Free</a>)</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="comment">// We found something we don&#39;t understand or can&#39;t handle. Mark any SROA-able</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="comment">// values in the operand list as no longer viable.</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands())</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    disableSROA(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;}</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">/// Analyze a basic block for its contribution to the inline cost.</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">/// This method walks the analyzer over every instruction in the given basic</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">/// block and accounts for their cost during inlining at this callsite. It</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">/// aborts early if the threshold has been exceeded or an impossible to inline</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">/// construct has been detected. It returns false if inlining is no longer</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment">/// viable, and true if inlining remains viable.</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;CallAnalyzer::analyzeBlock(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                           <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;const Value *&gt;</a> &amp;EphValues) {</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="comment">// FIXME: Currently, the number of instructions in a function regardless of</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">// our ability to simplify them during inline to constants or dead code,</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="comment">// are actually used by the vector bonus heuristic. As long as that&#39;s true,</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="comment">// we have to special case debug intrinsics here to prevent differences in</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="comment">// inlining due to debug symbols. Eventually, the number of unsimplified</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="comment">// instructions shouldn&#39;t factor into the cost computation, but until then,</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="comment">// hack around it here.</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="comment">// Similarly, skip pseudo-probes.</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isDebugOrPseudoInst())</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">// Skip ephemeral values.</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (EphValues.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    ++NumInstructions;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ExtractElementInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isVectorTy())</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      ++NumVectorInstructions;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="comment">// If the instruction simplified to a constant, there is no cost to this</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="comment">// instruction. Visit the instructions using our InstVisitor to account for</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="comment">// all of the per-instruction logic. The visit tree returns true if we</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="comment">// consumed the instruction in any way, and false if the instruction&#39;s base</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">// cost should count against inlining.</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    onInstructionAnalysisStart(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160; </div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span> (Base::visit(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      ++NumInstructionsSimplified;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      onMissedSimplification();</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    onInstructionAnalysisFinish(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keyword">using namespace </span>ore;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="comment">// If the visit this instruction detected an uninlinable pattern, abort.</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keywordflow">if</span> (IsRecursiveCall &amp;&amp; !AllowRecursiveCall)</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;recursive&quot;</span>);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ExposesReturnsTwice)</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;exposes returns twice&quot;</span>);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (HasDynamicAlloca)</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;dynamic alloca&quot;</span>);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (HasIndirectBr)</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;indirect branch&quot;</span>);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (HasUninlineableIntrinsic)</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;uninlinable intrinsic&quot;</span>);</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InitsVargArgs)</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;varargs&quot;</span>);</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>.isSuccess()) {</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;      <span class="keywordflow">if</span> (ORE)</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="InlineCost_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;NeverInline&quot;</span>,</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                                          &amp;CandidateCall)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                 &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;Callee&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &lt;&lt; <span class="stringliteral">&quot; has uninlinable pattern (&quot;</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                 &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;InlineResult&quot;</span>, <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>.getFailureReason())</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;) and cost is not fully computed&quot;</span>;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        });</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160; </div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="comment">// If the caller is a recursive function then we don&#39;t want to inline</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="comment">// functions which allocate a lot of stack space because it would increase</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="comment">// the caller stack usage dramatically.</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="keywordflow">if</span> (IsCallerRecursive &amp;&amp; AllocatedSize &gt; <a class="code" href="InlineCost_8cpp.html#a7806408b2a0bab4436109e57881cf32b">RecurStackSizeThreshold</a>) {</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="keyword">auto</span> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> =</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;          <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;recursive and allocates too much stack space&quot;</span>);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keywordflow">if</span> (ORE)</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="InlineCost_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;NeverInline&quot;</span>,</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                                          &amp;CandidateCall)</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                 &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;Callee&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &lt;&lt; <span class="stringliteral">&quot; is &quot;</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                 &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;InlineResult&quot;</span>, <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>.getFailureReason())</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;. Cost is not fully computed&quot;</span>;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        });</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    }</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordflow">if</span> (shouldStop())</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;          <span class="stringliteral">&quot;Call site analysis is not favorable to inlining.&quot;</span>);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160; </div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;}</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">/// Compute the base pointer and cumulative constant offsets for V.</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">/// This strips all constant offsets off of V, leaving it the base pointer, and</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">/// accumulates the total constant offset applied in the returned constant. It</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">/// returns 0 if V is not a pointer, and returns the constant &#39;0&#39; if there are</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment">/// no constant offsets applied.</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CallAnalyzer::stripAndComputeInBoundsConstantOffsets(<a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;V) {</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  <span class="keywordflow">if</span> (!V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;  <span class="keywordtype">unsigned</span> AS = V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;  <span class="keywordtype">unsigned</span> IntPtrWidth = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(AS);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a class="code" href="classllvm_1_1APInt.html#add4e37b60ea64faafbc9a5bf3e27280f">APInt::getZero</a>(IntPtrWidth);</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160; </div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;  <span class="comment">// Even though we don&#39;t look through PHI nodes, we could be called on an</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;  <span class="comment">// instruction in an unreachable block, which may be on a cycle.</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 4&gt;</a> Visited;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(V);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GEPOperator&gt;(V)) {</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;isInBounds() || !accumulateGEPOffset(*<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>))</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      V = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Operator.html#aca4ffddc11c10477a4a76ada6fd5da46">Operator::getOpcode</a>(V) == Instruction::BitCast) {</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      V = cast&lt;Operator&gt;(V)-&gt;getOperand(0);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GlobalAlias.html">GlobalAlias</a> *GA = dyn_cast&lt;GlobalAlias&gt;(V)) {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="keywordflow">if</span> (GA-&gt;isInterposable())</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      V = GA-&gt;getAliasee();</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    }</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp; <span class="stringliteral">&quot;Unexpected operand type!&quot;</span>);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  } <span class="keywordflow">while</span> (Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(V).second);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160; </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IdxPtrTy = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexType(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  <span class="keywordflow">return</span> cast&lt;ConstantInt&gt;(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IdxPtrTy, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>));</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;}</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment">/// Find dead blocks due to deleted CFG edges during inlining.</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment">/// If we know the successor of the current block, \p CurrBB, has to be \p</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="comment">/// NextBB, the other successors of \p CurrBB are dead if these successors have</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="comment">/// no live incoming CFG edges.  If one block is found to be dead, we can</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="comment">/// continue growing the dead block list by checking the successors of the dead</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment">/// blocks to see if all their incoming edges are dead or not.</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> CallAnalyzer::findDeadBlocks(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurrBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NextBB) {</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="keyword">auto</span> IsEdgeDead = [&amp;](<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ) {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="comment">// A CFG edge is dead if the predecessor is dead or the predecessor has a</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="comment">// known successor which is not the one under exam.</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="keywordflow">return</span> (DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(Pred) ||</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            (KnownSuccessors[Pred] &amp;&amp; KnownSuccessors[Pred] != Succ));</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  };</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  <span class="keyword">auto</span> IsNewlyDead = [&amp;](<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="comment">// If all the edges to a block are dead, the block is also dead.</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="keywordflow">return</span> (!DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) &amp;&amp;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            <a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a>(<a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>),</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                         [&amp;](<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) { <span class="keywordflow">return</span> IsEdgeDead(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>); }));</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  };</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(CurrBB)) {</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="keywordflow">if</span> (Succ == NextBB || !IsNewlyDead(Succ))</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 4&gt;</a> NewDead;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    NewDead.push_back(Succ);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">while</span> (!NewDead.empty()) {</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a> = NewDead.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="keywordflow">if</span> (DeadBlocks.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>).second)</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <span class="comment">// Continue growing the dead block lists.</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">Dead</a>))</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;          <span class="keywordflow">if</span> (IsNewlyDead(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>))</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            NewDead.push_back(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    }</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  }</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;}</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">/// Analyze a call site for potential inlining.</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">/// Returns true if inlining this call is viable, and false if it is not</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">/// viable. It computes the cost and adjusts the threshold based on numerous</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="comment">/// factors and heuristics. If this method returns false but the computed cost</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">/// is below the computed threshold, then inlining was forcibly disabled by</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">/// some artifact of the routine.</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> CallAnalyzer::analyze() {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  ++NumCallsAnalyzed;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = onAnalysisStart();</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.isSuccess())</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.empty())</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160; </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> = CandidateCall.<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>();</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  <span class="comment">// Check if the caller function is recursive itself.</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a>-&gt;users()) {</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a> = dyn_cast&lt;CallBase&gt;(U);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordflow">if</span> (Call &amp;&amp; <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>-&gt;getFunction() == Caller) {</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      IsCallerRecursive = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    }</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  }</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160; </div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  <span class="comment">// Populate our simplified values by mapping from function arguments to call</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="comment">// arguments with known important simplifications.</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="keyword">auto</span> CAI = CandidateCall.<a class="code" href="classllvm_1_1CallBase.html#a4fb513d744ca72275932b2c7003f16f6">arg_begin</a>();</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;FAI : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.args()) {</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CAI != CandidateCall.<a class="code" href="classllvm_1_1CallBase.html#ac0f11b96f81b2769dd23d028e3189075">arg_end</a>());</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(CAI))</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      SimplifiedValues[&amp;FAI] = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrArg = *CAI;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = stripAndComputeInBoundsConstantOffsets(PtrArg)) {</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      ConstantOffsetPtrs[&amp;FAI] = std::make_pair(PtrArg, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getValue());</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160; </div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="comment">// We can SROA any pointer arguments derived from alloca instructions.</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SROAArg = dyn_cast&lt;AllocaInst&gt;(PtrArg)) {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        SROAArgValues[&amp;FAI] = SROAArg;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        onInitializeSROAArg(SROAArg);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        EnabledSROAAllocas.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(SROAArg);</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      }</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    ++CAI;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  }</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  NumConstantArgs = SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a3d95cc2d359b8d9ed5bd9504b44930b5">size</a>();</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;  NumConstantOffsetPtrArgs = ConstantOffsetPtrs.<a class="code" href="classllvm_1_1DenseMapBase.html#a3d95cc2d359b8d9ed5bd9504b44930b5">size</a>();</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  NumAllocaArgs = SROAArgValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a3d95cc2d359b8d9ed5bd9504b44930b5">size</a>();</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160; </div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  <span class="comment">// FIXME: If a caller has multiple calls to a callee, we end up recomputing</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <span class="comment">// the ephemeral values multiple times (and they&#39;re completely determined by</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  <span class="comment">// the callee, so this is purely duplicate work).</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Value *, 32&gt;</a> EphValues;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <a class="code" href="structllvm_1_1CodeMetrics.html#a7e174506b52ad46ea1f746a7f727d999">CodeMetrics::collectEphemeralValues</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &amp;GetAssumptionCache(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>), EphValues);</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160; </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  <span class="comment">// The worklist of live basic blocks in the callee *after* inlining. We avoid</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  <span class="comment">// adding basic blocks of the callee which can be proven to be dead for this</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  <span class="comment">// particular call site in order to get more accurate cost estimates. This</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  <span class="comment">// requires a somewhat heavyweight iteration pattern: we need to walk the</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;  <span class="comment">// basic blocks in a breadth-first order as we insert live successors. To</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  <span class="comment">// accomplish this, prioritizing for small iterations because we exit after</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  <span class="comment">// crossing our threshold, we use a small-size optimized SetVector.</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;BasicBlock *, SmallVector&lt;BasicBlock *, 16&gt;</a>,</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 16&gt;</a>&gt;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      <a class="code" href="BasicBlockUtils_8cpp.html#a074f8df866dd09faecb84d0a37835494">BBSetVector</a>;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">BBSetVector</a> BBWorklist;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  BBWorklist.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock());</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160; </div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <span class="comment">// Note that we *must not* cache the size, this loop grows the worklist.</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0; Idx != BBWorklist.<a class="code" href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">size</a>(); ++Idx) {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="keywordflow">if</span> (shouldStop())</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160; </div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = BBWorklist[Idx];</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;empty())</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160; </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    onBlockStart(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="comment">// Disallow inlining a blockaddress with uses other than strictly callbr.</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="comment">// A blockaddress only has defined behavior for an indirect branch in the</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">// same function, and we do not currently support inlining indirect</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="comment">// branches.  But, the inliner may not see an indirect branch that ends up</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="comment">// being dead code at a particular call site. If the blockaddress escapes</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="comment">// the function, e.g., via a global variable, inlining may lead to an</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="comment">// invalid cross-function reference.</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <span class="comment">// FIXME: pr/39560: continue relaxing this overt restriction.</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;hasAddressTaken())</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="classllvm_1_1BlockAddress.html#af6e2f535824d8f9b4bf1b1a75e5ab57c">BlockAddress::get</a>(&amp;*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)-&gt;<a class="code" href="IVUsers_8cpp.html#ac2f338c3f467b3d09613e190d73044a5">users</a>())</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;CallBrInst&gt;(*U))</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;blockaddress used outside of callbr&quot;</span>);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160; </div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <span class="comment">// Analyze the cost of this block. If we blow through the threshold, this</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <span class="comment">// returns false, and we can bail on out.</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a> = analyzeBlock(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, EphValues);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>.isSuccess())</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160; </div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="comment">// Add in the live successors by first checking whether we have terminator</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="comment">// that may be simplified based on the values simplified by this call.</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = dyn_cast&lt;BranchInst&gt;(TI)) {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="keywordflow">if</span> (BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>()) {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">getCondition</a>();</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *SimpleCond =</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                dyn_cast_or_null&lt;ConstantInt&gt;(SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>))) {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NextBB = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(SimpleCond-&gt;isZero() ? 1 : 0);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;          BBWorklist.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(NextBB);</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;          KnownSuccessors[<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>] = NextBB;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;          findDeadBlocks(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, NextBB);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        }</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SwitchInst.html">SwitchInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SwitchInst&gt;(TI)) {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition();</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *SimpleCond =</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;              dyn_cast_or_null&lt;ConstantInt&gt;(SimplifiedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>))) {</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NextBB = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;findCaseValue(SimpleCond)-&gt;getCaseSuccessor();</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        BBWorklist.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(NextBB);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        KnownSuccessors[<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>] = NextBB;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        findDeadBlocks(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, NextBB);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      }</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    }</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160; </div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    <span class="comment">// If we&#39;re unable to select a particular successor, just count all of</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="comment">// them.</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> TIdx = 0, TSize = TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>(); TIdx != TSize;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;         ++TIdx)</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      BBWorklist.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6e5d2e18c81baaeec7dadc81a0dea993">getSuccessor</a>(TIdx));</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160; </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    onBlockAnalyzed(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <span class="comment">// If this is a noduplicate call, we can still inline as long as</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;  <span class="comment">// inlining this would cause the removal of the caller (so the instruction</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  <span class="comment">// is not actually duplicated, just moved).</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;  <span class="keywordflow">if</span> (!isSoleCallToLocalFunction(CandidateCall, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp; ContainsNoDuplicateCall)</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;noduplicate&quot;</span>);</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  <span class="comment">// If the callee&#39;s stack size exceeds the user-specified threshold,</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  <span class="comment">// do not let it be inlined.</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;  <span class="comment">// The command line option overrides a limit set in the function attributes.</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <span class="keywordtype">size_t</span> FinalStackSizeThreshold = <a class="code" href="InlineCost_8cpp.html#a0ac5b7c2981646d4f6a55fbc52feaeeb">StackSizeThreshold</a>;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="InlineCost_8cpp.html#a0ac5b7c2981646d4f6a55fbc52feaeeb">StackSizeThreshold</a>.getNumOccurrences())</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;int&gt; AttrMaxStackSize = <a class="code" href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">getStringFnAttrAsInt</a>(</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;            Caller, <a class="code" href="namespacellvm_1_1InlineConstants.html#aaa82a5af56de7ce383f94bd9f4e2bee3">InlineConstants::MaxInlineStackSizeAttributeName</a>))</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      FinalStackSizeThreshold = *AttrMaxStackSize;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  <span class="keywordflow">if</span> (AllocatedSize &gt; FinalStackSizeThreshold)</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;stacksize&quot;</span>);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  <span class="keywordflow">return</span> finalizeAnalysis();</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;}</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">InlineCostCallAnalyzer::print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>) {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="preprocessor">#define DEBUG_PRINT_STAT(x) OS &lt;&lt; &quot;      &quot; #x &quot;: &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="InlineCost_8cpp.html#a44fcadf99c45d9e7231ceed9730487e7">PrintInstructionComments</a>)</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, &amp;Writer);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumConstantArgs);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumConstantOffsetPtrArgs);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumAllocaArgs);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumConstantPtrCmps);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumConstantPtrDiffs);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumInstructionsSimplified);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(NumInstructions);</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(SROACostSavings);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(SROACostSavingsLost);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(LoadEliminationCost);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(ContainsNoDuplicateCall);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(Cost);</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <a class="code" href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a>(Threshold);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="preprocessor">#undef DEBUG_PRINT_STAT</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;}</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160; </div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">/// Dump stats about this call&#39;s analysis.</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment"></span><a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">InlineCostCallAnalyzer::dump</a>() { <a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); }</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">/// Test that there are no attribute conflicts between Caller and Callee</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">///        that prevent inlining.</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"><a class="line" href="InlineCost_8cpp.html#ad6e6415d4d2e809c620d08fb23c1544f"> 2789</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InlineCost_8cpp.html#ad6e6415d4d2e809c620d08fb23c1544f">functionsHaveCompatibleAttributes</a>(</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *Caller, <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; &amp;GetTLI) {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <span class="comment">// Note that CalleeTLI must be a copy not a reference. The legacy pass manager</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <span class="comment">// caches the most recently created TLI in the TargetLibraryInfoWrapperPass</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  <span class="comment">// object, and always returns the same object (which is overwritten on each</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  <span class="comment">// GetTLI call). Therefore we copy the first result.</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <span class="keyword">auto</span> CalleeTLI = GetTLI(*<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="InlineCost_8cpp.html#ab9082799f60c525cdaca5393dcd13894">IgnoreTTIInlineCompatible</a> ||</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;          <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ad2e1f19379514bb06cdcedb2bae8748d">areInlineCompatible</a>(Caller, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>)) &amp;&amp;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;         GetTLI(*Caller).areInlineCompatible(CalleeTLI,</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                                             <a class="code" href="InlineCost_8cpp.html#ab95282573f276af5623b0b909f91d823">InlineCallerSupersetNoBuiltin</a>) &amp;&amp;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;         <a class="code" href="namespacellvm_1_1AttributeFuncs.html#a32fe04d73013c7bede32a1e2279cf9e5">AttributeFuncs::areInlineCompatible</a>(*Caller, *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;}</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"><a class="line" href="namespacellvm.html#a2f5363235d78b46831e31ddbb498c982"> 2804</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a2f5363235d78b46831e31ddbb498c982">llvm::getCallsiteCost</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  int64_t <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = 0;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = Call.arg_size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">if</span> (Call.isByValArgument(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      <span class="comment">// We approximate the number of loads and stores needed by dividing the</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <span class="comment">// size of the byval type by the target&#39;s pointer size.</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *PTy = cast&lt;PointerType&gt;(Call.getArgOperand(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;getType());</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(Call.getParamByValType(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      <span class="keywordtype">unsigned</span> AS = PTy-&gt;<a class="code" href="classllvm_1_1PointerType.html#af8aeced5e71d2589fa3e9791043af5cb">getAddressSpace</a>();</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">PointerSize</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSizeInBits(AS);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="comment">// Ceiling division.</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      <span class="keywordtype">unsigned</span> NumStores = (<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> + <a class="code" href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">PointerSize</a> - 1) / <a class="code" href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">PointerSize</a>;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <span class="comment">// If it generates more than 8 stores it is likely to be expanded as an</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="comment">// inline memcpy so we take that as an upper bound. Otherwise we assume</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="comment">// one load and one store per word copied.</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      <span class="comment">// FIXME: The maxStoresPerMemcpy setting from the target should be used</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      <span class="comment">// here instead of a magic number of 8, but it&#39;s not available via</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      <span class="comment">// DataLayout.</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      NumStores = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(NumStores, 8U);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> += 2 * NumStores * <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      <span class="comment">// For non-byval arguments subtract off one instruction per call</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="comment">// argument.</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    }</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;  <span class="comment">// The call instruction also disappears after inlining.</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> += <a class="code" href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a>;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> += <a class="code" href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">CallPenalty</a>;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  <span class="keywordflow">return</span> std::min&lt;int64_t&gt;(<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a>, INT_MAX);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;}</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"><a class="line" href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319"> 2838</a></span>&#160;<a class="code" href="classllvm_1_1InlineCost.html">InlineCost</a> <a class="code" href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">llvm::getInlineCost</a>(</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <span class="keyword">const</span> <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> &amp;Params, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;CalleeTTI,</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetTLI,</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI,</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI, <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">getInlineCost</a>(Call, Call.getCalledFunction(), Params, CalleeTTI,</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                       GetAssumptionCache, GetTLI, GetBFI, PSI, ORE);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;}</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160; </div>
<div class="line"><a name="l02848"></a><span class="lineno"><a class="line" href="namespacellvm.html#ac25d98957a825ee699d9b11ee836cc19"> 2848</a></span>&#160;std::optional&lt;int&gt; <a class="code" href="namespacellvm.html#ac25d98957a825ee699d9b11ee836cc19">llvm::getInliningCostEstimate</a>(</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;CalleeTTI,</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI,</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI, <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE) {</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="keyword">const</span> <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> Params = {<span class="comment">/* DefaultThreshold*/</span> 0,</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                               <span class="comment">/*HintThreshold*/</span> {},</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                               <span class="comment">/*ColdThreshold*/</span> {},</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                               <span class="comment">/*OptSizeThreshold*/</span> {},</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                               <span class="comment">/*OptMinSizeThreshold*/</span> {},</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                               <span class="comment">/*HotCallSiteThreshold*/</span> {},</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                               <span class="comment">/*LocallyHotCallSiteThreshold*/</span> {},</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                               <span class="comment">/*ColdCallSiteThreshold*/</span> {},</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                               <span class="comment">/*ComputeFullInlineCost*/</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                               <span class="comment">/*EnableDeferral*/</span> <span class="keyword">true</span>};</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  InlineCostCallAnalyzer CA(*Call.getCalledFunction(), Call, Params, CalleeTTI,</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                            GetAssumptionCache, GetBFI, PSI, ORE, <span class="keyword">true</span>,</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                            <span class="comment">/*IgnoreThreshold*/</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <span class="keyword">auto</span> R = CA.analyze();</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <span class="keywordflow">if</span> (!R.isSuccess())</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <span class="keywordflow">return</span> CA.getCost();</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;}</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; </div>
<div class="line"><a name="l02873"></a><span class="lineno"><a class="line" href="namespacellvm.html#a31965ae9b8c0a53197f6a2dcc9205bd7"> 2873</a></span>&#160;std::optional&lt;InlineCostFeatures&gt; <a class="code" href="namespacellvm.html#a31965ae9b8c0a53197f6a2dcc9205bd7">llvm::getInliningCostFeatures</a>(</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;CalleeTTI,</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI,</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI, <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE) {</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  InlineCostFeaturesAnalyzer CFA(CalleeTTI, GetAssumptionCache, GetBFI, PSI,</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                                 ORE, *Call.getCalledFunction(), Call);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  <span class="keyword">auto</span> R = CFA.analyze();</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  <span class="keywordflow">if</span> (!R.isSuccess())</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="keywordflow">return</span> CFA.features();</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;}</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160; </div>
<div class="line"><a name="l02886"></a><span class="lineno"><a class="line" href="namespacellvm.html#aa41f9508130468035e0087f7cbdffa14"> 2886</a></span>&#160;std::optional&lt;InlineResult&gt; <a class="code" href="namespacellvm.html#aa41f9508130468035e0087f7cbdffa14">llvm::getAttributeBasedInliningDecision</a>(</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;CalleeTTI,</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetTLI) {</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; </div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <span class="comment">// Cannot inline indirect calls.</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>)</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;indirect call&quot;</span>);</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  <span class="comment">// When callee coroutine function is inlined into caller coroutine function</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="comment">// before coro-split pass,</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="comment">// coro-early pass can not handle this quiet well.</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="comment">// So we won&#39;t inline the coroutine function if it have not been unsplited</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isPresplitCoroutine())</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;unsplited coroutine call&quot;</span>);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="comment">// Never inline calls with byval arguments that does not have the alloca</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="comment">// address space. Since byval arguments can be replaced with a copy to an</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  <span class="comment">// alloca, the inlined code would need to be adjusted to handle that the</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  <span class="comment">// argument is in the alloca address space (so it is a little bit complicated</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <span class="comment">// to solve).</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="keywordtype">unsigned</span> AllocaAS = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getParent()-&gt;getDataLayout().getAllocaAddrSpace();</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = Call.arg_size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <span class="keywordflow">if</span> (Call.isByValArgument(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *PTy = cast&lt;PointerType&gt;(Call.getArgOperand(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;getType());</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <span class="keywordflow">if</span> (PTy-&gt;<a class="code" href="classllvm_1_1PointerType.html#af8aeced5e71d2589fa3e9791043af5cb">getAddressSpace</a>() != AllocaAS)</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;byval arguments without alloca&quot;</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                                     <span class="stringliteral">&quot; address space&quot;</span>);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    }</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160; </div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="comment">// Calls to functions with always-inline attributes should be inlined</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  <span class="comment">// whenever possible.</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="keywordflow">if</span> (Call.hasFnAttr(Attribute::AlwaysInline)) {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <span class="keywordflow">if</span> (Call.getAttributes().hasFnAttr(Attribute::NoInline))</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;noinline call site attribute&quot;</span>);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="keyword">auto</span> IsViable = <a class="code" href="namespacellvm.html#a5ae8db70add348cf4c743530e9b9f54e">isInlineViable</a>(*<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="keywordflow">if</span> (IsViable.isSuccess())</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(IsViable.getFailureReason());</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  }</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160; </div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="comment">// Never inline functions with conflicting attributes (unless callee has</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <span class="comment">// always-inline attribute).</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *Caller = Call.getCaller();</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="InlineCost_8cpp.html#ad6e6415d4d2e809c620d08fb23c1544f">functionsHaveCompatibleAttributes</a>(Caller, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, CalleeTTI, GetTLI))</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;conflicting attributes&quot;</span>);</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160; </div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  <span class="comment">// Don&#39;t inline this call if the caller has the optnone attribute.</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  <span class="keywordflow">if</span> (Caller-&gt;hasOptNone())</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;optnone attribute&quot;</span>);</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <span class="comment">// Don&#39;t inline a function that treats null pointer as valid into a caller</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <span class="comment">// that does not have this attribute.</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  <span class="keywordflow">if</span> (!Caller-&gt;nullPointerIsDefined() &amp;&amp; <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;nullPointerIsDefined())</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;nullptr definitions incompatible&quot;</span>);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160; </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <span class="comment">// Don&#39;t inline functions which can be interposed at link-time.</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isInterposable())</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;interposable&quot;</span>);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160; </div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;  <span class="comment">// Don&#39;t inline functions marked noinline.</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;hasFnAttribute(Attribute::NoInline))</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;noinline function attribute&quot;</span>);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160; </div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;  <span class="comment">// Don&#39;t inline call sites marked noinline.</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <span class="keywordflow">if</span> (Call.isNoInline())</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;noinline call site attribute&quot;</span>);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160; </div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;}</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160; </div>
<div class="line"><a name="l02957"></a><span class="lineno"><a class="line" href="namespacellvm.html#a11326a8194a8022478ebafeba2b5ccb5"> 2957</a></span>&#160;<a class="code" href="classllvm_1_1InlineCost.html">InlineCost</a> <a class="code" href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">llvm::getInlineCost</a>(</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Call, <a class="code" href="classllvm_1_1Function.html">Function</a> *Callee, <span class="keyword">const</span> <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> &amp;Params,</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;CalleeTTI,</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetTLI,</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetBFI,</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI, <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE) {</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160; </div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <span class="keyword">auto</span> UserDecision =</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;      <a class="code" href="namespacellvm.html#aa41f9508130468035e0087f7cbdffa14">llvm::getAttributeBasedInliningDecision</a>(Call, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, CalleeTTI, GetTLI);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160; </div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;  <span class="keywordflow">if</span> (UserDecision) {</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <span class="keywordflow">if</span> (UserDecision-&gt;isSuccess())</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineCost.html#aa71268864238db3f41e3d6582103e4e2">llvm::InlineCost::getAlways</a>(<span class="stringliteral">&quot;always inline attribute&quot;</span>);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineCost.html#aa1e6376794d0c3da5a2820a2943634eb">llvm::InlineCost::getNever</a>(UserDecision-&gt;getFailureReason());</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; </div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;      Analyzing call of &quot;</span> &lt;&lt; <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName()</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;... (caller:&quot;</span> &lt;&lt; Call.getCaller()-&gt;getName()</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  InlineCostCallAnalyzer CA(*<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, Call, Params, CalleeTTI,</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                            GetAssumptionCache, GetBFI, PSI, ORE);</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  <a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> ShouldInline = CA.analyze();</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160; </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(CA.dump());</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160; </div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  <span class="comment">// Always make cost benefit based decision explicit.</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;  <span class="comment">// We use always/never here since threshold is not meaningful,</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  <span class="comment">// as it&#39;s not what drives cost-benefit analysis.</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;  <span class="keywordflow">if</span> (CA.wasDecidedByCostBenefit()) {</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <span class="keywordflow">if</span> (ShouldInline.<a class="code" href="classllvm_1_1InlineResult.html#af279070ae6350a3acd0e80ba7da7d397">isSuccess</a>())</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineCost.html#aa71268864238db3f41e3d6582103e4e2">InlineCost::getAlways</a>(<span class="stringliteral">&quot;benefit over cost&quot;</span>,</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                                   CA.getCostBenefitPair());</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineCost.html#aa1e6376794d0c3da5a2820a2943634eb">InlineCost::getNever</a>(<span class="stringliteral">&quot;cost over benefit&quot;</span>, CA.getCostBenefitPair());</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;  }</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160; </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  <span class="keywordflow">if</span> (CA.wasDecidedByCostThreshold())</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineCost.html#ac1dbd59a648c96031c8d91238017e6c2">InlineCost::get</a>(CA.getCost(), CA.getThreshold(),</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                           CA.getStaticBonusApplied());</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160; </div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  <span class="comment">// No details on how the decision was made, simply return always or never.</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  <span class="keywordflow">return</span> ShouldInline.<a class="code" href="classllvm_1_1InlineResult.html#af279070ae6350a3acd0e80ba7da7d397">isSuccess</a>()</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;             ? <a class="code" href="classllvm_1_1InlineCost.html#aa71268864238db3f41e3d6582103e4e2">InlineCost::getAlways</a>(<span class="stringliteral">&quot;empty function&quot;</span>)</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;             : <a class="code" href="classllvm_1_1InlineCost.html#aa1e6376794d0c3da5a2820a2943634eb">InlineCost::getNever</a>(ShouldInline.<a class="code" href="classllvm_1_1InlineResult.html#a545b04aaa22d87b07a0871da2713a67a">getFailureReason</a>());</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;}</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; </div>
<div class="line"><a name="l03005"></a><span class="lineno"><a class="line" href="namespacellvm.html#a5ae8db70add348cf4c743530e9b9f54e"> 3005</a></span>&#160;<a class="code" href="classllvm_1_1InlineResult.html">InlineResult</a> <a class="code" href="namespacellvm.html#a5ae8db70add348cf4c743530e9b9f54e">llvm::isInlineViable</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  <span class="keywordtype">bool</span> ReturnsTwice = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(Attribute::ReturnsTwice);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="comment">// Disallow inlining of functions which contain indirect branches.</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <span class="keywordflow">if</span> (isa&lt;IndirectBrInst&gt;(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getTerminator()))</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;contains indirect branches&quot;</span>);</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160; </div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <span class="comment">// Disallow inlining of blockaddresses which are used by non-callbr</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="comment">// instructions.</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.hasAddressTaken())</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="classllvm_1_1BlockAddress.html#af6e2f535824d8f9b4bf1b1a75e5ab57c">BlockAddress::get</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)-&gt;<a class="code" href="IVUsers_8cpp.html#ac2f338c3f467b3d09613e190d73044a5">users</a>())</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">if</span> (!isa&lt;CallBrInst&gt;(*U))</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;blockaddress used outside of callbr&quot;</span>);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;II : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *Call = dyn_cast&lt;CallBase&gt;(&amp;II);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">if</span> (!Call)</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160; </div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="comment">// Disallow recursive calls.</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = Call-&gt;getCalledFunction();</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      <span class="keywordflow">if</span> (&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>)</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;recursive call&quot;</span>);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      <span class="comment">// Disallow calls which expose returns-twice to a function not previously</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <span class="comment">// attributed as such.</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <span class="keywordflow">if</span> (!ReturnsTwice &amp;&amp; isa&lt;CallInst&gt;(Call) &amp;&amp;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;          cast&lt;CallInst&gt;(Call)-&gt;canReturnTwice())</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(<span class="stringliteral">&quot;exposes returns-twice attribute&quot;</span>);</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>)</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getIntrinsicID()) {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        <span class="keywordflow">case</span> llvm::Intrinsic::icall_branch_funnel:</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;          <span class="comment">// Disallow inlining of @llvm.icall.branch.funnel because current</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;          <span class="comment">// backend can&#39;t separate call targets from call arguments.</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;              <span class="stringliteral">&quot;disallowed inlining of @llvm.icall.branch.funnel&quot;</span>);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        <span class="keywordflow">case</span> llvm::Intrinsic::localescape:</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;          <span class="comment">// Disallow inlining functions that call @llvm.localescape. Doing this</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;          <span class="comment">// correctly would require major changes to the inliner.</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;              <span class="stringliteral">&quot;disallowed inlining of @llvm.localescape&quot;</span>);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="keywordflow">case</span> llvm::Intrinsic::vastart:</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;          <span class="comment">// Disallow inlining of functions that initialize VarArgs with</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;          <span class="comment">// va_start.</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">InlineResult::failure</a>(</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;              <span class="stringliteral">&quot;contains VarArgs initialized with va_start&quot;</span>);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;        }</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    }</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  }</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">InlineResult::success</a>();</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;}</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="comment">// APIs to create InlineParams based on command line flags and/or other</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment">// parameters.</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"><a class="line" href="namespacellvm.html#a7b7c023dc811b7f80b31251d75db58b9"> 3064</a></span>&#160;<a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> <a class="code" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">llvm::getInlineParams</a>(<span class="keywordtype">int</span> Threshold) {</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> Params;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160; </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="comment">// This field is the threshold to use for a callee by default. This is</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <span class="comment">// derived from one or more of:</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;  <span class="comment">//  * optimization or size-optimization levels,</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;  <span class="comment">//  * a value passed to createFunctionInliningPass function, or</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  <span class="comment">//  * the -inline-threshold flag.</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  <span class="comment">//  If the -inline-threshold flag is explicitly specified, that is used</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  <span class="comment">//  irrespective of anything else.</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="InlineCost_8cpp.html#a9ab3097ecb543e993b6a1ccd0cb03258">InlineThreshold</a>.getNumOccurrences() &gt; 0)</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#aaa559292e3d904012000b7e1b767db85">DefaultThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a9ab3097ecb543e993b6a1ccd0cb03258">InlineThreshold</a>;</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#aaa559292e3d904012000b7e1b767db85">DefaultThreshold</a> = Threshold;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <span class="comment">// Set the HintThreshold knob from the -inlinehint-threshold.</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  Params.<a class="code" href="structllvm_1_1InlineParams.html#ac5fa84316036c761096ad4f9a07ccca2">HintThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a155256dae9eff9b764b9d5eb5a10d8a9">HintThreshold</a>;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  <span class="comment">// Set the HotCallSiteThreshold knob from the -hot-callsite-threshold.</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  Params.<a class="code" href="structllvm_1_1InlineParams.html#a75e7c36ed7f71d0c4afca48f835a098b">HotCallSiteThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a78324e64ee175c0703c3db3ce45943cc">HotCallSiteThreshold</a>;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="comment">// If the -locally-hot-callsite-threshold is explicitly specified, use it to</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  <span class="comment">// populate LocallyHotCallSiteThreshold. Later, we populate</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  <span class="comment">// Params.LocallyHotCallSiteThreshold from -locally-hot-callsite-threshold if</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="comment">// we know that optimization level is O3 (in the getInlineParams variant that</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="comment">// takes the opt and size levels).</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  <span class="comment">// FIXME: Remove this check (and make the assignment unconditional) after</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  <span class="comment">// addressing size regression issues at O2.</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="InlineCost_8cpp.html#a6690aaae8b3d4f4ddc10d536d59eaa7c">LocallyHotCallSiteThreshold</a>.getNumOccurrences() &gt; 0)</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#ac905a11da0015923ced48e7d1565f46c">LocallyHotCallSiteThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a6690aaae8b3d4f4ddc10d536d59eaa7c">LocallyHotCallSiteThreshold</a>;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <span class="comment">// Set the ColdCallSiteThreshold knob from the</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  <span class="comment">// -inline-cold-callsite-threshold.</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  Params.<a class="code" href="structllvm_1_1InlineParams.html#a5be58f238f61d418cfa212e7768c8ea3">ColdCallSiteThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a8ec73f89a2e044c3020319ba8f3e52c1">ColdCallSiteThreshold</a>;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160; </div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  <span class="comment">// Set the OptMinSizeThreshold and OptSizeThreshold params only if the</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  <span class="comment">// -inlinehint-threshold commandline option is not explicitly given. If that</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  <span class="comment">// option is present, then its value applies even for callees with size and</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="comment">// minsize attributes.</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  <span class="comment">// If the -inline-threshold is not specified, set the ColdThreshold from the</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;  <span class="comment">// -inlinecold-threshold even if it is not explicitly passed. If</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <span class="comment">// -inline-threshold is specified, then -inlinecold-threshold needs to be</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <span class="comment">// explicitly specified to set the ColdThreshold knob</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="InlineCost_8cpp.html#a9ab3097ecb543e993b6a1ccd0cb03258">InlineThreshold</a>.getNumOccurrences() == 0) {</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#a28b79b1b8e1c2f68da272b1778504be0">OptMinSizeThreshold</a> = <a class="code" href="namespacellvm_1_1InlineConstants.html#a4993676ac873d62a62542af065f1865b">InlineConstants::OptMinSizeThreshold</a>;</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#a38e17a3379fe0336330cda390fd23fea">OptSizeThreshold</a> = <a class="code" href="namespacellvm_1_1InlineConstants.html#a4665c23a10fcddd75e0de1d7d1262edb">InlineConstants::OptSizeThreshold</a>;</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#a709f2e88554f9b1dc20e16371813aa84">ColdThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a3107234de6aa860244f4ee5d3009486f">ColdThreshold</a>;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="InlineCost_8cpp.html#a3107234de6aa860244f4ee5d3009486f">ColdThreshold</a>.getNumOccurrences() &gt; 0) {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#a709f2e88554f9b1dc20e16371813aa84">ColdThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a3107234de6aa860244f4ee5d3009486f">ColdThreshold</a>;</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;  }</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="keywordflow">return</span> Params;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;}</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160; </div>
<div class="line"><a name="l03117"></a><span class="lineno"><a class="line" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50"> 3117</a></span>&#160;<a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> <a class="code" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">llvm::getInlineParams</a>() {</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">getInlineParams</a>(<a class="code" href="InlineCost_8cpp.html#a88449ce28c2bd9290260794929242c0a">DefaultThreshold</a>);</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;}</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160; </div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment">// Compute the default threshold for inlining based on the opt level and the</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment">// size opt level.</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"><a class="line" href="InlineCost_8cpp.html#a63865cbea27abfbcf52660f46ef822b5"> 3123</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="InlineCost_8cpp.html#a63865cbea27abfbcf52660f46ef822b5">computeThresholdFromOptLevels</a>(<span class="keywordtype">unsigned</span> OptLevel,</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                                         <span class="keywordtype">unsigned</span> SizeOptLevel) {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  <span class="keywordflow">if</span> (OptLevel &gt; 2)</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1InlineConstants.html#aa6363460750bae7277bffc8503d0c3b6">InlineConstants::OptAggressiveThreshold</a>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  <span class="keywordflow">if</span> (SizeOptLevel == 1) <span class="comment">// -Os</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1InlineConstants.html#a4665c23a10fcddd75e0de1d7d1262edb">InlineConstants::OptSizeThreshold</a>;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <span class="keywordflow">if</span> (SizeOptLevel == 2) <span class="comment">// -Oz</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1InlineConstants.html#a4993676ac873d62a62542af065f1865b">InlineConstants::OptMinSizeThreshold</a>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="InlineCost_8cpp.html#a88449ce28c2bd9290260794929242c0a">DefaultThreshold</a>;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;}</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160; </div>
<div class="line"><a name="l03134"></a><span class="lineno"><a class="line" href="namespacellvm.html#a23c13304b4746923b9c0207311aa5954"> 3134</a></span>&#160;<a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> <a class="code" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">llvm::getInlineParams</a>(<span class="keywordtype">unsigned</span> OptLevel, <span class="keywordtype">unsigned</span> SizeOptLevel) {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  <span class="keyword">auto</span> Params =</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <a class="code" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">getInlineParams</a>(<a class="code" href="InlineCost_8cpp.html#a63865cbea27abfbcf52660f46ef822b5">computeThresholdFromOptLevels</a>(OptLevel, SizeOptLevel));</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;  <span class="comment">// At O3, use the value of -locally-hot-callsite-threshold option to populate</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  <span class="comment">// Params.LocallyHotCallSiteThreshold. Below O3, this flag has effect only</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  <span class="comment">// when it is specified explicitly.</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  <span class="keywordflow">if</span> (OptLevel &gt; 2)</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    Params.<a class="code" href="structllvm_1_1InlineParams.html#ac905a11da0015923ced48e7d1565f46c">LocallyHotCallSiteThreshold</a> = <a class="code" href="InlineCost_8cpp.html#a6690aaae8b3d4f4ddc10d536d59eaa7c">LocallyHotCallSiteThreshold</a>;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  <span class="keywordflow">return</span> Params;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;}</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160; </div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a></div>
<div class="line"><a name="l03146"></a><span class="lineno"><a class="line" href="structllvm_1_1InlineCostAnnotationPrinterPass.html#aa0abf6fac51bc051d817b1f71c921098"> 3146</a></span>&#160;<a class="code" href="structllvm_1_1InlineCostAnnotationPrinterPass.html#aa0abf6fac51bc051d817b1f71c921098">InlineCostAnnotationPrinterPass::run</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                                     <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>) {</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;  <a class="code" href="InlineCost_8cpp.html#a44fcadf99c45d9e7231ceed9730487e7">PrintInstructionComments</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache =</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      [&amp;](<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp; {</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AssumptionAnalysis.html">AssumptionAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  };</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent();</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> PSI(*<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> <a class="code" href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">TTI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <span class="comment">// FIXME: Redesign the usage of InlineParams to expand the scope of this pass.</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  <span class="comment">// In the current implementation, the type of InlineParams doesn&#39;t matter as</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;  <span class="comment">// the pass serves only for verification of inliner&#39;s decisions.</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  <span class="comment">// We can add a flag which determines InlineParams for this run. Right now,</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  <span class="comment">// the default InlineParams are used.</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  <span class="keyword">const</span> <a class="code" href="structllvm_1_1InlineParams.html">InlineParams</a> Params = <a class="code" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">llvm::getInlineParams</a>();</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        <a class="code" href="classllvm_1_1Function.html">Function</a> *CalledFunction = CI-&gt;getCalledFunction();</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        <span class="keywordflow">if</span> (!CalledFunction || CalledFunction-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">isDeclaration</a>())</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> ORE(CalledFunction);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        InlineCostCallAnalyzer ICCA(*CalledFunction, *CI, Params, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>,</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                                    GetAssumptionCache, <span class="keyword">nullptr</span>, &amp;PSI, &amp;ORE);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        ICCA.analyze();</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        <a class="code" href="structllvm_1_1InlineCostAnnotationPrinterPass.html#a18a45967121f9b770eb8a2dad250d9d6">OS</a> &lt;&lt; <span class="stringliteral">&quot;      Analyzing call of &quot;</span> &lt;&lt; CalledFunction-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;... (caller:&quot;</span> &lt;&lt; CI-&gt;getCaller()-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        ICCA.print(<a class="code" href="structllvm_1_1InlineCostAnnotationPrinterPass.html#a18a45967121f9b770eb8a2dad250d9d6">OS</a>);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;        <a class="code" href="structllvm_1_1InlineCostAnnotationPrinterPass.html#a18a45967121f9b770eb8a2dad250d9d6">OS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      }</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    }</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;  }</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_a9a315d042512705500b545a6c6acb2bd"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#a9a315d042512705500b545a6c6acb2bd">set</a></div><div class="ttdeci">We currently generate a but we really shouldn eax ecx xorl edx divl ecx eax divl ecx movl eax ret A similar code sequence works for division We currently compile i32 v2 eax eax jo LBB1_2 atomic and others It is also currently not done for read modify write instructions It is also current not done if the OF or CF flags are needed The shift operators have the complication that when the shift count is EFLAGS is not set</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l01277">README.txt:1277</a></div></div>
<div class="ttc" id="aclassllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">This class represents an incoming formal argument to a Function.</div><div class="ttdef"><b>Definition:</b> <a href="Argument_8h_source.html#l00028">Argument.h:28</a></div></div>
<div class="ttc" id="aAssumptionCache_8h_html"><div class="ttname"><a href="AssumptionCache_8h.html">AssumptionCache.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_a662be1e66a5af621d46fa1c7a8aa1004"><div class="ttname"><a href="classllvm_1_1Constant.html#a662be1e66a5af621d46fa1c7a8aa1004">llvm::Constant::isAllOnesValue</a></div><div class="ttdeci">bool isAllOnesValue() const</div><div class="ttdoc">Return true if this is the value that would be returned by getAllOnesValue.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00093">Constants.cpp:93</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineResult_html_a364fcb5fb838e7ca83b9fc379bcb4a0a"><div class="ttname"><a href="classllvm_1_1InlineResult.html#a364fcb5fb838e7ca83b9fc379bcb4a0a">llvm::InlineResult::success</a></div><div class="ttdeci">static InlineResult success()</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00184">InlineCost.h:184</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca022565d444ccf496c0414bccefbcd9c8">llvm::TargetTransformInfo::TCC_Expensive</a></div><div class="ttdeci">@ TCC_Expensive</div><div class="ttdoc">The cost of a 'div' instruction on x86.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00269">TargetTransformInfo.h:269</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a3287172f2d13af086e6d66364e8c6de3"><div class="ttname"><a href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">llvm::Instruction::getNumSuccessors</a></div><div class="ttdeci">unsigned getNumSuccessors() const LLVM_READONLY</div><div class="ttdoc">Return the number of successors that this instruction has.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00823">Instruction.cpp:823</a></div></div>
<div class="ttc" id="aCompiler_8h_html_aa863693eef567397d9c292da5bf22d34"><div class="ttname"><a href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a></div><div class="ttdeci">#define LLVM_DUMP_METHOD</div><div class="ttdoc">Mark debug helper function definitions like dump() that should not be stripped from debug builds.</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00492">Compiler.h:492</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_adf4d22686e85732b2fef71e3c45531c6"><div class="ttname"><a href="classllvm_1_1Attribute.html#adf4d22686e85732b2fef71e3c45531c6">llvm::Attribute::isValid</a></div><div class="ttdeci">bool isValid() const</div><div class="ttdoc">Return true if the attribute is any kind of attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00185">Attributes.h:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac77dbedcfd916a5c9b58e753b2678a98"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">llvm::TargetTransformInfo::getInstructionCost</a></div><div class="ttdeci">InstructionCost getInstructionCost(const User *U, ArrayRef&lt; const Value * &gt; Operands, TargetCostKind CostKind) const</div><div class="ttdoc">Estimate the cost of a given IR user when lowered.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00230">TargetTransformInfo.cpp:230</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="anamespacellvm_html_a161dfc647ffe156fe6f145e0fcff95ed"><div class="ttname"><a href="namespacellvm.html#a161dfc647ffe156fe6f145e0fcff95ed">llvm::SaturatingAdd</a></div><div class="ttdeci">std::enable_if_t&lt; std::is_unsigned&lt; T &gt;::value, T &gt; SaturatingAdd(T X, T Y, bool *ResultOverflowed=nullptr)</div><div class="ttdoc">Add two unsigned integers, X and Y, of type T.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00583">MathExtras.h:583</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html"><div class="ttname"><a href="classllvm_1_1ReturnInst.html">llvm::ReturnInst</a></div><div class="ttdoc">Return a value (possibly void), from a function.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03057">Instructions.h:3057</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1generic__gep__type__iterator_html"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html">llvm::generic_gep_type_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00031">GetElementPtrTypeIterator.h:31</a></div></div>
<div class="ttc" id="aArchiveWriter_8cpp_html_aa9f638c7ae7fdd206a6c60e26bef9751"><div class="ttname"><a href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a></div><div class="ttdeci">static void print(raw_ostream &amp;Out, object::Archive::Kind Kind, T Val)</div><div class="ttdef"><b>Definition:</b> <a href="ArchiveWriter_8cpp_source.html#l00189">ArchiveWriter.cpp:189</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_aaa559292e3d904012000b7e1b767db85"><div class="ttname"><a href="structllvm_1_1InlineParams.html#aaa559292e3d904012000b7e1b767db85">llvm::InlineParams::DefaultThreshold</a></div><div class="ttdeci">int DefaultThreshold</div><div class="ttdoc">The default threshold to start with for a callee.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00207">InlineCost.h:207</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a9d17fae32cf8dbe9afa4043766b5592a"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a9d17fae32cf8dbe9afa4043766b5592a">llvm::InlineParams::AllowRecursiveCall</a></div><div class="ttdeci">std::optional&lt; bool &gt; AllowRecursiveCall</div><div class="ttdoc">Indicate whether we allow inlining for recursive call.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00238">InlineCost.h:238</a></div></div>
<div class="ttc" id="aGlobalOpt_8cpp_html_a652ede21e988a4de569cdbc7863ea234"><div class="ttname"><a href="GlobalOpt_8cpp.html#a652ede21e988a4de569cdbc7863ea234">isColdCallSite</a></div><div class="ttdeci">static bool isColdCallSite(CallBase &amp;CB, BlockFrequencyInfo &amp;CallerBFI)</div><div class="ttdoc">Return true if the block containing the call site has a BlockFrequency of less than ColdCCRelFreq% of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalOpt_8cpp_source.html#l01766">GlobalOpt.cpp:1766</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a28b79b1b8e1c2f68da272b1778504be0"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a28b79b1b8e1c2f68da272b1778504be0">llvm::InlineParams::OptMinSizeThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; OptMinSizeThreshold</div><div class="ttdoc">Threshold to use when the caller is optimized for minsize.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00219">InlineCost.h:219</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html"><div class="ttname"><a href="classllvm_1_1Attribute.html">llvm::Attribute</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00067">Attributes.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0b2ca98dc28c61793ff5c90d23e5f14e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::lookup</a></div><div class="ttdeci">ValueT lookup(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">lookup - Return the entry for the specified key, or a default constructed value if no such entry exis...</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00197">DenseMap.h:197</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a18b9d328d2490f447589ba60345eba6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">llvm::SetVector::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">Determine the number of elements in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00077">SetVector.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05258">Instructions.h:5258</a></div></div>
<div class="ttc" id="aGetElementPtrTypeIterator_8h_html"><div class="ttname"><a href="GetElementPtrTypeIterator_8h.html">GetElementPtrTypeIterator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a4b001d9b458035fbbfc154d52d354ee9"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const</div><div class="ttdoc">Return the constant as an APInt value reference.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00132">Constants.h:132</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a5be58f238f61d418cfa212e7768c8ea3"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a5be58f238f61d418cfa212e7768c8ea3">llvm::InlineParams::ColdCallSiteThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; ColdCallSiteThreshold</div><div class="ttdoc">Threshold to use when the callsite is considered cold.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00229">InlineCost.h:229</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a68fce0638c5ec7b96b8572cad9c20488"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a68fce0638c5ec7b96b8572cad9c20488">llvm::ConstantExpr::getICmp</a></div><div class="ttdeci">static Constant * getICmp(unsigned short pred, Constant *LHS, Constant *RHS, bool OnlyIfReduced=false)</div><div class="ttdoc">get* - Return some common constants without having to specify the full Instruction::OPCODE identifier...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02523">Constants.cpp:2523</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html_af8aeced5e71d2589fa3e9791043af5cb"><div class="ttname"><a href="classllvm_1_1PointerType.html#af8aeced5e71d2589fa3e9791043af5cb">llvm::PointerType::getAddressSpace</a></div><div class="ttdeci">unsigned getAddressSpace() const</div><div class="ttdoc">Return the address space of the Pointer type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00682">DerivedTypes.h:682</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdeci">@ ICMP_NE</div><div class="ttdoc">not equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00740">InstrTypes.h:740</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalAlias_html"><div class="ttname"><a href="classllvm_1_1GlobalAlias.html">llvm::GlobalAlias</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalAlias_8h_source.html#l00028">GlobalAlias.h:28</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a8683922a4b3d122c3b0d7d53b1cde2ad"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a8683922a4b3d122c3b0d7d53b1cde2ad">llvm::ConstantExpr::getSelect</a></div><div class="ttdeci">static Constant * getSelect(Constant *C, Constant *V1, Constant *V2, Type *OnlyIfReducedTy=nullptr)</div><div class="ttdoc">Select constant expr.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02441">Constants.cpp:2441</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a1eb8504bab5f794778d82db6ac829923"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::erase</a></div><div class="ttdeci">bool erase(const KeyT &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00302">DenseMap.h:302</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a253ef51d8dd3799be029082f278b567a"><div class="ttname"><a href="InlineCost_8cpp.html#a253ef51d8dd3799be029082f278b567a">MemAccessCost</a></div><div class="ttdeci">static cl::opt&lt; int &gt; MemAccessCost(&quot;inline-memaccess-cost&quot;, cl::Hidden, cl::init(0), cl::desc(&quot;Cost of load/store instruction when inlining&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a4665c23a10fcddd75e0de1d7d1262edb"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a4665c23a10fcddd75e0de1d7d1262edb">llvm::InlineConstants::OptSizeThreshold</a></div><div class="ttdeci">const int OptSizeThreshold</div><div class="ttdoc">Use when optsize (-Os) is specified.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00038">InlineCost.h:38</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ab95282573f276af5623b0b909f91d823"><div class="ttname"><a href="InlineCost_8cpp.html#ab95282573f276af5623b0b909f91d823">InlineCallerSupersetNoBuiltin</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; InlineCallerSupersetNoBuiltin(&quot;inline-caller-superset-nobuiltin&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Allow inlining when caller has a superset of callee's nobuiltin &quot; &quot;attributes.&quot;))</div></div>
<div class="ttc" id="aBasicBlockUtils_8cpp_html_a074f8df866dd09faecb84d0a37835494"><div class="ttname"><a href="BasicBlockUtils_8cpp.html#a074f8df866dd09faecb84d0a37835494">BBSetVector</a></div><div class="ttdeci">SetVector&lt; BasicBlock * &gt; BBSetVector</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l01733">BasicBlockUtils.cpp:1733</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aMemoryBuiltins_8h_html"><div class="ttname"><a href="MemoryBuiltins_8h.html">MemoryBuiltins.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a5e4a09f80c7cd5283dbbc7256d122d12"><div class="ttname"><a href="classllvm_1_1CallBase.html#a5e4a09f80c7cd5283dbbc7256d122d12">llvm::CallBase::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01264">InstrTypes.h:1264</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html_aa71268864238db3f41e3d6582103e4e2"><div class="ttname"><a href="classllvm_1_1InlineCost.html#aa71268864238db3f41e3d6582103e4e2">llvm::InlineCost::getAlways</a></div><div class="ttdeci">static InlineCost getAlways(const char *Reason, std::optional&lt; CostBenefitPair &gt; CostBenefit=std::nullopt)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00125">InlineCost.h:125</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5ae8db70add348cf4c743530e9b9f54e"><div class="ttname"><a href="namespacellvm.html#a5ae8db70add348cf4c743530e9b9f54e">llvm::isInlineViable</a></div><div class="ttdeci">InlineResult isInlineViable(Function &amp;Callee)</div><div class="ttdoc">Minimal filter to detect invalid constructs for inlining.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l03005">InlineCost.cpp:3005</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html"><div class="ttname"><a href="structllvm_1_1InlineParams.html">llvm::InlineParams</a></div><div class="ttdoc">Thresholds to tune inline cost analysis.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00205">InlineCost.h:205</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a53408c95a7bfb5443b43fb2134c3eb23"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">Return 1 if the specified key is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00145">DenseMap.h:145</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">llvm::tgtok::FalseVal</a></div><div class="ttdeci">@ FalseVal</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00062">TGLexer.h:62</a></div></div>
<div class="ttc" id="aOperator_8h_html"><div class="ttname"><a href="Operator_8h.html">Operator.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a3291338e19fa837f7b98305025a7d6c5"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a3291338e19fa837f7b98305025a7d6c5">llvm::InlineConstants::FunctionInlineCostMultiplierAttributeName</a></div><div class="ttdeci">const char FunctionInlineCostMultiplierAttributeName[]</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00059">InlineCost.h:59</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_aa30e16357eef0a6bb3dc98fb7fd67684"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#aa30e16357eef0a6bb3dc98fb7fd67684">llvm::TargetTransformInfo::getInlinerVectorBonusPercent</a></div><div class="ttdeci">int getInlinerVectorBonusPercent() const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00212">TargetTransformInfo.cpp:212</a></div></div>
<div class="ttc" id="anamespacellvm_html_a03503773241005f01b090b9862aad304"><div class="ttname"><a href="namespacellvm.html#a03503773241005f01b090b9862aad304">llvm::dump</a></div><div class="ttdeci">void dump(const SparseBitVector&lt; ElementSize &gt; &amp;LHS, raw_ostream &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="SparseBitVector_8h_source.html#l00877">SparseBitVector.h:877</a></div></div>
<div class="ttc" id="aSTLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a4fb513d744ca72275932b2c7003f16f6"><div class="ttname"><a href="classllvm_1_1CallBase.html#a4fb513d744ca72275932b2c7003f16f6">llvm::CallBase::arg_begin</a></div><div class="ttdeci">User::op_iterator arg_begin()</div><div class="ttdoc">Return the iterator pointing to the beginning of the argument list.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01326">InstrTypes.h:1326</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1UnaryOperator_html"><div class="ttname"><a href="classllvm_1_1UnaryOperator.html">llvm::UnaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00100">InstrTypes.h:100</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac828b9b52935f87659a4adf237f820a3"><div class="ttname"><a href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">llvm::gep_type_begin</a></div><div class="ttdeci">gep_type_iterator gep_type_begin(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00123">GetElementPtrTypeIterator.h:123</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a7806408b2a0bab4436109e57881cf32b"><div class="ttname"><a href="InlineCost_8cpp.html#a7806408b2a0bab4436109e57881cf32b">RecurStackSizeThreshold</a></div><div class="ttdeci">static cl::opt&lt; size_t &gt; RecurStackSizeThreshold(&quot;recursive-inline-max-stacksize&quot;, cl::Hidden, cl::init(InlineConstants::TotalAllocaSizeRecursiveCaller), cl::desc(&quot;Do not inline recursive functions with a stack &quot; &quot;size that exceeds the specified limit&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a79eed48913651aeedda2eed25201ea84"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">llvm::detail::DenseSetImpl&lt; ValueT, DenseMap&lt; ValueT, detail::DenseSetEmpty, DenseMapInfo&lt; ValueT &gt;, detail::DenseSetPair&lt; ValueT &gt; &gt;, DenseMapInfo&lt; ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00206">DenseSet.h:206</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_afe504aa31a6a354cec13f5b32d0b1d9d"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">llvm::detail::DenseSetImpl&lt; ValueT, DenseMap&lt; ValueT, detail::DenseSetEmpty, DenseMapInfo&lt; ValueT &gt;, detail::DenseSetPair&lt; ValueT &gt; &gt;, DenseMapInfo&lt; ValueT &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; ValueT &gt; V) const</div><div class="ttdoc">Return 1 if the specified key is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00097">DenseSet.h:97</a></div></div>
<div class="ttc" id="aConstantFolding_8h_html"><div class="ttname"><a href="ConstantFolding_8h.html">ConstantFolding.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_add4e37b60ea64faafbc9a5bf3e27280f"><div class="ttname"><a href="classllvm_1_1APInt.html#add4e37b60ea64faafbc9a5bf3e27280f">llvm::APInt::getZero</a></div><div class="ttdeci">static APInt getZero(unsigned numBits)</div><div class="ttdoc">Get the '0' value for the specified bit-width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00177">APInt.h:177</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ad6e6415d4d2e809c620d08fb23c1544f"><div class="ttname"><a href="InlineCost_8cpp.html#ad6e6415d4d2e809c620d08fb23c1544f">functionsHaveCompatibleAttributes</a></div><div class="ttdeci">static bool functionsHaveCompatibleAttributes(Function *Caller, Function *Callee, TargetTransformInfo &amp;TTI, function_ref&lt; const TargetLibraryInfo &amp;(Function &amp;)&gt; &amp;GetTLI)</div><div class="ttdoc">Test that there are no attribute conflicts between Caller and Callee that prevent inlining.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l02789">InlineCost.cpp:2789</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a5785ff0d45e059b3d783c960d3ee3759"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a5785ff0d45e059b3d783c960d3ee3759">InlinePriorityMode::CostBenefit</a></div><div class="ttdeci">@ CostBenefit</div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a43c6ebb4fd35ebd815d66a2df4eed0b9"><div class="ttname"><a href="namespacellvm.html#a43c6ebb4fd35ebd815d66a2df4eed0b9">llvm::gep_type_end</a></div><div class="ttdeci">gep_type_iterator gep_type_end(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00130">GetElementPtrTypeIterator.h:130</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ab0cc2683c96d662745a77c95e77b9c9c"><div class="ttname"><a href="InlineCost_8cpp.html#ab0cc2683c96d662745a77c95e77b9c9c">InstrCost</a></div><div class="ttdeci">static cl::opt&lt; int &gt; InstrCost(&quot;inline-instr-cost&quot;, cl::Hidden, cl::init(5), cl::desc(&quot;Cost of a single instruction when inlining&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a554ab77949b0a16670a83ec3307501eb"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a554ab77949b0a16670a83ec3307501eb">llvm::ConstantExpr::getSub</a></div><div class="ttdeci">static Constant * getSub(Constant *C1, Constant *C2, bool HasNUW=false, bool HasNSW=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02664">Constants.cpp:2664</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html_ab15a975a1c647356007e6b622ec99fb5"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html#ab15a975a1c647356007e6b622ec99fb5">llvm::BlockFrequencyInfo::getEntryFreq</a></div><div class="ttdeci">uint64_t getEntryFreq() const</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8cpp_source.html#l00280">BlockFrequencyInfo.cpp:280</a></div></div>
<div class="ttc" id="aCodeMetrics_8h_html"><div class="ttname"><a href="CodeMetrics_8h.html">CodeMetrics.h</a></div></div>
<div class="ttc" id="aFormattedStream_8h_html"><div class="ttname"><a href="FormattedStream_8h.html">FormattedStream.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ad2e1f19379514bb06cdcedb2bae8748d"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ad2e1f19379514bb06cdcedb2bae8748d">llvm::TargetTransformInfo::areInlineCompatible</a></div><div class="ttdeci">bool areInlineCompatible(const Function *Caller, const Function *Callee) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l01086">TargetTransformInfo.cpp:1086</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html">llvm::BlockFrequencyInfo</a></div><div class="ttdoc">BlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate IR basic block frequen...</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00037">BlockFrequencyInfo.h:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a32e606ac4c88f71f14212e42b808e7f4"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">llvm::GlobalValue::isDeclaration</a></div><div class="ttdeci">bool isDeclaration() const</div><div class="ttdoc">Return true if the primary definition of this global value is outside of the current translation unit...</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00275">Globals.cpp:275</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a38e17a3379fe0336330cda390fd23fea"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a38e17a3379fe0336330cda390fd23fea">llvm::InlineParams::OptSizeThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; OptSizeThreshold</div><div class="ttdoc">Threshold to use when the caller is optimized for size.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00216">InlineCost.h:216</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5f5f248d08aa55c63e5bc7a8304a7319"><div class="ttname"><a href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">llvm::getInlineCost</a></div><div class="ttdeci">InlineCost getInlineCost(CallBase &amp;Call, const InlineParams &amp;Params, TargetTransformInfo &amp;CalleeTTI, function_ref&lt; AssumptionCache &amp;(Function &amp;)&gt; GetAssumptionCache, function_ref&lt; const TargetLibraryInfo &amp;(Function &amp;)&gt; GetTLI, function_ref&lt; BlockFrequencyInfo &amp;(Function &amp;)&gt; GetBFI=nullptr, ProfileSummaryInfo *PSI=nullptr, OptimizationRemarkEmitter *ORE=nullptr)</div><div class="ttdoc">Get an InlineCost object representing the cost of inlining this callsite.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l02838">InlineCost.cpp:2838</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_ae4b6abe77abf42fb02081a6cc41a0132"><div class="ttname"><a href="classllvm_1_1Constant.html#ae4b6abe77abf42fb02081a6cc41a0132">llvm::Constant::isNullValue</a></div><div class="ttdeci">bool isNullValue() const</div><div class="ttdoc">Return true if this is the value that would be returned by getNullValue.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00076">Constants.cpp:76</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">InlinePriorityMode::Cost</a></div><div class="ttdeci">@ Cost</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a9ab3097ecb543e993b6a1ccd0cb03258"><div class="ttname"><a href="InlineCost_8cpp.html#a9ab3097ecb543e993b6a1ccd0cb03258">InlineThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; InlineThreshold(&quot;inline-threshold&quot;, cl::Hidden, cl::init(225), cl::desc(&quot;Control the amount of inlining to perform (default = 225)&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="anamespacellvm_html_a31965ae9b8c0a53197f6a2dcc9205bd7"><div class="ttname"><a href="namespacellvm.html#a31965ae9b8c0a53197f6a2dcc9205bd7">llvm::getInliningCostFeatures</a></div><div class="ttdeci">std::optional&lt; InlineCostFeatures &gt; getInliningCostFeatures(CallBase &amp;Call, TargetTransformInfo &amp;CalleeTTI, function_ref&lt; AssumptionCache &amp;(Function &amp;)&gt; GetAssumptionCache, function_ref&lt; BlockFrequencyInfo &amp;(Function &amp;)&gt; GetBFI=nullptr, ProfileSummaryInfo *PSI=nullptr, OptimizationRemarkEmitter *ORE=nullptr)</div><div class="ttdoc">Get the expanded cost features.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l02873">InlineCost.cpp:2873</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdeci">@ A</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00034">ARMBaseInfo.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a83b8c9e572130f403445c0b0f69b837c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">llvm::CallBase::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const</div><div class="ttdoc">Returns the function called, or null if this is an indirect function invocation or the function signa...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01406">InstrTypes.h:1406</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html_ac1dbd59a648c96031c8d91238017e6c2"><div class="ttname"><a href="classllvm_1_1InlineCost.html#ac1dbd59a648c96031c8d91238017e6c2">llvm::InlineCost::get</a></div><div class="ttdeci">static InlineCost get(int Cost, int Threshold, int StaticBonus=0)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00119">InlineCost.h:119</a></div></div>
<div class="ttc" id="anamespacellvm_1_1jitlink_1_1aarch64_html_a54a878e42755b4a0e4cc8709f3f34e51"><div class="ttname"><a href="namespacellvm_1_1jitlink_1_1aarch64.html#a54a878e42755b4a0e4cc8709f3f34e51">llvm::jitlink::aarch64::PointerSize</a></div><div class="ttdeci">constexpr uint64_t PointerSize</div><div class="ttdoc">aarch64 pointer size.</div><div class="ttdef"><b>Definition:</b> <a href="aarch64_8h_source.html#l00479">aarch64.h:479</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html"><div class="ttname"><a href="classllvm_1_1InlineCost.html">llvm::InlineCost</a></div><div class="ttdoc">Represents the cost of inlining a function.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00089">InlineCost.h:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a1881146f2dcc2ca57c9c5f77f938db9d"><div class="ttname"><a href="classllvm_1_1StringRef.html#a1881146f2dcc2ca57c9c5f77f938db9d">llvm::StringRef::getAsInteger</a></div><div class="ttdeci">bool getAsInteger(unsigned Radix, T &amp;Result) const</div><div class="ttdoc">Parse the current string as an integer of the specified radix.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00469">StringRef.h:469</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57bbf83a870bd632acf3165c19da8f44"><div class="ttname"><a href="namespacellvm.html#a57bbf83a870bd632acf3165c19da8f44">llvm::ConstantFoldCall</a></div><div class="ttdeci">Constant * ConstantFoldCall(const CallBase *Call, Function *F, ArrayRef&lt; Constant * &gt; Operands, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">ConstantFoldCall - Attempt to constant fold a call to the specified function with the specified argum...</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l03267">ConstantFolding.cpp:3267</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_aecdf3f88e590cff2cf824f128934342d"><div class="ttname"><a href="InlineCost_8cpp.html#aecdf3f88e590cff2cf824f128934342d">InlineEnableCostBenefitAnalysis</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; InlineEnableCostBenefitAnalysis(&quot;inline-enable-cost-benefit-analysis&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Enable the cost-benefit analysis for the inliner&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">llvm::ms_demangle::QualifierMangleMode::Result</a></div><div class="ttdeci">@ Result</div></div>
<div class="ttc" id="anamespacellvm_html_aa750395459fa1eb7130d6de8e3d074f6"><div class="ttname"><a href="namespacellvm.html#aa750395459fa1eb7130d6de8e3d074f6">llvm::simplifyBinOp</a></div><div class="ttdeci">Value * simplifyBinOp(unsigned Opcode, Value *LHS, Value *RHS, const SimplifyQuery &amp;Q)</div><div class="ttdoc">Given operands for a BinaryOperator, fold the result or return null.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l05812">InstructionSimplify.cpp:5812</a></div></div>
<div class="ttc" id="anamespacellvm_html_a20f356124998d05f7e605549cc2dda91"><div class="ttname"><a href="namespacellvm.html#a20f356124998d05f7e605549cc2dda91">llvm::canConstantFoldCallTo</a></div><div class="ttdeci">bool canConstantFoldCallTo(const CallBase *Call, const Function *F)</div><div class="ttdoc">canConstantFoldCallTo - Return true if its even possible to fold a call to the specified function.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l01495">ConstantFolding.cpp:1495</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7ef78f96e07a124af3b346d8df9010cc"><div class="ttname"><a href="namespacellvm.html#a7ef78f96e07a124af3b346d8df9010cc">llvm::InlineCostFeatureIndex</a></div><div class="ttdeci">InlineCostFeatureIndex</div><div class="ttdef"><b>Definition:</b> <a href="InlineModelFeatureMaps_8h_source.html#l00051">InlineModelFeatureMaps.h:51</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a8ec73f89a2e044c3020319ba8f3e52c1"><div class="ttname"><a href="InlineCost_8cpp.html#a8ec73f89a2e044c3020319ba8f3e52c1">ColdCallSiteThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; ColdCallSiteThreshold(&quot;inline-cold-callsite-threshold&quot;, cl::Hidden, cl::init(45), cl::desc(&quot;Threshold for inlining cold callsites&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_af5bf7228ae6efbaf626a0dcedf02d8c5"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#af5bf7228ae6efbaf626a0dcedf02d8c5">llvm::InlineConstants::getInstrCost</a></div><div class="ttdeci">int getInstrCost()</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l00184">InlineCost.cpp:184</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_af431ec215bba8bb9c56e7541d99920f2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">llvm::PatternMatch::m_FNeg</a></div><div class="ttdeci">FNeg_match&lt; OpTy &gt; m_FNeg(const OpTy &amp;X)</div><div class="ttdoc">Match 'fneg X' as 'fsub -0.0, X'.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01033">PatternMatch.h:1033</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">llvm::pdb::PDB_SymType::Caller</a></div><div class="ttdeci">@ Caller</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Operator_html_aca4ffddc11c10477a4a76ada6fd5da46"><div class="ttname"><a href="classllvm_1_1Operator.html#aca4ffddc11c10477a4a76ada6fd5da46">llvm::Operator::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Return the opcode for this Instruction or ConstantExpr.</div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00041">Operator.h:41</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a88449ce28c2bd9290260794929242c0a"><div class="ttname"><a href="InlineCost_8cpp.html#a88449ce28c2bd9290260794929242c0a">DefaultThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; DefaultThreshold(&quot;inlinedefault-threshold&quot;, cl::Hidden, cl::init(225), cl::desc(&quot;Default amount of inlining to perform&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineResult_html_af279070ae6350a3acd0e80ba7da7d397"><div class="ttname"><a href="classllvm_1_1InlineResult.html#af279070ae6350a3acd0e80ba7da7d397">llvm::InlineResult::isSuccess</a></div><div class="ttdeci">bool isSuccess() const</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00188">InlineCost.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1Option_html_a2dc75fafb68e7669e776e19da7857cdf"><div class="ttname"><a href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">llvm::cl::Option::getNumOccurrences</a></div><div class="ttdeci">int getNumOccurrences() const</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00401">CommandLine.h:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineCostAnnotationPrinterPass_html_aa0abf6fac51bc051d817b1f71c921098"><div class="ttname"><a href="structllvm_1_1InlineCostAnnotationPrinterPass.html#aa0abf6fac51bc051d817b1f71c921098">llvm::InlineCostAnnotationPrinterPass::run</a></div><div class="ttdeci">PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;FAM)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l03146">InlineCost.cpp:3146</a></div></div>
<div class="ttc" id="astructllvm_1_1CodeMetrics_html_a7e174506b52ad46ea1f746a7f727d999"><div class="ttname"><a href="structllvm_1_1CodeMetrics.html#a7e174506b52ad46ea1f746a7f727d999">llvm::CodeMetrics::collectEphemeralValues</a></div><div class="ttdeci">static void collectEphemeralValues(const Loop *L, AssumptionCache *AC, SmallPtrSetImpl&lt; const Value * &gt; &amp;EphValues)</div><div class="ttdoc">Collect a loop's ephemeral values (those used only by an assume or similar intrinsics in the loop).</div><div class="ttdef"><b>Definition:</b> <a href="CodeMetrics_8cpp_source.html#l00070">CodeMetrics.cpp:70</a></div></div>
<div class="ttc" id="aLint_8cpp_html_a7fb3c9caadeb0f7fe4828d380158d0f9"><div class="ttname"><a href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a></div><div class="ttdeci">Statically lint checks LLVM IR</div><div class="ttdef"><b>Definition:</b> <a href="Lint_8cpp_source.html#l00746">Lint.cpp:746</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_aba7063dea024346c7b70099c63703f50"><div class="ttname"><a href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">llvm::getInlineParams</a></div><div class="ttdeci">InlineParams getInlineParams()</div><div class="ttdoc">Generate the parameters to tune the inline cost analysis based only on the commandline options.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l03117">InlineCost.cpp:3117</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">llvm::MCID::Call</a></div><div class="ttdeci">@ Call</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00156">MCInstrDesc.h:156</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a155256dae9eff9b764b9d5eb5a10d8a9"><div class="ttname"><a href="InlineCost_8cpp.html#a155256dae9eff9b764b9d5eb5a10d8a9">HintThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; HintThreshold(&quot;inlinehint-threshold&quot;, cl::Hidden, cl::init(325), cl::desc(&quot;Threshold for inlining functions with inline hint&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_a968930aea9d9efa8d46dd890fce75643"><div class="ttname"><a href="classllvm_1_1Attribute.html#a968930aea9d9efa8d46dd890fce75643">llvm::Attribute::getValueAsString</a></div><div class="ttdeci">StringRef getValueAsString() const</div><div class="ttdoc">Return the attribute's value as a string.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00312">Attributes.cpp:312</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a1afb689cf73d254713061b112c900a72"><div class="ttname"><a href="InlineCost_8cpp.html#a1afb689cf73d254713061b112c900a72">OptComputeFullInlineCost</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; OptComputeFullInlineCost(&quot;inline-cost-full&quot;, cl::Hidden, cl::desc(&quot;Compute the full inline cost of a call site even when the cost &quot; &quot;exceeds the threshold.&quot;))</div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ab9082799f60c525cdaca5393dcd13894"><div class="ttname"><a href="InlineCost_8cpp.html#ab9082799f60c525cdaca5393dcd13894">IgnoreTTIInlineCompatible</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; IgnoreTTIInlineCompatible(&quot;ignore-tti-inline-compatible&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Ignore TTI attributes compatibility check between callee/caller &quot; &quot;during inline cost calculation&quot;))</div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00040">ProfileSummaryInfo.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_aac456a62894c9f0f8e9f06373bbf40f0"><div class="ttname"><a href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">llvm::BranchInst::getCondition</a></div><div class="ttdeci">Value * getCondition() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03220">Instructions.h:3220</a></div></div>
<div class="ttc" id="aMIRNamerPass_8cpp_html_a05e4be4ec3e2c3587dda0e376bb6822c"><div class="ttname"><a href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a></div><div class="ttdeci">mir Rename Register Operands</div><div class="ttdef"><b>Definition:</b> <a href="MIRNamerPass_8cpp_source.html#l00074">MIRNamerPass.cpp:74</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1InvokeInst_html"><div class="ttname"><a href="classllvm_1_1InvokeInst.html">llvm::InvokeInst</a></div><div class="ttdoc">Invoke instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03814">Instructions.h:3814</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html"><div class="ttname"><a href="classllvm_1_1CmpInst.html">llvm::CmpInst</a></div><div class="ttdoc">This class is the base class for the comparison instructions.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00708">InstrTypes.h:708</a></div></div>
<div class="ttc" id="aAssemblyAnnotationWriter_8h_html"><div class="ttname"><a href="AssemblyAnnotationWriter_8h.html">AssemblyAnnotationWriter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1function__ref_html"><div class="ttname"><a href="classllvm_1_1function__ref.html">llvm::function_ref</a></div><div class="ttdoc">An efficient, type-erasing, non-owning reference to a callable.</div><div class="ttdef"><b>Definition:</b> <a href="STLFunctionalExtras_8h_source.html#l00036">STLFunctionalExtras.h:36</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a709f2e88554f9b1dc20e16371813aa84"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a709f2e88554f9b1dc20e16371813aa84">llvm::InlineParams::ColdThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; ColdThreshold</div><div class="ttdoc">Threshold to use for cold callees.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00213">InlineCost.h:213</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet</a></div><div class="ttdoc">Implements a dense probed hash-table based set.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00268">DenseSet.h:268</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_aaa82a5af56de7ce383f94bd9f4e2bee3"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#aaa82a5af56de7ce383f94bd9f4e2bee3">llvm::InlineConstants::MaxInlineStackSizeAttributeName</a></div><div class="ttdeci">const char MaxInlineStackSizeAttributeName[]</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00062">InlineCost.h:62</a></div></div>
<div class="ttc" id="anamespacellvm_html_a264176188c0aadccd3ca5b6929b5a2e1ab24ce0cd392a5b0b8dedc66c25213594"><div class="ttname"><a href="namespacellvm.html#a264176188c0aadccd3ca5b6929b5a2e1ab24ce0cd392a5b0b8dedc66c25213594">llvm::AllocFnKind::Free</a></div><div class="ttdeci">@ Free</div></div>
<div class="ttc" id="anamespacellvm_html_a23d4c211faf80b8789923262b5b5ae77"><div class="ttname"><a href="namespacellvm.html#a23d4c211faf80b8789923262b5b5ae77">llvm::ProfileCount</a></div><div class="ttdeci">Function::ProfileCount ProfileCount</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileLoaderBaseImpl_8h_source.html#l00048">SampleProfileLoaderBaseImpl.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6e5d2e18c81baaeec7dadc81a0dea993"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6e5d2e18c81baaeec7dadc81a0dea993">llvm::Instruction::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned Idx) const LLVM_READONLY</div><div class="ttdoc">Return the specified successor. This instruction must be a terminator.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00835">Instruction.cpp:835</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a6e878d84d424326fd6132b320f075c97"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a6e878d84d424326fd6132b320f075c97">llvm::InlineConstants::IndirectCallThreshold</a></div><div class="ttdeci">const int IndirectCallThreshold</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00048">InlineCost.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html"><div class="ttname"><a href="classllvm_1_1StructLayout.html">llvm::StructLayout</a></div><div class="ttdoc">Used to lazily calculate structure layout information for a target machine, based on the DataLayout s...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00618">DataLayout.h:618</a></div></div>
<div class="ttc" id="aProfileSummaryInfo_8h_html"><div class="ttname"><a href="ProfileSummaryInfo_8h.html">ProfileSummaryInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CatchReturnInst_html"><div class="ttname"><a href="classllvm_1_1CatchReturnInst.html">llvm::CatchReturnInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04584">Instructions.h:4584</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_ac5fa84316036c761096ad4f9a07ccca2"><div class="ttname"><a href="structllvm_1_1InlineParams.html#ac5fa84316036c761096ad4f9a07ccca2">llvm::InlineParams::HintThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; HintThreshold</div><div class="ttdoc">Threshold to use for callees with inline hint.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00210">InlineCost.h:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionAnalysis_html"><div class="ttname"><a href="classllvm_1_1AssumptionAnalysis.html">llvm::AssumptionAnalysis</a></div><div class="ttdoc">A function analysis which provides an AssumptionCache.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00173">AssumptionCache.h:173</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a75e7c36ed7f71d0c4afca48f835a098b"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a75e7c36ed7f71d0c4afca48f835a098b">llvm::InlineParams::HotCallSiteThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; HotCallSiteThreshold</div><div class="ttdoc">Threshold to use when the callsite is considered hot.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00222">InlineCost.h:222</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequency_html_a8e9ed6b20c2503f66f1fd0725297aedc"><div class="ttname"><a href="classllvm_1_1BlockFrequency.html#a8e9ed6b20c2503f66f1fd0725297aedc">llvm::BlockFrequency::getFrequency</a></div><div class="ttdeci">uint64_t getFrequency() const</div><div class="ttdoc">Returns the frequency as a fixpoint number scaled by the entry frequency.</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequency_8h_source.html#l00034">BlockFrequency.h:34</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9cb2daa4b6729813d1f8d39b9e037a5a"><div class="ttname"><a href="namespacellvm.html#a9cb2daa4b6729813d1f8d39b9e037a5a">llvm::SaturatingMultiplyAdd</a></div><div class="ttdeci">std::enable_if_t&lt; std::is_unsigned&lt; T &gt;::value, T &gt; SaturatingMultiplyAdd(T X, T Y, T A, bool *ResultOverflowed=nullptr)</div><div class="ttdoc">Multiply two unsigned integers, X and Y, and add the unsigned integer, A to the product.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00658">MathExtras.h:658</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60e"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">llvm::Attribute::AttrKind</a></div><div class="ttdeci">AttrKind</div><div class="ttdoc">This enumeration lists the attributes that can be associated with parameters, function results,...</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00086">Attributes.h:86</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_aa6363460750bae7277bffc8503d0c3b6"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#aa6363460750bae7277bffc8503d0c3b6">llvm::InlineConstants::OptAggressiveThreshold</a></div><div class="ttdeci">const int OptAggressiveThreshold</div><div class="ttdoc">Use when -O3 is specified.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00044">InlineCost.h:44</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f635b6d5c5f74d0c2e359897a5e7498"><div class="ttname"><a href="namespacellvm.html#a2f635b6d5c5f74d0c2e359897a5e7498">llvm::lowerObjectSizeCall</a></div><div class="ttdeci">Value * lowerObjectSizeCall(IntrinsicInst *ObjectSize, const DataLayout &amp;DL, const TargetLibraryInfo *TLI, bool MustSucceed)</div><div class="ttdoc">Try to turn a call to @llvm.objectsize into an integer value of the given Type.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryBuiltins_8cpp_source.html#l00589">MemoryBuiltins.cpp:589</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdoc">Class to represent pointers.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00632">DerivedTypes.h:632</a></div></div>
<div class="ttc" id="anamespacellvm_html_aab02db480f387fca92956ef1c9a01941"><div class="ttname"><a href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">llvm::simplifyInstruction</a></div><div class="ttdeci">Value * simplifyInstruction(Instruction *I, const SimplifyQuery &amp;Q, OptimizationRemarkEmitter *ORE=nullptr)</div><div class="ttdoc">See if we can compute a simplified version of this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l06731">InstructionSimplify.cpp:6731</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aclassllvm_1_1formatted__raw__ostream_html"><div class="ttname"><a href="classllvm_1_1formatted__raw__ostream.html">llvm::formatted_raw_ostream</a></div><div class="ttdoc">formatted_raw_ostream - A raw_ostream that wraps another one and keeps track of line and column posit...</div><div class="ttdef"><b>Definition:</b> <a href="FormattedStream_8h_source.html#l00030">FormattedStream.h:30</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="astructllvm_1_1InlineCostAnnotationPrinterPass_html_a18a45967121f9b770eb8a2dad250d9d6"><div class="ttname"><a href="structllvm_1_1InlineCostAnnotationPrinterPass.html#a18a45967121f9b770eb8a2dad250d9d6">llvm::InlineCostAnnotationPrinterPass::OS</a></div><div class="ttdeci">raw_ostream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00340">InlineCost.h:340</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a3107234de6aa860244f4ee5d3009486f"><div class="ttname"><a href="InlineCost_8cpp.html#a3107234de6aa860244f4ee5d3009486f">ColdThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; ColdThreshold(&quot;inlinecold-threshold&quot;, cl::Hidden, cl::init(45), cl::desc(&quot;Threshold for inlining functions with cold attribute&quot;))</div></div>
<div class="ttc" id="aInstructionSimplify_8cpp_html_adb39181b87dffcd61082d08e02bf314e"><div class="ttname"><a href="InstructionSimplify_8cpp.html#adb39181b87dffcd61082d08e02bf314e">getFalse</a></div><div class="ttdeci">static Constant * getFalse(Type *Ty)</div><div class="ttdoc">For a boolean type or a vector of boolean type, return false or a vector with every element false.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l00122">InstructionSimplify.cpp:122</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ae2bb081d94f22e64ca6bc4bd58512a93"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a></div><div class="ttdeci">&lt;%struct.s * &gt; cast struct s *S to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *agg result to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *memtmp to sbyte *&lt; sbyte * &gt; sbyte uint ret void llc ends up issuing two memcpy or custom lower memcpy(of small size) to be ldmia/stmia. I think option 2 is better but the current register allocator cannot allocate a chunk of registers at a time. A feasible temporary solution is to use specific physical registers at the lowering time for small(&lt;</div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="aInlineCost_8h_html"><div class="ttname"><a href="InlineCost_8h.html">InlineCost.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0d69e81725c10fa5407f0bf34462068"><div class="ttname"><a href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">llvm::TTI</a></div><div class="ttdeci">TargetTransformInfo TTI</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00191">TargetTransformInfo.h:191</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_aa8b08fb48c8c58e63aa231a1099475d9"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#aa8b08fb48c8c58e63aa231a1099475d9">llvm::TargetTransformInfo::isLoweredToCall</a></div><div class="ttdeci">bool isLoweredToCall(const Function *F) const</div><div class="ttdoc">Test whether calls to a function lower to actual program function calls.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00298">TargetTransformInfo.cpp:298</a></div></div>
<div class="ttc" id="aclassllvm_1_1Record_html"><div class="ttname"><a href="classllvm_1_1Record.html">llvm::Record</a></div><div class="ttdef"><b>Definition:</b> <a href="Record_8h_source.html#l01577">Record.h:1577</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1GEPOperator_html"><div class="ttname"><a href="classllvm_1_1GEPOperator.html">llvm::GEPOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00378">Operator.h:378</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ac0f11b96f81b2769dd23d028e3189075"><div class="ttname"><a href="classllvm_1_1CallBase.html#ac0f11b96f81b2769dd23d028e3189075">llvm::CallBase::arg_end</a></div><div class="ttdeci">User::op_iterator arg_end()</div><div class="ttdoc">Return the iterator pointing to the end of the argument list.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01332">InstrTypes.h:1332</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad56f6a9b5cd05940017c4544df48bc30"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad56f6a9b5cd05940017c4544df48bc30">llvm::BranchInst::isUnconditional</a></div><div class="ttdeci">bool isUnconditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03217">Instructions.h:3217</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aM68kELFObjectWriter_8cpp_html_ae4a8bc3879d2282eefd72b16b12c2a37"><div class="ttname"><a href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a></div><div class="ttdeci">static M68kRelType getType(unsigned Kind, MCSymbolRefExpr::VariantKind &amp;Modifier, bool &amp;IsPCRel)</div><div class="ttdef"><b>Definition:</b> <a href="M68kELFObjectWriter_8cpp_source.html#l00048">M68kELFObjectWriter.cpp:48</a></div></div>
<div class="ttc" id="anamespacellvm_html_a67980a8ae101d2fda845eb750ffb1942"><div class="ttname"><a href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">llvm::print</a></div><div class="ttdeci">Printable print(const GCNRegPressure &amp;RP, const GCNSubtarget *ST=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="GCNRegPressure_8cpp_source.html#l00138">GCNRegPressure.cpp:138</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a0ac5b7c2981646d4f6a55fbc52feaeeb"><div class="ttname"><a href="InlineCost_8cpp.html#a0ac5b7c2981646d4f6a55fbc52feaeeb">StackSizeThreshold</a></div><div class="ttdeci">static cl::opt&lt; size_t &gt; StackSizeThreshold(&quot;inline-max-stacksize&quot;, cl::Hidden, cl::init(std::numeric_limits&lt; size_t &gt;::max()), cl::desc(&quot;Do not inline functions with a stack size &quot; &quot;that exceeds the specified limit&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272ca89f768b1267e3083b4eb05b4ab77e717">llvm::TargetTransformInfo::TCC_Free</a></div><div class="ttdeci">@ TCC_Free</div><div class="ttdoc">Expected to fold away in lowering.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00267">TargetTransformInfo.h:267</a></div></div>
<div class="ttc" id="anamespacellvm_html_a72278be77e997abc4b0dbde1be280006"><div class="ttname"><a href="namespacellvm.html#a72278be77e997abc4b0dbde1be280006">llvm::ConstantFoldInstOperands</a></div><div class="ttdeci">Constant * ConstantFoldInstOperands(Instruction *I, ArrayRef&lt; Constant * &gt; Ops, const DataLayout &amp;DL, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">ConstantFoldInstOperands - Attempt to constant fold an instruction with the specified operands.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l01209">ConstantFolding.cpp:1209</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a9e46a3a4bf99f8dcea9cb9efb4d977a3"><div class="ttname"><a href="classllvm_1_1CallBase.html#a9e46a3a4bf99f8dcea9cb9efb4d977a3">llvm::CallBase::getFnAttr</a></div><div class="ttdeci">Attribute getFnAttr(StringRef Kind) const</div><div class="ttdoc">Get the attribute of a given kind for the function.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01625">InstrTypes.h:1625</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00187">InstrTypes.h:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdoc">Class to represent struct types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00213">DerivedTypes.h:213</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="alib_2Analysis_2README_8txt_html_ad5ccdce1179bbfb942a084b3005f360d"><div class="ttname"><a href="lib_2Analysis_2README_8txt.html#ad5ccdce1179bbfb942a084b3005f360d">this</a></div><div class="ttdeci">Analysis the ScalarEvolution expression for r is this</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Analysis_2README_8txt_source.html#l00008">README.txt:8</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a6690aaae8b3d4f4ddc10d536d59eaa7c"><div class="ttname"><a href="InlineCost_8cpp.html#a6690aaae8b3d4f4ddc10d536d59eaa7c">LocallyHotCallSiteThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; LocallyHotCallSiteThreshold(&quot;locally-hot-callsite-threshold&quot;, cl::Hidden, cl::init(525), cl::desc(&quot;Threshold for locally hot callsites &quot;))</div></div>
<div class="ttc" id="aInstVisitor_8h_html"><div class="ttname"><a href="InstVisitor_8h.html">InstVisitor.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCache_html"><div class="ttname"><a href="classllvm_1_1AssumptionCache.html">llvm::AssumptionCache</a></div><div class="ttdoc">A cache of @llvm.assume calls within a function.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00042">AssumptionCache.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">llvm::TargetTransformInfo::TCK_SizeAndLatency</a></div><div class="ttdeci">@ TCK_SizeAndLatency</div><div class="ttdoc">The weighted sum of size and latency.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00245">TargetTransformInfo.h:245</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">llvm::Offset</a></div><div class="ttdeci">@ Offset</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ab2134ebaeaea50d7cf9be53c567777eb"><div class="ttname"><a href="InlineCost_8cpp.html#ab2134ebaeaea50d7cf9be53c567777eb">DEBUG_PRINT_STAT</a></div><div class="ttdeci">#define DEBUG_PRINT_STAT(x)</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a882d55a6aa2028e1a5ad708b275334e0"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">llvm::ConstantInt::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">This is just a convenience method to make client code smaller for a common code.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00193">Constants.h:193</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6a66ebb3aa12757479a3c88de77d78f8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">llvm::Instruction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const</div><div class="ttdoc">Return the function this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00074">Instruction.cpp:74</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a015846b6188ce15e08cd94c74a9df1a3"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a></div><div class="ttdeci">* A</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00089">README_ALTIVEC.txt:89</a></div></div>
<div class="ttc" id="aBasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00806">BasicAliasAnalysis.cpp:806</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchProbability_html"><div class="ttname"><a href="classllvm_1_1BranchProbability.html">llvm::BranchProbability</a></div><div class="ttdef"><b>Definition:</b> <a href="BranchProbability_8h_source.html#l00030">BranchProbability.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrToIntInst_html"><div class="ttname"><a href="classllvm_1_1PtrToIntInst.html">llvm::PtrToIntInst</a></div><div class="ttdoc">This class represents a cast from a pointer to an integer.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05207">Instructions.h:5207</a></div></div>
<div class="ttc" id="anamespacellvm_html_a24380444e7b6b5af3e742282c87d4219"><div class="ttname"><a href="namespacellvm.html#a24380444e7b6b5af3e742282c87d4219">llvm::getStringFnAttrAsInt</a></div><div class="ttdeci">std::optional&lt; int &gt; getStringFnAttrAsInt(CallBase &amp;CB, StringRef AttrKind)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l00175">InlineCost.cpp:175</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineResult_html_a545b04aaa22d87b07a0871da2713a67a"><div class="ttname"><a href="classllvm_1_1InlineResult.html#a545b04aaa22d87b07a0871da2713a67a">llvm::InlineResult::getFailureReason</a></div><div class="ttdeci">const char * getFailureReason() const</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00189">InlineCost.h:189</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html"><div class="ttname"><a href="classllvm_1_1InstVisitor.html">llvm::InstVisitor</a></div><div class="ttdoc">Base class for instruction visitors.</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00078">InstVisitor.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">This is the base class for all instructions that perform data casts.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00428">InstrTypes.h:428</a></div></div>
<div class="ttc" id="aBlockFrequencyInfo_8h_html"><div class="ttname"><a href="BlockFrequencyInfo_8h.html">BlockFrequencyInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">llvm::AMDGPUISD::BFI</a></div><div class="ttdeci">@ BFI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00441">AMDGPUISelLowering.h:441</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ac2f898cba8bf13271ebe0d59369c85ff"><div class="ttname"><a href="InlineCost_8cpp.html#ac2f898cba8bf13271ebe0d59369c85ff">DisableGEPConstOperand</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableGEPConstOperand(&quot;disable-gep-const-evaluation&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Disables evaluation of GetElementPtr with constant operands&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a4cbb2344996abd4332716e76178ad4f4"><div class="ttname"><a href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">llvm::CallBase::paramHasAttr</a></div><div class="ttdeci">bool paramHasAttr(unsigned ArgNo, Attribute::AttrKind Kind) const</div><div class="ttdoc">Determine whether the argument or parameter has the given attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00352">Instructions.cpp:352</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1f2f83d3af349e89d62c6277ba668b4f"><div class="ttname"><a href="namespacellvm.html#a1f2f83d3af349e89d62c6277ba668b4f">llvm::isAssumeLikeIntrinsic</a></div><div class="ttdeci">bool isAssumeLikeIntrinsic(const Instruction *I)</div><div class="ttdoc">Return true if it is an intrinsic that cannot be speculated but also cannot trap.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00527">ValueTracking.cpp:527</a></div></div>
<div class="ttc" id="aIVUsers_8cpp_html_ac2f338c3f467b3d09613e190d73044a5"><div class="ttname"><a href="IVUsers_8cpp.html#ac2f338c3f467b3d09613e190d73044a5">users</a></div><div class="ttdeci">iv users</div><div class="ttdef"><b>Definition:</b> <a href="IVUsers_8cpp_source.html#l00048">IVUsers.cpp:48</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_a0e1c3175b0ac22fe3853651c28e1ecb8"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">llvm::SmallPtrSetImplBase::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00093">SmallPtrSet.h:93</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a63bd3eb481440ad11d4b4905d2372f5e"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a63bd3eb481440ad11d4b4905d2372f5e">llvm::InlineConstants::MaxSimplifiedDynamicAllocaToInline</a></div><div class="ttdeci">const uint64_t MaxSimplifiedDynamicAllocaToInline</div><div class="ttdoc">Do not inline dynamic allocas that have been constant propagated to be static allocas above this amou...</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00057">InlineCost.h:57</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6e06e93488a2f32aeb56f86797a78c33"><div class="ttname"><a href="namespacellvm.html#a6e06e93488a2f32aeb56f86797a78c33">llvm::simplifyFNegInst</a></div><div class="ttdeci">Value * simplifyFNegInst(Value *Op, FastMathFlags FMF, const SimplifyQuery &amp;Q)</div><div class="ttdoc">Given operand for an FNeg, fold the result or return null.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l05307">InstructionSimplify.cpp:5307</a></div></div>
<div class="ttc" id="aCallingConv_8h_html"><div class="ttname"><a href="CallingConv_8h.html">CallingConv.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa41f9508130468035e0087f7cbdffa14"><div class="ttname"><a href="namespacellvm.html#aa41f9508130468035e0087f7cbdffa14">llvm::getAttributeBasedInliningDecision</a></div><div class="ttdeci">std::optional&lt; InlineResult &gt; getAttributeBasedInliningDecision(CallBase &amp;Call, Function *Callee, TargetTransformInfo &amp;CalleeTTI, function_ref&lt; const TargetLibraryInfo &amp;(Function &amp;)&gt; GetTLI)</div><div class="ttdoc">Returns InlineResult::success() if the call site should be always inlined because of user directives,...</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l02886">InlineCost.cpp:2886</a></div></div>
<div class="ttc" id="aclassllvm_1_1ResumeInst_html"><div class="ttname"><a href="classllvm_1_1ResumeInst.html">llvm::ResumeInst</a></div><div class="ttdoc">Resume the propagation of an exception.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04256">Instructions.h:4256</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a82dbbd8e3688b0bc1eedb338864d0d0c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">llvm::ConstantInt::getTrue</a></div><div class="ttdeci">static ConstantInt * getTrue(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00835">Constants.cpp:835</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html_a9b53bc4ade993c638837c1344465c1f8"><div class="ttname"><a href="classllvm_1_1StructLayout.html#a9b53bc4ade993c638837c1344465c1f8">llvm::StructLayout::getElementOffset</a></div><div class="ttdeci">uint64_t getElementOffset(unsigned Idx) const</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00648">DataLayout.h:648</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssemblyAnnotationWriter_html"><div class="ttname"><a href="classllvm_1_1AssemblyAnnotationWriter.html">llvm::AssemblyAnnotationWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="AssemblyAnnotationWriter_8h_source.html#l00027">AssemblyAnnotationWriter.h:27</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a169b2b8289fb0aefc607ae29c8b95cc6"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a169b2b8289fb0aefc607ae29c8b95cc6">llvm::InlineConstants::ColdccPenalty</a></div><div class="ttdeci">const int ColdccPenalty</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00051">InlineCost.h:51</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a9b5fc98b47d44d1150d3610bdfab1430"><div class="ttname"><a href="classllvm_1_1APInt.html#a9b5fc98b47d44d1150d3610bdfab1430">llvm::APInt::sextOrTrunc</a></div><div class="ttdeci">APInt sextOrTrunc(unsigned width) const</div><div class="ttdoc">Sign extend or truncate to width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l01002">APInt.cpp:1002</a></div></div>
<div class="ttc" id="aclassllvm_1_1ExtractValueInst_html"><div class="ttname"><a href="classllvm_1_1ExtractValueInst.html">llvm::ExtractValueInst</a></div><div class="ttdoc">This instruction extracts a struct member or array element value from an aggregate value.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02455">Instructions.h:2455</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html"><div class="ttname"><a href="classllvm_1_1TypeSize.html">llvm::TypeSize</a></div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00314">TypeSize.h:314</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a3d95cc2d359b8d9ed5bd9504b44930b5"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a3d95cc2d359b8d9ed5bd9504b44930b5">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::size</a></div><div class="ttdeci">unsigned size() const</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00099">DenseMap.h:99</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdoc">Provides information about what library functions are available for the current target.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00234">TargetLibraryInfo.h:234</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f5363235d78b46831e31ddbb498c982"><div class="ttname"><a href="namespacellvm.html#a2f5363235d78b46831e31ddbb498c982">llvm::getCallsiteCost</a></div><div class="ttdeci">int getCallsiteCost(const CallBase &amp;Call, const DataLayout &amp;DL)</div><div class="ttdoc">Return the cost associated with a callsite, including parameter passing and the call/return instructi...</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l02804">InlineCost.cpp:2804</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineResult_html_a77027fdc657b15aa5dd3d022e0fc07d3"><div class="ttname"><a href="classllvm_1_1InlineResult.html#a77027fdc657b15aa5dd3d022e0fc07d3">llvm::InlineResult::failure</a></div><div class="ttdeci">static InlineResult failure(const char *Reason)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00185">InlineCost.h:185</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a857f17b7aaa9452a4a5f231e836feefd"><div class="ttname"><a href="InlineCost_8cpp.html#a857f17b7aaa9452a4a5f231e836feefd">InlineSizeAllowance</a></div><div class="ttdeci">static cl::opt&lt; int &gt; InlineSizeAllowance(&quot;inline-size-allowance&quot;, cl::Hidden, cl::init(100), cl::desc(&quot;The maximum size of a callee that get's &quot; &quot;inlined without sufficient cycle savings&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_aab827381fb7034818435387572088683"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#aab827381fb7034818435387572088683">llvm::TargetTransformInfo::getInliningThresholdMultiplier</a></div><div class="ttdeci">unsigned getInliningThresholdMultiplier() const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00203">TargetTransformInfo.cpp:203</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a4993676ac873d62a62542af065f1865b"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a4993676ac873d62a62542af065f1865b">llvm::InlineConstants::OptMinSizeThreshold</a></div><div class="ttdeci">const int OptMinSizeThreshold</div><div class="ttdoc">Use when minsize (-Oz) is specified.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00041">InlineCost.h:41</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_aee1b90efc80e9ed2d7a7189e4570434b"><div class="ttname"><a href="InlineCost_8cpp.html#aee1b90efc80e9ed2d7a7189e4570434b">InlineSavingsMultiplier</a></div><div class="ttdeci">static cl::opt&lt; int &gt; InlineSavingsMultiplier(&quot;inline-savings-multiplier&quot;, cl::Hidden, cl::init(8), cl::desc(&quot;Multiplier to multiply cycle savings by during inlining&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1CleanupReturnInst_html"><div class="ttname"><a href="classllvm_1_1CleanupReturnInst.html">llvm::CleanupReturnInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04665">Instructions.h:4665</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html_ab8b72c18add22acd827f7a6cd1ff1bff"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html#ab8b72c18add22acd827f7a6cd1ff1bff">llvm::BlockFrequencyInfo::getBlockFreq</a></div><div class="ttdeci">BlockFrequency getBlockFreq(const BasicBlock *BB) const</div><div class="ttdoc">getblockFreq - Return block frequency.</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8cpp_source.html#l00203">BlockFrequencyInfo.cpp:203</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntToPtrInst_html"><div class="ttname"><a href="classllvm_1_1IntToPtrInst.html">llvm::IntToPtrInst</a></div><div class="ttdoc">This class represents a cast from an integer to a pointer.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05164">Instructions.h:5164</a></div></div>
<div class="ttc" id="aclassllvm_1_1IndirectBrInst_html"><div class="ttname"><a href="classllvm_1_1IndirectBrInst.html">llvm::IndirectBrInst</a></div><div class="ttdoc">Indirect Branch Instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03679">Instructions.h:3679</a></div></div>
<div class="ttc" id="aGlobalAlias_8h_html"><div class="ttname"><a href="GlobalAlias_8h.html">GlobalAlias.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a7e5dd9267d6c9b90b4daa6410be3da6a"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a7e5dd9267d6c9b90b4daa6410be3da6a">llvm::TargetTransformInfo::adjustInliningThreshold</a></div><div class="ttdeci">unsigned adjustInliningThreshold(const CallBase *CB) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00208">TargetTransformInfo.cpp:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a63865cbea27abfbcf52660f46ef822b5"><div class="ttname"><a href="InlineCost_8cpp.html#a63865cbea27abfbcf52660f46ef822b5">computeThresholdFromOptLevels</a></div><div class="ttdeci">static int computeThresholdFromOptLevels(unsigned OptLevel, unsigned SizeOptLevel)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l03123">InlineCost.cpp:3123</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a64b0a3c3724fe2cb1b335007c068179d"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a64b0a3c3724fe2cb1b335007c068179d">llvm::TargetTransformInfo::getEstimatedNumberOfCaseClusters</a></div><div class="ttdeci">unsigned getEstimatedNumberOfCaseClusters(const SwitchInst &amp;SI, unsigned &amp;JTSize, ProfileSummaryInfo *PSI, BlockFrequencyInfo *BFI) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00223">TargetTransformInfo.cpp:223</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html_aa1e6376794d0c3da5a2820a2943634eb"><div class="ttname"><a href="classllvm_1_1InlineCost.html#aa1e6376794d0c3da5a2820a2943634eb">llvm::InlineCost::getNever</a></div><div class="ttdeci">static InlineCost getNever(const char *Reason, std::optional&lt; CostBenefitPair &gt; CostBenefit=std::nullopt)</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00130">InlineCost.h:130</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AttributeFuncs_html_a32fe04d73013c7bede32a1e2279cf9e5"><div class="ttname"><a href="namespacellvm_1_1AttributeFuncs.html#a32fe04d73013c7bede32a1e2279cf9e5">llvm::AttributeFuncs::areInlineCompatible</a></div><div class="ttdeci">bool areInlineCompatible(const Function &amp;Caller, const Function &amp;Callee)</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l02118">Attributes.cpp:2118</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_ac32c5e568abcce09107853ccf11fbab6"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#ac32c5e568abcce09107853ccf11fbab6">llvm::InlineConstants::LastCallToStaticBonus</a></div><div class="ttdeci">const int LastCallToStaticBonus</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00050">InlineCost.h:50</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aInstructionSimplify_8h_html"><div class="ttname"><a href="InstructionSimplify_8h.html">InstructionSimplify.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockAddress_html_af6e2f535824d8f9b4bf1b1a75e5ab57c"><div class="ttname"><a href="classllvm_1_1BlockAddress.html#af6e2f535824d8f9b4bf1b1a75e5ab57c">llvm::BlockAddress::get</a></div><div class="ttdeci">static BlockAddress * get(Function *F, BasicBlock *BB)</div><div class="ttdoc">Return a BlockAddress for the specified function and basic block.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01778">Constants.cpp:1778</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00047">PatternMatch.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_af972d87e15b5f6ed61bd5c3956c5213d"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">llvm::detail::DenseSetImpl&lt; ValueT, DenseMap&lt; ValueT, detail::DenseSetEmpty, DenseMapInfo&lt; ValueT &gt;, detail::DenseSetPair&lt; ValueT &gt; &gt;, DenseMapInfo&lt; ValueT &gt; &gt;::erase</a></div><div class="ttdeci">bool erase(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00101">DenseSet.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl&lt; const Value * &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html_a45e6b2c5c4e59ddc05ad9a2685706e75"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html#a45e6b2c5c4e59ddc05ad9a2685706e75">llvm::BlockFrequencyInfo::getBlockProfileCount</a></div><div class="ttdeci">std::optional&lt; uint64_t &gt; getBlockProfileCount(const BasicBlock *BB, bool AllowSynthetic=false) const</div><div class="ttdoc">Returns the estimated profile count of BB.</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8cpp_source.html#l00208">BlockFrequencyInfo.cpp:208</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a78324e64ee175c0703c3db3ce45943cc"><div class="ttname"><a href="InlineCost_8cpp.html#a78324e64ee175c0703c3db3ce45943cc">HotCallSiteThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; HotCallSiteThreshold(&quot;hot-callsite-threshold&quot;, cl::Hidden, cl::init(3000), cl::desc(&quot;Threshold for hot callsites &quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1UnreachableInst_html"><div class="ttname"><a href="classllvm_1_1UnreachableInst.html">llvm::UnreachableInst</a></div><div class="ttdoc">This function has undefined behavior.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04773">Instructions.h:4773</a></div></div>
<div class="ttc" id="aclassllvm_1_1SwitchInst_html"><div class="ttname"><a href="classllvm_1_1SwitchInst.html">llvm::SwitchInst</a></div><div class="ttdoc">Multiway switch.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03283">Instructions.h:3283</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_1_1ProfileCount_html"><div class="ttname"><a href="classllvm_1_1Function_1_1ProfileCount.html">llvm::Function::ProfileCount</a></div><div class="ttdoc">Class to represent profile counts.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00252">Function.h:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdoc">an instruction to allocate memory on the stack</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a805c3f92f604b55c774d24607e6728a1"><div class="ttname"><a href="InlineCost_8cpp.html#a805c3f92f604b55c774d24607e6728a1">CallPenalty</a></div><div class="ttdeci">static cl::opt&lt; int &gt; CallPenalty(&quot;inline-call-penalty&quot;, cl::Hidden, cl::init(25), cl::desc(&quot;Call penalty that is applied per callsite when inlining&quot;))</div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RegState_html_aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013"><div class="ttname"><a href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da2fee1a7db4e84247a193a9af1f907013">llvm::RegState::Dead</a></div><div class="ttdeci">@ Dead</div><div class="ttdoc">Unused definition.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00050">MachineInstrBuilder.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9703f1294f70a821b4ddfb90b5322ea1"><div class="ttname"><a href="namespacellvm.html#a9703f1294f70a821b4ddfb90b5322ea1">llvm::InlineCostFeatures</a></div><div class="ttdeci">std::array&lt; int, static_cast&lt; size_t &gt;(InlineCostFeatureIndex::NumberOfFeatures)&gt; InlineCostFeatures</div><div class="ttdef"><b>Definition:</b> <a href="InlineModelFeatureMaps_8h_source.html#l00062">InlineModelFeatureMaps.h:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="InlineCost_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l00052">InlineCost.cpp:52</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_ac331ecdb7100a8944856d0e27d4dfdd5"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#ac331ecdb7100a8944856d0e27d4dfdd5">llvm::InlineConstants::TotalAllocaSizeRecursiveCaller</a></div><div class="ttdeci">const unsigned TotalAllocaSizeRecursiveCaller</div><div class="ttdoc">Do not inline functions which allocate this many bytes on the stack when the caller is recursive.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00054">InlineCost.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector</a></div><div class="ttdoc">A vector that has set insertion semantics.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00040">SetVector.h:40</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">llvm::CallingConv::Cold</a></div><div class="ttdeci">@ Cold</div><div class="ttdoc">Attempts to make code in the caller as efficient as possible under the assumption that the call is no...</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00047">CallingConv.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a499ea32ca1b8d16cedfe01d1e5b08f29"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">llvm::SmallVectorImpl::reserve</a></div><div class="ttdeci">void reserve(size_type N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00667">SmallVector.h:667</a></div></div>
<div class="ttc" id="aclassllvm_1_1InsertValueInst_html"><div class="ttname"><a href="classllvm_1_1InsertValueInst.html">llvm::InsertValueInst</a></div><div class="ttdoc">This instruction inserts a struct field of array element value into an aggregate value.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02566">Instructions.h:2566</a></div></div>
<div class="ttc" id="anamespacellvm_1_1InlineConstants_html_a52751d994299ef16256d21b118eaaf82"><div class="ttname"><a href="namespacellvm_1_1InlineConstants.html#a52751d994299ef16256d21b118eaaf82">llvm::InlineConstants::LoopPenalty</a></div><div class="ttdeci">const int LoopPenalty</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00049">InlineCost.h:49</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a58b95af1ca96e109f85a0646a05fceb7">llvm::tgtok::TrueVal</a></div><div class="ttdeci">@ TrueVal</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00062">TGLexer.h:62</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a44fcadf99c45d9e7231ceed9730487e7"><div class="ttname"><a href="InlineCost_8cpp.html#a44fcadf99c45d9e7231ceed9730487e7">PrintInstructionComments</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; PrintInstructionComments(&quot;print-instruction-comments&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Prints comments for instruction based on inline cost analysis&quot;))</div></div>
<div class="ttc" id="aInlineCost_8cpp_html_ad997850fcf588e85cfb6fe9642aa8ffa"><div class="ttname"><a href="InlineCost_8cpp.html#ad997850fcf588e85cfb6fe9642aa8ffa">HotCallSiteRelFreq</a></div><div class="ttdeci">static cl::opt&lt; int &gt; HotCallSiteRelFreq(&quot;hot-callsite-rel-freq&quot;, cl::Hidden, cl::init(60), cl::desc(&quot;Minimum block frequency, expressed as a multiple of caller's &quot; &quot;entry frequency, for a callsite to be hot in the absence of &quot; &quot;profile information.&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_ac453ad79a3d50950bac79bc9dff85918"><div class="ttname"><a href="classllvm_1_1FunctionType.html#ac453ad79a3d50950bac79bc9dff85918">llvm::FunctionType::getReturnType</a></div><div class="ttdeci">Type * getReturnType() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00124">DerivedTypes.h:124</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ad3b0e7df7704fa34e356e1178374b49e"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ad3b0e7df7704fa34e356e1178374b49e">llvm::TargetTransformInfo::getFPOpCost</a></div><div class="ttdeci">InstructionCost getFPOpCost(Type *Ty) const</div><div class="ttdoc">Return the expected cost of supporting the floating point operation of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00602">TargetTransformInfo.cpp:602</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineResult_html"><div class="ttname"><a href="classllvm_1_1InlineResult.html">llvm::InlineResult</a></div><div class="ttdoc">InlineResult is basically true or false.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00179">InlineCost.h:179</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac25d98957a825ee699d9b11ee836cc19"><div class="ttname"><a href="namespacellvm.html#ac25d98957a825ee699d9b11ee836cc19">llvm::getInliningCostEstimate</a></div><div class="ttdeci">std::optional&lt; int &gt; getInliningCostEstimate(CallBase &amp;Call, TargetTransformInfo &amp;CalleeTTI, function_ref&lt; AssumptionCache &amp;(Function &amp;)&gt; GetAssumptionCache, function_ref&lt; BlockFrequencyInfo &amp;(Function &amp;)&gt; GetBFI=nullptr, ProfileSummaryInfo *PSI=nullptr, OptimizationRemarkEmitter *ORE=nullptr)</div><div class="ttdoc">Get the cost estimate ignoring thresholds.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8cpp_source.html#l02848">InlineCost.cpp:2848</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aInlineCost_8cpp_html_a201484c094c4d9ad96166714816b99c4"><div class="ttname"><a href="InlineCost_8cpp.html#a201484c094c4d9ad96166714816b99c4">ColdCallSiteRelFreq</a></div><div class="ttdeci">static cl::opt&lt; int &gt; ColdCallSiteRelFreq(&quot;cold-callsite-rel-freq&quot;, cl::Hidden, cl::init(2), cl::desc(&quot;Maximum block frequency, expressed as a percentage of caller's &quot; &quot;entry frequency, for a callsite to be cold in the absence of &quot; &quot;profile information.&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a7e4be8b16fbd68c9045a388904044e01"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03218">Instructions.h:3218</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aSetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_ac905a11da0015923ced48e7d1565f46c"><div class="ttname"><a href="structllvm_1_1InlineParams.html#ac905a11da0015923ced48e7d1565f46c">llvm::InlineParams::LocallyHotCallSiteThreshold</a></div><div class="ttdeci">std::optional&lt; int &gt; LocallyHotCallSiteThreshold</div><div class="ttdoc">Threshold to use when the callsite is considered hot relative to function entry.</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00226">InlineCost.h:226</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 09:48:36 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
