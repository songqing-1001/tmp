<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Scalar/LoopIdiomRecognize.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_e6e1f1f37d351595fa984b942927b205.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LoopIdiomRecognize.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="LoopIdiomRecognize_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- LoopIdiomRecognize.cpp - Loop idiom recognition --------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This pass implements an idiom recognizer that transforms simple loops into a</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// non-loop form.  In cases that this kicks in, it can be a significant</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// performance win.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// If compiling for code size we avoid idiom recognition if the resulting</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// code could be larger than the code for the original loop. One way this could</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// happen is if the loop is not removable after idiom recognition due to the</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// presence of non-idiom instructions. The initial implementation of the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// heuristics applies to idioms in multi-block loops.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// TODO List:</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// Future loop memory idioms to recognize:</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//   memcmp, strlen, etc.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// Future floating point idioms to recognize in -ffast-math mode:</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//   fpowi</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// Future integer operation idioms to recognize:</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//   ctpop</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Beware that isel&#39;s default lowering for ctpop is highly inefficient for</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// i64 and larger types when i64 is legal and the value has few bits set.  It</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// would be good to enhance isel to emit a loop for ctpop in this case.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// This could recognize common matrix multiplies and dot product idioms and</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// replace them with calls to BLAS (if linked in??).</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopIdiomRecognize_8h.html">llvm/Transforms/Scalar/LoopIdiomRecognize.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="APInt_8h.html">llvm/ADT/APInt.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ArrayRef_8h.html">llvm/ADT/ArrayRef.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MapVector_8h.html">llvm/ADT/MapVector.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CmpInstAnalysis_8h.html">llvm/Analysis/CmpInstAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopAccessAnalysis_8h.html">llvm/Analysis/LoopAccessAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopPass_8h.html">llvm/Analysis/LoopPass.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemoryLocation_8h.html">llvm/Analysis/MemoryLocation.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemorySSA_8h.html">llvm/Analysis/MemorySSA.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemorySSAUpdater_8h.html">llvm/Analysis/MemorySSAUpdater.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MustExecute_8h.html">llvm/Analysis/MustExecute.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpressions_8h.html">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constant_8h.html">llvm/IR/Constant.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DebugLoc_8h.html">llvm/IR/DebugLoc.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalValue_8h.html">llvm/IR/GlobalValue.h</a>&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalVariable_8h.html">llvm/IR/GlobalVariable.h</a>&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Intrinsics_8h.html">llvm/IR/Intrinsics.h</a>&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="User_8h.html">llvm/IR/User.h</a>&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueHandle_8h.html">llvm/IR/ValueHandle.h</a>&quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionCost_8h.html">llvm/Support/InstructionCost.h</a>&quot;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BuildLibCalls_8h.html">llvm/Transforms/Utils/BuildLibCalls.h</a>&quot;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopUtils_8h.html">llvm/Transforms/Utils/LoopUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpander_8h.html">llvm/Transforms/Utils/ScalarEvolutionExpander.h</a>&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">  107</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;loop-idiom&quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumMemSet, <span class="stringliteral">&quot;Number of memset&#39;s formed from loop stores&quot;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumMemCpy, <span class="stringliteral">&quot;Number of memcpy&#39;s formed from loop load+stores&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumMemMove, <span class="stringliteral">&quot;Number of memmove&#39;s formed from loop load+stores&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    NumShiftUntilBitTest,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="stringliteral">&quot;Number of uncountable loops recognized as &#39;shift until bitttest&#39; idiom&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumShiftUntilZero,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <span class="stringliteral">&quot;Number of uncountable loops recognized as &#39;shift until zero&#39; idiom&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="structllvm_1_1DisableLIRP.html#aac47a395ddc8679b300a4b6c112df309">DisableLIRP::All</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool, true&gt;</a></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="LoopIdiomRecognize_8cpp.html#aa9480241a076359777eed7eeee8a9c29">DisableLIRPAll</a>(<span class="stringliteral">&quot;disable-&quot;</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot;-all&quot;</span>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                   <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Options to disable Loop Idiom Recognize Pass.&quot;</span>),</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                   <a class="code" href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">cl::location</a>(<a class="code" href="structllvm_1_1DisableLIRP.html#aac47a395ddc8679b300a4b6c112df309">DisableLIRP::All</a>), <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                   <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="structllvm_1_1DisableLIRP.html#a6d928236e02987de2267a46cd4211336">DisableLIRP::Memset</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool, true&gt;</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="LoopIdiomRecognize_8cpp.html#a3f1744064251470bbd48733d160d24bb">DisableLIRPMemset</a>(<span class="stringliteral">&quot;disable-&quot;</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot;-memset&quot;</span>,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                      <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Proceed with loop idiom recognize pass, but do &quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                               <span class="stringliteral">&quot;not convert loop(s) to memset.&quot;</span>),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                      <a class="code" href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">cl::location</a>(<a class="code" href="structllvm_1_1DisableLIRP.html#a6d928236e02987de2267a46cd4211336">DisableLIRP::Memset</a>), <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                      <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="structllvm_1_1DisableLIRP.html#ab19e3cae2e9e472353062a181092d68f">DisableLIRP::Memcpy</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool, true&gt;</a></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="LoopIdiomRecognize_8cpp.html#a8abe8ecbd58c795ba02e1b592903e766">DisableLIRPMemcpy</a>(<span class="stringliteral">&quot;disable-&quot;</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot;-memcpy&quot;</span>,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                      <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Proceed with loop idiom recognize pass, but do &quot;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                               <span class="stringliteral">&quot;not convert loop(s) to memcpy.&quot;</span>),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                      <a class="code" href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">cl::location</a>(<a class="code" href="structllvm_1_1DisableLIRP.html#ab19e3cae2e9e472353062a181092d68f">DisableLIRP::Memcpy</a>), <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                      <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="LoopIdiomRecognize_8cpp.html#a4cdd27e2100a2d388708721b81c77ffb">UseLIRCodeSizeHeurs</a>(</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="stringliteral">&quot;use-lir-code-size-heurs&quot;</span>,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Use loop idiom recognition code size heuristics when compiling&quot;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;             <span class="stringliteral">&quot;with -Os/-Oz&quot;</span>),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">class </span>LoopIdiomRecognize {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> *AA;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">TTI</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">bool</span> ApplyCodeSizeHeuristics;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  std::unique_ptr&lt;MemorySSAUpdater&gt; MSSAU;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">explicit</span> LoopIdiomRecognize(<a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> *AA, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                              <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                              <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, <a class="code" href="classllvm_1_1MemorySSA.html">MemorySSA</a> *MSSA,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                              <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      : AA(AA), DT(DT), LI(LI), SE(SE), TLI(TLI), <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), ORE(ORE) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (MSSA)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      MSSAU = std::make_unique&lt;MemorySSAUpdater&gt;(MSSA);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">bool</span> runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keyword">using</span> StoreList = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StoreInst *, 8&gt;</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keyword">using</span> StoreListMap = <a class="code" href="classllvm_1_1MapVector.html">MapVector&lt;Value *, StoreList&gt;</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  StoreListMap StoreRefsForMemset;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  StoreListMap StoreRefsForMemsetPattern;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  StoreList StoreRefsForMemcpy;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">bool</span> HasMemset;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">bool</span> HasMemsetPattern;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">bool</span> HasMemcpy;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">  /// Return code for isLegalStore()</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span>  <span class="keyword">enum</span> LegalStoreKind {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">None</a> = 0,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    Memset,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    MemsetPattern,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    Memcpy,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    UnorderedAtomicMemcpy,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    DontUse <span class="comment">// Dummy retval never to be used. Allows catching errors in retval</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">// handling.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  };</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">  /// \name Countable Loop Idiom Handling</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  /// @{</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">bool</span> runOnCountableLoop();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">bool</span> runOnLoopBlock(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                      <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;BasicBlock *&gt;</a> &amp;ExitBlocks);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">void</span> collectStores(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  LegalStoreKind isLegalStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keyword">enum class</span> ForMemset { <a class="code" href="namespacellvm.html#adacba4cb06d1dd9232ee3d2d49a44d8fabafd7322c6e97d25b6299b5d6fe8920b">No</a>, <a class="code" href="namespacellvm.html#ac505d74d262ee1e64d87b07121199e36a93cba07454f06a4a960172bbd6e2a435">Yes</a> };</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">bool</span> processLoopStores(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;StoreInst *&gt;</a> &amp;SL, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                         ForMemset For);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MemInst&gt;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">bool</span> processLoopMemIntrinsic(</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordtype">bool</span> (LoopIdiomRecognize::*Processor)(MemInst *, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *),</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">bool</span> processLoopMemCpy(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MCI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">bool</span> processLoopMemSet(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">bool</span> processLoopStridedStore(<a class="code" href="classllvm_1_1Value.html">Value</a> *DestPtr, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                               <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> StoreAlignment, <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredVal,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                               <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TheStore,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                               <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;Instruction *&gt;</a> &amp;Stores,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *Ev, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                               <span class="keywordtype">bool</span> IsNegStride, <span class="keywordtype">bool</span> IsLoopMemset = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">bool</span> processLoopStoreOfLoopLoad(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">bool</span> processLoopStoreOfLoopLoad(<a class="code" href="classllvm_1_1Value.html">Value</a> *DestPtr, <a class="code" href="classllvm_1_1Value.html">Value</a> *SourcePtr,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSize, <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> StoreAlign,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                  <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> LoadAlign, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TheStore,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TheLoad,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LoadEv,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">bool</span> avoidLIRForMultiBlockLoop(<span class="keywordtype">bool</span> IsMemset = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                 <span class="keywordtype">bool</span> IsLoopMemset = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  /// @}</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">  /// \name Noncountable Loop Idiom Handling</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  /// @{</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">bool</span> runOnNoncountableLoop();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">bool</span> recognizePopcount();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">void</span> transformLoopToPopcount(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreCondBB, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CntInst,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                               <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CntPhi, <a class="code" href="classllvm_1_1Value.html">Value</a> *Var);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">bool</span> recognizeAndInsertFFS();  <span class="comment">/// Find First Set: ctlz or cttz</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> transformLoopToCountable(<a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IntrinID, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreCondBB,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CntInst, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CntPhi,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                <a class="code" href="classllvm_1_1Value.html">Value</a> *Var, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DefX,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="keywordtype">bool</span> ZeroCheck,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                <span class="keywordtype">bool</span> IsCntPhiUsedOutsideLoop);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordtype">bool</span> recognizeShiftUntilBitTest();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">bool</span> recognizeShiftUntilZero();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  /// @}</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span>};</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keyword">class </span>LoopIdiomRecognizeLegacyPass : <span class="keyword">public</span> <a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a> {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keyword">explicit</span> LoopIdiomRecognizeLegacyPass() : <a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="namespacellvm.html#a82a4f09de58515e3236c6d8047d4b2ef">initializeLoopIdiomRecognizeLegacyPassPass</a>(</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        *<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">bool</span> runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1LPPassManager.html">LPPassManager</a> &amp;LPM)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1DisableLIRP.html#aac47a395ddc8679b300a4b6c112df309">DisableLIRP::All</a>)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (skipLoop(L))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> *AA = &amp;getAnalysis&lt;AAResultsWrapperPass&gt;().getAAResults();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT = &amp;getAnalysis&lt;DominatorTreeWrapperPass&gt;().getDomTree();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI = &amp;getAnalysis&lt;LoopInfoWrapperPass&gt;().getLoopInfo();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE = &amp;getAnalysis&lt;ScalarEvolutionWrapperPass&gt;().getSE();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI =</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        &amp;getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;().getTLI(</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            *L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>());</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> *<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> =</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        &amp;getAnalysis&lt;TargetTransformInfoWrapperPass&gt;().getTTI(</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            *L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = &amp;L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#afc70e919c88c86159cc94cea29b6c210">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">auto</span> *MSSAAnalysis = getAnalysisIfAvailable&lt;MemorySSAWrapperPass&gt;();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classllvm_1_1MemorySSA.html">MemorySSA</a> *MSSA = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (MSSAAnalysis)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      MSSA = &amp;MSSAAnalysis-&gt;getMSSA();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// For the old PM, we can&#39;t use OptimizationRemarkEmitter as an analysis</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// pass.  Function analyses need to be preserved across loop transformations</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// but ORE cannot be preserved (see comment before the pass definition).</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> ORE(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>());</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    LoopIdiomRecognize LIR(AA, DT, LI, SE, TLI, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, MSSA, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ORE);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">return</span> LIR.runOnLoop(L);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  /// This transformation requires natural loop information &amp; requires that</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">  /// loop preheaders be inserted into the CFG.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1MemorySSAWrapperPass.html">MemorySSAWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="namespacellvm.html#a92caae34bfacc63bda0f23d5d005a89e">getLoopAnalysisUsage</a>(AU);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;};</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">LoopIdiomRecognizeLegacyPass::ID</a> = 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classllvm_1_1LoopIdiomRecognizePass.html#a4a3aed1996ede85e98aa361e6f5d74a2">  313</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1LoopIdiomRecognizePass.html#a4a3aed1996ede85e98aa361e6f5d74a2">LoopIdiomRecognizePass::run</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;L, <a class="code" href="classllvm_1_1AnalysisManager.html">LoopAnalysisManager</a> &amp;AM,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                              <a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html">LoopStandardAnalysisResults</a> &amp;AR,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                              <a class="code" href="classllvm_1_1LPMUpdater.html">LPMUpdater</a> &amp;) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1DisableLIRP.html#aac47a395ddc8679b300a4b6c112df309">DisableLIRP::All</a>)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = &amp;L.<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#afc70e919c88c86159cc94cea29b6c210">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// For the new PM, we also can&#39;t use OptimizationRemarkEmitter as an analysis</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// pass.  Function analyses need to be preserved across loop transformations</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// but ORE cannot be preserved (see comment before the pass definition).</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> ORE(L.<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>());</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  LoopIdiomRecognize LIR(&amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#abd7da877be8576011299f4fcaaf299be">AA</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#aaa96df870a1b3d7ffc56bec3eb0b0cff">DT</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#aa09379aa4435be95eb717dd9b5d8b4c5">LI</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a124376878e24aef4252795ba9fea420f">SE</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a9e363c1eaf112166372e2d52704981fb">TLI</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a3444a9359f5f17f1694f82c41d5fd574">TTI</a>,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                         AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a1cfb392c267da10531478c2f42baa603">MSSA</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ORE);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">if</span> (!LIR.runOnLoop(&amp;L))</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keyword">auto</span> PA = <a class="code" href="namespacellvm.html#ac7294ba4e105807674fe3a394437fcc1">getLoopPassPreservedAnalyses</a>();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">if</span> (AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a1cfb392c267da10531478c2f42baa603">MSSA</a>)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    PA.preserve&lt;<a class="code" href="classllvm_1_1MemorySSAAnalysis.html">MemorySSAAnalysis</a>&gt;();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">return</span> PA;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<a class="code" href="LoopIdiomRecognize_8cpp.html#a61efc8509b54500974e6e976516cf7c9">INITIALIZE_PASS_BEGIN</a>(LoopIdiomRecognizeLegacyPass, <span class="stringliteral">&quot;loop-idiom&quot;</span>,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                      <span class="stringliteral">&quot;Recognize loop idioms&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1LoopPass.html">LoopPass</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a>)</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a50d03d8db5d7e05c9ddb41c6bdc7dec0">  342</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(LoopIdiomRecognizeLegacyPass, &quot;<a class="code" href="lib_2Analysis_2README_8txt.html#a01d2af4eee7c40485a0ce3683a2e907a">loop</a>-<a class="code" href="LoopIdiomRecognize_8cpp.html#a50d03d8db5d7e05c9ddb41c6bdc7dec0">idiom</a>&quot;,</div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a459b2591fc1a4a281fb3bb73cde092b9">  343</a></span>&#160;                    &quot;Recognize <a class="code" href="lib_2Analysis_2README_8txt.html#a01d2af4eee7c40485a0ce3683a2e907a">loop</a> <a class="code" href="LoopIdiomRecognize_8cpp.html#a459b2591fc1a4a281fb3bb73cde092b9">idioms</a>&quot;, <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="namespacellvm.html#a1e2870b3ccae0da50756ca172063719b">  345</a></span>&#160;<a class="code" href="classllvm_1_1Pass.html">Pass</a> *<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#a1e2870b3ccae0da50756ca172063719b">createLoopIdiomPass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> LoopIdiomRecognizeLegacyPass(); }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#aebc62faf59fecc07e8471fcf035d789e">  347</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#aebc62faf59fecc07e8471fcf035d789e">deleteDeadInstruction</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;replaceAllUsesWith(<a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType()));</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">//          Implementation of LoopIdiomRecognize</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordtype">bool</span> LoopIdiomRecognize::runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  CurLoop = L;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// If the loop could not be converted to canonical form, it must have an</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// indirectbr in it, just give up.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>())</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// Disable loop idiom recognition if the function&#39;s name is a common idiom.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (Name == <span class="stringliteral">&quot;memset&quot;</span> || Name == <span class="stringliteral">&quot;memcpy&quot;</span>)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// Determine if code size heuristics need to be applied.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  ApplyCodeSizeHeuristics =</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a1c455e007178a24dfb18ac0e200ea02c">hasOptSize</a>() &amp;&amp; <a class="code" href="LoopIdiomRecognize_8cpp.html#a4cdd27e2100a2d388708721b81c77ffb">UseLIRCodeSizeHeurs</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  HasMemset = TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">has</a>(LibFunc_memset);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  HasMemsetPattern = TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">has</a>(LibFunc_memset_pattern16);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  HasMemcpy = TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">has</a>(LibFunc_memcpy);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span> (HasMemset || HasMemsetPattern || HasMemcpy)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a91ac801aa45c78e0d0edbc36115ef054">hasLoopInvariantBackedgeTakenCount</a>(L))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">return</span> runOnCountableLoop();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> runOnNoncountableLoop();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordtype">bool</span> LoopIdiomRecognize::runOnCountableLoop() {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">getBackedgeTakenCount</a>(CurLoop);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!isa&lt;SCEVCouldNotCompute&gt;(BECount) &amp;&amp;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;         <span class="stringliteral">&quot;runOnCountableLoop() called on a loop without a predictable&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;         <span class="stringliteral">&quot;backedge-taken count&quot;</span>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// If this loop executes exactly one time, then it should be peeled, not</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// optimized by this pass.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *BECst = dyn_cast&lt;SCEVConstant&gt;(BECount))</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span> (BECst-&gt;getAPInt() == 0)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> ExitBlocks;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ae069a12f0a2d2deb69e30b439a91190e">getUniqueExitBlocks</a>(ExitBlocks);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Scanning: F[&quot;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    &lt;&lt; CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;] Countable Loop %&quot;</span> &lt;&lt; CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// The following transforms hoist stores/memsets into the loop pre-header.</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// Give up if the loop has instructions that may throw.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="classllvm_1_1SimpleLoopSafetyInfo.html">SimpleLoopSafetyInfo</a> SafetyInfo;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  SafetyInfo.<a class="code" href="classllvm_1_1SimpleLoopSafetyInfo.html#a262c2df9639d3f71b8d2a8158b819809">computeLoopSafetyInfo</a>(CurLoop);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">if</span> (SafetyInfo.<a class="code" href="classllvm_1_1SimpleLoopSafetyInfo.html#aa1b6a065ad4fde175bf904917241cba9">anyBlockMayThrow</a>())</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// Scan all the blocks in the loop that are not in subloops.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a5cc113cb783ab6e5ca7b69241431c19c">getBlocks</a>()) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// Ignore blocks in subloops.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) != CurLoop)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    MadeChange |= runOnLoopBlock(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, BECount, ExitBlocks);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">  425</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *ConstStride = cast&lt;SCEVConstant&gt;(StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1));</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">return</span> ConstStride-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">getAPInt</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">/// getMemSetPatternValue - If a strided store of the specified value is safe to</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">/// turn into a memset_pattern16, return a ConstantArray of 16 bytes that should</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">/// be passed in.  Otherwise, return null.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">/// Note that we don&#39;t ever attempt to use memset_pattern8 or 4, because these</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">/// just replicate their input array and then pass on to memset_pattern16.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">  436</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">getMemSetPatternValue</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// FIXME: This could check for UndefValue because it can be merged into any</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// other valid pattern.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// If the value isn&#39;t a constant, we can&#39;t promote it to being in a constant</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// array.  We could theoretically do a store to an alloca or something, but</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// that doesn&#39;t seem worthwhile.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> || isa&lt;ConstantExpr&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">// Only handle simple values that are a power of two bytes in size.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeSizeInBits(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (Size == 0 || (Size &amp; 7) || (Size &amp; (Size - 1)))</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// Don&#39;t care enough about darwin/ppc to implement this.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;isBigEndian())</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// Convert to size in bytes.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  Size /= 8;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="comment">// TODO: If CI is larger than 16-bytes, we can try slicing it in half to see</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// if the top and bottom are the same (e.g. for vectors and large integers).</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span> (Size &gt; 16)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// If the constant is exactly 16 bytes, just use it.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span> (Size == 16)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// Otherwise, we&#39;ll use an array of the constants.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordtype">unsigned</span> ArraySize = 16 / Size;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <a class="code" href="classllvm_1_1ArrayType.html">ArrayType</a> *AT = <a class="code" href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">ArrayType::get</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), ArraySize);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(AT, std::vector&lt;Constant *&gt;(ArraySize, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;LoopIdiomRecognize::LegalStoreKind</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;LoopIdiomRecognize::isLegalStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Don&#39;t touch volatile stores.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isVolatile())</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">// We only want simple or unordered-atomic stores.</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isUnordered())</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// Avoid merging nontemporal stores.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getMetadata(LLVMContext::MD_nontemporal))</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredVal = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StorePtr = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// Don&#39;t convert stores of non-integral pointer types to memsets (which stores</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// integers).</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;isNonIntegralPointerType(StoredVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>()))</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Reject stores that are so large that they overflow an unsigned.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// When storing out scalable vectors we bail out for now, since the code</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">// below currently only works for constant strides.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> SizeInBits = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeSizeInBits(StoredVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span> (SizeInBits.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">isScalable</a>() || (SizeInBits.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">getFixedValue</a>() &amp; 7) ||</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      (SizeInBits.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">getFixedValue</a>() &gt;&gt; 32) != 0)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// See if the pointer expression is an AddRec like {base,+,1} on the current</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// loop, which indicates a strided store.  If we have something else, it&#39;s a</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// random store we can&#39;t handle.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv =</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      dyn_cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(StorePtr));</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">if</span> (!StoreEv || StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != CurLoop || !StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// Check to see if we have a constant stride.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;SCEVConstant&gt;(StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1)))</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// See if the store can be turned into a memset.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// If the stored value is a byte-wise value (like i32 -1), then it may be</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// turned into a memset of i8 -1, assuming that all the consecutive bytes</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// are stored.  A store of i32 0x01020304 can never be turned into a memset,</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// but it can be turned into memset_pattern if the target supports it.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SplatValue = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(StoredVal, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// Note: memset and memset_pattern on unordered-atomic is yet not supported</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordtype">bool</span> UnorderedAtomic = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isUnordered() &amp;&amp; !<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isSimple();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// If we&#39;re allowed to form a memset, and the stored value would be</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// acceptable for memset, use it.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">if</span> (!UnorderedAtomic &amp;&amp; HasMemset &amp;&amp; SplatValue &amp;&amp; !<a class="code" href="structllvm_1_1DisableLIRP.html#a6d928236e02987de2267a46cd4211336">DisableLIRP::Memset</a> &amp;&amp;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="comment">// Verify that the stored value is loop invariant.  If not, we can&#39;t</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="comment">// promote the memset.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(SplatValue)) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// It looks like we can use SplatValue.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">return</span> LegalStoreKind::Memset;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">if</span> (!UnorderedAtomic &amp;&amp; HasMemsetPattern &amp;&amp; !<a class="code" href="structllvm_1_1DisableLIRP.html#a6d928236e02987de2267a46cd4211336">DisableLIRP::Memset</a> &amp;&amp;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="comment">// Don&#39;t create memset_pattern16s with address spaces.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      StorePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>() == 0 &amp;&amp;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <a class="code" href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">getMemSetPatternValue</a>(StoredVal, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">// It looks like we can use PatternValue!</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">return</span> LegalStoreKind::MemsetPattern;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// Otherwise, see if the store can be turned into a memcpy.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (HasMemcpy &amp;&amp; !<a class="code" href="structllvm_1_1DisableLIRP.html#ab19e3cae2e9e472353062a181092d68f">DisableLIRP::Memcpy</a>) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// Check to see if the stride matches the size of the store.  If so, then we</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// know that every byte is touched in the loop.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Stride = <a class="code" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a>(StoreEv);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">unsigned</span> StoreSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeStoreSize(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType());</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (StoreSize != Stride &amp;&amp; StoreSize != -Stride)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// The store must be feeding a non-volatile load.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// Only allow non-volatile loads</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (!LI || LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>())</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// Only allow simple or unordered-atomic loads</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (!LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ac072f8698be17d52f20bb63d59e6ce41">isUnordered</a>())</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// See if the pointer expression is an AddRec like {base,+,1} on the current</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// loop, which indicates a strided load.  If we have something else, it&#39;s a</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">// random load we can&#39;t handle.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LoadEv =</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        dyn_cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>()));</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (!LoadEv || LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != CurLoop || !LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// The store and load must share the same stride.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1) != LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1))</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// Success.  This store can be converted into a memcpy.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    UnorderedAtomic = UnorderedAtomic || LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">return</span> UnorderedAtomic ? LegalStoreKind::UnorderedAtomicMemcpy</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                           : LegalStoreKind::Memcpy;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// This store can&#39;t be transformed into a memset/memcpy.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;}</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordtype">void</span> LoopIdiomRecognize::collectStores(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  StoreRefsForMemset.clear();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  StoreRefsForMemsetPattern.clear();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  StoreRefsForMemcpy.clear();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// Make sure this is a strided store with a constant stride.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">switch</span> (isLegalStore(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">LegalStoreKind::None</a>:</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="comment">// Nothing to do</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">case</span> LegalStoreKind::Memset: {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="comment">// Find the base pointer.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand());</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      StoreRefsForMemset[<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>].push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">case</span> LegalStoreKind::MemsetPattern: {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">// Find the base pointer.</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand());</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      StoreRefsForMemsetPattern[<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>].push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">case</span> LegalStoreKind::Memcpy:</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">case</span> LegalStoreKind::UnorderedAtomicMemcpy:</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      StoreRefsForMemcpy.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;unhandled return value&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">/// runOnLoopBlock - Process the specified block, which lives in a counted loop</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">/// with the specified backedge count.  This block is known to be in the current</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">/// loop and not in any subloops.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::runOnLoopBlock(</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;BasicBlock *&gt;</a> &amp;ExitBlocks) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// We can only promote stores in this block if they are unconditionally</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// executed in the loop.  For a block to be unconditionally executed, it has</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// to dominate all the exit blocks of the loop.  Verify this now.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock : ExitBlocks)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (!DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, ExitBlock))</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// Look for store instructions, which may be optimized to memset/memcpy.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  collectStores(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// Look for a single store or sets of stores with a common base, which can be</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// optimized into a memset (memset_pattern).  The latter most commonly happens</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="comment">// with structs and handunrolled loops.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;SL : StoreRefsForMemset)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    MadeChange |= processLoopStores(SL.second, BECount, ForMemset::Yes);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;SL : StoreRefsForMemsetPattern)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    MadeChange |= processLoopStores(SL.second, BECount, ForMemset::No);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// Optimize the store into a memcpy, if it feeds an similarly strided load.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : StoreRefsForMemcpy)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    MadeChange |= processLoopStoreOfLoopLoad(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, BECount);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  MadeChange |= processLoopMemIntrinsic&lt;MemCpyInst&gt;(</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, &amp;LoopIdiomRecognize::processLoopMemCpy, BECount);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  MadeChange |= processLoopMemIntrinsic&lt;MemSetInst&gt;(</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, &amp;LoopIdiomRecognize::processLoopMemSet, BECount);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">/// See if this store(s) can be promoted to a memset.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopStores(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;StoreInst *&gt;</a> &amp;SL,</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount, ForMemset For) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// Try to find consecutive stores that can be transformed into memsets.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;StoreInst *&gt;</a> Heads, Tails;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;StoreInst *, StoreInst *&gt;</a> ConsecutiveChain;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// Do a quadratic search on all of the given stores and find</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// all of the pairs of stores that follow each other.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 16&gt;</a> IndexQueue;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = SL.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="SLPVectorizer_8cpp.html#a3ca9742688618517cc4690fb947fb609">isSimple</a>() &amp;&amp; <span class="stringliteral">&quot;Expected only non-volatile stores.&quot;</span>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstStoredVal = SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getValueOperand();</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstStorePtr = SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getPointerOperand();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *FirstStoreEv =</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(FirstStorePtr));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> FirstStride = <a class="code" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a>(FirstStoreEv);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordtype">unsigned</span> FirstStoreSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeStoreSize(SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;getValueOperand()-&gt;<a class="code" href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a>());</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// See if we can optimize just this store in isolation.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (FirstStride == FirstStoreSize || -FirstStride == FirstStoreSize) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      Heads.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstSplatValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *FirstPatternValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (For == ForMemset::Yes)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      FirstSplatValue = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(FirstStoredVal, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      FirstPatternValue = <a class="code" href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">getMemSetPatternValue</a>(FirstStoredVal, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((FirstSplatValue || FirstPatternValue) &amp;&amp;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;           <span class="stringliteral">&quot;Expected either splat value or pattern value.&quot;</span>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    IndexQueue.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// If a store has multiple consecutive store candidates, search Stores</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// array according to the sequence: from i+1 to e, then from i-1 to 0.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// This is because usually pairing with immediate succeeding or preceding</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// candidate create the best chance to find memset opportunity.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      IndexQueue.push_back(<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &gt; 0; --<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      IndexQueue.push_back(<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> - 1);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;k : IndexQueue) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SL[k]-&gt;<a class="code" href="SLPVectorizer_8cpp.html#a3ca9742688618517cc4690fb947fb609">isSimple</a>() &amp;&amp; <span class="stringliteral">&quot;Expected only non-volatile stores.&quot;</span>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *SecondStorePtr = SL[k]-&gt;getPointerOperand();</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *SecondStoreEv =</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(SecondStorePtr));</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> SecondStride = <a class="code" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a>(SecondStoreEv);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">if</span> (FirstStride != SecondStride)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *SecondStoredVal = SL[k]-&gt;getValueOperand();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *SecondSplatValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *SecondPatternValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">if</span> (For == ForMemset::Yes)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        SecondSplatValue = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(SecondStoredVal, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        SecondPatternValue = <a class="code" href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">getMemSetPatternValue</a>(SecondStoredVal, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((SecondSplatValue || SecondPatternValue) &amp;&amp;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;             <span class="stringliteral">&quot;Expected either splat value or pattern value.&quot;</span>);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ab1b85be3cd0fffad1d76673016015e02">isConsecutiveAccess</a>(SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], SL[k], *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, *SE, <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> (For == ForMemset::Yes) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(FirstSplatValue))</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            FirstSplatValue = SecondSplatValue;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          <span class="keywordflow">if</span> (FirstSplatValue != SecondSplatValue)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(FirstPatternValue))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            FirstPatternValue = SecondPatternValue;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          <span class="keywordflow">if</span> (FirstPatternValue != SecondPatternValue)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        Tails.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(SL[k]);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        Heads.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        ConsecutiveChain[SL[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = SL[k];</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">// We may run into multiple chains that merge into a single chain. We mark the</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// stores that we transformed so that we don&#39;t visit the same store twice.</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> TransformedStores;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// For stores that start but don&#39;t end a link in the chain:</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Heads) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> (Tails.<a class="code" href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">count</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// We found a store instr that starts a chain. Now follow the chain and try</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// to transform it.</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 8&gt;</a> AdjacentStores;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *HeadStore = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordtype">unsigned</span> StoreSize = 0;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">// Collect the chain into a list.</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">while</span> (Tails.<a class="code" href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">count</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || Heads.count(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">if</span> (TransformedStores.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      AdjacentStores.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      StoreSize += <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeStoreSize(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getValueOperand()-&gt;getType());</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="comment">// Move to the next value in the chain.</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = ConsecutiveChain[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredVal = HeadStore-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">getValueOperand</a>();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StorePtr = HeadStore-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv = cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(StorePtr));</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Stride = <a class="code" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a>(StoreEv);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// Check to see if the stride matches the size of the stores.  If so, then</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// we know that every byte is touched in the loop.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">if</span> (StoreSize != Stride &amp;&amp; StoreSize != -Stride)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordtype">bool</span> IsNegStride = StoreSize == -Stride;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntIdxTy = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getIndexType(StorePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(IntIdxTy, StoreSize);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span> (processLoopStridedStore(StorePtr, StoreSizeSCEV,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a>(HeadStore-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a3b47950858d6ed72efd1010a35b81caa">getAlign</a>()), StoredVal,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                HeadStore, AdjacentStores, StoreEv, BECount,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                IsNegStride)) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      TransformedStores.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(AdjacentStores.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(), AdjacentStores.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;}</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">/// processLoopMemIntrinsic - Template function for calling different processor</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">/// functions based on mem intrinsic type.</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MemInst&gt;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopMemIntrinsic(</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">bool</span> (LoopIdiomRecognize::*Processor)(MemInst *, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *),</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;) {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">// Look for memory instructions, which may be optimized to a larger one.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (MemInst *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = dyn_cast&lt;MemInst&gt;(Inst)) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="classllvm_1_1WeakTrackingVH.html">WeakTrackingVH</a> InstPtr(&amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">if</span> (!(this-&gt;*Processor)(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, BECount))</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="comment">// If processing the instruction invalidated our iterator, start over from</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// the top of the block.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> (!InstPtr)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin();</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;}</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">/// processLoopMemCpy - See if this memcpy can be promoted to a large memcpy</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopMemCpy(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MCI,</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// We can only handle non-volatile memcpys with a constant size.</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">if</span> (MCI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>() || !isa&lt;ConstantInt&gt;(MCI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>()))</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">// If we&#39;re not allowed to hack on memcpy, we fail.</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordflow">if</span> ((!HasMemcpy &amp;&amp; !isa&lt;MemCpyInlineInst&gt;(MCI)) || <a class="code" href="structllvm_1_1DisableLIRP.html#ab19e3cae2e9e472353062a181092d68f">DisableLIRP::Memcpy</a>)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dest = MCI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a> = MCI-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>();</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">if</span> (!Dest || !<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// See if the load and store pointer expressions are AddRec like {base,+,1} on</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">// the current loop, which indicates a strided load and store.  If we have</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// something else, it&#39;s a random load or store we can&#39;t handle.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv = dyn_cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Dest));</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (!StoreEv || StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != CurLoop || !StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LoadEv = dyn_cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>));</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">if</span> (!LoadEv || LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != CurLoop || !LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// Reject memcpys that are so large that they overflow an unsigned.</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SizeInBytes = cast&lt;ConstantInt&gt;(MCI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>())-&gt;<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">if</span> ((SizeInBytes &gt;&gt; 32) != 0)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">// Check if the stride matches the size of the memcpy. If so, then we know</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// that every byte is touched in the loop.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *ConstStoreStride =</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      dyn_cast&lt;SCEVConstant&gt;(StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1));</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *ConstLoadStride =</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      dyn_cast&lt;SCEVConstant&gt;(LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1));</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (!ConstStoreStride || !ConstLoadStride)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> StoreStrideValue = ConstStoreStride-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">getAPInt</a>();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> LoadStrideValue = ConstLoadStride-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">getAPInt</a>();</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// Huge stride value - give up</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordflow">if</span> (StoreStrideValue.<a class="code" href="classllvm_1_1APInt.html#a512fe2c15ea651294688eeec1341644c">getBitWidth</a>() &gt; 64 || LoadStrideValue.<a class="code" href="classllvm_1_1APInt.html#a512fe2c15ea651294688eeec1341644c">getBitWidth</a>() &gt; 64)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordflow">if</span> (SizeInBytes != StoreStrideValue &amp;&amp; SizeInBytes != -StoreStrideValue) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SizeStrideUnequal&quot;</span>, MCI)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Inst&quot;</span>, <span class="stringliteral">&quot;memcpy&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; in &quot;</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Function&quot;</span>, MCI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>())</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; function will not be hoisted: &quot;</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Reason&quot;</span>, <span class="stringliteral">&quot;memcpy size is not equal to stride&quot;</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    });</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  int64_t StoreStrideInt = StoreStrideValue.<a class="code" href="classllvm_1_1APInt.html#af2daa0ee117afefed4c82eee55bf97b7">getSExtValue</a>();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  int64_t LoadStrideInt = LoadStrideValue.<a class="code" href="classllvm_1_1APInt.html#af2daa0ee117afefed4c82eee55bf97b7">getSExtValue</a>();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">// Check if the load stride matches the store stride.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">if</span> (StoreStrideInt != LoadStrideInt)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">return</span> processLoopStoreOfLoopLoad(</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      Dest, <a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>, SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(Dest-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), SizeInBytes),</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      MCI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>(), MCI-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">getSourceAlign</a>(), MCI, MCI, StoreEv, LoadEv,</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      BECount);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">/// processLoopMemSet - See if this memset can be promoted to a large memset.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopMemSet(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI,</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// We can only handle non-volatile memsets.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">if</span> (MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>())</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// If we&#39;re not allowed to hack on memset, we fail.</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">if</span> (!HasMemset || <a class="code" href="structllvm_1_1DisableLIRP.html#a6d928236e02987de2267a46cd4211336">DisableLIRP::Memset</a>)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#a0bfa8e65ecd85f3151f84bb53ad4bcbca61cf8510205077b6f5491d38cd44c0f7">Pointer</a> = MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// See if the pointer expression is an AddRec like {base,+,1} on the current</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// loop, which indicates a strided store.  If we have something else, it&#39;s a</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// random store we can&#39;t handle.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *Ev = dyn_cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Pointer));</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span> (!Ev || Ev-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != CurLoop)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">if</span> (!Ev-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>()) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Pointer is not affine, abort\n&quot;</span>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PointerStrideSCEV = Ev-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *MemsetSizeSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">if</span> (!PointerStrideSCEV || !MemsetSizeSCEV)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keywordtype">bool</span> IsNegStride = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> IsConstantSize = isa&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">if</span> (IsConstantSize) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// Memset size is constant.</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// Check if the pointer stride matches the memset size. If so, then</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// we know that every byte is touched in the loop.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  memset size is constant\n&quot;</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SizeInBytes = cast&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>())-&gt;<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *ConstStride = dyn_cast&lt;SCEVConstant&gt;(Ev-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">getOperand</a>(1));</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">if</span> (!ConstStride)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Stride = ConstStride-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">getAPInt</a>();</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (SizeInBytes != Stride &amp;&amp; SizeInBytes != -Stride)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    IsNegStride = SizeInBytes == -Stride;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">// Memset size is non-constant.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// Check if the pointer stride matches the memset size.</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// To be conservative, the pass would not promote pointers that aren&#39;t in</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// address space zero. Also, the pass only handles memset length and stride</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">// that are invariant for the top level loop.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  memset size is non-constant\n&quot;</span>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1codeview.html#a0bfa8e65ecd85f3151f84bb53ad4bcbca61cf8510205077b6f5491d38cd44c0f7">Pointer</a>-&gt;getType()-&gt;getPointerAddressSpace() != 0) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  pointer is not in address space zero, &quot;</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;abort\n&quot;</span>);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(MemsetSizeSCEV, CurLoop)) {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  memset size is not a loop-invariant, &quot;</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;abort\n&quot;</span>);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">// Compare positive direction PointerStrideSCEV with MemsetSizeSCEV</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    IsNegStride = PointerStrideSCEV-&gt;<a class="code" href="classllvm_1_1SCEV.html#a87b23e247f35b163544f1ce8e920801c">isNonConstantNegative</a>();</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PositiveStrideSCEV =</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        IsNegStride ? SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">getNegativeSCEV</a>(PointerStrideSCEV)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    : PointerStrideSCEV;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  MemsetSizeSCEV: &quot;</span> &lt;&lt; *MemsetSizeSCEV &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;  PositiveStrideSCEV: &quot;</span> &lt;&lt; *PositiveStrideSCEV</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span> (PositiveStrideSCEV != MemsetSizeSCEV) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="comment">// If an expression is covered by the loop guard, compare again and</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="comment">// proceed with optimization if equal.</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *FoldedPositiveStride =</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ad146072469181af4ccb7ef03c28999ba">applyLoopGuards</a>(PositiveStrideSCEV, CurLoop);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *FoldedMemsetSize =</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ad146072469181af4ccb7ef03c28999ba">applyLoopGuards</a>(MemsetSizeSCEV, CurLoop);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Try to fold SCEV based on loop guard\n&quot;</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;    FoldedMemsetSize: &quot;</span> &lt;&lt; *FoldedMemsetSize &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;    FoldedPositiveStride: &quot;</span> &lt;&lt; *FoldedPositiveStride</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">if</span> (FoldedPositiveStride != FoldedMemsetSize) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  SCEV don&#39;t match, abort\n&quot;</span>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="comment">// Verify that the memset value is loop invariant.  If not, we can&#39;t promote</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="comment">// the memset.</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SplatValue = MSI-&gt;<a class="code" href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">getValue</a>();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (!SplatValue || !CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(SplatValue))</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 1&gt;</a> MSIs;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  MSIs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(MSI);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">return</span> processLoopStridedStore(Pointer, SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>()),</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                 MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>(), SplatValue, MSI, MSIs, Ev,</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                 BECount, IsNegStride, <span class="comment">/*IsLoopMemset=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">/// mayLoopAccessLocation - Return true if the specified loop might access the</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">/// specified pointer location, which is a loop-strided access.  The &#39;Access&#39;</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">/// argument specifies what the verboten forms of access are (read or write).</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb"> 1005</a></span>&#160;<a class="code" href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb">mayLoopAccessLocation</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2e">ModRefInfo</a> Access, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV,</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                      <a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> &amp;AA,</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                      <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;Instruction *&gt;</a> &amp;IgnoredInsts) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="comment">// Get the location that may be stored across the loop.  Since the access is</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="comment">// strided positively through memory, we say that the modified location starts</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="comment">// at the pointer and has infinite size.</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <a class="code" href="classllvm_1_1LocationSize.html">LocationSize</a> AccessSize = <a class="code" href="classllvm_1_1LocationSize.html#aecff732f116417f2c4e99ac146339300">LocationSize::afterPointer</a>();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">// If the loop iterates a fixed number of times, we can refine the access size</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="comment">// to be exactly the size of the memset, which is (BECount+1)*StoreSize</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *BECst = dyn_cast&lt;SCEVConstant&gt;(BECount);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *ConstSize = dyn_cast&lt;SCEVConstant&gt;(StoreSizeSCEV);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (BECst &amp;&amp; ConstSize)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    AccessSize = <a class="code" href="classllvm_1_1LocationSize.html#a131715ceeb92fb803a329d6b76d14e0d">LocationSize::precise</a>((BECst-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#ab319aacb4209aeca2c72d50a0d585b47">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>() + 1) *</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                       ConstSize-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#ab319aacb4209aeca2c72d50a0d585b47">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>());</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// TODO: For this to be really effective, we have to dive into the pointer</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">// operand in the store.  Store to &amp;A[i] of 100 will always return may alias</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">// with store of &amp;A[100], we need to StoreLoc to be &quot;A&quot; with size of 100,</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="comment">// which will then no-alias a store to &amp;A[100].</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> StoreLoc(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, AccessSize);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>())</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keywordflow">if</span> (!IgnoredInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#af74676a3c7447be34bd2c1da76ec0c48">contains</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          <a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA.<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, StoreLoc) &amp; Access))</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;}</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">// If we have a negative stride, Start refers to the end of the memory location</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">// we&#39;re trying to memset.  Therefore, we need to recompute the base pointer,</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">// which is just Start - BECount*Size.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ab5f1717b899684c80274c08ed18d34a9"> 1039</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#ab5f1717b899684c80274c08ed18d34a9">getStartForNegStride</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Start, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount,</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                        <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtr, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV,</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                        <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#adc040502444e4504cdbc04c87e4e3055">getTruncateOrZeroExtend</a>(BECount, IntPtr);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">if</span> (!StoreSizeSCEV-&gt;<a class="code" href="classllvm_1_1SCEV.html#a1ecb726f4e7b445057b795ed500546a0">isOne</a>()) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// index = back edge count * store size</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>,</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                           SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#adc040502444e4504cdbc04c87e4e3055">getTruncateOrZeroExtend</a>(StoreSizeSCEV, IntPtr),</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                           <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">SCEV::FlagNUW</a>);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// base pointer = start - index * store size</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(Start, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;}</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">/// Compute trip count from the backedge taken count.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a1d585c107a14470e0f38289b60164ed1"> 1054</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#a1d585c107a14470e0f38289b60164ed1">getTripCount</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount, <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtr,</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                <a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *TripCountS = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// The # stored bytes is (BECount+1).  Expand the trip count out to</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">// pointer size if it isn&#39;t already.</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="comment">// If we&#39;re going to need to zero extend the BE count, check if we can add</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="comment">// one to it prior to zero extending without overflow. Provided this is safe,</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="comment">// it allows better simplification of the +1.</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeSizeInBits(BECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) &lt;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeSizeInBits(IntPtr) &amp;&amp;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#adc8cf3b4b56f754b02ea30263bd4561e">isLoopEntryGuardedByCond</a>(</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          CurLoop, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>, BECount,</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;          SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">getNegativeSCEV</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ac93dd46031b1e2f9fdb0cee7a99681df">getOne</a>(BECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>())))) {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    TripCountS = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">getZeroExtendExpr</a>(</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(BECount, SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ac93dd46031b1e2f9fdb0cee7a99681df">getOne</a>(BECount-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>()), <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">SCEV::FlagNUW</a>),</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        IntPtr);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    TripCountS = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#adc040502444e4504cdbc04c87e4e3055">getTruncateOrZeroExtend</a>(BECount, IntPtr),</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ac93dd46031b1e2f9fdb0cee7a99681df">getOne</a>(IntPtr), <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">SCEV::FlagNUW</a>);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">return</span> TripCountS;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;}</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">/// Compute the number of bytes as a SCEV from the backedge taken count.</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">/// This also maps the SCEV into the provided type and tries to handle the</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">/// computation in a way that will fold cleanly.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#aca5de061452897f79eaf9d8964d3b269"> 1084</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#aca5de061452897f79eaf9d8964d3b269">getNumBytes</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount, <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtr,</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *TripCountSCEV = <a class="code" href="LoopIdiomRecognize_8cpp.html#a1d585c107a14470e0f38289b60164ed1">getTripCount</a>(BECount, IntPtr, CurLoop, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SE);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">return</span> SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(TripCountSCEV,</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#adc040502444e4504cdbc04c87e4e3055">getTruncateOrZeroExtend</a>(StoreSizeSCEV, IntPtr),</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        <a class="code" href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">SCEV::FlagNUW</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;}</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">/// processLoopStridedStore - We see a strided store of some value.  If we can</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">/// transform this into a memset or memset_pattern in the loop preheader, do so.</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopStridedStore(</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *DestPtr, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV, <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> StoreAlignment,</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredVal, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TheStore,</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;Instruction *&gt;</a> &amp;Stores, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *Ev,</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount, <span class="keywordtype">bool</span> IsNegStride, <span class="keywordtype">bool</span> IsLoopMemset) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SplatValue = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(StoredVal, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *PatternValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="keywordflow">if</span> (!SplatValue)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    PatternValue = <a class="code" href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">getMemSetPatternValue</a>(StoredVal, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((SplatValue || PatternValue) &amp;&amp;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;         <span class="stringliteral">&quot;Expected either splat value or pattern value.&quot;</span>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="comment">// The trip count of the loop and the base pointer of the addrec SCEV is</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="comment">// guaranteed to be loop invariant, which means that it should dominate the</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">// header.  This allows us to insert code for it in the preheader.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordtype">unsigned</span> DestAS = DestPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Preheader = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> Expander(*SE, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="stringliteral">&quot;loop-idiom&quot;</span>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpanderCleaner.html">SCEVExpanderCleaner</a> ExpCleaner(Expander);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *DestInt8PtrTy = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy(DestAS);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntIdxTy = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getIndexType(DestPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Start = Ev-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>();</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="comment">// Handle negative strided loops.</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">if</span> (IsNegStride)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    Start = <a class="code" href="LoopIdiomRecognize_8cpp.html#ab5f1717b899684c80274c08ed18d34a9">getStartForNegStride</a>(Start, BECount, IntIdxTy, StoreSizeSCEV, SE);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="comment">// TODO: ideally we should still be able to generate memset if SCEV expander</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="comment">// is taught to generate the dependencies at the latest point.</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordflow">if</span> (!Expander.isSafeToExpand(Start))</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// Okay, we have a strided store &quot;p[i]&quot; of a splattable value.  We can turn</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">// this into a memset in the loop preheader now if we want.  However, this</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="comment">// would be unsafe to do if there is anything else in the loop that may read</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="comment">// or write to the aliased location.  Check for any overlap by generating the</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="comment">// base pointer and checking the region.</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> =</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      Expander.expandCodeFor(Start, DestInt8PtrTy, Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="comment">// From here on out, conservatively report to the pass manager that we&#39;ve</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="comment">// changed the IR, even if we later clean up these added instructions. There</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="comment">// may be structural differences e.g. in the order of use lists not accounted</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="comment">// for in just a textual dump of the IR. This is written as a variable, even</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">// though statically all the places this dominates could be replaced with</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="comment">// &#39;true&#39;, with the hope that anyone trying to be clever / &quot;more precise&quot; with</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="comment">// the return value will read this comment, and leave them alone.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb">mayLoopAccessLocation</a>(BasePtr, <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea6524b183b5cd0850f2cff6d30d581af9">ModRefInfo::ModRef</a>, CurLoop, BECount,</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                            StoreSizeSCEV, *AA, Stores))</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">if</span> (avoidLIRForMultiBlockLoop(<span class="comment">/*IsMemset=*/</span><span class="keyword">true</span>, IsLoopMemset))</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">// Okay, everything looks good, insert the memset.</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NumBytesS =</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <a class="code" href="LoopIdiomRecognize_8cpp.html#aca5de061452897f79eaf9d8964d3b269">getNumBytes</a>(BECount, IntIdxTy, StoreSizeSCEV, CurLoop, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SE);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="comment">// TODO: ideally we should still be able to generate memset if SCEV expander</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">// is taught to generate the dependencies at the latest point.</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">if</span> (!Expander.isSafeToExpand(NumBytesS))</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NumBytes =</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      Expander.expandCodeFor(NumBytesS, IntIdxTy, Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCall;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">if</span> (SplatValue) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> : Stores)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      AATags = AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a6b173e97523275314f3f2b433a5f71a9">merge</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getAAMetadata());</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> CI = dyn_cast&lt;ConstantInt&gt;(NumBytes))</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      AATags = AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#abc415418337d16a2b07a2b8ab6e8dc36">extendTo</a>(CI-&gt;getZExtValue());</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      AATags = AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#abc415418337d16a2b07a2b8ab6e8dc36">extendTo</a>(-1);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    NewCall = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemSet(</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        BasePtr, SplatValue, NumBytes, <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a>(StoreAlignment),</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="comment">/*isVolatile=*/</span><span class="keyword">false</span>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a56188042f9dd6003cb8ed087e8ae654f">TBAA</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5175e1defb539f65df5ded7a806fa5c8">Scope</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a81f3c11f463009d8b19b544f5bfed40c">NoAlias</a>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_memset_pattern16)) {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">// Everything is emitted in default address space</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8PtrTy = DestInt8PtrTy;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FuncName = <span class="stringliteral">&quot;memset_pattern16&quot;</span>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> MSP = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_memset_pattern16,</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                            <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getVoidTy(), Int8PtrTy, Int8PtrTy, IntIdxTy);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="namespacellvm.html#a4a57dcd94b6daa3eacdbe8471955f4b1">inferNonMandatoryLibFuncAttrs</a>(M, FuncName, *TLI);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">// Otherwise we should form a memset_pattern16.  PatternValue is known to be</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">// an constant array of 16-bytes.  Plop the value into a mergable global.</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a> *GV = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(*M, PatternValue-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="keyword">true</span>,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                            <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">GlobalValue::PrivateLinkage</a>,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                            PatternValue, <span class="stringliteral">&quot;.memset_pattern&quot;</span>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    GV-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a38c97622dccff7ae31fe0be3b21c9b3d">setUnnamedAddr</a>(<a class="code" href="classllvm_1_1GlobalValue.html#ae8df4be75bfc50b1eadd74e85c25fa45a4cc6684df7b4a92b1dec6fce3264fac8">GlobalValue::UnnamedAddr::Global</a>); <span class="comment">// Ok to merge these.</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    GV-&gt;<a class="code" href="classllvm_1_1GlobalObject.html#a49b398b1c83ef4d42c8f7756b443f61f">setAlignment</a>(<a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(16));</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PatternPtr = <a class="code" href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">ConstantExpr::getBitCast</a>(GV, Int8PtrTy);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    NewCall = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(MSP, {<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>, PatternPtr, NumBytes});</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  NewCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordflow">if</span> (MSSAU) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *NewMemAcc = MSSAU-&gt;createMemoryAccessInBB(</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        NewCall, <span class="keyword">nullptr</span>, NewCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), <a class="code" href="classllvm_1_1MemorySSA.html#a9773fde54683945b9e34a0f2e5c1a5a5a7806c120eb87aea9fbb52fed327e09de">MemorySSA::BeforeTerminator</a>);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    MSSAU-&gt;insertDef(cast&lt;MemoryDef&gt;(NewMemAcc), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Formed memset: &quot;</span> &lt;&lt; *NewCall &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;    from store to: &quot;</span> &lt;&lt; *Ev &lt;&lt; <span class="stringliteral">&quot; at: &quot;</span> &lt;&lt; *TheStore</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>(<a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;ProcessLoopStridedStore&quot;</span>,</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                         NewCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>(), Preheader);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> &lt;&lt; <span class="stringliteral">&quot;Transformed loop-strided store in &quot;</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Function&quot;</span>, TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>())</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; function into a call to &quot;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;NewFunction&quot;</span>, NewCall-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>())</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;() intrinsic&quot;</span>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">if</span> (!Stores.empty())</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a177844335152e882e8ac429dd1102716">ore::setExtraArgs</a>();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Stores) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;FromBlock&quot;</span>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;getName())</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;ToBlock&quot;</span>, Preheader-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  });</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="comment">// Okay, the memset has been formed.  Zap the original store and anything that</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">// feeds into it.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Stores) {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (MSSAU)</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      MSSAU-&gt;removeMemoryAccess(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="LoopIdiomRecognize_8cpp.html#aebc62faf59fecc07e8471fcf035d789e">deleteDeadInstruction</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="keywordflow">if</span> (MSSAU &amp;&amp; <a class="code" href="namespacellvm.html#aa29fe161c408879ada30c90ebbf55dcf">VerifyMemorySSA</a>)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    MSSAU-&gt;getMemorySSA()-&gt;verifyMemorySSA();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  ++NumMemSet;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  ExpCleaner.markResultUsed();</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;}</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">/// If the stored value is a strided load in the same loop with the same stride</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">/// this may be transformable into a memcpy.  This kicks in for stuff like</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/// for (i) A[i] = B[i];</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopStoreOfLoopLoad(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isUnordered() &amp;&amp; <span class="stringliteral">&quot;Expected only non-volatile non-ordered stores.&quot;</span>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StorePtr = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv = cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(StorePtr));</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="keywordtype">unsigned</span> StoreSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getTypeStoreSize(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType());</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="comment">// The store must be feeding a non-volatile load.</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ac072f8698be17d52f20bb63d59e6ce41">isUnordered</a>() &amp;&amp; <span class="stringliteral">&quot;Expected only non-volatile non-ordered loads.&quot;</span>);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// See if the pointer expression is an AddRec like {base,+,1} on the current</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">// loop, which indicates a strided load.  If we have something else, it&#39;s a</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">// random load we can&#39;t handle.</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LoadPtr = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LoadEv = cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LoadPtr));</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(StorePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), StoreSize);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="keywordflow">return</span> processLoopStoreOfLoopLoad(StorePtr, LoadPtr, StoreSizeSCEV,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                    <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(), LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, LI,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                    StoreEv, LoadEv, BECount);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="keyword">class </span>MemmoveVerifier {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keyword">explicit</span> MemmoveVerifier(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> &amp;LoadBasePtr, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> &amp;StoreBasePtr,</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), BP1(<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#afc6337ef6e00f6bebd44d81b685d655f">GetPointerBaseWithConstantOffset</a>(</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    LoadBasePtr.stripPointerCasts(), LoadOff, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)),</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        BP2(<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#afc6337ef6e00f6bebd44d81b685d655f">GetPointerBaseWithConstantOffset</a>(</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            StoreBasePtr.stripPointerCasts(), StoreOff, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)),</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        IsSameObject(BP1 == BP2) {}</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordtype">bool</span> loadAndStoreMayFormMemmove(<span class="keywordtype">unsigned</span> StoreSize, <span class="keywordtype">bool</span> IsNegStride,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;TheLoad,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                  <span class="keywordtype">bool</span> IsMemCpy)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">if</span> (IsMemCpy) {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="comment">// Ensure that LoadBasePtr is after StoreBasePtr or before StoreBasePtr</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="comment">// for negative stride.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">if</span> ((!IsNegStride &amp;&amp; LoadOff &lt;= StoreOff) ||</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          (IsNegStride &amp;&amp; LoadOff &gt;= StoreOff))</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="comment">// Ensure that LoadBasePtr is after StoreBasePtr or before StoreBasePtr</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="comment">// for negative stride. LoadBasePtr shouldn&#39;t overlap with StoreBasePtr.</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      int64_t LoadSize =</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(TheLoad.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue() / 8;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keywordflow">if</span> (BP1 != BP2 || LoadSize != int64_t(StoreSize))</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">if</span> ((!IsNegStride &amp;&amp; LoadOff &lt; StoreOff + int64_t(StoreSize)) ||</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;          (IsNegStride &amp;&amp; LoadOff + LoadSize &gt; StoreOff))</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  int64_t LoadOff = 0;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  int64_t StoreOff = 0;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *BP1;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *BP2;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> IsSameObject;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;};</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keywordtype">bool</span> LoopIdiomRecognize::processLoopStoreOfLoopLoad(</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *DestPtr, <a class="code" href="classllvm_1_1Value.html">Value</a> *SourcePtr, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StoreSizeSCEV,</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> StoreAlign, <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> LoadAlign, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TheStore,</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TheLoad, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *StoreEv,</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LoadEv, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BECount) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">// FIXME: until llvm.memcpy.inline supports dynamic sizes, we need to</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="comment">// conservatively bail here, since otherwise we may have to transform</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="comment">// llvm.memcpy.inline into llvm.memcpy which is illegal.</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordflow">if</span> (isa&lt;MemCpyInlineInst&gt;(TheStore))</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="comment">// The trip count of the loop and the base pointer of the addrec SCEV is</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="comment">// guaranteed to be loop invariant, which means that it should dominate the</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment">// header.  This allows us to insert code for it in the preheader.</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Preheader = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> Expander(*SE, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="stringliteral">&quot;loop-idiom&quot;</span>);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpanderCleaner.html">SCEVExpanderCleaner</a> ExpCleaner(Expander);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *StrStart = StoreEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>();</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordtype">unsigned</span> StrAS = DestPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntIdxTy = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getIntNTy(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getIndexSizeInBits(StrAS));</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> Stride = <a class="code" href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a>(StoreEv);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *ConstStoreSize = dyn_cast&lt;SCEVConstant&gt;(StoreSizeSCEV);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="comment">// TODO: Deal with non-constant size; Currently expect constant store size</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ConstStoreSize &amp;&amp; <span class="stringliteral">&quot;store size is expected to be a constant&quot;</span>);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  int64_t StoreSize = ConstStoreSize-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#ab319aacb4209aeca2c72d50a0d585b47">getValue</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordtype">bool</span> IsNegStride = StoreSize == -Stride;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">// Handle negative strided loops.</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="keywordflow">if</span> (IsNegStride)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    StrStart =</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <a class="code" href="LoopIdiomRecognize_8cpp.html#ab5f1717b899684c80274c08ed18d34a9">getStartForNegStride</a>(StrStart, BECount, IntIdxTy, StoreSizeSCEV, SE);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="comment">// Okay, we have a strided store &quot;p[i]&quot; of a loaded value.  We can turn</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="comment">// this into a memcpy in the loop preheader now if we want.  However, this</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="comment">// would be unsafe to do if there is anything else in the loop that may read</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="comment">// or write the memory region we&#39;re storing to.  This includes the load that</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">// feeds the stores.  Check for an alias by generating the base address and</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">// checking everything.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StoreBasePtr = Expander.expandCodeFor(</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      StrStart, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy(StrAS), Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="comment">// From here on out, conservatively report to the pass manager that we&#39;ve</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">// changed the IR, even if we later clean up these added instructions. There</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="comment">// may be structural differences e.g. in the order of use lists not accounted</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="comment">// for in just a textual dump of the IR. This is written as a variable, even</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// though statically all the places this dominates could be replaced with</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">// &#39;true&#39;, with the hope that anyone trying to be clever / &quot;more precise&quot; with</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="comment">// the return value will read this comment, and leave them alone.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 2&gt;</a> IgnoredInsts;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  IgnoredInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(TheStore);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="keywordtype">bool</span> IsMemCpy = isa&lt;MemCpyInst&gt;(TheStore);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> InstRemark = IsMemCpy ? <span class="stringliteral">&quot;memcpy&quot;</span> : <span class="stringliteral">&quot;load and store&quot;</span>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordtype">bool</span> LoopAccessStore =</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <a class="code" href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb">mayLoopAccessLocation</a>(StoreBasePtr, <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea6524b183b5cd0850f2cff6d30d581af9">ModRefInfo::ModRef</a>, CurLoop, BECount,</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                            StoreSizeSCEV, *AA, IgnoredInsts);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keywordflow">if</span> (LoopAccessStore) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// For memmove case it&#39;s not enough to guarantee that loop doesn&#39;t access</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">// TheStore and TheLoad. Additionally we need to make sure that TheStore is</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// the only user of TheLoad.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span> (!TheLoad-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>())</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    IgnoredInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(TheLoad);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb">mayLoopAccessLocation</a>(StoreBasePtr, <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea6524b183b5cd0850f2cff6d30d581af9">ModRefInfo::ModRef</a>, CurLoop,</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                              BECount, StoreSizeSCEV, *AA, IgnoredInsts)) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;LoopMayAccessStore&quot;</span>,</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                        TheStore)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Inst&quot;</span>, InstRemark) &lt;&lt; <span class="stringliteral">&quot; in &quot;</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Function&quot;</span>, TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>())</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; function will not be hoisted: &quot;</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Reason&quot;</span>, <span class="stringliteral">&quot;The loop may access store location&quot;</span>);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      });</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    IgnoredInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(TheLoad);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *LdStart = LoadEv-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>();</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="keywordtype">unsigned</span> LdAS = SourcePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="comment">// Handle negative strided loops.</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keywordflow">if</span> (IsNegStride)</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    LdStart =</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <a class="code" href="LoopIdiomRecognize_8cpp.html#ab5f1717b899684c80274c08ed18d34a9">getStartForNegStride</a>(LdStart, BECount, IntIdxTy, StoreSizeSCEV, SE);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="comment">// For a memcpy, we have to make sure that the input array is not being</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="comment">// mutated by the loop.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LoadBasePtr = Expander.expandCodeFor(</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      LdStart, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy(LdAS), Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="comment">// If the store is a memcpy instruction, we must check if it will write to</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="comment">// the load memory locations. So remove it from the ignored stores.</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  MemmoveVerifier <a class="code" href="SafepointIRVerifier_8cpp.html#ae91b89e3dbb8e36d143a6efcc4d5d85a">Verifier</a>(*LoadBasePtr, *StoreBasePtr, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">if</span> (IsMemCpy &amp;&amp; !<a class="code" href="SafepointIRVerifier_8cpp.html#ae91b89e3dbb8e36d143a6efcc4d5d85a">Verifier</a>.IsSameObject)</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    IgnoredInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(TheStore);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb">mayLoopAccessLocation</a>(LoadBasePtr, <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea7aeb0277500c86e4aa6bd23f9a737942">ModRefInfo::Mod</a>, CurLoop, BECount,</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                            StoreSizeSCEV, *AA, IgnoredInsts)) {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;LoopMayAccessLoad&quot;</span>, TheLoad)</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Inst&quot;</span>, InstRemark) &lt;&lt; <span class="stringliteral">&quot; in &quot;</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Function&quot;</span>, TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>())</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; function will not be hoisted: &quot;</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Reason&quot;</span>, <span class="stringliteral">&quot;The loop may access load location&quot;</span>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    });</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordtype">bool</span> UseMemMove = IsMemCpy ? <a class="code" href="SafepointIRVerifier_8cpp.html#ae91b89e3dbb8e36d143a6efcc4d5d85a">Verifier</a>.IsSameObject : LoopAccessStore;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">if</span> (UseMemMove)</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SafepointIRVerifier_8cpp.html#ae91b89e3dbb8e36d143a6efcc4d5d85a">Verifier</a>.loadAndStoreMayFormMemmove(StoreSize, IsNegStride, *TheLoad,</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                             IsMemCpy))</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="keywordflow">if</span> (avoidLIRForMultiBlockLoop())</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="comment">// Okay, everything is safe, we can transform this!</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *NumBytesS =</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <a class="code" href="LoopIdiomRecognize_8cpp.html#aca5de061452897f79eaf9d8964d3b269">getNumBytes</a>(BECount, IntIdxTy, StoreSizeSCEV, CurLoop, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SE);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NumBytes =</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      Expander.expandCodeFor(NumBytesS, IntIdxTy, Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = TheLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> StoreAATags = TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  AATags = AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a6b173e97523275314f3f2b433a5f71a9">merge</a>(StoreAATags);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> CI = dyn_cast&lt;ConstantInt&gt;(NumBytes))</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    AATags = AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#abc415418337d16a2b07a2b8ab6e8dc36">extendTo</a>(CI-&gt;getZExtValue());</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    AATags = AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#abc415418337d16a2b07a2b8ab6e8dc36">extendTo</a>(-1);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCall = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">// Check whether to generate an unordered atomic memcpy:</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">//  If the load or store are atomic, then they must necessarily be unordered</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">//  by previous checks.</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="keywordflow">if</span> (!TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>() &amp;&amp; !TheLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>()) {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (UseMemMove)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      NewCall = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemMove(</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          StoreBasePtr, StoreAlign, LoadBasePtr, LoadAlign, NumBytes,</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;          <span class="comment">/*isVolatile=*/</span><span class="keyword">false</span>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a56188042f9dd6003cb8ed087e8ae654f">TBAA</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5175e1defb539f65df5ded7a806fa5c8">Scope</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a81f3c11f463009d8b19b544f5bfed40c">NoAlias</a>);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      NewCall =</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemCpy(StoreBasePtr, StoreAlign, LoadBasePtr, LoadAlign,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                               NumBytes, <span class="comment">/*isVolatile=*/</span><span class="keyword">false</span>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a56188042f9dd6003cb8ed087e8ae654f">TBAA</a>,</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                               AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a4831dbe1cbfb8f0e07600bf890af8353">TBAAStruct</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5175e1defb539f65df5ded7a806fa5c8">Scope</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a81f3c11f463009d8b19b544f5bfed40c">NoAlias</a>);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="comment">// For now don&#39;t support unordered atomic memmove.</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">if</span> (UseMemMove)</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">// We cannot allow unaligned ops for unordered load/store, so reject</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// anything where the alignment isn&#39;t at least the element size.</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((StoreAlign &amp;&amp; LoadAlign) &amp;&amp;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;           <span class="stringliteral">&quot;Expect unordered load/store to have align.&quot;</span>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">if</span> (*StoreAlign &lt; StoreSize || *LoadAlign &lt; StoreSize)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">// If the element.atomic memcpy is not lowered into explicit</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">// loads/stores later, then it will be lowered into an element-size</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">// specific lib call. If the lib call doesn&#39;t exist for our store size, then</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">// we shouldn&#39;t generate the memcpy.</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">if</span> (StoreSize &gt; <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a422b020a05731c432411d574a7728af5">getAtomicMemIntrinsicMaxElementSize</a>())</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// Create the call.</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">// Note that unordered atomic loads/stores are *required* by the spec to</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">// have an alignment but non-atomic loads/stores may not.</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    NewCall = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateElementUnorderedAtomicMemCpy(</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        StoreBasePtr, *StoreAlign, LoadBasePtr, *LoadAlign, NumBytes, StoreSize,</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a56188042f9dd6003cb8ed087e8ae654f">TBAA</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a4831dbe1cbfb8f0e07600bf890af8353">TBAAStruct</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5175e1defb539f65df5ded7a806fa5c8">Scope</a>, AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a81f3c11f463009d8b19b544f5bfed40c">NoAlias</a>);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  NewCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordflow">if</span> (MSSAU) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *NewMemAcc = MSSAU-&gt;createMemoryAccessInBB(</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        NewCall, <span class="keyword">nullptr</span>, NewCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), <a class="code" href="classllvm_1_1MemorySSA.html#a9773fde54683945b9e34a0f2e5c1a5a5a7806c120eb87aea9fbb52fed327e09de">MemorySSA::BeforeTerminator</a>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    MSSAU-&gt;insertDef(cast&lt;MemoryDef&gt;(NewMemAcc), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Formed new call: &quot;</span> &lt;&lt; *NewCall &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;    from load ptr=&quot;</span> &lt;&lt; *LoadEv &lt;&lt; <span class="stringliteral">&quot; at: &quot;</span> &lt;&lt; *TheLoad</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;    from store ptr=&quot;</span> &lt;&lt; *StoreEv &lt;&lt; <span class="stringliteral">&quot; at: &quot;</span> &lt;&lt; *TheStore</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;ProcessLoopStoreOfLoopLoad&quot;</span>,</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                              NewCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>(), Preheader)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;Formed a call to &quot;</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;           &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;NewFunction&quot;</span>, NewCall-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>())</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;() intrinsic from &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Inst&quot;</span>, InstRemark)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; instruction in &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Function&quot;</span>, TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>())</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; function&quot;</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;           &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a177844335152e882e8ac429dd1102716">ore::setExtraArgs</a>()</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;           &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;FromBlock&quot;</span>, TheStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>())</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;           &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;ToBlock&quot;</span>, Preheader-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  });</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">// Okay, a new call to memcpy/memmove has been formed.  Zap the original store</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// and anything that feeds into it.</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordflow">if</span> (MSSAU)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    MSSAU-&gt;removeMemoryAccess(TheStore, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <a class="code" href="LoopIdiomRecognize_8cpp.html#aebc62faf59fecc07e8471fcf035d789e">deleteDeadInstruction</a>(TheStore);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">if</span> (MSSAU &amp;&amp; <a class="code" href="namespacellvm.html#aa29fe161c408879ada30c90ebbf55dcf">VerifyMemorySSA</a>)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    MSSAU-&gt;getMemorySSA()-&gt;verifyMemorySSA();</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">if</span> (UseMemMove)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    ++NumMemMove;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    ++NumMemCpy;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  ExpCleaner.markResultUsed();</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;}</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">// When compiling for codesize we avoid idiom recognition for a multi-block loop</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">// unless it is a loop_memset idiom or a memset/memcpy idiom in a nested loop.</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="keywordtype">bool</span> LoopIdiomRecognize::avoidLIRForMultiBlockLoop(<span class="keywordtype">bool</span> IsMemset,</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                                   <span class="keywordtype">bool</span> IsLoopMemset) {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="keywordflow">if</span> (ApplyCodeSizeHeuristics &amp;&amp; CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a261ee3c4745564c7be9283984c9af06b">getNumBlocks</a>() &gt; 1) {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">if</span> (CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a0fa33dfd6ffaaae721fc05b6941263aa">isOutermost</a>() &amp;&amp; (!IsMemset || !IsLoopMemset)) {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; : LIR &quot;</span> &lt;&lt; (IsMemset ? <span class="stringliteral">&quot;Memset&quot;</span> : <span class="stringliteral">&quot;Memcpy&quot;</span>)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; avoided: multi-block top-level loop\n&quot;</span>);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;}</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="keywordtype">bool</span> LoopIdiomRecognize::runOnNoncountableLoop() {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Scanning: F[&quot;</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                    &lt;&lt; CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;] Noncountable Loop %&quot;</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                    &lt;&lt; CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="keywordflow">return</span> recognizePopcount() || recognizeAndInsertFFS() ||</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;         recognizeShiftUntilBitTest() || recognizeShiftUntilZero();</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;}</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">/// Check if the given conditional branch is based on the comparison between</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">/// a variable and zero, and if the variable is non-zero or zero (JmpOnZero is</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">/// true), the control yields to the loop entry. If the branch matches the</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">/// behavior, the variable involved in the comparison is returned. This function</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">/// will be called to see if the precondition and postcondition of the loop are</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">/// in desirable form.</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c"> 1579</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c">matchCondition</a>(<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopEntry,</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                             <span class="keywordtype">bool</span> JmpOnZero = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="keywordflow">if</span> (!BI || !BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>())</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = dyn_cast&lt;ICmpInst&gt;(BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">getCondition</a>());</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>)</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CmpZero = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>-&gt;getOperand(1));</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (!CmpZero || !CmpZero-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>())</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *TrueSucc = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FalseSucc = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">if</span> (JmpOnZero)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(TrueSucc, FalseSucc);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred = <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>-&gt;getPredicate();</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">if</span> ((Pred == <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a> &amp;&amp; TrueSucc == LoopEntry) ||</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      (Pred == <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">ICmpInst::ICMP_EQ</a> &amp;&amp; FalseSucc == LoopEntry))</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">// Check if the recurrence variable `VarX` is in the right form to create</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">// the idiom. Returns the value coerced to a PHINode if so.</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36"> 1607</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36">getRecurrenceVar</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *VarX, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DefX,</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                 <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopEntry) {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keyword">auto</span> *PhiX = dyn_cast&lt;PHINode&gt;(VarX);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keywordflow">if</span> (PhiX &amp;&amp; PhiX-&gt;getParent() == LoopEntry &amp;&amp;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      (PhiX-&gt;getOperand(0) == DefX || PhiX-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1) == DefX))</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">return</span> PhiX;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;}</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">/// Return true iff the idiom is detected in the loop.</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">/// Additionally:</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">/// 1) \p CntInst is set to the instruction counting the population bit.</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">/// 2) \p CntPhi is set to the corresponding phi node.</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">/// 3) \p Var is set to the value whose population bits are being counted.</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">/// The core idiom we are trying to detect is:</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">///    if (x0 != 0)</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">///      goto loop-exit // the precondition of the loop</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">///    cnt0 = init-val;</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">///    do {</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment">///       x1 = phi (x0, x2);</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">///       cnt1 = phi(cnt0, cnt2);</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">///       cnt2 = cnt1 + 1;</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">///        ...</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">///       x2 = x1 &amp; (x1 - 1);</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">///        ...</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">///    } while(x != 0);</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">/// loop-exit:</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a48f061a53492f73dc9d82812f4350b44"> 1640</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#a48f061a53492f73dc9d82812f4350b44">detectPopcountIdiom</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreCondBB,</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                                <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;CntInst, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *&amp;CntPhi,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Var) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="comment">// step 1: Check to see if the look-back branch match this pattern:</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="comment">//    &quot;if (a!=0) goto loop-entry&quot;.</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopEntry;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DefX2, *CountInst;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VarX1, *VarX0;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PhiX, *CountPhi;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  DefX2 = CountInst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  VarX1 = VarX0 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  PhiX = CountPhi = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  LoopEntry = *(CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af9096a02aa326d9a55f4d16ba9f9d243">block_begin</a>());</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">// step 1: Check if the loop-back branch is in desirable form.</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classT.html">T</a> = <a class="code" href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c">matchCondition</a>(</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            dyn_cast&lt;BranchInst&gt;(LoopEntry-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()), LoopEntry))</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      DefX2 = dyn_cast&lt;Instruction&gt;(<a class="code" href="classT.html">T</a>);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="comment">// step 2: detect instructions corresponding to &quot;x2 = x1 &amp; (x1 - 1)&quot;</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">if</span> (!DefX2 || DefX2-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != Instruction::And)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *SubOneOp;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">if</span> ((SubOneOp = dyn_cast&lt;BinaryOperator&gt;(DefX2-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0))))</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      VarX1 = DefX2-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      VarX1 = DefX2-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      SubOneOp = dyn_cast&lt;BinaryOperator&gt;(DefX2-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="keywordflow">if</span> (!SubOneOp || SubOneOp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) != VarX1)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Dec = dyn_cast&lt;ConstantInt&gt;(SubOneOp-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordflow">if</span> (!Dec ||</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        !((SubOneOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() == Instruction::Sub &amp;&amp; Dec-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">isOne</a>()) ||</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          (SubOneOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() == <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> &amp;&amp;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;           Dec-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a13cc1f5d3225f4ec063520a747acec4c">isMinusOne</a>()))) {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="comment">// step 3: Check the recurrence of variable X</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  PhiX = <a class="code" href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36">getRecurrenceVar</a>(VarX1, DefX2, LoopEntry);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordflow">if</span> (!PhiX)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="comment">// step 4: Find the instruction which count the population: cnt2 = cnt1 + 1</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    CountInst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a>(</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;             LoopEntry-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>()-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>(), LoopEntry-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>())) {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordflow">if</span> (Inst.<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Inc = dyn_cast&lt;ConstantInt&gt;(Inst.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">if</span> (!Inc || !Inc-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">isOne</a>())</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = <a class="code" href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36">getRecurrenceVar</a>(Inst.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), &amp;Inst, LoopEntry);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="keywordflow">if</span> (!Phi)</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="comment">// Check if the result of the instruction is live of the loop.</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keywordtype">bool</span> LiveOutLoop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : Inst.<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="keywordflow">if</span> ((cast&lt;Instruction&gt;(U))-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>() != LoopEntry) {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;          LiveOutLoop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordflow">if</span> (LiveOutLoop) {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        CountInst = &amp;Inst;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        CountPhi = Phi;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> (!CountInst)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// step 5: check if the precondition is in this form:</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="comment">//   &quot;if (x != 0) goto loop-head ; else goto somewhere-we-don&#39;t-care;&quot;</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keyword">auto</span> *PreCondBr = dyn_cast&lt;BranchInst&gt;(PreCondBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classT.html">T</a> = <a class="code" href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c">matchCondition</a>(PreCondBr, CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>());</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a> != PhiX-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) &amp;&amp; <a class="code" href="classT.html">T</a> != PhiX-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    CntInst = CountInst;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    CntPhi = CountPhi;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    Var = <a class="code" href="classT.html">T</a>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;}</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">/// Return true if the idiom is detected in the loop.</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">/// Additionally:</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">/// 1) \p CntInst is set to the instruction Counting Leading Zeros (CTLZ)</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">///       or nullptr if there is no such.</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">/// 2) \p CntPhi is set to the corresponding phi node</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">///       or nullptr if there is no such.</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">/// 3) \p Var is set to the value whose CTLZ could be used.</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">/// 4) \p DefX is set to the instruction calculating Loop exit condition.</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">/// The core idiom we are trying to detect is:</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">///    if (x0 == 0)</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">///      goto loop-exit // the precondition of the loop</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">///    cnt0 = init-val;</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">///    do {</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">///       x = phi (x0, x.next);   //PhiX</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment">///       cnt = phi(cnt0, cnt.next);</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="comment">///       cnt.next = cnt + 1;</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">///        ...</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">///       x.next = x &gt;&gt; 1;   // DefX</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">///        ...</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">///    } while(x.next != 0);</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">/// loop-exit:</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a7ff0d8853961745bbe8afef66fab99dc"> 1773</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#a7ff0d8853961745bbe8afef66fab99dc">detectShiftUntilZeroIdiom</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                                      <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> &amp;IntrinID, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;InitX,</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                                      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;CntInst, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *&amp;CntPhi,</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;DefX) {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopEntry;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *VarX = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  DefX = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  CntInst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  CntPhi = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  LoopEntry = *(CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af9096a02aa326d9a55f4d16ba9f9d243">block_begin</a>());</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="comment">// step 1: Check if the loop-back branch is in desirable form.</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classT.html">T</a> = <a class="code" href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c">matchCondition</a>(</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;          dyn_cast&lt;BranchInst&gt;(LoopEntry-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()), LoopEntry))</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    DefX = dyn_cast&lt;Instruction&gt;(<a class="code" href="classT.html">T</a>);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="comment">// step 2: detect instructions corresponding to &quot;x.next = x &gt;&gt; 1 or x &lt;&lt; 1&quot;</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">if</span> (!DefX || !DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ac5984d6827f6e6922bed00bf03ba9552">isShift</a>())</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  IntrinID = DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::Shl ? Intrinsic::cttz :</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                                     Intrinsic::ctlz;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Shft = dyn_cast&lt;ConstantInt&gt;(DefX-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">if</span> (!Shft || !Shft-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">isOne</a>())</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  VarX = DefX-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="comment">// step 3: Check the recurrence of variable X</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PhiX = <a class="code" href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36">getRecurrenceVar</a>(VarX, DefX, LoopEntry);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">if</span> (!PhiX)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  InitX = PhiX-&gt;<a class="code" href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">getIncomingValueForBlock</a>(CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>());</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="comment">// Make sure the initial value can&#39;t be negative otherwise the ashr in the</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="comment">// loop might never reach zero which would make the loop infinite.</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">if</span> (DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::AShr &amp;&amp; !<a class="code" href="namespacellvm.html#ac0be0d93ccd89dac00411b3a5a8bef87">isKnownNonNegative</a>(InitX, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">// step 4: Find the instruction which count the CTLZ: cnt.next = cnt + 1</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="comment">//         or cnt.next = cnt + -1.</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">// TODO: We can skip the step. If loop trip count is known (CTLZ),</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="comment">//       then all uses of &quot;cnt.next&quot; could be optimized to the trip count</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="comment">//       plus &quot;cnt0&quot;. Currently it is not optimized.</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="comment">//       This step could be used to detect POPCNT instruction:</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">//       cnt.next = cnt + (x.next &amp; 1)</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a>(</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;           LoopEntry-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>()-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>(), LoopEntry-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>())) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="keywordflow">if</span> (Inst.<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a>)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Inc = dyn_cast&lt;ConstantInt&gt;(Inst.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordflow">if</span> (!Inc || (!Inc-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">isOne</a>() &amp;&amp; !Inc-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a13cc1f5d3225f4ec063520a747acec4c">isMinusOne</a>()))</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi = <a class="code" href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36">getRecurrenceVar</a>(Inst.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), &amp;Inst, LoopEntry);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">if</span> (!Phi)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; </div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    CntInst = &amp;Inst;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    CntPhi = Phi;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keywordflow">if</span> (!CntInst)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;}</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">/// Recognize CTLZ or CTTZ idiom in a non-countable loop and convert the loop</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">/// to countable (with CTLZ / CTTZ trip count). If CTLZ / CTTZ inserted as a new</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">/// trip count returns true; otherwise, returns false.</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::recognizeAndInsertFFS() {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="comment">// Give up if the loop has multiple blocks or multiple backedges.</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="keywordflow">if</span> (CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">getNumBackEdges</a>() != 1 || CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a261ee3c4745564c7be9283984c9af06b">getNumBlocks</a>() != 1)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IntrinID;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *InitX;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DefX = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CntPhi = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CntInst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="comment">// Help decide if transformation is profitable. For ShiftUntilZero idiom,</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="comment">// this is always 6.</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordtype">size_t</span> IdiomCanonicalSize = 6;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopIdiomRecognize_8cpp.html#a7ff0d8853961745bbe8afef66fab99dc">detectShiftUntilZeroIdiom</a>(CurLoop, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IntrinID, InitX,</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                                 CntInst, CntPhi, DefX))</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; </div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="keywordtype">bool</span> IsCntPhiUsedOutsideLoop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : CntPhi-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="keywordflow">if</span> (!CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(cast&lt;Instruction&gt;(U))) {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      IsCntPhiUsedOutsideLoop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="keywordtype">bool</span> IsCntInstUsedOutsideLoop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : CntInst-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">if</span> (!CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(cast&lt;Instruction&gt;(U))) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      IsCntInstUsedOutsideLoop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="comment">// If both CntInst and CntPhi are used outside the loop the profitability</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="comment">// is questionable.</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="keywordflow">if</span> (IsCntInstUsedOutsideLoop &amp;&amp; IsCntPhiUsedOutsideLoop)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="comment">// For some CPUs result of CTLZ(X) intrinsic is undefined</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="comment">// when X is 0. If we can not guarantee X != 0, we need to check this</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="comment">// when expand.</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <span class="keywordtype">bool</span> ZeroCheck = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="comment">// It is safe to assume Preheader exist as it was checked in</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="comment">// parent function RunOnLoop.</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PH = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="comment">// If we are using the count instruction outside the loop, make sure we</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="comment">// have a zero check as a precondition. Without the check the loop would run</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <span class="comment">// one iteration for before any check of the input value. This means 0 and 1</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="comment">// would have identical behavior in the original loop and thus</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordflow">if</span> (!IsCntPhiUsedOutsideLoop) {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keyword">auto</span> *PreCondBB = PH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (!PreCondBB)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keyword">auto</span> *PreCondBI = dyn_cast&lt;BranchInst&gt;(PreCondBB-&gt;getTerminator());</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">if</span> (!PreCondBI)</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c">matchCondition</a>(PreCondBI, PH) != InitX)</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    ZeroCheck = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="comment">// Check if CTLZ / CTTZ intrinsic is profitable. Assume it is always</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  <span class="comment">// profitable if we delete the loop.</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <span class="comment">// the loop has only 6 instructions:</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="comment">//  %n.addr.0 = phi [ %n, %entry ], [ %shr, %while.cond ]</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="comment">//  %i.0 = phi [ %i0, %entry ], [ %inc, %while.cond ]</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <span class="comment">//  %shr = ashr %n.addr.0, 1</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <span class="comment">//  %tobool = icmp eq %shr, 0</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="comment">//  %inc = add nsw %i.0, 1</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <span class="comment">//  br i1 %tobool</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {InitX,</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                         <a class="code" href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">ConstantInt::getBool</a>(InitX-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), ZeroCheck)};</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="comment">// @llvm.dbg doesn&#39;t count as they have no semantic effect.</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keyword">auto</span> InstWithoutDebugIt = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a2069641f358ef416658a2f321ca19d74">instructionsWithoutDebug</a>();</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm_1_1BTF.html#a3b20e188bd3a15443a74fc637b6aed33a4af5f992bdc47a779c499ffc6fdcaf43">HeaderSize</a> =</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      std::distance(InstWithoutDebugIt.begin(), InstWithoutDebugIt.end());</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <a class="code" href="classllvm_1_1IntrinsicCostAttributes.html">IntrinsicCostAttributes</a> <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>(IntrinID, InitX-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> =</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a4218f47749d093473e680ad0199fb239">getIntrinsicInstrCost</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1BTF.html#a3b20e188bd3a15443a74fc637b6aed33a4af5f992bdc47a779c499ffc6fdcaf43">HeaderSize</a> != IdiomCanonicalSize &amp;&amp;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      Cost &gt; <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">TargetTransformInfo::TCC_Basic</a>)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  transformLoopToCountable(IntrinID, PH, CntInst, CntPhi, InitX, DefX,</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                           DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>(), ZeroCheck,</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                           IsCntPhiUsedOutsideLoop);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;}</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">/// Recognizes a population count idiom in a non-countable loop.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">/// If detected, transforms the relevant code to issue the popcount intrinsic</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">/// function call, and returns true; otherwise, returns false.</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::recognizePopcount() {</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a6480799b120b617b9b34f1313afe6661">getPopcntSupport</a>(32) != <a class="code" href="classllvm_1_1TargetTransformInfo.html#aa4c17e89b1ef061ed69f42b7cee93dbeac71465fd61f1ba8aa2c7c397722b5e05">TargetTransformInfo::PSK_FastHardware</a>)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <span class="comment">// Counting population are usually conducted by few arithmetic instructions.</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="comment">// Such instructions can be easily &quot;absorbed&quot; by vacant slots in a</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="comment">// non-compact loop. Therefore, recognizing popcount idiom only makes sense</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="comment">// in a compact loop.</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="comment">// Give up if the loop has multiple blocks or multiple backedges.</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="keywordflow">if</span> (CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">getNumBackEdges</a>() != 1 || CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a261ee3c4745564c7be9283984c9af06b">getNumBlocks</a>() != 1)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopBody = *(CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af9096a02aa326d9a55f4d16ba9f9d243">block_begin</a>());</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">if</span> (LoopBody-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">size</a>() &gt;= 20) {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// The loop is too big, bail out.</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="comment">// It should have a preheader containing nothing but an unconditional branch.</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PH = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">if</span> (!PH || &amp;PH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>() != PH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keyword">auto</span> *EntryBI = dyn_cast&lt;BranchInst&gt;(PH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <span class="keywordflow">if</span> (!EntryBI || EntryBI-&gt;isConditional())</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="comment">// It should have a precondition block where the generated popcount intrinsic</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="comment">// function can be inserted.</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keyword">auto</span> *PreCondBB = PH-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="keywordflow">if</span> (!PreCondBB)</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="keyword">auto</span> *PreCondBI = dyn_cast&lt;BranchInst&gt;(PreCondBB-&gt;getTerminator());</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="keywordflow">if</span> (!PreCondBI || PreCondBI-&gt;isUnconditional())</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CntInst;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CntPhi;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Val;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopIdiomRecognize_8cpp.html#a48f061a53492f73dc9d82812f4350b44">detectPopcountIdiom</a>(CurLoop, PreCondBB, CntInst, CntPhi, Val))</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  transformLoopToPopcount(PreCondBB, CntInst, CntPhi, Val);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;}</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a981d06c604c92a3b7845343de8c04471"> 1988</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#a981d06c604c92a3b7845343de8c04471">createPopcntIntrinsic</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *Val,</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Ops[] = {Val};</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Tys[] = {Val-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()};</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#ae3f9633c349ede5341aa376d9c97dd8f">GetInsertBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *Func = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::ctpop, Tys);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a31c5c58143c6e9da9c544a7afcba2710">CreateCall</a>(Func, Ops);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keywordflow">return</span> CI;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;}</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a450f245604b777ad6722de8c2c0caff9"> 2001</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="LoopIdiomRecognize_8cpp.html#a450f245604b777ad6722de8c2c0caff9">createFFSIntrinsic</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *Val,</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="keywordtype">bool</span> ZeroCheck,</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                                    <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IID) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Ops[] = {Val, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a7c1fb40f1a3dd18bf3a2527e5aa0ed59">getInt1</a>(ZeroCheck)};</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Tys[] = {Val-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()};</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#ae3f9633c349ede5341aa376d9c97dd8f">GetInsertBlock</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *Func = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, IID, Tys);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a31c5c58143c6e9da9c544a7afcba2710">CreateCall</a>(Func, Ops);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keywordflow">return</span> CI;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;}</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">/// Transform the following loop (Using CTLZ, CTTZ is similar):</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">/// loop:</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">///   CntPhi = PHI [Cnt0, CntInst]</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">///   PhiX = PHI [InitX, DefX]</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">///   CntInst = CntPhi + 1</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">///   DefX = PhiX &gt;&gt; 1</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">///   LOOP_BODY</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">///   Br: loop if (DefX != 0)</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">/// Use(CntPhi) or Use(CntInst)</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">/// Into:</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">/// If CntPhi used outside the loop:</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">///   CountPrev = BitWidth(InitX) - CTLZ(InitX &gt;&gt; 1)</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">///   Count = CountPrev + 1</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">/// else</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">///   Count = BitWidth(InitX) - CTLZ(InitX)</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">/// loop:</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">///   CntPhi = PHI [Cnt0, CntInst]</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">///   PhiX = PHI [InitX, DefX]</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">///   PhiCount = PHI [Count, Dec]</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">///   CntInst = CntPhi + 1</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">///   DefX = PhiX &gt;&gt; 1</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">///   Dec = PhiCount - 1</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">///   LOOP_BODY</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">///   Br: loop if (Dec != 0)</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">/// Use(CountPrev + Cnt0) // Use(CntPhi)</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">/// or</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">/// Use(Count + Cnt0) // Use(CntInst)</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">/// If LOOP_BODY is empty the loop will be deleted.</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">/// If CntInst and DefX are not used in LOOP_BODY they will be removed.</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> LoopIdiomRecognize::transformLoopToCountable(</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IntrinID, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Preheader, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CntInst,</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CntPhi, <a class="code" href="classllvm_1_1Value.html">Value</a> *InitX, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DefX, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordtype">bool</span> ZeroCheck, <span class="keywordtype">bool</span> IsCntPhiUsedOutsideLoop) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *PreheaderBr = cast&lt;BranchInst&gt;(Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">// Step 1: Insert the CTLZ/CTTZ instruction at the end of the preheader block</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(PreheaderBr);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="comment">// If there are no uses of CntPhi crate:</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">//   Count = BitWidth - CTLZ(InitX);</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="comment">//   NewCount = Count;</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">// If there are uses of CntPhi create:</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">//   NewCount = BitWidth - CTLZ(InitX &gt;&gt; 1);</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="comment">//   Count = NewCount + 1;</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *InitXNext;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="keywordflow">if</span> (IsCntPhiUsedOutsideLoop) {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">if</span> (DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::AShr)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      InitXNext = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(InitX, 1);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::LShr)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      InitXNext = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(InitX, 1);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DefX-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::Shl) <span class="comment">// cttz</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      InitXNext = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(InitX, 1);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected opcode!&quot;</span>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    InitXNext = InitX;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Count =</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <a class="code" href="LoopIdiomRecognize_8cpp.html#a450f245604b777ad6722de8c2c0caff9">createFFSIntrinsic</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, InitXNext, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ZeroCheck, IntrinID);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CountTy = Count-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  Count = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CountTy, CountTy-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>()), Count);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewCount = Count;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="keywordflow">if</span> (IsCntPhiUsedOutsideLoop)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    Count = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(Count, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CountTy, 1));</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  NewCount = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExtOrTrunc(NewCount, CntInst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CntInitVal = CntPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">getIncomingValueForBlock</a>(Preheader);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordflow">if</span> (cast&lt;ConstantInt&gt;(CntInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))-&gt;isOne()) {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="comment">// If the counter was being incremented in the loop, add NewCount to the</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="comment">// counter&#39;s initial value, but only if the initial value is not zero.</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *InitConst = dyn_cast&lt;ConstantInt&gt;(CntInitVal);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">if</span> (!InitConst || !InitConst-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>())</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      NewCount = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(NewCount, CntInitVal);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">// If the count was being decremented in the loop, subtract NewCount from</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">// the counter&#39;s initial value.</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    NewCount = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(CntInitVal, NewCount);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="comment">// Step 2: Insert new IV and loop condition:</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="comment">// loop:</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">//   ...</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="comment">//   PhiCount = PHI [Count, Dec]</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="comment">//   ...</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="comment">//   Dec = PhiCount - 1</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <span class="comment">//   ...</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="comment">//   Br: loop if (Dec != 0)</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Body = *(CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af9096a02aa326d9a55f4d16ba9f9d243">block_begin</a>());</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="keyword">auto</span> *LbBr = cast&lt;BranchInst&gt;(Body-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *LbCond = cast&lt;ICmpInst&gt;(LbBr-&gt;getCondition());</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *TcPhi = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(CountTy, 2, <span class="stringliteral">&quot;tcphi&quot;</span>, &amp;Body-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(LbCond);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TcDec = cast&lt;Instruction&gt;(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      TcPhi, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CountTy, 1), <span class="stringliteral">&quot;tcdec&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  TcPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(Count, Preheader);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  TcPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(TcDec, Body);</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred =</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      (LbBr-&gt;getSuccessor(0) == Body) ? <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP_NE</a> : <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP_EQ</a>;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  LbCond-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">setPredicate</a>(Pred);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  LbCond-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, TcDec);</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  LbCond-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CountTy, 0));</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160; </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="comment">// Step 3: All the references to the original counter outside</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="comment">//  the loop are replaced with the NewCount</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="keywordflow">if</span> (IsCntPhiUsedOutsideLoop)</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    CntPhi-&gt;<a class="code" href="classllvm_1_1Value.html#aa56e7093b552d99d48d66c5ae781236a">replaceUsesOutsideBlock</a>(NewCount, Body);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    CntInst-&gt;<a class="code" href="classllvm_1_1Value.html#aa56e7093b552d99d48d66c5ae781236a">replaceUsesOutsideBlock</a>(NewCount, Body);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="comment">// step 4: Forget the &quot;non-computable&quot; trip-count SCEV associated with the</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="comment">//   loop. The loop would otherwise not be deleted even if it becomes empty.</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(CurLoop);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;}</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="keywordtype">void</span> LoopIdiomRecognize::transformLoopToPopcount(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreCondBB,</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                                                 <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CntInst,</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                                                 <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CntPhi, <a class="code" href="classllvm_1_1Value.html">Value</a> *Var) {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreHead = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="keyword">auto</span> *PreCondBr = cast&lt;BranchInst&gt;(PreCondBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = CntInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>();</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="comment">// Assuming before transformation, the loop is following:</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="comment">//  if (x) // the precondition</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="comment">//     do { cnt++; x &amp;= x - 1; } while(x);</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="comment">// Step 1: Insert the ctpop instruction at the end of the precondition block</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(PreCondBr);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *PopCnt, *PopCntZext, *NewCount, *TripCnt;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    PopCnt = <a class="code" href="LoopIdiomRecognize_8cpp.html#a981d06c604c92a3b7845343de8c04471">createPopcntIntrinsic</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Var, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    NewCount = PopCntZext =</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExtOrTrunc(PopCnt, cast&lt;IntegerType&gt;(CntPhi-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">if</span> (NewCount != PopCnt)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      (cast&lt;Instruction&gt;(NewCount))-&gt;setDebugLoc(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">// TripCnt is exactly the number of iterations the loop has</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    TripCnt = NewCount;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">// If the population counter&#39;s initial value is not zero, insert Add Inst.</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *CntInitVal = CntPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">getIncomingValueForBlock</a>(PreHead);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *InitConst = dyn_cast&lt;ConstantInt&gt;(CntInitVal);</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="keywordflow">if</span> (!InitConst || !InitConst-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>()) {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      NewCount = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(NewCount, CntInitVal);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      (cast&lt;Instruction&gt;(NewCount))-&gt;setDebugLoc(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  }</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="comment">// Step 2: Replace the precondition from &quot;if (x == 0) goto loop-exit&quot; to</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="comment">//   &quot;if (NewCount == 0) loop-exit&quot;. Without this change, the intrinsic</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="comment">//   function would be partial dead code, and downstream passes will drag</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="comment">//   it back from the precondition block to the preheader.</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  {</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *PreCond = cast&lt;ICmpInst&gt;(PreCondBr-&gt;getCondition());</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Opnd0 = PopCntZext;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Opnd1 = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(PopCntZext-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">if</span> (PreCond-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0) != Var)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Opnd0, Opnd1);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *NewPreCond = cast&lt;ICmpInst&gt;(</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmp(PreCond-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>(), Opnd0, Opnd1));</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    PreCondBr-&gt;setCondition(NewPreCond);</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <a class="code" href="namespacellvm.html#a1106b8a15061e8494873e10bb8a364e5">RecursivelyDeleteTriviallyDeadInstructions</a>(PreCond, TLI);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  }</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <span class="comment">// Step 3: Note that the population count is exactly the trip count of the</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="comment">// loop in question, which enable us to convert the loop from noncountable</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  <span class="comment">// loop into a countable one. The benefit is twofold:</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="comment">//  - If the loop only counts population, the entire loop becomes dead after</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="comment">//    the transformation. It is a lot easier to prove a countable loop dead</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">//    than to prove a noncountable one. (In some C dialects, an infinite loop</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="comment">//    isn&#39;t dead even if it computes nothing useful. In general, DCE needs</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="comment">//    to prove a noncountable loop finite before safely delete it.)</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="comment">//  - If the loop also performs something else, it remains alive.</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="comment">//    Since it is transformed to countable form, it can be aggressively</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="comment">//    optimized by some optimizations which are in general not applicable</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="comment">//    to a noncountable loop.</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="comment">// After this step, this loop (conceptually) would look like following:</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  <span class="comment">//   newcnt = __builtin_ctpop(x);</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  <span class="comment">//   t = newcnt;</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="comment">//   if (x)</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="comment">//     do { cnt++; x &amp;= x-1; t--) } while (t &gt; 0);</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Body = *(CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af9096a02aa326d9a55f4d16ba9f9d243">block_begin</a>());</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  {</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keyword">auto</span> *LbBr = cast&lt;BranchInst&gt;(Body-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *LbCond = cast&lt;ICmpInst&gt;(LbBr-&gt;getCondition());</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = TripCnt-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *TcPhi = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(Ty, 2, <span class="stringliteral">&quot;tcphi&quot;</span>, &amp;Body-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(LbCond);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TcDec = cast&lt;Instruction&gt;(</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(TcPhi, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 1),</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                          <span class="stringliteral">&quot;tcdec&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    TcPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(TripCnt, PreHead);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    TcPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(TcDec, Body);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160; </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred =</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        (LbBr-&gt;getSuccessor(0) == Body) ? <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad">CmpInst::ICMP_UGT</a> : <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba2751d6136a2819749dcef65dc19a4246">CmpInst::ICMP_SLE</a>;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    LbCond-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">setPredicate</a>(Pred);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    LbCond-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, TcDec);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    LbCond-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 0));</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;  <span class="comment">// Step 4: All the references to the original population counter outside</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <span class="comment">//  the loop are replaced with the NewCount -- the value returned from</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  <span class="comment">//  __builtin_ctpop().</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  CntInst-&gt;<a class="code" href="classllvm_1_1Value.html#aa56e7093b552d99d48d66c5ae781236a">replaceUsesOutsideBlock</a>(NewCount, Body);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">// step 5: Forget the &quot;non-computable&quot; trip-count SCEV associated with the</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="comment">//   loop. The loop would otherwise not be deleted even if it becomes empty.</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(CurLoop);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;}</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">/// Match loop-invariant value.</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"><a class="line" href="structmatch__LoopInvariant.html"> 2244</a></span>&#160;<span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> SubPattern_t&gt; <span class="keyword">struct </span><a class="code" href="structmatch__LoopInvariant.html">match_LoopInvariant</a> {</div>
<div class="line"><a name="l02245"></a><span class="lineno"><a class="line" href="structmatch__LoopInvariant.html#ab80c6bca262e3acb5a845956ee23ebe0"> 2245</a></span>&#160;  SubPattern_t <a class="code" href="structmatch__LoopInvariant.html#ab80c6bca262e3acb5a845956ee23ebe0">SubPattern</a>;</div>
<div class="line"><a name="l02246"></a><span class="lineno"><a class="line" href="structmatch__LoopInvariant.html#ab4196b7cec294de605709d4e2f7bdca8"> 2246</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *<a class="code" href="structmatch__LoopInvariant.html#ab4196b7cec294de605709d4e2f7bdca8">L</a>;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"><a class="line" href="structmatch__LoopInvariant.html#a6f131444d55da7baae124947522860e5"> 2248</a></span>&#160;  <a class="code" href="structmatch__LoopInvariant.html#a6f131444d55da7baae124947522860e5">match_LoopInvariant</a>(<span class="keyword">const</span> SubPattern_t &amp;SP, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L)</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      : SubPattern(SP), L(L) {}</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"><a class="line" href="structmatch__LoopInvariant.html#af1067ef7599d580590a21ba0dc9fd29b"> 2251</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ITy&gt; <span class="keywordtype">bool</span> <a class="code" href="structmatch__LoopInvariant.html#af1067ef7599d580590a21ba0dc9fd29b">match</a>(ITy *V) {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">return</span> L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(V) &amp;&amp; SubPattern.match(V);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;};</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">/// Matches if the value is loop-invariant.</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Ty&gt;</div>
<div class="line"><a name="l02258"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af"> 2258</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="structmatch__LoopInvariant.html">match_LoopInvariant&lt;Ty&gt;</a> <a class="code" href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af">m_LoopInvariant</a>(<span class="keyword">const</span> Ty &amp;M, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="structmatch__LoopInvariant.html">match_LoopInvariant&lt;Ty&gt;</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, L);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">/// Return true if the idiom is detected in the loop.</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">/// The core idiom we are trying to detect is:</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">///   entry:</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">///     %bitmask = shl i32 1, %bitpos</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">///     br label %loop</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">///   loop:</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">///     %x.curr = phi i32 [ %x, %entry ], [ %x.next, %loop ]</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">///     %x.curr.bitmasked = and i32 %x.curr, %bitmask</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">///     %x.curr.isbitunset = icmp eq i32 %x.curr.bitmasked, 0</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment">///     %x.next = shl i32 %x.curr, 1</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment">///     br i1 %x.curr.isbitunset, label %loop, label %end</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment">///   end:</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">///     %x.curr.res = phi i32 [ %x.curr, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment">///     %x.next.res = phi i32 [ %x.next, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#a419746e2bdc89fee0101b010a13ec0c7"> 2284</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#a419746e2bdc89fee0101b010a13ec0c7">detectShiftUntilBitTestIdiom</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;BaseX,</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                                         <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;BitMask, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;BitPos,</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                                         <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;CurrX, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;NextX) {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;             <span class="stringliteral">&quot; Performing shift-until-bittest idiom detection.\n&quot;</span>);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="comment">// Give up if the loop has multiple blocks or multiple backedges.</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keywordflow">if</span> (CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a261ee3c4745564c7be9283984c9af06b">getNumBlocks</a>() != 1 || CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">getNumBackEdges</a>() != 1) {</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad block/backedge count.\n&quot;</span>);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopHeaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPreheaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopPreheaderBB &amp;&amp; <span class="stringliteral">&quot;There is always a loop preheader.&quot;</span>);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160; </div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="comment">// Step 1: Check if the loop backedge is in desirable form.</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CmpLHS, *CmpRHS;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *TrueBB, *FalseBB;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>(),</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;             <a class="code" href="namespacellvm_1_1PatternMatch.html#a4fd27a44c5fd9958fdd9150622129cd3">m_Br</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a3fe9b3ddb71b9fb53d9fc74b3a0710bf">m_ICmp</a>(Pred, <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpLHS), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CmpRHS)),</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                  <a class="code" href="namespacellvm_1_1PatternMatch.html#acec0ee78d2266b990662e36784791999">m_BasicBlock</a>(TrueBB), <a class="code" href="namespacellvm_1_1PatternMatch.html#acec0ee78d2266b990662e36784791999">m_BasicBlock</a>(FalseBB)))) {</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad backedge structure.\n&quot;</span>);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  }</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="comment">// Step 2: Check if the backedge&#39;s condition is in desirable form.</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <span class="keyword">auto</span> MatchVariableBitMask = [&amp;]() {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">ICmpInst::isEquality</a>(Pred) &amp;&amp; <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CmpRHS, <a class="code" href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">m_Zero</a>()) &amp;&amp;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;           <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CmpLHS,</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                 <a class="code" href="namespacellvm_1_1PatternMatch.html#ae9d735be1ececf149966a4da253f0320">m_c_And</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CurrX),</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                         <a class="code" href="namespacellvm_1_1PatternMatch.html#a575c2299c6f145ba3a12efa20829db43">m_CombineAnd</a>(</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                             <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(BitMask),</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                             <a class="code" href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af">m_LoopInvariant</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">m_Shl</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(BitPos)),</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                                             CurLoop))));</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  };</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  <span class="keyword">auto</span> MatchConstantBitMask = [&amp;]() {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">ICmpInst::isEquality</a>(Pred) &amp;&amp; <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CmpRHS, <a class="code" href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">m_Zero</a>()) &amp;&amp;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;           <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CmpLHS, <a class="code" href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">m_And</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(CurrX),</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                               <a class="code" href="namespacellvm_1_1PatternMatch.html#a575c2299c6f145ba3a12efa20829db43">m_CombineAnd</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(BitMask), <a class="code" href="namespacellvm_1_1PatternMatch.html#ad5e60756e331a97669d11b5c9d8691a2">m_Power2</a>()))) &amp;&amp;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;           (BitPos = <a class="code" href="classllvm_1_1ConstantExpr.html#af46fd5126112a587bb12f09b1c0e385b">ConstantExpr::getExactLogBase2</a>(cast&lt;Constant&gt;(BitMask)));</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  };</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <span class="keyword">auto</span> MatchDecomposableConstantBitMask = [&amp;]() {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#ad4d2f143e181b60a4f70d791bbcba8b3">llvm::decomposeBitTestICmp</a>(CmpLHS, CmpRHS, Pred, CurrX, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) &amp;&amp;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;           <a class="code" href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">ICmpInst::isEquality</a>(Pred) &amp;&amp; <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.isPowerOf2() &amp;&amp;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;           (BitMask = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CurrX-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>)) &amp;&amp;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;           (BitPos = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CurrX-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.logBase2()));</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  };</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160; </div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">if</span> (!MatchVariableBitMask() &amp;&amp; !MatchConstantBitMask() &amp;&amp;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      !MatchDecomposableConstantBitMask()) {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad backedge comparison.\n&quot;</span>);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="comment">// Step 3: Check if the recurrence is in desirable form.</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keyword">auto</span> *CurrXPN = dyn_cast&lt;PHINode&gt;(CurrX);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="keywordflow">if</span> (!CurrXPN || CurrXPN-&gt;getParent() != LoopHeaderBB) {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Not an expected PHI node.\n&quot;</span>);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  }</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  BaseX = CurrXPN-&gt;getIncomingValueForBlock(LoopPreheaderBB);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  NextX =</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      dyn_cast&lt;Instruction&gt;(CurrXPN-&gt;getIncomingValueForBlock(LoopHeaderBB));</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(BaseX) &amp;&amp;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;         <span class="stringliteral">&quot;Expected BaseX to be avaliable in the preheader!&quot;</span>);</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <span class="keywordflow">if</span> (!NextX || !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(NextX, <a class="code" href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">m_Shl</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(CurrX), <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))) {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="comment">// FIXME: support right-shift?</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad recurrence.\n&quot;</span>);</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  <span class="comment">// Step 4: Check if the backedge&#39;s destinations are in desirable form.</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">ICmpInst::isEquality</a>(Pred) &amp;&amp;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;         <span class="stringliteral">&quot;Should only get equality predicates here.&quot;</span>);</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="comment">// cmp-br is commutative, so canonicalize to a single variant.</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  <span class="keywordflow">if</span> (Pred != ICmpInst::Predicate::ICMP_EQ) {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    Pred = <a class="code" href="classllvm_1_1CmpInst.html#aa2a54b545d237ecfe450fd1292f7675e">ICmpInst::getInversePredicate</a>(Pred);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(TrueBB, FalseBB);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="comment">// We expect to exit loop when comparison yields false,</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="comment">// so when it yields true we should branch back to loop header.</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="keywordflow">if</span> (TrueBB != LoopHeaderBB) {</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad backedge flow.\n&quot;</span>);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  }</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="comment">// Okay, idiom checks out.</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;}</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">/// Look for the following loop:</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">///   entry:</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">///     %bitmask = shl i32 1, %bitpos</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">///     br label %loop</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">///   loop:</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment">///     %x.curr = phi i32 [ %x, %entry ], [ %x.next, %loop ]</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">///     %x.curr.bitmasked = and i32 %x.curr, %bitmask</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">///     %x.curr.isbitunset = icmp eq i32 %x.curr.bitmasked, 0</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">///     %x.next = shl i32 %x.curr, 1</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">///     br i1 %x.curr.isbitunset, label %loop, label %end</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">///   end:</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">///     %x.curr.res = phi i32 [ %x.curr, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">///     %x.next.res = phi i32 [ %x.next, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">/// And transform it into:</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">///   entry:</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">///     %bitmask = shl i32 1, %bitpos</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">///     %lowbitmask = add i32 %bitmask, -1</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">///     %mask = or i32 %lowbitmask, %bitmask</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">///     %x.masked = and i32 %x, %mask</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">///     %x.masked.numleadingzeros = call i32 @llvm.ctlz.i32(i32 %x.masked,</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">///                                                         i1 true)</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">///     %x.masked.numactivebits = sub i32 32, %x.masked.numleadingzeros</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">///     %x.masked.leadingonepos = add i32 %x.masked.numactivebits, -1</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">///     %backedgetakencount = sub i32 %bitpos, %x.masked.leadingonepos</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">///     %tripcount = add i32 %backedgetakencount, 1</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">///     %x.curr = shl i32 %x, %backedgetakencount</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">///     %x.next = shl i32 %x, %tripcount</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">///     br label %loop</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">///   loop:</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">///     %loop.iv = phi i32 [ 0, %entry ], [ %loop.iv.next, %loop ]</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">///     %loop.iv.next = add nuw i32 %loop.iv, 1</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">///     %loop.ivcheck = icmp eq i32 %loop.iv.next, %tripcount</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">///     br i1 %loop.ivcheck, label %end, label %loop</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">///   end:</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">///     %x.curr.res = phi i32 [ %x.curr, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">///     %x.next.res = phi i32 [ %x.next, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::recognizeShiftUntilBitTest() {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, *BitMask, *BitPos, *XCurr;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *XNext;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopIdiomRecognize_8cpp.html#a419746e2bdc89fee0101b010a13ec0c7">detectShiftUntilBitTestIdiom</a>(CurLoop, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, BitMask, BitPos, XCurr,</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                                    XNext)) {</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;               <span class="stringliteral">&quot; shift-until-bittest idiom detection failed.\n&quot;</span>);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; shift-until-bittest idiom detected!\n&quot;</span>);</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">// Ok, it is the idiom we were looking for, we *could* transform this loop,</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">// but is it profitable to transform?</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160; </div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopHeaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPreheaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopPreheaderBB &amp;&amp; <span class="stringliteral">&quot;There is always a loop preheader.&quot;</span>);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuccessorBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>();</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuccessorBB &amp;&amp; <span class="stringliteral">&quot;There is only a single successor.&quot;</span>);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(LoopPreheaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(cast&lt;Instruction&gt;(XCurr)-&gt;<a class="code" href="MachineInstrBundle_8cpp.html#af44c9b089359803924e0b92bea3b6d03">getDebugLoc</a>());</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IntrID = Intrinsic::ctlz;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getType();</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keywordtype">unsigned</span> Bitwidth = Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>();</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TargetTransformInfo::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> =</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <span class="comment">// The rewrite is considered to be unprofitable iff and only iff the</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  <span class="comment">// intrinsic/shift we&#39;ll use are not cheap. Note that we are okay with *just*</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="comment">// making the loop countable, even if nothing else changes.</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <a class="code" href="classllvm_1_1IntrinsicCostAttributes.html">IntrinsicCostAttributes</a> <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>(</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      IntrID, Ty, {<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Ty), <span class="comment">/*is_zero_undef=*/</span><a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getTrue()});</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a4218f47749d093473e680ad0199fb239">getIntrinsicInstrCost</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="keywordflow">if</span> (Cost &gt; <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">TargetTransformInfo::TCC_Basic</a>) {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;               <span class="stringliteral">&quot; Intrinsic is too costly, not beneficial\n&quot;</span>);</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">getArithmeticInstrCost</a>(Instruction::Shl, Ty, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>) &gt;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">TargetTransformInfo::TCC_Basic</a>) {</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Shift is too costly, not beneficial\n&quot;</span>);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  <span class="comment">// Ok, transform appears worthwhile.</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <span class="comment">// Step 1: Compute the loop trip count.</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160; </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LowBitMask = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(BitMask, <a class="code" href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(Ty),</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                                        BitPos-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.lowbitmask&quot;</span>);</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> =</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateOr(LowBitMask, BitMask, BitPos-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.mask&quot;</span>);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *XMasked = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAnd(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getName() + <span class="stringliteral">&quot;.masked&quot;</span>);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *XMaskedNumLeadingZeros = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      IntrID, Ty, {XMasked, <span class="comment">/*is_zero_undef=*/</span><a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getTrue()},</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="comment">/*FMFSource=*/</span><span class="keyword">nullptr</span>, XMasked-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.numleadingzeros&quot;</span>);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *XMaskedNumActiveBits = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>()), XMaskedNumLeadingZeros,</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      XMasked-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.numactivebits&quot;</span>, <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>,</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="comment">/*HasNSW=*/</span>Bitwidth != 2);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *XMaskedLeadingOnePos =</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(XMaskedNumActiveBits, <a class="code" href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(Ty),</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                        XMasked-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.leadingonepos&quot;</span>, <span class="comment">/*HasNUW=*/</span><span class="keyword">false</span>,</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                        <span class="comment">/*HasNSW=*/</span>Bitwidth &gt; 2);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; </div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LoopBackedgeTakenCount = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      BitPos, XMaskedLeadingOnePos, CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.backedgetakencount&quot;</span>,</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>, <span class="comment">/*HasNSW=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;  <span class="comment">// We know loop&#39;s backedge-taken count, but what&#39;s loop&#39;s trip count?</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <span class="comment">// Note that while NUW is always safe, while NSW is only for bitwidths != 2.</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LoopTripCount =</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(LoopBackedgeTakenCount, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 1),</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                        CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.tripcount&quot;</span>, <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>,</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                        <span class="comment">/*HasNSW=*/</span>Bitwidth != 2);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  <span class="comment">// Step 2: Compute the recurrence&#39;s final value without a loop.</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;  <span class="comment">// NewX is always safe to compute, because `LoopBackedgeTakenCount`</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="comment">// will always be smaller than `bitwidth(X)`, i.e. we never get poison.</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewX = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, LoopBackedgeTakenCount);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  NewX-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(XCurr);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(NewX))</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;copyIRFlags(XNext, <span class="comment">/*IncludeWrapFlags=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewXNext;</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  <span class="comment">// Rewriting XNext is more complicated, however, because `X &lt;&lt; LoopTripCount`</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;  <span class="comment">// will be poison iff `LoopTripCount == bitwidth(X)` (which will happen</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;  <span class="comment">// iff `BitPos` is `bitwidth(x) - 1` and `X` is `1`). So unless we know</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  <span class="comment">// that isn&#39;t the case, we&#39;ll need to emit an alternative, safe IR.</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;  <span class="keywordflow">if</span> (XNext-&gt;<a class="code" href="classllvm_1_1Instruction.html#a350f4fdc01c770b5cf6a8be2624ae3e5">hasNoSignedWrap</a>() || XNext-&gt;<a class="code" href="classllvm_1_1Instruction.html#a100c666f9253331dd1d166a863248326">hasNoUnsignedWrap</a>() ||</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">PatternMatch::match</a>(</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;          BitPos, <a class="code" href="namespacellvm_1_1PatternMatch.html#abb22519fa3bf66d9e0bc6d1a733a5821">PatternMatch::m_SpecificInt_ICMP</a>(</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                      <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">ICmpInst::ICMP_NE</a>, <a class="code" href="classllvm_1_1APInt.html">APInt</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>(),</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                                               Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() - 1))))</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    NewXNext = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, LoopTripCount);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="comment">// Otherwise, just additionally shift by one. It&#39;s the smallest solution,</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="comment">// alternatively, we could check that NewX is INT_MIN (or BitPos is )</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="comment">// and select 0 instead.</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    NewXNext = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(NewX, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 1));</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  NewXNext-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(XNext);</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(NewXNext))</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;copyIRFlags(XNext, <span class="comment">/*IncludeWrapFlags=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  <span class="comment">// Step 3: Adjust the successor basic block to recieve the computed</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="comment">//         recurrence&#39;s final value instead of the recurrence itself.</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160; </div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  XCurr-&gt;<a class="code" href="classllvm_1_1Value.html#aa56e7093b552d99d48d66c5ae781236a">replaceUsesOutsideBlock</a>(NewX, LoopHeaderBB);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  XNext-&gt;<a class="code" href="classllvm_1_1Value.html#aa56e7093b552d99d48d66c5ae781236a">replaceUsesOutsideBlock</a>(NewXNext, LoopHeaderBB);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160; </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="comment">// Step 4: Rewrite the loop into a countable form, with canonical IV.</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  <span class="comment">// The new canonical induction variable.</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(Ty, 2, CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.iv&quot;</span>);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160; </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <span class="comment">// The induction itself.</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  <span class="comment">// Note that while NUW is always safe, while NSW is only for bitwidths != 2.</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="keyword">auto</span> *IVNext =</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 1), <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;getName() + <span class="stringliteral">&quot;.next&quot;</span>,</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                        <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>, <span class="comment">/*HasNSW=*/</span>Bitwidth != 2);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160; </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  <span class="comment">// The loop trip count check.</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  <span class="keyword">auto</span> *IVCheck = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpEQ(IVNext, LoopTripCount,</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                                       CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.ivcheck&quot;</span>);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCondBr(IVCheck, SuccessorBB, LoopHeaderBB);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="comment">// Populate the IV PHI.</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;addIncoming(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 0), LoopPreheaderBB);</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;addIncoming(IVNext, LoopHeaderBB);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  <span class="comment">// Step 5: Forget the &quot;non-computable&quot; trip-count SCEV associated with the</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  <span class="comment">//   loop. The loop would otherwise not be deleted even if it becomes empty.</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160; </div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(CurLoop);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; </div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;  <span class="comment">// Other passes will take care of actually deleting the loop if possible.</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; shift-until-bittest idiom optimized!\n&quot;</span>);</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  ++NumShiftUntilBitTest;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;}</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">/// Return true if the idiom is detected in the loop.</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment">/// The core idiom we are trying to detect is:</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment">///   entry:</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment">///     %start = &lt;...&gt;</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment">///     %extraoffset = &lt;...&gt;</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="comment">///     br label %for.cond</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment">///   loop:</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">///     %iv = phi i8 [ %start, %entry ], [ %iv.next, %for.cond ]</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment">///     %nbits = add nsw i8 %iv, %extraoffset</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">///     %val.shifted = {{l,a}shr,shl} i8 %val, %nbits</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">///     %val.shifted.iszero = icmp eq i8 %val.shifted, 0</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="comment">///     %iv.next = add i8 %iv, 1</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">///     br i1 %val.shifted.iszero, label %end, label %loop</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">///   end:</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="comment">///     %iv.res = phi i8 [ %iv, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="comment">///     %nbits.res = phi i8 [ %nbits, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">///     %val.shifted.res = phi i8 [ %val.shifted, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">///     %val.shifted.iszero.res = phi i1 [ %val.shifted.iszero, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="comment">///     %iv.next.res = phi i8 [ %iv.next, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"><a class="line" href="LoopIdiomRecognize_8cpp.html#ab329d363cb73927378483de592986282"> 2620</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopIdiomRecognize_8cpp.html#a7ff0d8853961745bbe8afef66fab99dc">detectShiftUntilZeroIdiom</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLoop, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                                      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;ValShiftedIsZero,</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                                      <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> &amp;IntrinID, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>,</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                                      <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Start, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Val,</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *&amp;ExtraOffsetExpr,</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                                      <span class="keywordtype">bool</span> &amp;InvertedCond) {</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;             <span class="stringliteral">&quot; Performing shift-until-zero idiom detection.\n&quot;</span>);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <span class="comment">// Give up if the loop has multiple blocks or multiple backedges.</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="keywordflow">if</span> (CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a261ee3c4745564c7be9283984c9af06b">getNumBlocks</a>() != 1 || CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">getNumBackEdges</a>() != 1) {</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad block/backedge count.\n&quot;</span>);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160; </div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ValShifted, *NBits, *IVNext;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ExtraOffset;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; </div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopHeaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPreheaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopPreheaderBB &amp;&amp; <span class="stringliteral">&quot;There is always a loop preheader.&quot;</span>);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  <span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  <span class="comment">// Step 1: Check if the loop backedge, condition is in desirable form.</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *TrueBB, *FalseBB;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>(),</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;             <a class="code" href="namespacellvm_1_1PatternMatch.html#a4fd27a44c5fd9958fdd9150622129cd3">m_Br</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(ValShiftedIsZero), <a class="code" href="namespacellvm_1_1PatternMatch.html#acec0ee78d2266b990662e36784791999">m_BasicBlock</a>(TrueBB),</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                  <a class="code" href="namespacellvm_1_1PatternMatch.html#acec0ee78d2266b990662e36784791999">m_BasicBlock</a>(FalseBB))) ||</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(ValShiftedIsZero,</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;             <a class="code" href="namespacellvm_1_1PatternMatch.html#a3fe9b3ddb71b9fb53d9fc74b3a0710bf">m_ICmp</a>(Pred, <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(ValShifted), <a class="code" href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">m_Zero</a>())) ||</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      !<a class="code" href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">ICmpInst::isEquality</a>(Pred)) {</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad backedge structure.\n&quot;</span>);</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  }</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  <span class="comment">// Step 2: Check if the comparison&#39;s operand is in desirable form.</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  <span class="comment">// FIXME: Val could be a one-input PHI node, which we should look past.</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(ValShifted, <a class="code" href="namespacellvm_1_1PatternMatch.html#afa39ee3f650fe22a645ff55ee6d56879">m_Shift</a>(<a class="code" href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af">m_LoopInvariant</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(Val), CurLoop),</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                                 <a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(NBits)))) {</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad comparisons value computation.\n&quot;</span>);</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  IntrinID = ValShifted-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::Shl ? Intrinsic::cttz</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                                                         : Intrinsic::ctlz;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160; </div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  <span class="comment">// Step 3: Check if the shift amount is in desirable form.</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160; </div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(NBits, <a class="code" href="namespacellvm_1_1PatternMatch.html#ad191220adaaedcfba833985509a17452">m_c_Add</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>),</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                           <a class="code" href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af">m_LoopInvariant</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(ExtraOffset), CurLoop))) &amp;&amp;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;      (NBits-&gt;<a class="code" href="classllvm_1_1Instruction.html#a350f4fdc01c770b5cf6a8be2624ae3e5">hasNoSignedWrap</a>() || NBits-&gt;<a class="code" href="classllvm_1_1Instruction.html#a100c666f9253331dd1d166a863248326">hasNoUnsignedWrap</a>()))</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    ExtraOffsetExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">getNegativeSCEV</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(ExtraOffset));</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(NBits,</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                 <a class="code" href="namespacellvm_1_1PatternMatch.html#ac3ed5602889a22db44a16e1b97fac5b8">m_Sub</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">m_Instruction</a>(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>),</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                       <a class="code" href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af">m_LoopInvariant</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(ExtraOffset), CurLoop))) &amp;&amp;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;           NBits-&gt;<a class="code" href="classllvm_1_1Instruction.html#a350f4fdc01c770b5cf6a8be2624ae3e5">hasNoSignedWrap</a>())</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    ExtraOffsetExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(ExtraOffset);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a> = NBits;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    ExtraOffsetExpr = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a4d5ee57f499d862572c863b9e190884f">getZero</a>(NBits-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160; </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  <span class="comment">// Step 4: Check if the recurrence is in desirable form.</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <span class="keyword">auto</span> *IVPN = dyn_cast&lt;PHINode&gt;(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="keywordflow">if</span> (!IVPN || IVPN-&gt;getParent() != LoopHeaderBB) {</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Not an expected PHI node.\n&quot;</span>);</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  }</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160; </div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  Start = IVPN-&gt;getIncomingValueForBlock(LoopPreheaderBB);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  IVNext = dyn_cast&lt;Instruction&gt;(IVPN-&gt;getIncomingValueForBlock(LoopHeaderBB));</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="keywordflow">if</span> (!IVNext || !<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(IVNext, <a class="code" href="namespacellvm_1_1PatternMatch.html#a944c25ac9b73b02a17a20a08a25b9b21">m_Add</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">m_Specific</a>(IVPN), <a class="code" href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">m_One</a>()))) {</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad recurrence.\n&quot;</span>);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  }</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160; </div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  <span class="comment">// Step 4: Check if the backedge&#39;s destinations are in desirable form.</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">ICmpInst::isEquality</a>(Pred) &amp;&amp;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;         <span class="stringliteral">&quot;Should only get equality predicates here.&quot;</span>);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  <span class="comment">// cmp-br is commutative, so canonicalize to a single variant.</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  InvertedCond = Pred != ICmpInst::Predicate::ICMP_EQ;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  <span class="keywordflow">if</span> (InvertedCond) {</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    Pred = <a class="code" href="classllvm_1_1CmpInst.html#aa2a54b545d237ecfe450fd1292f7675e">ICmpInst::getInversePredicate</a>(Pred);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(TrueBB, FalseBB);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  }</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160; </div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  <span class="comment">// We expect to exit loop when comparison yields true,</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="comment">// so when it yields false we should branch back to loop header.</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  <span class="keywordflow">if</span> (FalseBB != LoopHeaderBB) {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Bad backedge flow.\n&quot;</span>);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  }</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; </div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;  <span class="comment">// The new, countable, loop will certainly only run a known number of</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  <span class="comment">// iterations, It won&#39;t be infinite. But the old loop might be infinite</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <span class="comment">// under certain conditions. For logical shifts, the value will become zero</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  <span class="comment">// after at most bitwidth(%Val) loop iterations. However, for arithmetic</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  <span class="comment">// right-shift, iff the sign bit was set, the value will never become zero,</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="comment">// and the loop may never finish.</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  <span class="keywordflow">if</span> (ValShifted-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::AShr &amp;&amp;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      !<a class="code" href="namespacellvm.html#a6de4882dde0c939a449377f8f8abb8a8">isMustProgress</a>(CurLoop) &amp;&amp; !SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a06719fdab228f099aeac0c8ee40a7e34">isKnownNonNegative</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Val))) {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; Can not prove the loop is finite.\n&quot;</span>);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  <span class="comment">// Okay, idiom checks out.</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;}</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment">/// Look for the following loop:</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment">///   entry:</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="comment">///     %start = &lt;...&gt;</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="comment">///     %extraoffset = &lt;...&gt;</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">///     br label %for.cond</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">///   loop:</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">///     %iv = phi i8 [ %start, %entry ], [ %iv.next, %for.cond ]</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment">///     %nbits = add nsw i8 %iv, %extraoffset</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment">///     %val.shifted = {{l,a}shr,shl} i8 %val, %nbits</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">///     %val.shifted.iszero = icmp eq i8 %val.shifted, 0</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment">///     %iv.next = add i8 %iv, 1</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">///     br i1 %val.shifted.iszero, label %end, label %loop</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment">///   end:</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment">///     %iv.res = phi i8 [ %iv, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment">///     %nbits.res = phi i8 [ %nbits, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="comment">///     %val.shifted.res = phi i8 [ %val.shifted, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="comment">///     %val.shifted.iszero.res = phi i1 [ %val.shifted.iszero, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment">///     %iv.next.res = phi i8 [ %iv.next, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">/// And transform it into:</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">///   entry:</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">///     %start = &lt;...&gt;</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">///     %extraoffset = &lt;...&gt;</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="comment">///     %val.numleadingzeros = call i8 @llvm.ct{l,t}z.i8(i8 %val, i1 0)</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="comment">///     %val.numactivebits = sub i8 8, %val.numleadingzeros</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="comment">///     %extraoffset.neg = sub i8 0, %extraoffset</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="comment">///     %tmp = add i8 %val.numactivebits, %extraoffset.neg</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment">///     %iv.final = call i8 @llvm.smax.i8(i8 %tmp, i8 %start)</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="comment">///     %loop.tripcount = sub i8 %iv.final, %start</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment">///     br label %loop</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment">///   loop:</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment">///     %loop.iv = phi i8 [ 0, %entry ], [ %loop.iv.next, %loop ]</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment">///     %loop.iv.next = add i8 %loop.iv, 1</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="comment">///     %loop.ivcheck = icmp eq i8 %loop.iv.next, %loop.tripcount</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment">///     %iv = add i8 %loop.iv, %start</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment">///     br i1 %loop.ivcheck, label %end, label %loop</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment">///   end:</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment">///     %iv.res = phi i8 [ %iv.final, %loop ] &lt;...&gt;</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">///     &lt;...&gt;</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> LoopIdiomRecognize::recognizeShiftUntilZero() {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ValShiftedIsZero;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IntrID;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Start, *Val;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExtraOffsetExpr;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <span class="keywordtype">bool</span> InvertedCond;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopIdiomRecognize_8cpp.html#a7ff0d8853961745bbe8afef66fab99dc">detectShiftUntilZeroIdiom</a>(CurLoop, SE, ValShiftedIsZero, IntrID, <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>,</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                                 Start, Val, ExtraOffsetExpr, InvertedCond)) {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;               <span class="stringliteral">&quot; shift-until-zero idiom detection failed.\n&quot;</span>);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  }</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; shift-until-zero idiom detected!\n&quot;</span>);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <span class="comment">// Ok, it is the idiom we were looking for, we *could* transform this loop,</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="comment">// but is it profitable to transform?</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160; </div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopHeaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPreheaderBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopPreheaderBB &amp;&amp; <span class="stringliteral">&quot;There is always a loop preheader.&quot;</span>);</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuccessorBB = CurLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>();</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuccessorBB &amp;&amp; <span class="stringliteral">&quot;There is only a single successor.&quot;</span>);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160; </div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(LoopPreheaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetCurrentDebugLocation(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Val-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <span class="keywordtype">unsigned</span> Bitwidth = Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>();</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">TargetTransformInfo::TargetCostKind</a> <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a> =</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">TargetTransformInfo::TCK_SizeAndLatency</a>;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  <span class="comment">// The rewrite is considered to be unprofitable iff and only iff the</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  <span class="comment">// intrinsic we&#39;ll use are not cheap. Note that we are okay with *just*</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="comment">// making the loop countable, even if nothing else changes.</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  <a class="code" href="classllvm_1_1IntrinsicCostAttributes.html">IntrinsicCostAttributes</a> <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>(</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      IntrID, Ty, {<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Ty), <span class="comment">/*is_zero_undef=*/</span><a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getFalse()});</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>-&gt;<a class="code" href="classllvm_1_1TargetTransformInfo.html#a4218f47749d093473e680ad0199fb239">getIntrinsicInstrCost</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <a class="code" href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a>);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;  <span class="keywordflow">if</span> (Cost &gt; <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">TargetTransformInfo::TCC_Basic</a>) {</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;               <span class="stringliteral">&quot; Intrinsic is too costly, not beneficial\n&quot;</span>);</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160; </div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;  <span class="comment">// Ok, transform appears worthwhile.</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;  MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <span class="keywordtype">bool</span> OffsetIsZero = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ExtraOffsetExprC = dyn_cast&lt;SCEVConstant&gt;(ExtraOffsetExpr))</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    OffsetIsZero = ExtraOffsetExprC-&gt;isZero();</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; </div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  <span class="comment">// Step 1: Compute the loop&#39;s final IV value / trip count.</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160; </div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *ValNumLeadingZeros = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      IntrID, Ty, {Val, <span class="comment">/*is_zero_undef=*/</span><a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getFalse()},</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="comment">/*FMFSource=*/</span><span class="keyword">nullptr</span>, Val-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.numleadingzeros&quot;</span>);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ValNumActiveBits = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>()), ValNumLeadingZeros,</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      Val-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.numactivebits&quot;</span>, <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>,</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;      <span class="comment">/*HasNSW=*/</span>Bitwidth != 2);</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160; </div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> Expander(*SE, *<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="stringliteral">&quot;loop-idiom&quot;</span>);</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  Expander.setInsertPoint(&amp;*<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.GetInsertPoint());</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ExtraOffset = Expander.expandCodeFor(ExtraOffsetExpr);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; </div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ValNumActiveBitsOffset = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      ValNumActiveBits, ExtraOffset, ValNumActiveBits-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.offset&quot;</span>,</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      <span class="comment">/*HasNUW=*/</span>OffsetIsZero, <span class="comment">/*HasNSW=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IVFinal = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(<a class="code" href="namespacellvm_1_1APIntOps.html#afee2477c062b67b487941ee0f4ff95ba">Intrinsic::smax</a>, {Ty},</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                                           {ValNumActiveBitsOffset, Start},</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                                           <span class="comment">/*FMFSource=*/</span><span class="keyword">nullptr</span>, <span class="stringliteral">&quot;iv.final&quot;</span>);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="keyword">auto</span> *LoopBackedgeTakenCount = cast&lt;Instruction&gt;(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      IVFinal, Start, CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.backedgetakencount&quot;</span>,</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="comment">/*HasNUW=*/</span>OffsetIsZero, <span class="comment">/*HasNSW=*/</span><span class="keyword">true</span>));</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <span class="comment">// FIXME: or when the offset was `add nuw`</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160; </div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;  <span class="comment">// We know loop&#39;s backedge-taken count, but what&#39;s loop&#39;s trip count?</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LoopTripCount =</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(LoopBackedgeTakenCount, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 1),</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                        CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.tripcount&quot;</span>, <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>,</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                        <span class="comment">/*HasNSW=*/</span>Bitwidth != 2);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160; </div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  <span class="comment">// Step 2: Adjust the successor basic block to recieve the original</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  <span class="comment">//         induction variable&#39;s final value instead of the orig. IV itself.</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;replaceUsesOutsideBlock(IVFinal, LoopHeaderBB);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160; </div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  <span class="comment">// Step 3: Rewrite the loop into a countable form, with canonical IV.</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160; </div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <span class="comment">// The new canonical induction variable.</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  <span class="keyword">auto</span> *CIV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(Ty, 2, CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.iv&quot;</span>);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160; </div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  <span class="comment">// The induction itself.</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  <span class="keyword">auto</span> *CIVNext =</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(CIV, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 1), CIV-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.next&quot;</span>,</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                        <span class="comment">/*HasNUW=*/</span><span class="keyword">true</span>, <span class="comment">/*HasNSW=*/</span>Bitwidth != 2);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160; </div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  <span class="comment">// The loop trip count check.</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  <span class="keyword">auto</span> *CIVCheck = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpEQ(CIVNext, LoopTripCount,</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                                        CurLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() + <span class="stringliteral">&quot;.ivcheck&quot;</span>);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keyword">auto</span> *NewIVCheck = CIVCheck;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="keywordflow">if</span> (InvertedCond) {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    NewIVCheck = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateNot(CIVCheck);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    NewIVCheck-&gt;takeName(ValShiftedIsZero);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="comment">// The original IV, but rebased to be an offset to the CIV.</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="keyword">auto</span> *IVDePHId = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(CIV, Start, <span class="stringliteral">&quot;&quot;</span>, <span class="comment">/*HasNUW=*/</span><span class="keyword">false</span>,</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                                     <span class="comment">/*HasNSW=*/</span><span class="keyword">true</span>); <span class="comment">// FIXME: what about NUW?</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  IVDePHId-&gt;takeName(<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>);</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="comment">// The loop terminator.</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCondBr(CIVCheck, SuccessorBB, LoopHeaderBB);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  LoopHeaderBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160; </div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  <span class="comment">// Populate the IV PHI.</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  CIV-&gt;addIncoming(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Ty, 0), LoopPreheaderBB);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  CIV-&gt;addIncoming(CIVNext, LoopHeaderBB);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160; </div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="comment">// Step 4: Forget the &quot;non-computable&quot; trip-count SCEV associated with the</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  <span class="comment">//   loop. The loop would otherwise not be deleted even if it becomes empty.</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(CurLoop);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="comment">// Step 5: Try to cleanup the loop&#39;s body somewhat.</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;replaceAllUsesWith(IVDePHId);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;  <a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  ValShiftedIsZero-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewIVCheck);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  ValShiftedIsZero-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160; </div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="comment">// Other passes will take care of actually deleting the loop if possible.</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160; </div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot; shift-until-zero idiom optimized!\n&quot;</span>);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  ++NumShiftUntilZero;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionCost_html"><div class="ttname"><a href="classllvm_1_1InstructionCost.html">llvm::InstructionCost</a></div><div class="ttdef"><b>Definition:</b> <a href="InstructionCost_8h_source.html#l00029">InstructionCost.h:29</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_aa9480241a076359777eed7eeee8a9c29"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#aa9480241a076359777eed7eeee8a9c29">DisableLIRPAll</a></div><div class="ttdeci">static cl::opt&lt; bool, true &gt; DisableLIRPAll(&quot;disable-&quot; DEBUG_TYPE &quot;-all&quot;, cl::desc(&quot;Options to disable Loop Idiom Recognize Pass.&quot;), cl::location(DisableLIRP::All), cl::init(false), cl::ReallyHidden)</div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_aa4c17e89b1ef061ed69f42b7cee93dbeac71465fd61f1ba8aa2c7c397722b5e05"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#aa4c17e89b1ef061ed69f42b7cee93dbeac71465fd61f1ba8aa2c7c397722b5e05">llvm::TargetTransformInfo::PSK_FastHardware</a></div><div class="ttdeci">@ PSK_FastHardware</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00603">TargetTransformInfo.h:603</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1106b8a15061e8494873e10bb8a364e5"><div class="ttname"><a href="namespacellvm.html#a1106b8a15061e8494873e10bb8a364e5">llvm::RecursivelyDeleteTriviallyDeadInstructions</a></div><div class="ttdeci">bool RecursivelyDeleteTriviallyDeadInstructions(Value *V, const TargetLibraryInfo *TLI=nullptr, MemorySSAUpdater *MSSAU=nullptr, std::function&lt; void(Value *)&gt; AboutToDeleteCallback=std::function&lt; void(Value *)&gt;())</div><div class="ttdoc">If the specified value is a trivially dead instruction, delete it.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00537">Local.cpp:537</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a91ac801aa45c78e0d0edbc36115ef054"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a91ac801aa45c78e0d0edbc36115ef054">llvm::ScalarEvolution::hasLoopInvariantBackedgeTakenCount</a></div><div class="ttdeci">bool hasLoopInvariantBackedgeTakenCount(const Loop *L)</div><div class="ttdoc">Return true if the specified loop has an analyzable loop-invariant backedge-taken count.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l13494">ScalarEvolution.cpp:13494</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9d3ba236d13373cde794da2023acc7a0"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a></div><div class="ttdeci">Function Attrs</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00215">README_ALTIVEC.txt:215</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bb"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bb">llvm::TargetTransformInfo::TargetCostKind</a></div><div class="ttdeci">TargetCostKind</div><div class="ttdoc">The kind of cost model.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00241">TargetTransformInfo.h:241</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a6cb6a58fb0ded82b4c7755fc4c27c86d"><div class="ttname"><a href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">llvm::Loop::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const Value *V) const</div><div class="ttdoc">Return true if the specified value is loop invariant.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00060">LoopInfo.cpp:60</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_adc8cf3b4b56f754b02ea30263bd4561e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#adc8cf3b4b56f754b02ea30263bd4561e">llvm::ScalarEvolution::isLoopEntryGuardedByCond</a></div><div class="ttdeci">bool isLoopEntryGuardedByCond(const Loop *L, ICmpInst::Predicate Pred, const SCEV *LHS, const SCEV *RHS)</div><div class="ttdoc">Test whether entry to the loop is protected by a conditional between LHS and RHS.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l11569">ScalarEvolution.cpp:11569</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a083bb1deb1d2ba244a99ceae9e734bc1"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">llvm::ScalarEvolution::getNegativeSCEV</a></div><div class="ttdeci">const SCEV * getNegativeSCEV(const SCEV *V, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdoc">Return the SCEV object corresponding to -V.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04556">ScalarEvolution.cpp:4556</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdeci">@ ICMP_EQ</div><div class="ttdoc">equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00739">InstrTypes.h:739</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac0be0d93ccd89dac00411b3a5a8bef87"><div class="ttname"><a href="namespacellvm.html#ac0be0d93ccd89dac00411b3a5a8bef87">llvm::isKnownNonNegative</a></div><div class="ttdeci">bool isKnownNonNegative(const Value *V, const DataLayout &amp;DL, unsigned Depth=0, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr, bool UseInstrInfo=true)</div><div class="ttdoc">Returns true if the give value is known to be non-negative.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00320">ValueTracking.cpp:320</a></div></div>
<div class="ttc" id="astructmatch__LoopInvariant_html"><div class="ttname"><a href="structmatch__LoopInvariant.html">match_LoopInvariant</a></div><div class="ttdoc">Match loop-invariant value.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02244">LoopIdiomRecognize.cpp:2244</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a11045c7973ab24a8d6315b61fa337d4e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">llvm::SmallPtrSetImpl::erase</a></div><div class="ttdeci">bool erase(PtrType Ptr)</div><div class="ttdoc">erase - If the set contains the specified pointer, remove it and return true, otherwise return false.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00379">SmallPtrSet.h:379</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ab48af53a5000ecede46c76dabb4578d2"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">llvm::LoopBase::getExitBlock</a></div><div class="ttdeci">BlockT * getExitBlock() const</div><div class="ttdoc">If getExitBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00107">LoopInfoImpl.h:107</a></div></div>
<div class="ttc" id="aclassllvm_1_1WeakTrackingVH_html"><div class="ttname"><a href="classllvm_1_1WeakTrackingVH.html">llvm::WeakTrackingVH</a></div><div class="ttdoc">Value handle that is nullable, but tries to track the Value.</div><div class="ttdef"><b>Definition:</b> <a href="ValueHandle_8h_source.html#l00204">ValueHandle.h:204</a></div></div>
<div class="ttc" id="astructmatch__LoopInvariant_html_ab4196b7cec294de605709d4e2f7bdca8"><div class="ttname"><a href="structmatch__LoopInvariant.html#ab4196b7cec294de605709d4e2f7bdca8">match_LoopInvariant::L</a></div><div class="ttdeci">const Loop * L</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02246">LoopIdiomRecognize.cpp:2246</a></div></div>
<div class="ttc" id="aCmpInstAnalysis_8h_html"><div class="ttname"><a href="CmpInstAnalysis_8h.html">CmpInstAnalysis.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1LocationSize_html_aecff732f116417f2c4e99ac146339300"><div class="ttname"><a href="classllvm_1_1LocationSize.html#aecff732f116417f2c4e99ac146339300">llvm::LocationSize::afterPointer</a></div><div class="ttdeci">constexpr static LocationSize afterPointer()</div><div class="ttdoc">Any location after the base pointer (but still within the underlying object).</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00125">MemoryLocation.h:125</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdoc">This enumeration lists the possible predicates for CmpInst subclasses.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00718">InstrTypes.h:718</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a54bb7394d874cbbef1d81e6bea89d4f3"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">llvm::SCEVAddRecExpr::isAffine</a></div><div class="ttdeci">bool isAffine() const</div><div class="ttdoc">Return true if this represents an expression A + B*x where A and B are loop invariant values.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00358">ScalarEvolutionExpressions.h:358</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aScalarEvolutionExpander_8h_html"><div class="ttname"><a href="ScalarEvolutionExpander_8h.html">ScalarEvolutionExpander.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_ac03b57021568dcc4d9a685c40011ff09"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">llvm::MemIntrinsicBase::getDestAlign</a></div><div class="ttdeci">MaybeAlign getDestAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00847">IntrinsicInst.h:847</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a1d3a0e869e478018c481a577ed9d25ee"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">llvm::SCEVAddRecExpr::getStart</a></div><div class="ttdeci">const SCEV * getStart() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00341">ScalarEvolutionExpressions.h:341</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="aMemorySSAUpdater_8h_html"><div class="ttname"><a href="MemorySSAUpdater_8h.html">MemorySSAUpdater.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_aed47e4757f3240146f8ad40c2cdbf2d1"><div class="ttname"><a href="namespacellvm_1_1cl.html#aed47e4757f3240146f8ad40c2cdbf2d1">llvm::cl::location</a></div><div class="ttdeci">LocationClass&lt; Ty &gt; location(Ty &amp;L)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00465">CommandLine.h:465</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a04337b572d34ea413c35dbac5d75530b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const</div><div class="ttdoc">Return true if the specified loop is contained within in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a9188f84e1dd67530330dcab9cae787d7"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">llvm::details::FixedOrScalableQuantity::isScalable</a></div><div class="ttdeci">constexpr bool isScalable() const</div><div class="ttdoc">Returns whether the quantity is scaled by a runtime quantity (vscale).</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00166">TypeSize.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpander_html"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html">llvm::SCEVExpander</a></div><div class="ttdoc">This class uses information about analyze scalars to rewrite expressions in canonical form.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00050">ScalarEvolutionExpander.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a2069641f358ef416658a2f321ca19d74"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a2069641f358ef416658a2f321ca19d74">llvm::BasicBlock::instructionsWithoutDebug</a></div><div class="ttdeci">iterator_range&lt; filter_iterator&lt; BasicBlock::const_iterator, std::function&lt; bool(const Instruction &amp;)&gt; &gt; &gt; instructionsWithoutDebug(bool SkipPseudoOp=true) const</div><div class="ttdoc">Return a const iterator range over the instructions in the block, skipping any debug instructions.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00103">BasicBlock.cpp:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4abb39a66573f61fda80469faa5d861d"><div class="ttname"><a href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">llvm::Type::getScalarType</a></div><div class="ttdeci">Type * getScalarType() const</div><div class="ttdoc">If this is a vector type, return the element type, otherwise return 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00341">Type.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a944c25ac9b73b02a17a20a08a25b9b21"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a944c25ac9b73b02a17a20a08a25b9b21">llvm::PatternMatch::m_Add</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Add &gt; m_Add(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00979">PatternMatch.h:979</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_af2daa0ee117afefed4c82eee55bf97b7"><div class="ttname"><a href="classllvm_1_1APInt.html#af2daa0ee117afefed4c82eee55bf97b7">llvm::APInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const</div><div class="ttdoc">Get sign extended value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01516">APInt.h:1516</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a48f061a53492f73dc9d82812f4350b44"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a48f061a53492f73dc9d82812f4350b44">detectPopcountIdiom</a></div><div class="ttdeci">static bool detectPopcountIdiom(Loop *CurLoop, BasicBlock *PreCondBB, Instruction *&amp;CntInst, PHINode *&amp;CntPhi, Value *&amp;Var)</div><div class="ttdoc">Return true iff the idiom is detected in the loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01640">LoopIdiomRecognize.cpp:1640</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aLoopAccessAnalysis_8h_html"><div class="ttname"><a href="LoopAccessAnalysis_8h.html">LoopAccessAnalysis.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aMapVector_8h_html"><div class="ttname"><a href="MapVector_8h.html">MapVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00039">GlobalVariable.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00880">DenseMap.h:880</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdoc">The main scalar evolution driver.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00452">ScalarEvolution.h:452</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a4218f47749d093473e680ad0199fb239"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a4218f47749d093473e680ad0199fb239">llvm::TargetTransformInfo::getIntrinsicInstrCost</a></div><div class="ttdeci">InstructionCost getIntrinsicInstrCost(const IntrinsicCostAttributes &amp;ICA, TTI::TargetCostKind CostKind) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00983">TargetTransformInfo.cpp:983</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">llvm::CmpInst::ICMP_NE</a></div><div class="ttdeci">@ ICMP_NE</div><div class="ttdoc">not equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00740">InstrTypes.h:740</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa2a54b545d237ecfe450fd1292f7675e"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa2a54b545d237ecfe450fd1292f7675e">llvm::CmpInst::getInversePredicate</a></div><div class="ttdeci">Predicate getInversePredicate() const</div><div class="ttdoc">For example, EQ -&gt; NE, UGT -&gt; ULE, SLT -&gt; SGE, OEQ -&gt; UNE, UGT -&gt; OLE, OLT -&gt; UGE,...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00832">InstrTypes.h:832</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_ae79d05dd3d0b05e080e08f8c5c33f880"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">llvm::ConstantExpr::getBitCast</a></div><div class="ttdeci">static Constant * getBitCast(Constant *C, Type *Ty, bool OnlyIfReduced=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02229">Constants.cpp:2229</a></div></div>
<div class="ttc" id="anamespacellvm_html_a82a4f09de58515e3236c6d8047d4b2ef"><div class="ttname"><a href="namespacellvm.html#a82a4f09de58515e3236c6d8047d4b2ef">llvm::initializeLoopIdiomRecognizeLegacyPassPass</a></div><div class="ttdeci">void initializeLoopIdiomRecognizeLegacyPassPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="anamespacellvm_html_a92caae34bfacc63bda0f23d5d005a89e"><div class="ttname"><a href="namespacellvm.html#a92caae34bfacc63bda0f23d5d005a89e">llvm::getLoopAnalysisUsage</a></div><div class="ttdeci">void getLoopAnalysisUsage(AnalysisUsage &amp;AU)</div><div class="ttdoc">Helper to consistently add the set of standard passes to a loop pass's AnalysisUsage.</div><div class="ttdef"><b>Definition:</b> <a href="LoopUtils_8cpp_source.html#l00141">LoopUtils.cpp:141</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a4fd27a44c5fd9958fdd9150622129cd3"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a4fd27a44c5fd9958fdd9150622129cd3">llvm::PatternMatch::m_Br</a></div><div class="ttdeci">brc_match&lt; Cond_t, bind_ty&lt; BasicBlock &gt;, bind_ty&lt; BasicBlock &gt; &gt; m_Br(const Cond_t &amp;C, BasicBlock *&amp;T, BasicBlock *&amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01731">PatternMatch.h:1731</a></div></div>
<div class="ttc" id="aAPInt_8h_html"><div class="ttname"><a href="APInt_8h.html">APInt.h</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html">llvm::AAMDNodes</a></div><div class="ttdoc">A collection of metadata nodes that might be associated with a memory access used by the alias-analys...</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00651">Metadata.h:651</a></div></div>
<div class="ttc" id="aScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a512fe2c15ea651294688eeec1341644c"><div class="ttname"><a href="classllvm_1_1APInt.html#a512fe2c15ea651294688eeec1341644c">llvm::APInt::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const</div><div class="ttdoc">Return the number of bits in the APInt.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01439">APInt.h:1439</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html_aaaeded5d0cab77f531b294638459aca5"><div class="ttname"><a href="classllvm_1_1ICmpInst.html#aaaeded5d0cab77f531b294638459aca5">llvm::ICmpInst::isEquality</a></div><div class="ttdeci">bool isEquality() const</div><div class="ttdoc">Return true if this predicate is either EQ or NE.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01292">Instructions.h:1292</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_a4831dbe1cbfb8f0e07600bf890af8353"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#a4831dbe1cbfb8f0e07600bf890af8353">llvm::AAMDNodes::TBAAStruct</a></div><div class="ttdeci">MDNode * TBAAStruct</div><div class="ttdoc">The tag for type-based alias analysis (tbaa struct).</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00671">Metadata.h:671</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1e2870b3ccae0da50756ca172063719b"><div class="ttname"><a href="namespacellvm.html#a1e2870b3ccae0da50756ca172063719b">llvm::createLoopIdiomPass</a></div><div class="ttdeci">Pass * createLoopIdiomPass()</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00345">LoopIdiomRecognize.cpp:345</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a1d585c107a14470e0f38289b60164ed1"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a1d585c107a14470e0f38289b60164ed1">getTripCount</a></div><div class="ttdeci">static const SCEV * getTripCount(const SCEV *BECount, Type *IntPtr, Loop *CurLoop, const DataLayout *DL, ScalarEvolution *SE)</div><div class="ttdoc">Compute trip count from the backedge taken count.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01054">LoopIdiomRecognize.cpp:1054</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ac5984d6827f6e6922bed00bf03ba9552"><div class="ttname"><a href="classllvm_1_1Instruction.html#ac5984d6827f6e6922bed00bf03ba9552">llvm::Instruction::isShift</a></div><div class="ttdeci">bool isShift() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00175">Instruction.h:175</a></div></div>
<div class="ttc" id="anamespacellvm_html_acab8f775ddc87695d750e4838231b3ba"><div class="ttname"><a href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">llvm::isBytewiseValue</a></div><div class="ttdeci">Value * isBytewiseValue(Value *V, const DataLayout &amp;DL)</div><div class="ttdoc">If the specified value can be set by repeating the same byte in memory, return the i8 value that it i...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04001">ValueTracking.cpp:4001</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html">llvm::LoopStandardAnalysisResults</a></div><div class="ttdoc">The adaptor from a function pass to a loop pass computes these analyses and makes them available to t...</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00051">LoopAnalysisManager.h:51</a></div></div>
<div class="ttc" id="astructmatch__LoopInvariant_html_af1067ef7599d580590a21ba0dc9fd29b"><div class="ttname"><a href="structmatch__LoopInvariant.html#af1067ef7599d580590a21ba0dc9fd29b">match_LoopInvariant::match</a></div><div class="ttdeci">bool match(ITy *V)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02251">LoopIdiomRecognize.cpp:2251</a></div></div>
<div class="ttc" id="anamespacellvm_html_a854abfc88bcd24e3878e2c9ab1f70fd3"><div class="ttname"><a href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">llvm::isModOrRefSet</a></div><div class="ttdeci">bool isModOrRefSet(const ModRefInfo MRI)</div><div class="ttdef"><b>Definition:</b> <a href="ModRef_8h_source.html#l00042">ModRef.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_ae8df4be75bfc50b1eadd74e85c25fa45a4cc6684df7b4a92b1dec6fce3264fac8"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#ae8df4be75bfc50b1eadd74e85c25fa45a4cc6684df7b4a92b1dec6fce3264fac8">llvm::GlobalValue::UnnamedAddr::Global</a></div><div class="ttdeci">@ Global</div></div>
<div class="ttc" id="anamespacellvm_html_ab1b85be3cd0fffad1d76673016015e02"><div class="ttname"><a href="namespacellvm.html#ab1b85be3cd0fffad1d76673016015e02">llvm::isConsecutiveAccess</a></div><div class="ttdeci">bool isConsecutiveAccess(Value *A, Value *B, const DataLayout &amp;DL, ScalarEvolution &amp;SE, bool CheckType=true)</div><div class="ttdoc">Returns true if the memory operations A and B are consecutive.</div><div class="ttdef"><b>Definition:</b> <a href="LoopAccessAnalysis_8cpp_source.html#l01592">LoopAccessAnalysis.cpp:1592</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ad146072469181af4ccb7ef03c28999ba"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ad146072469181af4ccb7ef03c28999ba">llvm::ScalarEvolution::applyLoopGuards</a></div><div class="ttdeci">const SCEV * applyLoopGuards(const SCEV *Expr, const Loop *L)</div><div class="ttdoc">Try to apply information from loop guards for L to Expr.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l14970">ScalarEvolution.cpp:14970</a></div></div>
<div class="ttc" id="aclassllvm_1_1MapVector_html"><div class="ttname"><a href="classllvm_1_1MapVector.html">llvm::MapVector&lt; Value *, StoreList &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt; Value *, 16 &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="astructllvm_1_1DisableLIRP_html_aac47a395ddc8679b300a4b6c112df309"><div class="ttname"><a href="structllvm_1_1DisableLIRP.html#aac47a395ddc8679b300a4b6c112df309">llvm::DisableLIRP::All</a></div><div class="ttdeci">static bool All</div><div class="ttdoc">When true, the entire pass is disabled.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8h_source.html#l00030">LoopIdiomRecognize.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba2751d6136a2819749dcef65dc19a4246"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba2751d6136a2819749dcef65dc19a4246">llvm::CmpInst::ICMP_SLE</a></div><div class="ttdeci">@ ICMP_SLE</div><div class="ttdoc">signed less or equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00748">InstrTypes.h:748</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a06719fdab228f099aeac0c8ee40a7e34"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a06719fdab228f099aeac0c8ee40a7e34">llvm::ScalarEvolution::isKnownNonNegative</a></div><div class="ttdeci">bool isKnownNonNegative(const SCEV *S)</div><div class="ttdoc">Test if the given expression is known to be non-negative.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l10829">ScalarEvolution.cpp:10829</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_af46fd5126112a587bb12f09b1c0e385b"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#af46fd5126112a587bb12f09b1c0e385b">llvm::ConstantExpr::getExactLogBase2</a></div><div class="ttdeci">static Constant * getExactLogBase2(Constant *C)</div><div class="ttdoc">If C is a scalar/fixed width vector of known powers of 2, then this function returns a new scalar/fix...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02712">Constants.cpp:2712</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a59fb91d1691350f7d1b8e8a114e3f2a4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">llvm::BasicBlock::getSinglePredecessor</a></div><div class="ttdeci">const BasicBlock * getSinglePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a single predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00284">BasicBlock.cpp:284</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a38c97622dccff7ae31fe0be3b21c9b3d"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a38c97622dccff7ae31fe0be3b21c9b3d">llvm::GlobalValue::setUnnamedAddr</a></div><div class="ttdeci">void setUnnamedAddr(UnnamedAddr Val)</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00227">GlobalValue.h:227</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayType_html"><div class="ttname"><a href="classllvm_1_1ArrayType.html">llvm::ArrayType</a></div><div class="ttdoc">Class to represent array types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00357">DerivedTypes.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00264">Instructions.h:264</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_adc040502444e4504cdbc04c87e4e3055"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#adc040502444e4504cdbc04c87e4e3055">llvm::ScalarEvolution::getTruncateOrZeroExtend</a></div><div class="ttdeci">const SCEV * getTruncateOrZeroExtend(const SCEV *V, Type *Ty, unsigned Depth=0)</div><div class="ttdoc">Return a SCEV corresponding to a conversion of the input value to the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04692">ScalarEvolution.cpp:4692</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ae9d735be1ececf149966a4da253f0320"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ae9d735be1ececf149966a4da253f0320">llvm::PatternMatch::m_c_And</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::And, true &gt; m_c_And(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches an And with LHS and RHS in either order.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l02262">PatternMatch.h:2262</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_a5175e1defb539f65df5ded7a806fa5c8"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#a5175e1defb539f65df5ded7a806fa5c8">llvm::AAMDNodes::Scope</a></div><div class="ttdeci">MDNode * Scope</div><div class="ttdoc">The tag for alias scope specification (used with noalias).</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00674">Metadata.h:674</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVConstant_html_ab319aacb4209aeca2c72d50a0d585b47"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html#ab319aacb4209aeca2c72d50a0d585b47">llvm::SCEVConstant::getValue</a></div><div class="ttdeci">ConstantInt * getValue() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00069">ScalarEvolutionExpressions.h:69</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_aaa96df870a1b3d7ffc56bec3eb0b0cff"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#aaa96df870a1b3d7ffc56bec3eb0b0cff">llvm::LoopStandardAnalysisResults::DT</a></div><div class="ttdeci">DominatorTree &amp; DT</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00054">LoopAnalysisManager.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_af51c113a039c82f6870df5dc9666b5e3"><div class="ttname"><a href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">llvm::LoadInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdoc">Return the alignment of the access that is being performed.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00220">Instructions.h:220</a></div></div>
<div class="ttc" id="aclassllvm_1_1SimpleLoopSafetyInfo_html"><div class="ttname"><a href="classllvm_1_1SimpleLoopSafetyInfo.html">llvm::SimpleLoopSafetyInfo</a></div><div class="ttdoc">Simple and conservative implementation of LoopSafetyInfo that can give false-positive answers to its ...</div><div class="ttdef"><b>Definition:</b> <a href="MustExecute_8h_source.html#l00110">MustExecute.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a0bfa8e65ecd85f3151f84bb53ad4bcbca61cf8510205077b6f5491d38cd44c0f7"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a0bfa8e65ecd85f3151f84bb53ad4bcbca61cf8510205077b6f5491d38cd44c0f7">llvm::codeview::PointerMode::Pointer</a></div><div class="ttdeci">@ Pointer</div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">llvm::cl::ReallyHidden</a></div><div class="ttdeci">@ ReallyHidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00139">CommandLine.h:139</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a7c1fb40f1a3dd18bf3a2527e5aa0ed59"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a7c1fb40f1a3dd18bf3a2527e5aa0ed59">llvm::IRBuilderBase::getInt1</a></div><div class="ttdeci">ConstantInt * getInt1(bool V)</div><div class="ttdoc">Get a constant value representing either true or false.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00447">IRBuilder.h:447</a></div></div>
<div class="ttc" id="aMustExecute_8h_html"><div class="ttname"><a href="MustExecute_8h.html">MustExecute.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a261ee3c4745564c7be9283984c9af06b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a261ee3c4745564c7be9283984c9af06b">llvm::LoopBase::getNumBlocks</a></div><div class="ttdeci">unsigned getNumBlocks() const</div><div class="ttdoc">Get the number of blocks in this loop in constant time.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00202">LoopInfo.h:202</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemSetBase_html_a1f2497dcafee1cce332763e4015e23c0"><div class="ttname"><a href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">llvm::MemSetBase::getValue</a></div><div class="ttdeci">Value * getValue() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00940">IntrinsicInst.h:940</a></div></div>
<div class="ttc" id="alib_2Analysis_2README_8txt_html_a01d2af4eee7c40485a0ce3683a2e907a"><div class="ttname"><a href="lib_2Analysis_2README_8txt.html#a01d2af4eee7c40485a0ce3683a2e907a">loop</a></div><div class="ttdeci">Analysis the ScalarEvolution expression for r is&lt; loop &gt; Outside the loop</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Analysis_2README_8txt_source.html#l00008">README.txt:8</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aAliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ad299b0f4378f644f67168c72c763716f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ad299b0f4378f644f67168c72c763716f">llvm::ScalarEvolution::getMulExpr</a></div><div class="ttdeci">const SCEV * getMulExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Get a canonical multiply expression, or something simpler if possible.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l03132">ScalarEvolution.cpp:3132</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a91efa71de05b0c2d00730a0279f58658"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">llvm::BitmaskEnumDetail::Mask</a></div><div class="ttdeci">constexpr std::underlying_type_t&lt; E &gt; Mask()</div><div class="ttdoc">Get a bitmask with 1s in all places up to the high-order bit of E's largest value.</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00080">BitmaskEnum.h:80</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_a14298313bdf734e2db5a921cc6e861a0"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">llvm::StoreInst::getValueOperand</a></div><div class="ttdeci">Value * getValueOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00390">Instructions.h:390</a></div></div>
<div class="ttc" id="aGlobalValue_8h_html"><div class="ttname"><a href="GlobalValue_8h.html">GlobalValue.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a9679969ae87f8a08d5f6948be6cf7210"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a9679969ae87f8a08d5f6948be6cf7210">llvm::TargetTransformInfo::getArithmeticInstrCost</a></div><div class="ttdeci">InstructionCost getArithmeticInstrCost(unsigned Opcode, Type *Ty, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, TTI::OperandValueInfo Opd1Info={TTI::OK_AnyValue, TTI::OP_None}, TTI::OperandValueInfo Opd2Info={TTI::OK_AnyValue, TTI::OP_None}, ArrayRef&lt; const Value * &gt; Args=ArrayRef&lt; const Value * &gt;(), const Instruction *CxtI=nullptr) const</div><div class="ttdoc">This is an approximation of reciprocal throughput of a math/logic op.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00803">TargetTransformInfo.cpp:803</a></div></div>
<div class="ttc" id="anamespacellvm_html_adacba4cb06d1dd9232ee3d2d49a44d8fabafd7322c6e97d25b6299b5d6fe8920b"><div class="ttname"><a href="namespacellvm.html#adacba4cb06d1dd9232ee3d2d49a44d8fabafd7322c6e97d25b6299b5d6fe8920b">llvm::InlinerFunctionImportStatsOpts::No</a></div><div class="ttdeci">@ No</div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAWrapperPass_html"><div class="ttname"><a href="classllvm_1_1MemorySSAWrapperPass.html">llvm::MemorySSAWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes MemorySSA.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00986">MemorySSA.h:986</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ac93dd46031b1e2f9fdb0cee7a99681df"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ac93dd46031b1e2f9fdb0cee7a99681df">llvm::ScalarEvolution::getOne</a></div><div class="ttdeci">const SCEV * getOne(Type *Ty)</div><div class="ttdoc">Return a SCEV for the constant 1 of a specific type.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00656">ScalarEvolution.h:656</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html"><div class="ttname"><a href="classllvm_1_1AAResults.html">llvm::AAResults</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00294">AliasAnalysis.h:294</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8h_html"><div class="ttname"><a href="LoopIdiomRecognize_8h.html">LoopIdiomRecognize.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a6480799b120b617b9b34f1313afe6661"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a6480799b120b617b9b34f1313afe6661">llvm::TargetTransformInfo::getPopcntSupport</a></div><div class="ttdeci">PopcntSupportKind getPopcntSupport(unsigned IntTyWidthInBit) const</div><div class="ttdoc">Return hardware support for population count.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00585">TargetTransformInfo.cpp:585</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">InlinePriorityMode::Cost</a></div><div class="ttdeci">@ Cost</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1LocationSize_html"><div class="ttname"><a href="classllvm_1_1LocationSize.html">llvm::LocationSize</a></div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00067">MemoryLocation.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BTF_html_a3b20e188bd3a15443a74fc637b6aed33a4af5f992bdc47a779c499ffc6fdcaf43"><div class="ttname"><a href="namespacellvm_1_1BTF.html#a3b20e188bd3a15443a74fc637b6aed33a4af5f992bdc47a779c499ffc6fdcaf43">llvm::BTF::HeaderSize</a></div><div class="ttdeci">@ HeaderSize</div><div class="ttdef"><b>Definition:</b> <a href="BTF_8h_source.html#l00060">BTF.h:60</a></div></div>
<div class="ttc" id="aIntrinsics_8h_html"><div class="ttname"><a href="Intrinsics_8h.html">Intrinsics.h</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a57efb022f2ee2e19e4cdf582f4d27f2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">llvm::Instruction::isAtomic</a></div><div class="ttdeci">bool isAtomic() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction has an AtomicOrdering of unordered or higher.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00666">Instruction.cpp:666</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html_a2205e49ace8bb2fd9934342ff6a25e13"><div class="ttname"><a href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">llvm::AAResults::getModRefInfo</a></div><div class="ttdeci">ModRefInfo getModRefInfo(const Instruction *I, const std::optional&lt; MemoryLocation &gt; &amp;OptLoc)</div><div class="ttdoc">Check whether or not an instruction may read or write the optionally specified memory location.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00488">AliasAnalysis.h:488</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a83b8c9e572130f403445c0b0f69b837c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">llvm::CallBase::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const</div><div class="ttdoc">Returns the function called, or null if this is an indirect function invocation or the function signa...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01406">InstrTypes.h:1406</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a40f34cc77d2b3bc73384f535c8101858"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">llvm::LoopBase::blocks</a></div><div class="ttdeci">iterator_range&lt; block_iterator &gt; blocks() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00195">LoopInfo.h:195</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a04353aa48874f9bda89ff9059cd1a5a6"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a04353aa48874f9bda89ff9059cd1a5a6">llvm::PatternMatch::m_Instruction</a></div><div class="ttdeci">bind_ty&lt; Instruction &gt; m_Instruction(Instruction *&amp;I)</div><div class="ttdoc">Match an instruction, capturing it if we match.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00716">PatternMatch.h:716</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdeci">@ Store</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00033">SparcInstrInfo.h:33</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html">llvm::MaybeAlign</a></div><div class="ttdoc">This struct is a compact representation of a valid (power of two) or undefined (0) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00117">Alignment.h:117</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ad191220adaaedcfba833985509a17452"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ad191220adaaedcfba833985509a17452">llvm::PatternMatch::m_c_Add</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Add, true &gt; m_c_Add(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches a Add with LHS and RHS in either order.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l02248">PatternMatch.h:2248</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_adfb61ffe25c950c75c86310245b3ef39"><div class="ttname"><a href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">llvm::PHINode::getIncomingValueForBlock</a></div><div class="ttdeci">Value * getIncomingValueForBlock(const BasicBlock *BB) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02889">Instructions.h:2889</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a5cc113cb783ab6e5ca7b69241431c19c"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a5cc113cb783ab6e5ca7b69241431c19c">llvm::LoopBase::getBlocks</a></div><div class="ttdeci">ArrayRef&lt; BlockT * &gt; getBlocks() const</div><div class="ttdoc">Get a list of the basic blocks which make up this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00188">LoopInfo.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_a4d51384de6e1798bb6aa875aebeea9f0"><div class="ttname"><a href="classllvm_1_1Constant.html#a4d51384de6e1798bb6aa875aebeea9f0">llvm::Constant::getAllOnesValue</a></div><div class="ttdeci">static Constant * getAllOnesValue(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00403">Constants.cpp:403</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a31bf07f3f61525486633bc1d0bbaf029"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00391">InstrTypes.h:391</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a9f382207d841377156d4c7868b66b9a5"><div class="ttname"><a href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits() const LLVM_READONLY</div><div class="ttdoc">If this is a vector type, return the getPrimitiveSizeInBits value for the element type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00188">Type.cpp:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a217e0207d9cc8e046c2dccbf0e4bb198"><div class="ttname"><a href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Get zero extended value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01494">APInt.h:1494</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d"><div class="ttname"><a href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">llvm::codeview::EncodedFramePtrReg::BasePtr</a></div><div class="ttdeci">@ BasePtr</div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01740">Constants.cpp:1740</a></div></div>
<div class="ttc" id="aclassllvm_1_1LocationSize_html_a131715ceeb92fb803a329d6b76d14e0d"><div class="ttname"><a href="classllvm_1_1LocationSize.html#a131715ceeb92fb803a329d6b76d14e0d">llvm::LocationSize::precise</a></div><div class="ttdeci">static LocationSize precise(uint64_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00102">MemoryLocation.h:102</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6de4882dde0c939a449377f8f8abb8a8"><div class="ttname"><a href="namespacellvm.html#a6de4882dde0c939a449377f8f8abb8a8">llvm::isMustProgress</a></div><div class="ttdeci">bool isMustProgress(const Loop *L)</div><div class="ttdoc">Return true if this loop can be assumed to make progress.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l01118">LoopInfo.cpp:1118</a></div></div>
<div class="ttc" id="aLoopUtils_8h_html"><div class="ttname"><a href="LoopUtils_8h.html">LoopUtils.h</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00107">LoopIdiomRecognize.cpp:107</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3b1c5788b85ffa254be0e834edf5cf8f"><div class="ttname"><a href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">llvm::getUnderlyingObject</a></div><div class="ttdeci">const Value * getUnderlyingObject(const Value *V, unsigned MaxLookup=6)</div><div class="ttdoc">This method strips off any GEP address adjustments and pointer casts from the specified value,...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04567">ValueTracking.cpp:4567</a></div></div>
<div class="ttc" id="aDebugLoc_8h_html"><div class="ttname"><a href="DebugLoc_8h.html">DebugLoc.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LPPassManager_html"><div class="ttname"><a href="classllvm_1_1LPPassManager.html">llvm::LPPassManager</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopPass_8h_source.html#l00076">LoopPass.h:76</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aade703948f2fdabdc65868bdf42d3141"><div class="ttname"><a href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">llvm::Instruction::getAAMetadata</a></div><div class="ttdeci">AAMDNodes getAAMetadata() const</div><div class="ttdoc">Returns the AA metadata for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01499">Metadata.cpp:1499</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a07e8c2e78d42ff18e17fc7c47e4479af"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a07e8c2e78d42ff18e17fc7c47e4479af">m_LoopInvariant</a></div><div class="ttdeci">match_LoopInvariant&lt; Ty &gt; m_LoopInvariant(const Ty &amp;M, const Loop *L)</div><div class="ttdoc">Matches if the value is loop-invariant.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02258">LoopIdiomRecognize.cpp:2258</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_afc70e919c88c86159cc94cea29b6c210"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#afc70e919c88c86159cc94cea29b6c210">llvm::BasicBlock::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this basic block belongs to, or nullptr if the function does no...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00146">BasicBlock.cpp:146</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a043cdaf7b89aaeeb127be5d93411637f"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a></div><div class="ttdeci">uint64_t Align</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00082">ELFObjHandler.cpp:82</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a46ef6115027606b67adcf4d28f3dac17"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">const Instruction * getFirstNonPHI() const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00208">BasicBlock.cpp:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_a3b47950858d6ed72efd1010a35b81caa"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a3b47950858d6ed72efd1010a35b81caa">llvm::StoreInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00345">Instructions.h:345</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_aa512958c35cfdd696c21623a964fc2d9"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">llvm::MemTransferBase::getSourceAlign</a></div><div class="ttdeci">MaybeAlign getSourceAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00909">IntrinsicInst.h:909</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_afa39ee3f650fe22a645ff55ee6d56879"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#afa39ee3f650fe22a645ff55ee6d56879">llvm::PatternMatch::m_Shift</a></div><div class="ttdeci">BinOpPred_match&lt; LHS, RHS, is_shift_op &gt; m_Shift(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches shift operations.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01296">PatternMatch.h:1296</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a917a64b00c1745fd0c78c2b2320cd4ad"><div class="ttname"><a href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">llvm::Loop::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00891">LoopInfo.h:891</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a13e877ef779ba7a0688081079f4f9b03"><div class="ttname"><a href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">llvm::Type::getIntegerBitWidth</a></div><div class="ttdeci">unsigned getIntegerBitWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00097">DerivedTypes.h:97</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicCostAttributes_html"><div class="ttname"><a href="classllvm_1_1IntrinsicCostAttributes.html">llvm::IntrinsicCostAttributes</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00119">TargetTransformInfo.h:119</a></div></div>
<div class="ttc" id="aErlangGCPrinter_8cpp_html_a74b474c0616ab55c1d9487f11fd31d26"><div class="ttname"><a href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; ErlangGCPrinter &gt; X(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1MemSetInst_html"><div class="ttname"><a href="classllvm_1_1MemSetInst.html">llvm::MemSetInst</a></div><div class="ttdoc">This class wraps the llvm.memset and llvm.memset.inline intrinsics.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01080">IntrinsicInst.h:1080</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aebdb2700a77d10ae6f0ce115e23d9f77"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aebdb2700a77d10ae6f0ce115e23d9f77">llvm::PatternMatch::m_One</a></div><div class="ttdeci">cst_pred_ty&lt; is_one &gt; m_One()</div><div class="ttdoc">Match an integer 1 or a vector with all elements equal to 1.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00517">PatternMatch.h:517</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00059">PassSupport.h:59</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_aac456a62894c9f0f8e9f06373bbf40f0"><div class="ttname"><a href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">llvm::BranchInst::getCondition</a></div><div class="ttdeci">Value * getCondition() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03220">Instructions.h:3220</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_a87b23e247f35b163544f1ce8e920801c"><div class="ttname"><a href="classllvm_1_1SCEV.html#a87b23e247f35b163544f1ce8e920801c">llvm::SCEV::isNonConstantNegative</a></div><div class="ttdeci">bool isNonConstantNegative() const</div><div class="ttdoc">Return true if the specified scev is negated, but not a constant.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00478">ScalarEvolution.cpp:478</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a30bd18ac905eacf3601bc6a553a9ff49"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">llvm::ScalarEvolution::getSCEV</a></div><div class="ttdeci">const SCEV * getSCEV(Value *V)</div><div class="ttdoc">Return a SCEV expression for the full generality of the specified expression.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04534">ScalarEvolution.cpp:4534</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_af9096a02aa326d9a55f4d16ba9f9d243"><div class="ttname"><a href="classllvm_1_1LoopBase.html#af9096a02aa326d9a55f4d16ba9f9d243">llvm::LoopBase::block_begin</a></div><div class="ttdeci">block_iterator block_begin() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00193">LoopInfo.h:193</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ad5e60756e331a97669d11b5c9d8691a2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ad5e60756e331a97669d11b5c9d8691a2">llvm::PatternMatch::m_Power2</a></div><div class="ttdeci">cst_pred_ty&lt; is_power2 &gt; m_Power2()</div><div class="ttdoc">Match an integer or vector power-of-2.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00544">PatternMatch.h:544</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_ab10dcc08be6d7ecc655688c7f5e5fcca"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#ab10dcc08be6d7ecc655688c7f5e5fcca">getStoreStride</a></div><div class="ttdeci">static APInt getStoreStride(const SCEVAddRecExpr *StoreEv)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00425">LoopIdiomRecognize.cpp:425</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a4cdd27e2100a2d388708721b81c77ffb"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a4cdd27e2100a2d388708721b81c77ffb">UseLIRCodeSizeHeurs</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; UseLIRCodeSizeHeurs(&quot;use-lir-code-size-heurs&quot;, cl::desc(&quot;Use loop idiom recognition code size heuristics when compiling&quot; &quot;with -Os/-Oz&quot;), cl::init(true), cl::Hidden)</div></div>
<div class="ttc" id="anamespacellvm_html_ac7294ba4e105807674fe3a394437fcc1"><div class="ttname"><a href="namespacellvm.html#ac7294ba4e105807674fe3a394437fcc1">llvm::getLoopPassPreservedAnalyses</a></div><div class="ttdeci">PreservedAnalyses getLoopPassPreservedAnalyses()</div><div class="ttdoc">Returns the minimum set of Analyses that all loop passes must preserve.</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8cpp_source.html#l00138">LoopAnalysisManager.cpp:138</a></div></div>
<div class="ttc" id="aSafepointIRVerifier_8cpp_html_ae91b89e3dbb8e36d143a6efcc4d5d85a"><div class="ttname"><a href="SafepointIRVerifier_8cpp.html#ae91b89e3dbb8e36d143a6efcc4d5d85a">Verifier</a></div><div class="ttdeci">verify safepoint Safepoint IR Verifier</div><div class="ttdef"><b>Definition:</b> <a href="SafepointIRVerifier_8cpp_source.html#l00251">SafepointIRVerifier.cpp:251</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdoc">This class represents an analyzed expression in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00075">ScalarEvolution.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ae77be336e228cf9aa00709a8606dfb98"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">llvm::PatternMatch::m_Zero</a></div><div class="ttdeci">is_zero m_Zero()</div><div class="ttdoc">Match any null constant or a vector with all elements equal to 0.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00537">PatternMatch.h:537</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a350f4fdc01c770b5cf6a8be2624ae3e5"><div class="ttname"><a href="classllvm_1_1Instruction.html#a350f4fdc01c770b5cf6a8be2624ae3e5">llvm::Instruction::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const LLVM_READONLY</div><div class="ttdoc">Determine whether the no signed wrap flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00177">Instruction.cpp:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">This instruction compares its operands according to the predicate given to the constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01197">Instructions.h:1197</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfoWrapperPass.html">llvm::TargetLibraryInfoWrapperPass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00565">TargetLibraryInfo.h:565</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopPass_html"><div class="ttname"><a href="classllvm_1_1LoopPass.html">llvm::LoopPass</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopPass_8h_source.html#l00028">LoopPass.h:28</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfoWrapperPass.html">llvm::TargetTransformInfoWrapperPass</a></div><div class="ttdoc">Wrapper pass for TargetTransformInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l02682">TargetTransformInfo.h:2682</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a100c666f9253331dd1d166a863248326"><div class="ttname"><a href="classllvm_1_1Instruction.html#a100c666f9253331dd1d166a863248326">llvm::Instruction::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const LLVM_READONLY</div><div class="ttdoc">Determine whether the no unsigned wrap flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00173">Instruction.cpp:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="aclassllvm_1_1LPMUpdater_html"><div class="ttname"><a href="classllvm_1_1LPMUpdater.html">llvm::LPMUpdater</a></div><div class="ttdoc">This class provides an interface for updating the loop pass manager based on mutations to the loop ne...</div><div class="ttdef"><b>Definition:</b> <a href="LoopPassManager_8h_source.html#l00262">LoopPassManager.h:262</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a7004354fbee1c8cd74ed9001915e1db5"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a7004354fbee1c8cd74ed9001915e1db5">llvm::SmallPtrSetImpl::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00408">SmallPtrSet.h:408</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ae069a12f0a2d2deb69e30b439a91190e"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ae069a12f0a2d2deb69e30b439a91190e">llvm::LoopBase::getUniqueExitBlocks</a></div><div class="ttdeci">void getUniqueExitBlocks(SmallVectorImpl&lt; BlockT * &gt; &amp;ExitBlocks) const</div><div class="ttdoc">Return all unique successor blocks of this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00142">LoopInfoImpl.h:142</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a981d06c604c92a3b7845343de8c04471"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a981d06c604c92a3b7845343de8c04471">createPopcntIntrinsic</a></div><div class="ttdeci">static CallInst * createPopcntIntrinsic(IRBuilder&lt;&gt; &amp;IRBuilder, Value *Val, const DebugLoc &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01988">LoopIdiomRecognize.cpp:1988</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aMemoryLocation_8h_html"><div class="ttname"><a href="MemoryLocation_8h.html">MemoryLocation.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html"><div class="ttname"><a href="classllvm_1_1MemorySSA.html">llvm::MemorySSA</a></div><div class="ttdoc">Encapsulates MemorySSA, including all data associated with memory accesses.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00700">MemorySSA.h:700</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a7a7c8e0e4f836c13c015b62e18f386bd"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">llvm::LoopInfoBase::getLoopFor</a></div><div class="ttdeci">LoopT * getLoopFor(const BlockT *BB) const</div><div class="ttdoc">Return the inner most loop that BB lives in.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00992">LoopInfo.h:992</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ac3280e7f76f955403fe17eacf126b90d"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const</div><div class="ttdoc">If there is a preheader for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00183">LoopInfoImpl.h:183</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a427435d4da769ae680a8e77ef89520aa"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a427435d4da769ae680a8e77ef89520aa">llvm::PatternMatch::m_And</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::And &gt; m_And(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01093">PatternMatch.h:1093</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_abf73a826b5d6f739eb4af48ddf14c5b4"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#abf73a826b5d6f739eb4af48ddf14c5b4">llvm::SmallPtrSetImpl::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00403">SmallPtrSet.h:403</a></div></div>
<div class="ttc" id="aArrayRef_8h_html"><div class="ttname"><a href="ArrayRef_8h.html">ArrayRef.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVConstant_html"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html">llvm::SCEVConstant</a></div><div class="ttdoc">This class represents a constant integer value.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00060">ScalarEvolutionExpressions.h:60</a></div></div>
<div class="ttc" id="anamespacellvm_html_a87cba3c4c88ab5df01a7f7dece1e0266"><div class="ttname"><a href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">llvm::getOrInsertLibFunc</a></div><div class="ttdeci">FunctionCallee getOrInsertLibFunc(Module *M, const TargetLibraryInfo &amp;TLI, LibFunc TheLibFunc, FunctionType *T, AttributeList AttributeList)</div><div class="ttdoc">Calls getOrInsertFunction() and then makes sure to add mandatory argument attributes.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01285">BuildLibCalls.cpp:1285</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a33880aaca0ad05e5f1557f079305bde5"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">llvm::details::FixedOrScalableQuantity::getFixedValue</a></div><div class="ttdeci">constexpr ScalarTy getFixedValue() const</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00182">TypeSize.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9db8c44b250b90e3ab7e4d144e7c9c2e"><div class="ttname"><a href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2e">llvm::ModRefInfo</a></div><div class="ttdeci">ModRefInfo</div><div class="ttdoc">Flags indicating whether a memory access modifies or references memory.</div><div class="ttdef"><b>Definition:</b> <a href="ModRef_8h_source.html#l00027">ModRef.h:27</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ac3ed5602889a22db44a16e1b97fac5b8"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ac3ed5602889a22db44a16e1b97fac5b8">llvm::PatternMatch::m_Sub</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Sub &gt; m_Sub(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00991">PatternMatch.h:991</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_aa56e7093b552d99d48d66c5ae781236a"><div class="ttname"><a href="classllvm_1_1Value.html#aa56e7093b552d99d48d66c5ae781236a">llvm::Value::replaceUsesOutsideBlock</a></div><div class="ttdeci">void replaceUsesOutsideBlock(Value *V, BasicBlock *BB)</div><div class="ttdoc">replaceUsesOutsideBlock - Go through the uses list for this definition and make each use point to &quot;V&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00584">Value.cpp:584</a></div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="astructmatch__LoopInvariant_html_ab80c6bca262e3acb5a845956ee23ebe0"><div class="ttname"><a href="structmatch__LoopInvariant.html#ab80c6bca262e3acb5a845956ee23ebe0">match_LoopInvariant::SubPattern</a></div><div class="ttdeci">SubPattern_t SubPattern</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02245">LoopIdiomRecognize.cpp:2245</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a7ff0d8853961745bbe8afef66fab99dc"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a7ff0d8853961745bbe8afef66fab99dc">detectShiftUntilZeroIdiom</a></div><div class="ttdeci">static bool detectShiftUntilZeroIdiom(Loop *CurLoop, const DataLayout &amp;DL, Intrinsic::ID &amp;IntrinID, Value *&amp;InitX, Instruction *&amp;CntInst, PHINode *&amp;CntPhi, Instruction *&amp;DefX)</div><div class="ttdoc">Return true if the idiom is detected in the loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01773">LoopIdiomRecognize.cpp:1773</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html_a54699e3f128acda6003afc11d3027f6c"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">llvm::TargetLibraryInfo::has</a></div><div class="ttdeci">bool has(LibFunc F) const</div><div class="ttdoc">Tests whether a library function is available.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00340">TargetLibraryInfo.h:340</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0d69e81725c10fa5407f0bf34462068"><div class="ttname"><a href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">llvm::TTI</a></div><div class="ttdeci">TargetTransformInfo TTI</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00191">TargetTransformInfo.h:191</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpanderCleaner_html"><div class="ttname"><a href="classllvm_1_1SCEVExpanderCleaner.html">llvm::SCEVExpanderCleaner</a></div><div class="ttdoc">Helper to remove instructions inserted during SCEV expansion, unless they are marked as used.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00510">ScalarEvolutionExpander.h:510</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayType_html_adf411edc4f135b570ab218079474ce77"><div class="ttname"><a href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">llvm::ArrayType::get</a></div><div class="ttdeci">static ArrayType * get(Type *ElementType, uint64_t NumElements)</div><div class="ttdoc">This static method is the primary way to construct an ArrayType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00640">Type.cpp:640</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAAnalysis_html"><div class="ttname"><a href="classllvm_1_1MemorySSAAnalysis.html">llvm::MemorySSAAnalysis</a></div><div class="ttdoc">An analysis that produces MemorySSA for a function.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00936">MemorySSA.h:936</a></div></div>
<div class="ttc" id="aclassllvm_1_1SimpleLoopSafetyInfo_html_a262c2df9639d3f71b8d2a8158b819809"><div class="ttname"><a href="classllvm_1_1SimpleLoopSafetyInfo.html#a262c2df9639d3f71b8d2a8158b819809">llvm::SimpleLoopSafetyInfo::computeLoopSafetyInfo</a></div><div class="ttdeci">void computeLoopSafetyInfo(const Loop *CurLoop) override</div><div class="ttdoc">Computes safety information for a loop checks loop body &amp; header for the possibility of may throw exc...</div><div class="ttdef"><b>Definition:</b> <a href="MustExecute_8cpp_source.html#l00051">MustExecute.cpp:51</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aInstructionCost_8h_html"><div class="ttname"><a href="InstructionCost_8h.html">InstructionCost.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00174">User.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aM68kELFObjectWriter_8cpp_html_ae4a8bc3879d2282eefd72b16b12c2a37"><div class="ttname"><a href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a></div><div class="ttdeci">static M68kRelType getType(unsigned Kind, MCSymbolRefExpr::VariantKind &amp;Modifier, bool &amp;IsPCRel)</div><div class="ttdef"><b>Definition:</b> <a href="M68kELFObjectWriter_8cpp_source.html#l00048">M68kELFObjectWriter.cpp:48</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a8abe8ecbd58c795ba02e1b592903e766"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a8abe8ecbd58c795ba02e1b592903e766">DisableLIRPMemcpy</a></div><div class="ttdeci">static cl::opt&lt; bool, true &gt; DisableLIRPMemcpy(&quot;disable-&quot; DEBUG_TYPE &quot;-memcpy&quot;, cl::desc(&quot;Proceed with loop idiom recognize pass, but do &quot; &quot;not convert loop(s) to memcpy.&quot;), cl::location(DisableLIRP::Memcpy), cl::init(false), cl::ReallyHidden)</div></div>
<div class="ttc" id="aMachineInstrBundle_8cpp_html_af44c9b089359803924e0b92bea3b6d03"><div class="ttname"><a href="MachineInstrBundle_8cpp.html#af44c9b089359803924e0b92bea3b6d03">getDebugLoc</a></div><div class="ttdeci">static DebugLoc getDebugLoc(MachineBasicBlock::instr_iterator FirstMI, MachineBasicBlock::instr_iterator LastMI)</div><div class="ttdoc">Return the first found DebugLoc that has a DILocation, given a range of instructions.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8cpp_source.html#l00110">MachineInstrBundle.cpp:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a575c2299c6f145ba3a12efa20829db43"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a575c2299c6f145ba3a12efa20829db43">llvm::PatternMatch::m_CombineAnd</a></div><div class="ttdeci">match_combine_and&lt; LTy, RTy &gt; m_CombineAnd(const LTy &amp;L, const RTy &amp;R)</div><div class="ttdoc">Combine two pattern matchers matching L &amp;&amp; R.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00224">PatternMatch.h:224</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Sched_html_ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9"><div class="ttname"><a href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309eac13545a6345c7d5b3c9cc8932ad3b0e9">llvm::Sched::Source</a></div><div class="ttdeci">@ Source</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00100">TargetLowering.h:100</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_afa96fcb672bc190afac38ab7cc0e42b2"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">llvm::MemIntrinsicBase::getDest</a></div><div class="ttdeci">Value * getDest() const</div><div class="ttdoc">This is just like getRawDest, but it strips off any cast instructions (including addrspacecast) that ...</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00833">IntrinsicInst.h:833</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_a6b173e97523275314f3f2b433a5f71a9"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#a6b173e97523275314f3f2b433a5f71a9">llvm::AAMDNodes::merge</a></div><div class="ttdeci">AAMDNodes merge(const AAMDNodes &amp;Other) const</div><div class="ttdoc">Given two sets of AAMDNodes applying to potentially different locations, determine the best AAMDNodes...</div><div class="ttdef"><b>Definition:</b> <a href="TypeBasedAliasAnalysis_8cpp_source.html#l00522">TypeBasedAliasAnalysis.cpp:522</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00187">InstrTypes.h:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_abb22519fa3bf66d9e0bc6d1a733a5821"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#abb22519fa3bf66d9e0bc6d1a733a5821">llvm::PatternMatch::m_SpecificInt_ICMP</a></div><div class="ttdeci">cst_pred_ty&lt; icmp_pred_with_threshold &gt; m_SpecificInt_ICMP(ICmpInst::Predicate Predicate, const APInt &amp;Threshold)</div><div class="ttdoc">Match an integer or vector with every element comparing 'pred' (eg/ne/...) to Threshold.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00598">PatternMatch.h:598</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba7f80055e1969cb850739546467460ad8">llvm::TargetTransformInfo::TCK_SizeAndLatency</a></div><div class="ttdeci">@ TCK_SizeAndLatency</div><div class="ttdoc">The weighted sum of size and latency.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00245">TargetTransformInfo.h:245</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a2eb94d079d8416118f4aaed865ab05d7"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a2eb94d079d8416118f4aaed865ab05d7">llvm::ScalarEvolution::getConstant</a></div><div class="ttdeci">const SCEV * getConstant(ConstantInt *V)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00497">ScalarEvolution.cpp:497</a></div></div>
<div class="ttc" id="aLoopPass_8h_html"><div class="ttname"><a href="LoopPass_8h.html">LoopPass.h</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a882d55a6aa2028e1a5ad708b275334e0"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">llvm::ConstantInt::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">This is just a convenience method to make client code smaller for a common code.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00193">Constants.h:193</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a0fa33dfd6ffaaae721fc05b6941263aa"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a0fa33dfd6ffaaae721fc05b6941263aa">llvm::LoopBase::isOutermost</a></div><div class="ttdeci">bool isOutermost() const</div><div class="ttdoc">Return true if the loop does not have a parent (natural) loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00185">LoopInfo.h:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6a66ebb3aa12757479a3c88de77d78f8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">llvm::Instruction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const</div><div class="ttdoc">Return the function this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00074">Instruction.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdoc">Add the specified Pass class to the set of analyses preserved by this pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00098">PassAnalysisSupport.h:98</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aCostModel_8cpp_html_a263d4048026a7c0a91393b998181f16e"><div class="ttname"><a href="CostModel_8cpp.html#a263d4048026a7c0a91393b998181f16e">CostKind</a></div><div class="ttdeci">static cl::opt&lt; TargetTransformInfo::TargetCostKind &gt; CostKind(&quot;cost-kind&quot;, cl::desc(&quot;Target cost kind&quot;), cl::init(TargetTransformInfo::TCK_RecipThroughput), cl::values(clEnumValN(TargetTransformInfo::TCK_RecipThroughput, &quot;throughput&quot;, &quot;Reciprocal throughput&quot;), clEnumValN(TargetTransformInfo::TCK_Latency, &quot;latency&quot;, &quot;Instruction latency&quot;), clEnumValN(TargetTransformInfo::TCK_CodeSize, &quot;code-size&quot;, &quot;Code size&quot;), clEnumValN(TargetTransformInfo::TCK_SizeAndLatency, &quot;size-latency&quot;, &quot;Code size and latency&quot;)))</div></div>
<div class="ttc" id="aBasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00806">BasicAliasAnalysis.cpp:806</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9db8c44b250b90e3ab7e4d144e7c9c2ea7aeb0277500c86e4aa6bd23f9a737942"><div class="ttname"><a href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea7aeb0277500c86e4aa6bd23f9a737942">llvm::ModRefInfo::Mod</a></div><div class="ttdeci">@ Mod</div><div class="ttdoc">The access may modify the value stored in memory.</div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382"><div class="ttname"><a href="classllvm_1_1SCEV.html#af43000d4dcb7d6d63cb6e36933ed3f6faafb62cd6afdc004ef6e8a1f6288eb382">llvm::SCEV::FlagNUW</a></div><div class="ttdeci">@ FlagNUW</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00133">ScalarEvolution.h:133</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a13cc1f5d3225f4ec063520a747acec4c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a13cc1f5d3225f4ec063520a747acec4c">llvm::ConstantInt::isMinusOne</a></div><div class="ttdeci">bool isMinusOne() const</div><div class="ttdoc">This function will return true iff every bit in this constant is set to true.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00205">Constants.h:205</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_aa09379aa4435be95eb717dd9b5d8b4c5"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#aa09379aa4435be95eb717dd9b5d8b4c5">llvm::LoopStandardAnalysisResults::LI</a></div><div class="ttdeci">LoopInfo &amp; LI</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00055">LoopAnalysisManager.h:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryAccess_html"><div class="ttname"><a href="classllvm_1_1MemoryAccess.html">llvm::MemoryAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00142">MemorySSA.h:142</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a50d03d8db5d7e05c9ddb41c6bdc7dec0"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a50d03d8db5d7e05c9ddb41c6bdc7dec0">idiom</a></div><div class="ttdeci">loop idiom</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00342">LoopIdiomRecognize.cpp:342</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aValueHandle_8h_html"><div class="ttname"><a href="ValueHandle_8h.html">ValueHandle.h</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_ad5b80034d8c2856f418f1eb8c4901a6c"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#ad5b80034d8c2856f418f1eb8c4901a6c">matchCondition</a></div><div class="ttdeci">static Value * matchCondition(BranchInst *BI, BasicBlock *LoopEntry, bool JmpOnZero=false)</div><div class="ttdoc">Check if the given conditional branch is based on the comparison between a variable and zero,...</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01579">LoopIdiomRecognize.cpp:1579</a></div></div>
<div class="ttc" id="aclassllvm_1_1SimpleLoopSafetyInfo_html_aa1b6a065ad4fde175bf904917241cba9"><div class="ttname"><a href="classllvm_1_1SimpleLoopSafetyInfo.html#aa1b6a065ad4fde175bf904917241cba9">llvm::SimpleLoopSafetyInfo::anyBlockMayThrow</a></div><div class="ttdeci">bool anyBlockMayThrow() const override</div><div class="ttdoc">Returns true iff any block of the loop for which this info is contains an instruction that may throw ...</div><div class="ttdef"><b>Definition:</b> <a href="MustExecute_8cpp_source.html#l00047">MustExecute.cpp:47</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_aefa39f6b622360ce4e947feb9f671b73"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=std::nullopt)</div><div class="ttdoc">Create or insert an LLVM Function declaration for an intrinsic, and return it.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l01502">Function.cpp:1502</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_ade6253c0c19609ec9c632e60e08896fb"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#ade6253c0c19609ec9c632e60e08896fb">mayLoopAccessLocation</a></div><div class="ttdeci">static bool mayLoopAccessLocation(Value *Ptr, ModRefInfo Access, Loop *L, const SCEV *BECount, const SCEV *StoreSizeSCEV, AliasAnalysis &amp;AA, SmallPtrSetImpl&lt; Instruction * &gt; &amp;IgnoredInsts)</div><div class="ttdoc">mayLoopAccessLocation - Return true if the specified loop might access the specified pointer location...</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01005">LoopIdiomRecognize.cpp:1005</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a1c455e007178a24dfb18ac0e200ea02c"><div class="ttname"><a href="classllvm_1_1Function.html#a1c455e007178a24dfb18ac0e200ea02c">llvm::Function::hasOptSize</a></div><div class="ttdeci">bool hasOptSize() const</div><div class="ttdoc">Optimize this function for size (-Os) or minimum size (-Oz).</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00644">Function.h:644</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a5a19768af81df7e5fe571bc08dcd48b3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">llvm::ScalarEvolution::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const SCEV *S, const Loop *L)</div><div class="ttdoc">Return true if the value of the given SCEV is unchanging in the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l13775">ScalarEvolution.cpp:13775</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a419746e2bdc89fee0101b010a13ec0c7"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a419746e2bdc89fee0101b010a13ec0c7">detectShiftUntilBitTestIdiom</a></div><div class="ttdeci">static bool detectShiftUntilBitTestIdiom(Loop *CurLoop, Value *&amp;BaseX, Value *&amp;BitMask, Value *&amp;BitPos, Value *&amp;CurrX, Instruction *&amp;NextX)</div><div class="ttdoc">Return true if the idiom is detected in the loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02284">LoopIdiomRecognize.cpp:2284</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab706e7ebb1969c5e34f28bfcf2ff719e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00326">BasicBlock.h:326</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopIdiomRecognizePass_html_a4a3aed1996ede85e98aa361e6f5d74a2"><div class="ttname"><a href="classllvm_1_1LoopIdiomRecognizePass.html#a4a3aed1996ede85e98aa361e6f5d74a2">llvm::LoopIdiomRecognizePass::run</a></div><div class="ttdeci">PreservedAnalyses run(Loop &amp;L, LoopAnalysisManager &amp;AM, LoopStandardAnalysisResults &amp;AR, LPMUpdater &amp;U)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00313">LoopIdiomRecognize.cpp:313</a></div></div>
<div class="ttc" id="astructllvm_1_1DisableLIRP_html_ab19e3cae2e9e472353062a181092d68f"><div class="ttname"><a href="structllvm_1_1DisableLIRP.html#ab19e3cae2e9e472353062a181092d68f">llvm::DisableLIRP::Memcpy</a></div><div class="ttdeci">static bool Memcpy</div><div class="ttdoc">When true, Memcpy is disabled.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8h_source.html#l00036">LoopIdiomRecognize.h:36</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="anamespacellvm_html_a57d0e3799b16937e1f8df20ca1f1f3df"><div class="ttname"><a href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">llvm::isLibFuncEmittable</a></div><div class="ttdeci">bool isLibFuncEmittable(const Module *M, const TargetLibraryInfo *TLI, LibFunc TheLibFunc)</div><div class="ttdoc">Check whether the library function is available on target and also that it in the current Module is a...</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01363">BuildLibCalls.cpp:1363</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_aca5de061452897f79eaf9d8964d3b269"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#aca5de061452897f79eaf9d8964d3b269">getNumBytes</a></div><div class="ttdeci">static const SCEV * getNumBytes(const SCEV *BECount, Type *IntPtr, const SCEV *StoreSizeSCEV, Loop *CurLoop, const DataLayout *DL, ScalarEvolution *SE)</div><div class="ttdoc">Compute the number of bytes as a SCEV from the backedge taken count.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01084">LoopIdiomRecognize.cpp:1084</a></div></div>
<div class="ttc" id="aConstant_8h_html"><div class="ttname"><a href="Constant_8h.html">Constant.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a592bdd7731b14ff4ff5d646f6f399900"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">llvm::ScalarEvolution::forgetLoop</a></div><div class="ttdeci">void forgetLoop(const Loop *L)</div><div class="ttdoc">This method should be called by the client when it has changed a loop in a way that may effect Scalar...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08463">ScalarEvolution.cpp:8463</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_af6314c51a3cc5a619beb697246177bf0"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00342">ScalarEvolutionExpressions.h:342</a></div></div>
<div class="ttc" id="anamespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00050">GraphWriter.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad4d2f143e181b60a4f70d791bbcba8b3"><div class="ttname"><a href="namespacellvm.html#ad4d2f143e181b60a4f70d791bbcba8b3">llvm::decomposeBitTestICmp</a></div><div class="ttdeci">bool decomposeBitTestICmp(Value *LHS, Value *RHS, CmpInst::Predicate &amp;Pred, Value *&amp;X, APInt &amp;Mask, bool LookThroughTrunc=true)</div><div class="ttdoc">Decompose an icmp into the form ((X &amp; Mask) pred 0) if possible.</div><div class="ttdef"><b>Definition:</b> <a href="CmpInstAnalysis_8cpp_source.html#l00076">CmpInstAnalysis.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a8bcb86d8d126d95b0dc05f09e8f3df96"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">llvm::ScalarEvolution::getMinusSCEV</a></div><div class="ttdeci">const SCEV * getMinusSCEV(const SCEV *LHS, const SCEV *RHS, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Return LHS-RHS.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04642">ScalarEvolution.cpp:4642</a></div></div>
<div class="ttc" id="anamespacellvm_html_aebf1ed936ad0e792e159d7a4ae1b7f07"><div class="ttname"><a href="namespacellvm.html#aebf1ed936ad0e792e159d7a4ae1b7f07">llvm::None</a></div><div class="ttdeci">constexpr std::nullopt_t None</div><div class="ttdef"><b>Definition:</b> <a href="None_8h_source.html#l00028">None.h:28</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_a81f3c11f463009d8b19b544f5bfed40c"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#a81f3c11f463009d8b19b544f5bfed40c">llvm::AAMDNodes::NoAlias</a></div><div class="ttdeci">MDNode * NoAlias</div><div class="ttdoc">The tag specifying the noalias scope.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00677">Metadata.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_abcb1eb8c51771752c4fee2d539fa25cc"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">llvm::MemIntrinsicBase::getLength</a></div><div class="ttdeci">Value * getLength() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00824">IntrinsicInst.h:824</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_a3444a9359f5f17f1694f82c41d5fd574"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#a3444a9359f5f17f1694f82c41d5fd574">llvm::LoopStandardAnalysisResults::TTI</a></div><div class="ttdeci">TargetTransformInfo &amp; TTI</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00058">LoopAnalysisManager.h:58</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_ac65a3f99550bda88e8f41035695aacdd"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#ac65a3f99550bda88e8f41035695aacdd">getMemSetPatternValue</a></div><div class="ttdeci">static Constant * getMemSetPatternValue(Value *V, const DataLayout *DL)</div><div class="ttdoc">getMemSetPatternValue - If a strided store of the specified value is safe to turn into a memset_patte...</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00436">LoopIdiomRecognize.cpp:436</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a177844335152e882e8ac429dd1102716"><div class="ttname"><a href="namespacellvm_1_1ore.html#a177844335152e882e8ac429dd1102716">llvm::ore::setExtraArgs</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::setExtraArgs setExtraArgs</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00138">OptimizationRemarkEmitter.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_afe7d477c6022fe7123b90e3b39c58e69"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#afe7d477c6022fe7123b90e3b39c58e69">llvm::ConstantInt::getBool</a></div><div class="ttdeci">static ConstantInt * getBool(LLVMContext &amp;Context, bool V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00849">Constants.cpp:849</a></div></div>
<div class="ttc" id="aGlobalVariable_8h_html"><div class="ttname"><a href="GlobalVariable_8h.html">GlobalVariable.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ae3f9633c349ede5341aa376d9c97dd8f"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ae3f9633c349ede5341aa376d9c97dd8f">llvm::IRBuilderBase::GetInsertBlock</a></div><div class="ttdeci">BasicBlock * GetInsertBlock() const</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00174">IRBuilder.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html_a9773fde54683945b9e34a0f2e5c1a5a5a7806c120eb87aea9fbb52fed327e09de"><div class="ttname"><a href="classllvm_1_1MemorySSA.html#a9773fde54683945b9e34a0f2e5c1a5a5a7806c120eb87aea9fbb52fed327e09de">llvm::MemorySSA::BeforeTerminator</a></div><div class="ttdeci">@ BeforeTerminator</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00788">MemorySSA.h:788</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html"><div class="ttname"><a href="classllvm_1_1TypeSize.html">llvm::TypeSize</a></div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00314">TypeSize.h:314</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdoc">This node represents a polynomial recurrence on the trip count of the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00330">ScalarEvolutionExpressions.h:330</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a459b2591fc1a4a281fb3bb73cde092b9"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a459b2591fc1a4a281fb3bb73cde092b9">idioms</a></div><div class="ttdeci">loop Recognize loop idioms</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00343">LoopIdiomRecognize.cpp:343</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a21c2c6ae5ec23004dc4020eacf83bbce"><div class="ttname"><a href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">llvm::SetVector::count</a></div><div class="ttdeci">size_type count(const key_type &amp;key) const</div><div class="ttdoc">Count the number of elements of a given key in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00208">SetVector.h:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdoc">Provides information about what library functions are available for the current target.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00234">TargetLibraryInfo.h:234</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_a1ecb726f4e7b445057b795ed500546a0"><div class="ttname"><a href="classllvm_1_1SCEV.html#a1ecb726f4e7b445057b795ed500546a0">llvm::SCEV::isOne</a></div><div class="ttdeci">bool isOne() const</div><div class="ttdoc">Return true if the expression is a constant one.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00466">ScalarEvolution.cpp:466</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantArray_html_a0900dacdc7ad8e3ea0cc92993c7fd422"><div class="ttname"><a href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">llvm::ConstantArray::get</a></div><div class="ttdeci">static Constant * get(ArrayType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01249">Constants.cpp:1249</a></div></div>
<div class="ttc" id="anamespacellvm_html_afc6337ef6e00f6bebd44d81b685d655f"><div class="ttname"><a href="namespacellvm.html#afc6337ef6e00f6bebd44d81b685d655f">llvm::GetPointerBaseWithConstantOffset</a></div><div class="ttdeci">Value * GetPointerBaseWithConstantOffset(Value *Ptr, int64_t &amp;Offset, const DataLayout &amp;DL, bool AllowNonInbounds=true)</div><div class="ttdoc">Analyze the specified pointer to see if it can be expressed as a base pointer plus a constant offset.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8h_source.html#l00271">ValueTracking.h:271</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac505d74d262ee1e64d87b07121199e36a93cba07454f06a4a960172bbd6e2a435"><div class="ttname"><a href="namespacellvm.html#ac505d74d262ee1e64d87b07121199e36a93cba07454f06a4a960172bbd6e2a435">llvm::PrevailingType::Yes</a></div><div class="ttdeci">@ Yes</div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a389bb3581ba3c8094b89642efaf8e514"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">llvm::LoopBase::getNumBackEdges</a></div><div class="ttdeci">unsigned getNumBackEdges() const</div><div class="ttdoc">Calculate the number of back edges to the loop header.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00267">LoopInfo.h:267</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">llvm::MCID::Add</a></div><div class="ttdeci">@ Add</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00186">MCInstrDesc.h:186</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a126a12b67fa620ad28ec0c919ca7a3e8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">llvm::CmpInst::setPredicate</a></div><div class="ttdeci">void setPredicate(Predicate P)</div><div class="ttdoc">Set the predicate for this instruction to the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00811">InstrTypes.h:811</a></div></div>
<div class="ttc" id="aSLPVectorizer_8cpp_html_a3ca9742688618517cc4690fb947fb609"><div class="ttname"><a href="SLPVectorizer_8cpp.html#a3ca9742688618517cc4690fb947fb609">isSimple</a></div><div class="ttdeci">static bool isSimple(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="SLPVectorizer_8cpp_source.html#l00821">SLPVectorizer.cpp:821</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_a124376878e24aef4252795ba9fea420f"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#a124376878e24aef4252795ba9fea420f">llvm::LoopStandardAnalysisResults::SE</a></div><div class="ttdeci">ScalarEvolution &amp; SE</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00056">LoopAnalysisManager.h:56</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_abd7da877be8576011299f4fcaaf299be"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#abd7da877be8576011299f4fcaaf299be">llvm::LoopStandardAnalysisResults::AA</a></div><div class="ttdeci">AAResults &amp; AA</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00052">LoopAnalysisManager.h:52</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_a56188042f9dd6003cb8ed087e8ae654f"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#a56188042f9dd6003cb8ed087e8ae654f">llvm::AAMDNodes::TBAA</a></div><div class="ttdeci">MDNode * TBAA</div><div class="ttdoc">The tag for type-based alias analysis.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00668">Metadata.h:668</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVConstant_html_a17304ab072a5b259c03e766a2b78a30b"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">llvm::SCEVConstant::getAPInt</a></div><div class="ttdeci">const APInt &amp; getAPInt() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00070">ScalarEvolutionExpressions.h:70</a></div></div>
<div class="ttc" id="aScalarEvolutionExpressions_8h_html"><div class="ttname"><a href="ScalarEvolutionExpressions_8h.html">ScalarEvolutionExpressions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aclassllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdoc">Pass interface - Implemented by all 'passes'.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00091">Pass.h:91</a></div></div>
<div class="ttc" id="aMemorySSA_8h_html"><div class="ttname"><a href="MemorySSA_8h.html">MemorySSA.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6d745b25efdc69435508f1e936919f8b"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6d745b25efdc69435508f1e936919f8b">llvm::ScalarEvolution::getZeroExtendExpr</a></div><div class="ttdeci">const SCEV * getZeroExtendExpr(const SCEV *Op, Type *Ty, unsigned Depth=0)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l01609">ScalarEvolution.cpp:1609</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">llvm::GlobalValue::PrivateLinkage</a></div><div class="ttdeci">@ PrivateLinkage</div><div class="ttdoc">Like Internal, but omit from symbol table.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00056">GlobalValue.h:56</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemCpyInst_html"><div class="ttname"><a href="classllvm_1_1MemCpyInst.html">llvm::MemCpyInst</a></div><div class="ttdoc">This class wraps the llvm.memcpy intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01132">IntrinsicInst.h:1132</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a2eccc19f9061eeb7ad1e30e21f76034d"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">llvm::LoadInst::isVolatile</a></div><div class="ttdeci">bool isVolatile() const</div><div class="ttdoc">Return true if this is a load from a volatile memory location.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00214">Instructions.h:214</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsic_html_ada78af22b202d8b7d9fe772c2c9476ce"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">llvm::MemIntrinsic::isVolatile</a></div><div class="ttdeci">bool isVolatile() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01057">IntrinsicInst.h:1057</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="astructmatch__LoopInvariant_html_a6f131444d55da7baae124947522860e5"><div class="ttname"><a href="structmatch__LoopInvariant.html#a6f131444d55da7baae124947522860e5">match_LoopInvariant::match_LoopInvariant</a></div><div class="ttdeci">match_LoopInvariant(const SubPattern_t &amp;SP, const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02248">LoopIdiomRecognize.cpp:2248</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a2d9861feadd3a09792967a012559e7b2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a2d9861feadd3a09792967a012559e7b2">llvm::PatternMatch::m_Specific</a></div><div class="ttdeci">specificval_ty m_Specific(const Value *V)</div><div class="ttdoc">Match if we have a specific specified value.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00772">PatternMatch.h:772</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aUser_8h_html"><div class="ttname"><a href="User_8h.html">User.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_ac03c1c093059ea000216af8dd6f2dbf4"><div class="ttname"><a href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">llvm::StoreInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00393">Instructions.h:393</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a31c5c58143c6e9da9c544a7afcba2710"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a31c5c58143c6e9da9c544a7afcba2710">llvm::IRBuilderBase::CreateCall</a></div><div class="ttdeci">CallInst * CreateCall(FunctionType *FTy, Value *Callee, ArrayRef&lt; Value * &gt; Args=std::nullopt, const Twine &amp;Name=&quot;&quot;, MDNode *FPMathTag=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02293">IRBuilder.h:2293</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a3fe9b3ddb71b9fb53d9fc74b3a0710bf"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a3fe9b3ddb71b9fb53d9fc74b3a0710bf">llvm::PatternMatch::m_ICmp</a></div><div class="ttdeci">CmpClass_match&lt; LHS, RHS, ICmpInst, ICmpInst::Predicate &gt; m_ICmp(ICmpInst::Predicate &amp;Pred, const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01394">PatternMatch.h:1394</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad">llvm::CmpInst::ICMP_UGT</a></div><div class="ttdeci">@ ICMP_UGT</div><div class="ttdoc">unsigned greater than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00741">InstrTypes.h:741</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab9f68be0e2bcdf14f503f45edea63023"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">llvm::BasicBlock::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00324">BasicBlock.h:324</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa7414ba9f658ff1287d22a4b8fe81bcb"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const</div><div class="ttdoc">Return the predicate for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00808">InstrTypes.h:808</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a4d5ee57f499d862572c863b9e190884f"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a4d5ee57f499d862572c863b9e190884f">llvm::ScalarEvolution::getZero</a></div><div class="ttdeci">const SCEV * getZero(Type *Ty)</div><div class="ttdoc">Return a SCEV for the constant 0 of a specific type.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00653">ScalarEvolution.h:653</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_ab5f1717b899684c80274c08ed18d34a9"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#ab5f1717b899684c80274c08ed18d34a9">getStartForNegStride</a></div><div class="ttdeci">static const SCEV * getStartForNegStride(const SCEV *Start, const SCEV *BECount, Type *IntPtr, const SCEV *StoreSizeSCEV, ScalarEvolution *SE)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01039">LoopIdiomRecognize.cpp:1039</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_a1cfb392c267da10531478c2f42baa603"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#a1cfb392c267da10531478c2f42baa603">llvm::LoopStandardAnalysisResults::MSSA</a></div><div class="ttdeci">MemorySSA * MSSA</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00061">LoopAnalysisManager.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionCallee_html"><div class="ttname"><a href="classllvm_1_1FunctionCallee.html">llvm::FunctionCallee</a></div><div class="ttdoc">A handy container for a FunctionType+Callee-pointer pair, which can be passed around as a single enti...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00165">DerivedTypes.h:165</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="ablake3__impl_8h_html_a78823051d1dad34b9b3d8120112e674d"><div class="ttname"><a href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a></div><div class="ttdeci">static const uint32_t IV[8]</div><div class="ttdef"><b>Definition:</b> <a href="blake3__impl_8h_source.html#l00077">blake3_impl.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl&lt; BasicBlock * &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a422b020a05731c432411d574a7728af5"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a422b020a05731c432411d574a7728af5">llvm::TargetTransformInfo::getAtomicMemIntrinsicMaxElementSize</a></div><div class="ttdeci">unsigned getAtomicMemIntrinsicMaxElementSize() const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l01058">TargetTransformInfo.cpp:1058</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a61efc8509b54500974e6e976516cf7c9"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a61efc8509b54500974e6e976516cf7c9">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(LoopIdiomRecognizeLegacyPass, &quot;loop-idiom&quot;, &quot;Recognize loop idioms&quot;, false, false) INITIALIZE_PASS_END(LoopIdiomRecognizeLegacyPass</div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl&lt; Instruction * &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_aefeda9454a5e8dfcec3deb106964832a"><div class="ttname"><a href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">llvm::SCEV::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">Return the LLVM type of this SCEV expression.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00401">ScalarEvolution.cpp:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_aef6d2bea715d1793e956f41ddeea2320"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">llvm::ScalarEvolution::getAddExpr</a></div><div class="ttdeci">const SCEV * getAddExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Get a canonical add expression, or something simpler if possible.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02537">ScalarEvolution.cpp:2537</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a450f245604b777ad6722de8c2c0caff9"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a450f245604b777ad6722de8c2c0caff9">createFFSIntrinsic</a></div><div class="ttdeci">static CallInst * createFFSIntrinsic(IRBuilder&lt;&gt; &amp;IRBuilder, Value *Val, const DebugLoc &amp;DL, bool ZeroCheck, Intrinsic::ID IID)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l02001">LoopIdiomRecognize.cpp:2001</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a244bfbe5aae876e56cf5e62f0f27867a"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">llvm::ConstantInt::isOne</a></div><div class="ttdeci">bool isOne() const</div><div class="ttdoc">This is just a convenience method to make client code smaller for a common case.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00199">Constants.h:199</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ac072f8698be17d52f20bb63d59e6ce41"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ac072f8698be17d52f20bb63d59e6ce41">llvm::LoadInst::isUnordered</a></div><div class="ttdeci">bool isUnordered() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00258">Instructions.h:258</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_a3f1744064251470bbd48733d160d24bb"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#a3f1744064251470bbd48733d160d24bb">DisableLIRPMemset</a></div><div class="ttdeci">static cl::opt&lt; bool, true &gt; DisableLIRPMemset(&quot;disable-&quot; DEBUG_TYPE &quot;-memset&quot;, cl::desc(&quot;Proceed with loop idiom recognize pass, but do &quot; &quot;not convert loop(s) to memset.&quot;), cl::location(DisableLIRP::Memset), cl::init(false), cl::ReallyHidden)</div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_aebc62faf59fecc07e8471fcf035d789e"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#aebc62faf59fecc07e8471fcf035d789e">deleteDeadInstruction</a></div><div class="ttdeci">static void deleteDeadInstruction(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l00347">LoopIdiomRecognize.cpp:347</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4a57dcd94b6daa3eacdbe8471955f4b1"><div class="ttname"><a href="namespacellvm.html#a4a57dcd94b6daa3eacdbe8471955f4b1">llvm::inferNonMandatoryLibFuncAttrs</a></div><div class="ttdeci">bool inferNonMandatoryLibFuncAttrs(Module *M, StringRef Name, const TargetLibraryInfo &amp;TLI)</div><div class="ttdoc">Analyze the name and prototype of the given function and set any applicable attributes.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l00253">BuildLibCalls.cpp:253</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa29fe161c408879ada30c90ebbf55dcf"><div class="ttname"><a href="namespacellvm.html#aa29fe161c408879ada30c90ebbf55dcf">llvm::VerifyMemorySSA</a></div><div class="ttdeci">bool VerifyMemorySSA</div><div class="ttdoc">Enables verification of MemorySSA.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8cpp_source.html#l00089">MemorySSA.cpp:89</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">llvm::TargetTransformInfo::TCC_Basic</a></div><div class="ttdeci">@ TCC_Basic</div><div class="ttdoc">The cost of a typical 'add' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00268">TargetTransformInfo.h:268</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00381">Value.cpp:381</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdoc">A debug info location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00033">DebugLoc.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_acec0ee78d2266b990662e36784791999"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#acec0ee78d2266b990662e36784791999">llvm::PatternMatch::m_BasicBlock</a></div><div class="ttdeci">class_match&lt; BasicBlock &gt; m_BasicBlock()</div><div class="ttdoc">Match an arbitrary basic block value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00168">PatternMatch.h:168</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalObject_html_a49b398b1c83ef4d42c8f7756b443f61f"><div class="ttname"><a href="classllvm_1_1GlobalObject.html#a49b398b1c83ef4d42c8f7756b443f61f">llvm::GlobalObject::setAlignment</a></div><div class="ttdeci">void setAlignment(Align Align)</div><div class="ttdoc">Sets the alignment attribute of the GlobalObject.</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00130">Globals.cpp:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVNAryExpr_html_a1714619ea14108def95a89c39adbe6f4"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#a1714619ea14108def95a89c39adbe6f4">llvm::SCEVNAryExpr::getOperand</a></div><div class="ttdeci">const SCEV * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00196">ScalarEvolutionExpressions.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector</a></div><div class="ttdoc">A vector that has set insertion semantics.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00040">SetVector.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a22d9bcbd44563106d7217f3bd9a4039e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">llvm::ScalarEvolution::getBackedgeTakenCount</a></div><div class="ttdeci">const SCEV * getBackedgeTakenCount(const Loop *L, ExitCountKind Kind=Exact)</div><div class="ttdoc">If the specified loop has a predictable backedge-taken count, return it, otherwise return a SCEVCould...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08331">ScalarEvolution.cpp:8331</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_af74676a3c7447be34bd2c1da76ec0c48"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#af74676a3c7447be34bd2c1da76ec0c48">llvm::SmallPtrSetImpl::contains</a></div><div class="ttdeci">bool contains(ConstPtrType Ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00389">SmallPtrSet.h:389</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aLoopIdiomRecognize_8cpp_html_adde19680053c8b4956a7417a6ef13e36"><div class="ttname"><a href="LoopIdiomRecognize_8cpp.html#adde19680053c8b4956a7417a6ef13e36">getRecurrenceVar</a></div><div class="ttdeci">static PHINode * getRecurrenceVar(Value *VarX, Instruction *DefX, BasicBlock *LoopEntry)</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8cpp_source.html#l01607">LoopIdiomRecognize.cpp:1607</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_a9e363c1eaf112166372e2d52704981fb"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#a9e363c1eaf112166372e2d52704981fb">llvm::LoopStandardAnalysisResults::TLI</a></div><div class="ttdeci">TargetLibraryInfo &amp; TLI</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00057">LoopAnalysisManager.h:57</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aBuildLibCalls_8h_html"><div class="ttname"><a href="BuildLibCalls_8h.html">BuildLibCalls.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a37668d9884c78ac77254cf9fb8a4276a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a37668d9884c78ac77254cf9fb8a4276a">llvm::PatternMatch::m_Shl</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::Shl &gt; m_Shl(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01111">PatternMatch.h:1111</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="anamespacellvm_1_1APIntOps_html_afee2477c062b67b487941ee0f4ff95ba"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#afee2477c062b67b487941ee0f4ff95ba">llvm::APIntOps::smax</a></div><div class="ttdeci">const APInt &amp; smax(const APInt &amp;A, const APInt &amp;B)</div><div class="ttdoc">Determine the larger of two APInts considered to be signed.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l02180">APInt.h:2180</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a7e4be8b16fbd68c9045a388904044e01"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03218">Instructions.h:3218</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9db8c44b250b90e3ab7e4d144e7c9c2ea6524b183b5cd0850f2cff6d30d581af9"><div class="ttname"><a href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2ea6524b183b5cd0850f2cff6d30d581af9">llvm::ModRefInfo::ModRef</a></div><div class="ttdeci">@ ModRef</div><div class="ttdoc">The access may reference and may modify the value stored in memory.</div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html">llvm::MemoryLocation</a></div><div class="ttdoc">Representation for a specific memory location.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00211">MemoryLocation.h:211</a></div></div>
<div class="ttc" id="astructllvm_1_1DisableLIRP_html_a6d928236e02987de2267a46cd4211336"><div class="ttname"><a href="structllvm_1_1DisableLIRP.html#a6d928236e02987de2267a46cd4211336">llvm::DisableLIRP::Memset</a></div><div class="ttdeci">static bool Memset</div><div class="ttdoc">When true, Memset is disabled.</div><div class="ttdef"><b>Definition:</b> <a href="LoopIdiomRecognize_8h_source.html#l00033">LoopIdiomRecognize.h:33</a></div></div>
<div class="ttc" id="aSetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_abc415418337d16a2b07a2b8ab6e8dc36"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#abc415418337d16a2b07a2b8ab6e8dc36">llvm::AAMDNodes::extendTo</a></div><div class="ttdeci">AAMDNodes extendTo(ssize_t Len) const</div><div class="ttdoc">Create a new AAMDNode that describes this AAMDNode after extending it to apply to a series of bytes o...</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00718">Metadata.h:718</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_a308bc73da13a316c472338f9be5562e8"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">llvm::MemTransferBase::getSource</a></div><div class="ttdeci">Value * getSource() const</div><div class="ttdoc">This is just like getRawSource, but it strips off any cast instructions that feed it,...</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00894">IntrinsicInst.h:894</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_a80add6b3b1cdaec560907995127adc16"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">llvm::Intrinsic::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00039">TargetTransformInfo.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1PoisonValue_html_a1bf08613fb664a2e377a9a72c59a6b66"><div class="ttname"><a href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">llvm::PoisonValue::get</a></div><div class="ttdeci">static PoisonValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'poison' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01759">Constants.cpp:1759</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:31:48 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
