<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/X86/X86InstCombineIntrinsic.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_558b7c0c66e2ff4834e628dd4b3edd32.html">X86</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">X86InstCombineIntrinsic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="X86InstCombineIntrinsic_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- X86InstCombineIntrinsic.cpp - X86 specific InstCombine pass -------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// This file implements a TargetTransformInfo analysis pass specific to the</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// X86 target machine. It uses the target&#39;s detailed information to provide</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// more precise answers to certain TTI queries, while letting the target</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/// independent and default TTI implementations handle the rest.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86TargetTransformInfo_8h.html">X86TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsX86.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KnownBits_8h.html">llvm/Support/KnownBits.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstCombiner_8h.html">llvm/Transforms/InstCombine/InstCombiner.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   25</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;x86tti&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/// Return a constant boolean vector that has true elements in all positions</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/// where the input constant data vector has an element with the sign bit set.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#afdc88fd3067f332e0080c7dfdf3fbbbb">   29</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#afdc88fd3067f332e0080c7dfdf3fbbbb">getNegativeIsTrueBoolVec</a>(<a class="code" href="classllvm_1_1Constant.html">Constant</a> *V) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *IntTy = <a class="code" href="classllvm_1_1VectorType.html#a7fdb2317662e3e901e47544a40190f12">VectorType::getInteger</a>(cast&lt;VectorType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  V = <a class="code" href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">ConstantExpr::getBitCast</a>(V, IntTy);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  V = <a class="code" href="classllvm_1_1ConstantExpr.html#a68fce0638c5ec7b96b8572cad9c20488">ConstantExpr::getICmp</a>(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a">CmpInst::ICMP_SGT</a>, <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(IntTy),</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                            V);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/// Convert the x86 XMM integer vector mask to a vector of bools based on</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/// each element&#39;s most significant bit (the sign bit).</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a5823441d951ade391206be8c839f8f3e">   39</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a5823441d951ade391206be8c839f8f3e">getBoolVecFromMask</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// Fold Constant Mask.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ConstantMask = dyn_cast&lt;ConstantDataVector&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>))</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86InstCombineIntrinsic_8cpp.html#afdc88fd3067f332e0080c7dfdf3fbbbb">getNegativeIsTrueBoolVec</a>(ConstantMask);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// Mask was extended from a boolean vector.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ExtMask;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">PatternMatch::match</a>(</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;          <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aaab494a433fbb23bc68393ee8bcfc5ac">PatternMatch::m_SExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">PatternMatch::m_Value</a>(ExtMask))) &amp;&amp;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      ExtMask-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">isIntOrIntVectorTy</a>(1))</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">return</span> ExtMask;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// TODO: If the x86 backend knew how to convert a bool vector mask back to an</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// XMM register mask efficiently, we could transform all x86 masked intrinsics</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// to LLVM masked intrinsics and remove the x86 masked intrinsic defs.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a8ad21e3937e91bb59d18d2c76915fe5c">   57</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a8ad21e3937e91bb59d18d2c76915fe5c">simplifyX86MaskedLoad</a>(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II, <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = II.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = II.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ZeroVec = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// Zero Mask - masked load instruction creates a zero vector.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantAggregateZero&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>))</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, ZeroVec);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">// The mask is constant or extended from a bool vector. Convert this x86</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// intrinsic to the LLVM intrinsic to allow target-independent optimizations.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *BoolMask = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a5823441d951ade391206be8c839f8f3e">getBoolVecFromMask</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>)) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// First, cast the x86 intrinsic scalar pointer to a vector pointer to match</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// the LLVM intrinsic definition for the pointer argument.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">unsigned</span> AddrSpace = cast&lt;PointerType&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType())-&gt;getAddressSpace();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *VecPtrTy = <a class="code" href="classllvm_1_1PointerType.html#a050a395d1656e546679d8b144d951bb2">PointerType::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), AddrSpace);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrCast = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a06d64f226fabd94d694d6abd82e3c7b3">CreateBitCast</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, VecPtrTy, <span class="stringliteral">&quot;castvec&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// The pass-through vector for an x86 masked load is a zero vector.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewMaskedLoad = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a483f68557374e8fc58f8a294e7f1268e">CreateMaskedLoad</a>(</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), PtrCast, <a class="code" href="structllvm_1_1Align.html">Align</a>(1), BoolMask, ZeroVec);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, NewMaskedLoad);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// TODO: If the x86 backend knew how to convert a bool vector mask back to an</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// XMM register mask efficiently, we could transform all x86 masked intrinsics</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// to LLVM masked intrinsics and remove the x86 masked intrinsic defs.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a708996b12b1b5e6ac2555880bdaeda64">   87</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a708996b12b1b5e6ac2555880bdaeda64">simplifyX86MaskedStore</a>(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II, <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = II.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = II.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = II.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(2);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// Zero Mask - this masked store instruction does nothing.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantAggregateZero&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>)) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    IC.<a class="code" href="classllvm_1_1InstCombiner.html#a271d5063c18ca60e0e96a0f916096148">eraseInstFromFunction</a>(II);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// The SSE2 version is too weird (eg, unaligned but non-temporal) to do</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// anything else at this level.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::x86_sse2_maskmov_dqu)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// The mask is constant or extended from a bool vector. Convert this x86</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// intrinsic to the LLVM intrinsic to allow target-independent optimizations.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *BoolMask = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a5823441d951ade391206be8c839f8f3e">getBoolVecFromMask</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>)) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">unsigned</span> AddrSpace = cast&lt;PointerType&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType())-&gt;getAddressSpace();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *VecPtrTy = <a class="code" href="classllvm_1_1PointerType.html#a050a395d1656e546679d8b144d951bb2">PointerType::get</a>(Vec-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), AddrSpace);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrCast = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a06d64f226fabd94d694d6abd82e3c7b3">CreateBitCast</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, VecPtrTy, <span class="stringliteral">&quot;castvec&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#aad07e3e0fa03f6c780e13d924325d8d0">CreateMaskedStore</a>(Vec, PtrCast, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), BoolMask);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// &#39;Replace uses&#39; doesn&#39;t work for stores. Erase the original masked store.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    IC.<a class="code" href="classllvm_1_1InstCombiner.html#a271d5063c18ca60e0e96a0f916096148">eraseInstFromFunction</a>(II);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a43695b2883d7c018af50a606291e46b1">  120</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a43695b2883d7c018af50a606291e46b1">simplifyX86immShift</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                  <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">bool</span> LogicalShift = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">bool</span> ShiftLeft = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">bool</span> IsImm = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">switch</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>()) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected intrinsic!&quot;</span>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrai_d:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrai_w:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrai_d:</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrai_w:</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_q_128:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_q_256:</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_d_512:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_q_512:</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_w_512:</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    IsImm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    [[fallthrough]];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psra_d:</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psra_w:</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psra_d:</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psra_w:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_q_128:</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_q_256:</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_d_512:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_q_512:</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_w_512:</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    LogicalShift = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ShiftLeft = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrli_d:</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrli_q:</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrli_w:</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrli_d:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrli_q:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrli_w:</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrli_d_512:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrli_q_512:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrli_w_512:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    IsImm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    [[fallthrough]];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrl_d:</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrl_q:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrl_w:</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrl_d:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrl_q:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrl_w:</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrl_d_512:</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrl_q_512:</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrl_w_512:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    LogicalShift = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    ShiftLeft = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pslli_d:</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pslli_q:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pslli_w:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pslli_d:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pslli_q:</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pslli_w:</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pslli_d_512:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pslli_q_512:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pslli_w_512:</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    IsImm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    [[fallthrough]];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psll_d:</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psll_q:</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psll_w:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psll_d:</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psll_q:</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psll_w:</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psll_d_512:</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psll_q_512:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psll_w_512:</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    LogicalShift = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    ShiftLeft = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((LogicalShift || !ShiftLeft) &amp;&amp; <span class="stringliteral">&quot;Only logical shifts can shift left&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Amt = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keyword">auto</span> *VT = cast&lt;FixedVectorType&gt;(Vec-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SVT = VT-&gt;getElementType();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *AmtVT = Amt-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">unsigned</span> VWidth = VT-&gt;getNumElements();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = SVT-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// If the shift amount is guaranteed to be in-range we can replace it with a</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// generic shift. If its guaranteed to be out of range, logical shifts combine</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// to zero and arithmetic shifts are clamped to (BitWidth - 1).</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span> (IsImm) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AmtVT-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(32) &amp;&amp; <span class="stringliteral">&quot;Unexpected shift-by-immediate type&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="structllvm_1_1KnownBits.html">KnownBits</a> KnownAmtBits =</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">llvm::computeKnownBits</a>(Amt, II.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>());</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (KnownAmtBits.<a class="code" href="structllvm_1_1KnownBits.html#a825476b2436eb817b735fdd34ee521c4">getMaxValue</a>().<a class="code" href="classllvm_1_1APInt.html#a545e8d5dfa1688acea0d0e275b03682f">ult</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      Amt = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExtOrTrunc(Amt, SVT);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      Amt = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(VWidth, Amt);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">return</span> (LogicalShift ? (ShiftLeft ? <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(Vec, Amt)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                        : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(Vec, Amt))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                           : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(Vec, Amt));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (KnownAmtBits.<a class="code" href="structllvm_1_1KnownBits.html#a9b35c622a902a7a7dc93b807a9fa9265">getMinValue</a>().<a class="code" href="classllvm_1_1APInt.html#af4b1ccc0b78f9da9f3f3944e06007f1d">uge</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>)) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">if</span> (LogicalShift)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">ConstantAggregateZero::get</a>(VT);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      Amt = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SVT, <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> - 1);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(Vec, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(VWidth, Amt));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Ensure the first element has an in-range value and the rest of the</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// elements in the bottom 64 bits are zero.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AmtVT-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>() &amp;&amp; AmtVT-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;           cast&lt;VectorType&gt;(AmtVT)-&gt;getElementType() == SVT &amp;&amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;           <span class="stringliteral">&quot;Unexpected shift-by-scalar type&quot;</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">unsigned</span> NumAmtElts = cast&lt;FixedVectorType&gt;(AmtVT)-&gt;getNumElements();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedLower = <a class="code" href="classllvm_1_1APInt.html#aec662ee6ab1490a4cabebf2812e5b9ca">APInt::getOneBitSet</a>(NumAmtElts, 0);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedUpper = <a class="code" href="classllvm_1_1APInt.html#a46ceedee591f92727b85641794a96061">APInt::getBitsSet</a>(NumAmtElts, 1, NumAmtElts / 2);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="structllvm_1_1KnownBits.html">KnownBits</a> KnownLowerBits = <a class="code" href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">llvm::computeKnownBits</a>(</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        Amt, DemandedLower, II.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="structllvm_1_1KnownBits.html">KnownBits</a> KnownUpperBits = <a class="code" href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">llvm::computeKnownBits</a>(</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        Amt, DemandedUpper, II.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>());</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (KnownLowerBits.<a class="code" href="structllvm_1_1KnownBits.html#a825476b2436eb817b735fdd34ee521c4">getMaxValue</a>().<a class="code" href="classllvm_1_1APInt.html#a545e8d5dfa1688acea0d0e275b03682f">ult</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>) &amp;&amp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        (DemandedUpper.<a class="code" href="classllvm_1_1APInt.html#a49cd5939942c6665aba4cae8c220dff1">isZero</a>() || KnownUpperBits.<a class="code" href="structllvm_1_1KnownBits.html#a1620c017d995c7ccbcb59e0212618017">isZero</a>())) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 16&gt;</a> ZeroSplat(VWidth, 0);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      Amt = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(Amt, ZeroSplat);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">return</span> (LogicalShift ? (ShiftLeft ? <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(Vec, Amt)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                        : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(Vec, Amt))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                           : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(Vec, Amt));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// Simplify if count is constant vector.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keyword">auto</span> *CDV = dyn_cast&lt;ConstantDataVector&gt;(Amt);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span> (!CDV)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// SSE2/AVX2 uses all the first 64-bits of the 128-bit vector</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// operand to compute the shift amount.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AmtVT-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>() &amp;&amp; AmtVT-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;         cast&lt;VectorType&gt;(AmtVT)-&gt;getElementType() == SVT &amp;&amp;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;         <span class="stringliteral">&quot;Unexpected shift-by-scalar type&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// Concatenate the sub-elements to create the 64-bit value.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> Count(64, 0);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, NumSubElts = 64 / <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != NumSubElts; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">unsigned</span> SubEltIdx = (NumSubElts - 1) - <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">auto</span> *SubElt = cast&lt;ConstantInt&gt;(CDV-&gt;getElementAsConstant(SubEltIdx));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    Count &lt;&lt;= <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    Count |= SubElt-&gt;getValue().<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(64);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// If shift-by-zero then just return the original value.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (Count.<a class="code" href="classllvm_1_1APInt.html#a49cd5939942c6665aba4cae8c220dff1">isZero</a>())</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">return</span> Vec;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// Handle cases when Shift &gt;= BitWidth.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span> (Count.<a class="code" href="classllvm_1_1APInt.html#af4b1ccc0b78f9da9f3f3944e06007f1d">uge</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>)) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// If LogicalShift - just return zero.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (LogicalShift)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">ConstantAggregateZero::get</a>(VT);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// If ArithmeticShift - clamp Shift to (BitWidth - 1).</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    Count = <a class="code" href="classllvm_1_1APInt.html">APInt</a>(64, <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> - 1);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// Get a constant vector of the same type as the first operand.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keyword">auto</span> ShiftAmt = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SVT, Count.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">auto</span> ShiftVec = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateVectorSplat(VWidth, ShiftAmt);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (ShiftLeft)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(Vec, ShiftVec);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span> (LogicalShift)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(Vec, ShiftVec);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(Vec, ShiftVec);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">// Attempt to simplify AVX2 per-element shift intrinsics to a generic IR shift.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">// Unlike the generic IR shifts, the intrinsics have defined behaviour for out</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">// of range shift amounts (logical - set to zero, arithmetic - splat sign bit).</span></div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a464ebe507cbf5cd1d772ecd1aacdaff6">  302</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a464ebe507cbf5cd1d772ecd1aacdaff6">simplifyX86varShift</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                  <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">bool</span> LogicalShift = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordtype">bool</span> ShiftLeft = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">switch</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>()) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected intrinsic!&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrav_d:</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrav_d_256:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_q_128:</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_q_256:</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_d_512:</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_q_512:</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_w_128:</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_w_256:</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_w_512:</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    LogicalShift = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    ShiftLeft = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_d:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_d_256:</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_q:</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_q_256:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_d_512:</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_q_512:</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_w_128:</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_w_256:</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_w_512:</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    LogicalShift = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    ShiftLeft = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_d:</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_d_256:</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_q:</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_q_256:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_d_512:</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_q_512:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_w_128:</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_w_256:</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_w_512:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    LogicalShift = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    ShiftLeft = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((LogicalShift || !ShiftLeft) &amp;&amp; <span class="stringliteral">&quot;Only logical shifts can shift left&quot;</span>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Amt = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">auto</span> *VT = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SVT = VT-&gt;getElementType();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">int</span> NumElts = VT-&gt;getNumElements();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = SVT-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// If the shift amount is guaranteed to be in-range we can replace it with a</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// generic shift.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="code" href="structllvm_1_1KnownBits.html">KnownBits</a> KnownAmt =</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">llvm::computeKnownBits</a>(Amt, II.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (KnownAmt.<a class="code" href="structllvm_1_1KnownBits.html#a825476b2436eb817b735fdd34ee521c4">getMaxValue</a>().<a class="code" href="classllvm_1_1APInt.html#a545e8d5dfa1688acea0d0e275b03682f">ult</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>)) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">return</span> (LogicalShift ? (ShiftLeft ? <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(Vec, Amt)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                      : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(Vec, Amt))</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                         : <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(Vec, Amt));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// Simplify if all shift amounts are constant/undef.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">auto</span> *CShift = dyn_cast&lt;Constant&gt;(Amt);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">if</span> (!CShift)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// Collect each element&#39;s shift amount.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// We also collect special cases: UNDEF = -1, OUT-OF-RANGE = BitWidth.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordtype">bool</span> AnyOutOfRange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> ShiftAmts;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumElts; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">auto</span> *CElt = CShift-&gt;getAggregateElement(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (isa_and_nonnull&lt;UndefValue&gt;(CElt)) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      ShiftAmts.push_back(-1);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">auto</span> *COp = dyn_cast_or_null&lt;ConstantInt&gt;(CElt);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (!COp)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// Handle out of range shifts.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// If LogicalShift - set to BitWidth (special case).</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// If ArithmeticShift - set to (BitWidth - 1) (sign splat).</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> ShiftVal = COp-&gt;getValue();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (ShiftVal.<a class="code" href="classllvm_1_1APInt.html#af4b1ccc0b78f9da9f3f3944e06007f1d">uge</a>(<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>)) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      AnyOutOfRange = LogicalShift;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      ShiftAmts.push_back(LogicalShift ? <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> : <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> - 1);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    ShiftAmts.push_back((<span class="keywordtype">int</span>)ShiftVal.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// If all elements out of range or UNDEF, return vector of zeros/undefs.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// ArithmeticShift should only hit this if they are all UNDEF.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">auto</span> OutOfRange = [&amp;](<span class="keywordtype">int</span> Idx) { <span class="keywordflow">return</span> (Idx &lt; 0) || (<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> &lt;= Idx); };</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a>(ShiftAmts, OutOfRange)) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 8&gt;</a> ConstantVec;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Idx : ShiftAmts) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">if</span> (Idx &lt; 0) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        ConstantVec.push_back(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(SVT));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LogicalShift &amp;&amp; <span class="stringliteral">&quot;Logical shift expected&quot;</span>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        ConstantVec.push_back(<a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(SVT));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(ConstantVec);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// We can&#39;t handle only some out of range values with generic logical shifts.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (AnyOutOfRange)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Build the shift amount constant vector.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 8&gt;</a> ShiftVecAmts;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Idx : ShiftAmts) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (Idx &lt; 0)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      ShiftVecAmts.push_back(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(SVT));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      ShiftVecAmts.push_back(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SVT, Idx));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keyword">auto</span> ShiftVec = <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(ShiftVecAmts);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">if</span> (ShiftLeft)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShl(Vec, ShiftVec);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">if</span> (LogicalShift)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(Vec, ShiftVec);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAShr(Vec, ShiftVec);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a09b36f90a9ee67af8d0cf1597784f518">  438</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a09b36f90a9ee67af8d0cf1597784f518">simplifyX86pack</a>(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                              <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <span class="keywordtype">bool</span> IsSigned) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ResTy = II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// Fast all undef handling.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(Arg0) &amp;&amp; isa&lt;UndefValue&gt;(Arg1))</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(ResTy);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keyword">auto</span> *ArgTy = cast&lt;FixedVectorType&gt;(Arg0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">unsigned</span> NumLanes = ResTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() / 128;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">unsigned</span> NumSrcElts = ArgTy-&gt;getNumElements();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;FixedVectorType&gt;(ResTy)-&gt;getNumElements() == (2 * NumSrcElts) &amp;&amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         <span class="stringliteral">&quot;Unexpected packing types&quot;</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordtype">unsigned</span> NumSrcEltsPerLane = NumSrcElts / NumLanes;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordtype">unsigned</span> DstScalarSizeInBits = ResTy-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordtype">unsigned</span> SrcScalarSizeInBits = ArgTy-&gt;getScalarSizeInBits();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcScalarSizeInBits == (2 * DstScalarSizeInBits) &amp;&amp;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="stringliteral">&quot;Unexpected packing types&quot;</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// Constant folding.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;Constant&gt;(Arg0) || !isa&lt;Constant&gt;(Arg1))</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// Clamp Values - signed/unsigned both use signed clamp values, but they</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// differ on the min/max values.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> MinValue, MaxValue;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">if</span> (IsSigned) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// PACKSS: Truncate signed value with signed saturation.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// Source values less than dst minint are saturated to minint.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// Source values greater than dst maxint are saturated to maxint.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    MinValue =</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="classllvm_1_1APInt.html#a8f877403433892e14ff0c692cbe9efdf">APInt::getSignedMinValue</a>(DstScalarSizeInBits).<a class="code" href="classllvm_1_1APInt.html#aca8fce65eb69a82aa10a635e2e79877a">sext</a>(SrcScalarSizeInBits);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    MaxValue =</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="classllvm_1_1APInt.html#a562c9513409b74f02cb3a5c9bae672ea">APInt::getSignedMaxValue</a>(DstScalarSizeInBits).<a class="code" href="classllvm_1_1APInt.html#aca8fce65eb69a82aa10a635e2e79877a">sext</a>(SrcScalarSizeInBits);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// PACKUS: Truncate signed value with unsigned saturation.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// Source values less than zero are saturated to zero.</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// Source values greater than dst maxuint are saturated to maxuint.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    MinValue = <a class="code" href="classllvm_1_1APInt.html#add4e37b60ea64faafbc9a5bf3e27280f">APInt::getZero</a>(SrcScalarSizeInBits);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    MaxValue = <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(SrcScalarSizeInBits, DstScalarSizeInBits);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keyword">auto</span> *MinC = <a class="code" href="classllvm_1_1Constant.html#a0154da1d06b29a1d5649607ae2dfc389">Constant::getIntegerValue</a>(ArgTy, MinValue);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keyword">auto</span> *MaxC = <a class="code" href="classllvm_1_1Constant.html#a0154da1d06b29a1d5649607ae2dfc389">Constant::getIntegerValue</a>(ArgTy, MaxValue);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  Arg0 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSelect(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpSLT(Arg0, MinC), MinC, Arg0);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  Arg1 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSelect(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpSLT(Arg1, MinC), MinC, Arg1);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  Arg0 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSelect(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpSGT(Arg0, MaxC), MaxC, Arg0);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  Arg1 = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSelect(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpSGT(Arg1, MaxC), MaxC, Arg1);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// Shuffle clamped args together at the lane level.</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 32&gt;</a> PackMask;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Lane = 0; Lane != NumLanes; ++Lane) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Elt = 0; Elt != NumSrcEltsPerLane; ++Elt)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      PackMask.push_back(Elt + (Lane * NumSrcEltsPerLane));</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Elt = 0; Elt != NumSrcEltsPerLane; ++Elt)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      PackMask.push_back(Elt + (Lane * NumSrcEltsPerLane) + NumSrcElts);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(Arg0, Arg1, PackMask);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// Truncate to dst size.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(<a class="code" href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">Shuffle</a>, ResTy);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a72e7e99bed226a41d93b4afb6f24a264">  504</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a72e7e99bed226a41d93b4afb6f24a264">simplifyX86movmsk</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ResTy = II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">// movmsk(undef) -&gt; zero as we must ensure the upper bits are zero.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>))</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(ResTy);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keyword">auto</span> *ArgTy = dyn_cast&lt;FixedVectorType&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getType());</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// We can&#39;t easily peek through x86_mmx types.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span> (!ArgTy)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// Expand MOVMSK to compare/bitcast/zext:</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// e.g. PMOVMSKB(v16i8 x):</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// %cmp = icmp slt &lt;16 x i8&gt; %x, zeroinitializer</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">// %int = bitcast &lt;16 x i1&gt; %cmp to i16</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// %res = zext i16 %int to i32</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = ArgTy-&gt;getNumElements();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntegerTy = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getIntNTy(NumElts);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, <a class="code" href="classllvm_1_1VectorType.html#a7fdb2317662e3e901e47544a40190f12">VectorType::getInteger</a>(ArgTy));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIsNeg(Res);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(Res, IntegerTy);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExtOrTrunc(Res, ResTy);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">return</span> Res;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a7f9bf3b17f89cfbe4fabd1ac2bdc3712">  533</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a7f9bf3b17f89cfbe4fabd1ac2bdc3712">simplifyX86addcarry</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                  <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CarryIn = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Op2 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RetTy = II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *OpTy = Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RetTy-&gt;<a class="code" href="classllvm_1_1Type.html#a15d34f8dc07013df378e0fb3d0134c08">getStructElementType</a>(0)-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(8) &amp;&amp;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;         RetTy-&gt;<a class="code" href="classllvm_1_1Type.html#a15d34f8dc07013df378e0fb3d0134c08">getStructElementType</a>(1) == OpTy &amp;&amp; OpTy == Op2-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() &amp;&amp;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         <span class="stringliteral">&quot;Unexpected types for x86 addcarry&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// If carry-in is zero, this is just an unsigned add with overflow.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(CarryIn, <a class="code" href="namespacellvm_1_1PatternMatch.html#a874d53817a4923de8e58af6b278c09b0">PatternMatch::m_ZeroInt</a>())) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *UAdd = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::uadd_with_overflow, OpTy,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                          {Op1, Op2});</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// The types have to be adjusted to match the x86 call types.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *UAddResult = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateExtractValue(UAdd, 0);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *UAddOV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateExtractValue(UAdd, 1),</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                       <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8Ty());</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = <a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(RetTy);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertValue(Res, UAddOV, 0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertValue(Res, UAddResult, 1);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a2636ba332d036d0143eec07de82c7136">  560</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a2636ba332d036d0143eec07de82c7136">simplifyX86insertps</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                  <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keyword">auto</span> *CInt = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordflow">if</span> (!CInt)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VecTy-&gt;getNumElements() == 4 &amp;&amp; <span class="stringliteral">&quot;insertps with wrong vector type&quot;</span>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// The immediate permute control byte looks like this:</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">//    [3:0] - zero mask for each 32-bit lane</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">//    [5:4] - select one 32-bit destination lane</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">//    [7:6] - select one 32-bit source lane</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  uint8_t <a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> = CInt-&gt;getZExtValue();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  uint8_t ZMask = <a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &amp; 0xf;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  uint8_t DestLane = (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &gt;&gt; 4) &amp; 0<a class="code" href="README-SSE_8txt.html#a11ca92463dc5dfc09bbe2ba2f3ea0c96">x3</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  uint8_t SourceLane = (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &gt;&gt; 6) &amp; 0<a class="code" href="README-SSE_8txt.html#a11ca92463dc5dfc09bbe2ba2f3ea0c96">x3</a>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1ConstantAggregateZero.html">ConstantAggregateZero</a> *ZeroVector = <a class="code" href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">ConstantAggregateZero::get</a>(VecTy);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// If all zero mask bits are set, this was just a weird way to</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">// generate a zero vector.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (ZMask == 0xf)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">return</span> ZeroVector;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// Initialize by passing all of the first source bits through.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordtype">int</span> ShuffleMask[4] = {0, 1, 2, 3};</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// We may replace the second operand with the zero vector.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span> (ZMask) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">// If the zero mask is being used with a single input or the zero mask</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// overrides the destination lane, this is a shuffle with the zero vector.</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> ((II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0) == II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1)) ||</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        (ZMask &amp; (1 &lt;&lt; DestLane))) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      V1 = ZeroVector;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="comment">// We may still move 32-bits of the first source vector from one lane</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="comment">// to another.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      ShuffleMask[DestLane] = SourceLane;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">// The zero mask may override the previous insert operation.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span> ((ZMask &gt;&gt; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) &amp; 0x1)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          ShuffleMask[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 4;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="comment">// TODO: Model this case as 2 shuffles or a &#39;logical and&#39; plus shuffle?</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">// Replace the selected destination lane with the selected source lane.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    ShuffleMask[DestLane] = SourceLane + 4;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), V1, ShuffleMask);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">/// Attempt to simplify SSE4A EXTRQ/EXTRQI instructions using constant folding</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">/// or conversion to a shuffle vector.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#aee284a557cb4df418d8a665a5e4ace3c">  619</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#aee284a557cb4df418d8a665a5e4ace3c">simplifyX86extrq</a>(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II, <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                               <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CILength, <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CIIndex,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                               <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keyword">auto</span> LowConstantHighUndef = [&amp;](<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Val) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy64 = <a class="code" href="classllvm_1_1Type.html#a05186fa23e4d11b9855a9599ba87a4b7">Type::getInt64Ty</a>(II.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy64, Val),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(IntTy64)};</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  };</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// See if we&#39;re dealing with constant values.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keyword">auto</span> *C0 = dyn_cast&lt;Constant&gt;(Op0);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keyword">auto</span> *CI0 =</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      C0 ? dyn_cast_or_null&lt;ConstantInt&gt;(C0-&gt;getAggregateElement((<span class="keywordtype">unsigned</span>)0))</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// Attempt to constant fold.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span> (CILength &amp;&amp; CIIndex) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">// From AMD documentation: &quot;The bit index and field length are each six</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// bits in length other bits of the field are ignored.&quot;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> APIndex = CIIndex-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> APLength = CILength-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = APIndex.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// From AMD documentation: &quot;a value of zero in the field length is</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// defined as length of 64&quot;.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = APLength == 0 ? 64 : APLength.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// From AMD documentation: &quot;If the sum of the bit index + length field</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// is greater than 64, the results are undefined&quot;.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordtype">unsigned</span> End = <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> + <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Note that both field index and field length are 8-bit quantities.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// Since variables &#39;Index&#39; and &#39;Length&#39; are unsigned values</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// obtained from zero-extending field index and field length</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// respectively, their sum should never wrap around.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (End &gt; 64)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">// If we are inserting whole bytes, we can convert this to a shuffle.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">// Lowering can recognize EXTRQI shuffle masks.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> % 8) == 0 &amp;&amp; (<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> % 8) == 0) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">// Convert bit indices to byte indices.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> /= 8;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> /= 8;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy8 = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(II.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keyword">auto</span> *ShufTy = <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(IntTy8, 16);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 16&gt;</a> ShuffleMask;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != (<a class="code" href="lib_2Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        ShuffleMask.push_back(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 8; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        ShuffleMask.push_back(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 16);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 8; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 16; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        ShuffleMask.push_back(-1);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *SV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(Op0, ShufTy),</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <a class="code" href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">ConstantAggregateZero::get</a>(ShufTy), ShuffleMask);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(SV, II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">// Constant Fold - shift Index&#39;th bit to lowest position and mask off</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// Length bits.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (CI0) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Elt = CI0-&gt;getValue();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      Elt.<a class="code" href="classllvm_1_1APInt.html#af338e23a90c301183968435e80cd6a27">lshrInPlace</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      Elt = Elt.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordflow">return</span> LowConstantHighUndef(Elt.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>());</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// If we were an EXTRQ call, we&#39;ll save registers if we convert to EXTRQI.</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::x86_sse4a_extrq) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {Op0, CILength, CIIndex};</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = II.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::x86_sse4a_extrqi);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">// Constant Fold - extraction from zero is always {zero, undef}.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">if</span> (CI0 &amp;&amp; CI0-&gt;isZero())</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">return</span> LowConstantHighUndef(0);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">/// Attempt to simplify SSE4A INSERTQ/INSERTQI instructions using constant</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">/// folding or conversion to a shuffle vector.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a6ec81729c2f0ec00aaa1a7c8560f6b8c">  710</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a6ec81729c2f0ec00aaa1a7c8560f6b8c">simplifyX86insertq</a>(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II, <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0, <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                 <a class="code" href="classllvm_1_1APInt.html">APInt</a> APLength, <a class="code" href="classllvm_1_1APInt.html">APInt</a> APIndex,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                 <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">// From AMD documentation: &quot;The bit index and field length are each six bits</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// in length other bits of the field are ignored.&quot;</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  APIndex = APIndex.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  APLength = APLength.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// Attempt to constant fold.</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = APIndex.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// From AMD documentation: &quot;a value of zero in the field length is</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">// defined as length of 64&quot;.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = APLength == 0 ? 64 : APLength.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// From AMD documentation: &quot;If the sum of the bit index + length field</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// is greater than 64, the results are undefined&quot;.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordtype">unsigned</span> End = <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> + <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// Note that both field index and field length are 8-bit quantities.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// Since variables &#39;Index&#39; and &#39;Length&#39; are unsigned values</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// obtained from zero-extending field index and field length</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="comment">// respectively, their sum should never wrap around.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">if</span> (End &gt; 64)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="comment">// If we are inserting whole bytes, we can convert this to a shuffle.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// Lowering can recognize INSERTQI shuffle masks.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> % 8) == 0 &amp;&amp; (<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> % 8) == 0) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// Convert bit indices to byte indices.</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> /= 8;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> /= 8;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy8 = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(II.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keyword">auto</span> *ShufTy = <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(IntTy8, 16);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 16&gt;</a> ShuffleMask;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != (<a class="code" href="lib_2Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      ShuffleMask.push_back(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != (<a class="code" href="lib_2Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a>)<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      ShuffleMask.push_back(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + 16);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> + <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 8; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      ShuffleMask.push_back(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 8; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != 16; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      ShuffleMask.push_back(-1);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(Op0, ShufTy),</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                            <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(Op1, ShufTy),</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                            ShuffleMask);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(SV, II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="comment">// See if we&#39;re dealing with constant values.</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keyword">auto</span> *C0 = dyn_cast&lt;Constant&gt;(Op0);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = dyn_cast&lt;Constant&gt;(Op1);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keyword">auto</span> *CI00 =</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      C0 ? dyn_cast_or_null&lt;ConstantInt&gt;(C0-&gt;getAggregateElement((<span class="keywordtype">unsigned</span>)0))</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;         : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keyword">auto</span> *CI10 =</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> ? dyn_cast_or_null&lt;ConstantInt&gt;(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;getAggregateElement((<span class="keywordtype">unsigned</span>)0))</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;         : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// Constant Fold - insert bottom Length bits starting at the Index&#39;th bit.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">if</span> (CI00 &amp;&amp; CI10) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> V00 = CI00-&gt;getValue();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> V10 = CI10-&gt;getValue();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(64, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>).<a class="code" href="classllvm_1_1APInt.html#acb9c55b6986369948507ca5241b4e411">shl</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    V00 = V00 &amp; ~<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    V10 = V10.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>).<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(64).<a class="code" href="classllvm_1_1APInt.html#acb9c55b6986369948507ca5241b4e411">shl</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> Val = V00 | V10;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy64 = <a class="code" href="classllvm_1_1Type.html#a05186fa23e4d11b9855a9599ba87a4b7">Type::getInt64Ty</a>(II.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy64, Val.<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>()),</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                        <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(IntTy64)};</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">ConstantVector::get</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// If we were an INSERTQ call, we&#39;ll save demanded elements if we convert to</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="comment">// INSERTQI.</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::x86_sse4a_insertq) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy8 = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(II.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CILength = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy8, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CIIndex = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy8, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {Op0, Op1, CILength, CIIndex};</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = II.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::x86_sse4a_insertqi);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">/// Attempt to convert pshufb* to shufflevector if the mask is constant.</span></div>
<div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#afbdcf5b93b5500c5bdb516d47abc5ff4">  803</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#afbdcf5b93b5500c5bdb516d47abc5ff4">simplifyX86pshufb</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keyword">auto</span> *V = dyn_cast&lt;Constant&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> (!V)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = VecTy-&gt;getNumElements();</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((NumElts == 16 || NumElts == 32 || NumElts == 64) &amp;&amp;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;         <span class="stringliteral">&quot;Unexpected number of elements in shuffle mask!&quot;</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">// Construct a shuffle mask from constant integers or UNDEFs.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordtype">int</span> Indexes[64];</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// Each byte in the shuffle control mask forms an index to permute the</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">// corresponding byte in the destination operand.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumElts; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *COp = V-&gt;<a class="code" href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">getAggregateElement</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (!COp || (!isa&lt;UndefValue&gt;(COp) &amp;&amp; !isa&lt;ConstantInt&gt;(COp)))</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(COp)) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      Indexes[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = -1;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    int8_t <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = cast&lt;ConstantInt&gt;(COp)-&gt;getValue().getZExtValue();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// If the most significant bit (bit[7]) of each byte of the shuffle</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">// control mask is set, then zero is written in the result byte.</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// The zero vector is in the right-hand side of the resulting</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// shufflevector.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// The value of each index for the high 128-bit lane is the least</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// significant 4 bits of the respective shuffle control byte.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = ((<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &lt; 0) ? NumElts : <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &amp; 0x0F) + (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &amp; 0xF0);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    Indexes[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keyword">auto</span> V1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a> = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(VecTy);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(V1, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">V2</a>, <a class="code" href="namespacellvm.html#ab9c6b351507d3c0730f4290919d43a12">ArrayRef</a>(Indexes, NumElts));</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;}</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">/// Attempt to convert vpermilvar* to shufflevector if the mask is constant.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a0b5bb50aa2c37c48ff126baafc9b2989">  848</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a0b5bb50aa2c37c48ff126baafc9b2989">simplifyX86vpermilvar</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                    <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keyword">auto</span> *V = dyn_cast&lt;Constant&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">if</span> (!V)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = VecTy-&gt;getNumElements();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordtype">bool</span> IsPD = VecTy-&gt;getScalarType()-&gt;isDoubleTy();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordtype">unsigned</span> NumLaneElts = IsPD ? 2 : 4;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumElts == 16 || NumElts == 8 || NumElts == 4 || NumElts == 2);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// Construct a shuffle mask from constant integers or UNDEFs.</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordtype">int</span> Indexes[16];</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">// The intrinsics only read one or two bits, clear the rest.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumElts; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *COp = V-&gt;<a class="code" href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">getAggregateElement</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> (!COp || (!isa&lt;UndefValue&gt;(COp) &amp;&amp; !isa&lt;ConstantInt&gt;(COp)))</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(COp)) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      Indexes[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = -1;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = cast&lt;ConstantInt&gt;(COp)-&gt;getValue();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(32).<a class="code" href="classllvm_1_1APInt.html#a0fa9845f80fa0642b31c238f4ab0d5ef">getLoBits</a>(2);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// The PD variants uses bit 1 to select per-lane element index, so</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// shift down to convert to generic shuffle mask index.</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (IsPD)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>.<a class="code" href="classllvm_1_1APInt.html#af338e23a90c301183968435e80cd6a27">lshrInPlace</a>(1);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// The _256 variants are a bit trickier since the mask bits always index</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">// into the corresponding 128 half. In order to convert to a generic</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// shuffle, we have to make that explicit.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> += <a class="code" href="classllvm_1_1APInt.html">APInt</a>(32, (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> / NumLaneElts) * NumLaneElts);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    Indexes[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>.getZExtValue();</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keyword">auto</span> V1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(V1, <a class="code" href="namespacellvm.html#ab9c6b351507d3c0730f4290919d43a12">ArrayRef</a>(Indexes, NumElts));</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">/// Attempt to convert vpermd/vpermps to shufflevector if the mask is constant.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno"><a class="line" href="X86InstCombineIntrinsic_8cpp.html#a54b9709cc11722284848f2d12e605f9f">  895</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a54b9709cc11722284848f2d12e605f9f">simplifyX86vpermv</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II,</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                <a class="code" href="classllvm_1_1IRBuilder.html">InstCombiner::BuilderTy</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keyword">auto</span> *V = dyn_cast&lt;Constant&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">if</span> (!V)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordtype">unsigned</span> Size = VecTy-&gt;getNumElements();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((Size == 4 || Size == 8 || Size == 16 || Size == 32 || Size == 64) &amp;&amp;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;         <span class="stringliteral">&quot;Unexpected shuffle mask size&quot;</span>);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// Construct a shuffle mask from constant integers or UNDEFs.</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordtype">int</span> Indexes[64];</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; Size; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *COp = V-&gt;<a class="code" href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">getAggregateElement</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span> (!COp || (!isa&lt;UndefValue&gt;(COp) &amp;&amp; !isa&lt;ConstantInt&gt;(COp)))</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(COp)) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      Indexes[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = -1;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = cast&lt;ConstantInt&gt;(COp)-&gt;getZExtValue();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &amp;= Size - 1;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    Indexes[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keyword">auto</span> V1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateShuffleVector(V1, <a class="code" href="namespacellvm.html#ab9c6b351507d3c0730f4290919d43a12">ArrayRef</a>(Indexes, Size));</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;}</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;std::optional&lt;Instruction *&gt;</div>
<div class="line"><a name="l00929"></a><span class="lineno"><a class="line" href="classllvm_1_1X86TTIImpl.html#a47cb7185e35282131b486036ff7c45df">  929</a></span>&#160;<a class="code" href="classllvm_1_1X86TTIImpl.html#a47cb7185e35282131b486036ff7c45df">X86TTIImpl::instCombineIntrinsic</a>(<a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC, <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keyword">auto</span> SimplifyDemandedVectorEltsLow = [&amp;IC](<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>,</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                             <span class="keywordtype">unsigned</span> DemandedWidth) {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> UndefElts(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>, 0);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts = <a class="code" href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">APInt::getLowBitsSet</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>, DemandedWidth);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#a7bbbdfd451adf8eb62a5dc6bcec8a3f0">SimplifyDemandedVectorElts</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, DemandedElts, UndefElts);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  };</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IID = II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>();</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">switch</span> (IID) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_bextr_32:</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_bextr_64:</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tbm_bextri_u32:</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tbm_bextri_u64:</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// If the RHS is a constant we can try some simplifications.</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1))) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = (<a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> &amp;= 0xff;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>();</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="comment">// If the length is 0 or the shift is out of range, replace with zero.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> == 0 || <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> &gt;= <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0));</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="comment">// If the LHS is also a constant, we can completely constant fold this.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *InC = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0))) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Result = InC-&gt;getZExtValue() &gt;&gt; <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> &gt; <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;          <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        Result &amp;= maskTrailingOnes&lt;uint64_t&gt;(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Result));</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="comment">// TODO should we turn this into &#39;and&#39; if shift is 0? Or &#39;shl&#39; if we</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="comment">// are only masking bits that a shift already cleared?</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_bzhi_32:</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_bzhi_64:</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="comment">// If the RHS is a constant we can try some simplifications.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1))) {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>() &amp; 0xff;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &gt;= <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> == 0) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0));</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="comment">// If the LHS is also a constant, we can completely constant fold this.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *InC = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0))) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Result = InC-&gt;getZExtValue();</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        Result &amp;= maskTrailingOnes&lt;uint64_t&gt;(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II,</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Result));</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="comment">// TODO should we convert this to an AND if the RHS is constant?</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_pext_32:</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_pext_64:</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MaskC = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1))) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">if</span> (MaskC-&gt;isNullValue()) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0));</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keywordflow">if</span> (MaskC-&gt;isAllOnesValue()) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keywordtype">unsigned</span> MaskIdx, MaskLen;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">if</span> (MaskC-&gt;getValue().isShiftedMask(MaskIdx, MaskLen)) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">// any single contingous sequence of 1s anywhere in the mask simply</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">// describes a subset of the input bits shifted to the appropriate</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="comment">// position.  Replace with the straight forward IR.</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Masked = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#af5a702ee0c9fcfdb2f18c91eb0499bf2">CreateAnd</a>(Input, II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *ShiftAmt = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), MaskIdx);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Shifted = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#ae7f65cf79c9900a2b0504fbc25db1428">CreateLShr</a>(Masked, ShiftAmt);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, Shifted);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SrcC = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0))) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Src = SrcC-&gt;getZExtValue();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = MaskC-&gt;getZExtValue();</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Result = 0;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BitToSet = 1;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          <span class="comment">// Isolate lowest set bit.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BitToTest = <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> &amp; -<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <span class="keywordflow">if</span> (BitToTest &amp; Src)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            Result |= BitToSet;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          BitToSet &lt;&lt;= 1;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <span class="comment">// Clear lowest set bit.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> &amp;= <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> - 1;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Result));</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_pdep_32:</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_bmi_pdep_64:</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MaskC = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1))) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordflow">if</span> (MaskC-&gt;isNullValue()) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0));</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">if</span> (MaskC-&gt;isAllOnesValue()) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordtype">unsigned</span> MaskIdx, MaskLen;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <span class="keywordflow">if</span> (MaskC-&gt;getValue().isShiftedMask(MaskIdx, MaskLen)) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">// any single contingous sequence of 1s anywhere in the mask simply</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">// describes a subset of the input bits shifted to the appropriate</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="comment">// position.  Replace with the straight forward IR.</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *ShiftAmt = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), MaskIdx);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Shifted = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#ae69ee83570f05c1d5fb5026c11145d6b">CreateShl</a>(Input, ShiftAmt);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Masked = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#af5a702ee0c9fcfdb2f18c91eb0499bf2">CreateAnd</a>(Shifted, II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, Masked);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SrcC = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0))) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Src = SrcC-&gt;getZExtValue();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = MaskC-&gt;getZExtValue();</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Result = 0;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BitToTest = 1;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          <span class="comment">// Isolate lowest set bit.</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BitToSet = <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> &amp; -<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          <span class="keywordflow">if</span> (BitToTest &amp; Src)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            Result |= BitToSet;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          BitToTest &lt;&lt;= 1;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;          <span class="comment">// Clear lowest set bit;</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> &amp;= <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> - 1;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Result));</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_cvtss2si:</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_cvtss2si64:</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_cvttss2si:</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_cvttss2si64:</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_cvtsd2si:</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_cvtsd2si64:</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_cvttsd2si:</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_cvttsd2si64:</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtss2si32:</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtss2si64:</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtss2usi32:</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtss2usi64:</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtsd2si32:</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtsd2si64:</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtsd2usi32:</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcvtsd2usi64:</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttss2si:</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttss2si64:</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttss2usi:</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttss2usi64:</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttsd2si:</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttsd2si64:</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttsd2usi:</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_cvttsd2usi64: {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// These intrinsics only demand the 0th element of their input vectors. If</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">// we can simplify the input based on that, do so now.</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordtype">unsigned</span> VWidth = cast&lt;FixedVectorType&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getType())-&gt;getNumElements();</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, VWidth, 1)) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_mmx_pmovmskb:</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_movmsk_ps:</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_movmsk_pd:</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pmovmskb_128:</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_movmsk_pd_256:</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_movmsk_ps_256:</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pmovmskb:</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a72e7e99bed226a41d93b4afb6f24a264">simplifyX86movmsk</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_comieq_ss:</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_comige_ss:</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_comigt_ss:</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_comile_ss:</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_comilt_ss:</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_comineq_ss:</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_ucomieq_ss:</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_ucomige_ss:</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_ucomigt_ss:</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_ucomile_ss:</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_ucomilt_ss:</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_ucomineq_ss:</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_comieq_sd:</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_comige_sd:</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_comigt_sd:</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_comile_sd:</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_comilt_sd:</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_comineq_sd:</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_ucomieq_sd:</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_ucomige_sd:</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_ucomigt_sd:</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_ucomile_sd:</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_ucomilt_sd:</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_ucomineq_sd:</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcomi_ss:</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vcomi_sd:</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_cmp_ss:</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_cmp_sd: {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// These intrinsics only demand the 0th element of their input vectors. If</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">// we can simplify the input based on that, do so now.</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordtype">unsigned</span> VWidth = cast&lt;FixedVectorType&gt;(Arg0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Arg0, VWidth, 1)) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Arg1, VWidth, 1)) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 1, V);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (MadeChange) {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">return</span> &amp;II;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_add_ps_512:</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_div_ps_512:</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mul_ps_512:</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_sub_ps_512:</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_add_pd_512:</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_div_pd_512:</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mul_pd_512:</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_sub_pd_512:</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// If the rounding mode is CUR_DIRECTION(4) we can turn these into regular</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// IR operations.</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *R = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2))) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">if</span> (R-&gt;getValue() == 4) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *V;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordflow">switch</span> (IID) {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Case stmts out of sync!&quot;</span>);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_add_ps_512:</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_add_pd_512:</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a0037e4c509dde63e30ae3e0287c5ee69">CreateFAdd</a>(Arg0, Arg1);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_sub_ps_512:</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_sub_pd_512:</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a17689bb6df5ac02081d2adc9f5c3d282">CreateFSub</a>(Arg0, Arg1);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mul_ps_512:</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mul_pd_512:</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a490a5df5a9f49b5648d251cda2f7c428">CreateFMul</a>(Arg0, Arg1);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_div_ps_512:</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_div_pd_512:</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a894d9a647d9e28d6332ebd0b48c5a0b2">CreateFDiv</a>(Arg0, Arg1);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_add_ss_round:</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_div_ss_round:</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_mul_ss_round:</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_sub_ss_round:</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_add_sd_round:</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_div_sd_round:</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_mul_sd_round:</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_sub_sd_round:</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">// If the rounding mode is CUR_DIRECTION(4) we can turn these into regular</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">// IR operations.</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *R = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(4))) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">if</span> (R-&gt;getValue() == 4) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="comment">// Extract the element as scalars.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a5c728ddd7890c015533b42cdd7307b0c">CreateExtractElement</a>(Arg0, (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a5c728ddd7890c015533b42cdd7307b0c">CreateExtractElement</a>(Arg1, (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *V;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">switch</span> (IID) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Case stmts out of sync!&quot;</span>);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_add_ss_round:</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_add_sd_round:</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a0037e4c509dde63e30ae3e0287c5ee69">CreateFAdd</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_sub_ss_round:</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_sub_sd_round:</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a17689bb6df5ac02081d2adc9f5c3d282">CreateFSub</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_mul_ss_round:</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_mul_sd_round:</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a490a5df5a9f49b5648d251cda2f7c428">CreateFMul</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_div_ss_round:</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_div_sd_round:</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a894d9a647d9e28d6332ebd0b48c5a0b2">CreateFDiv</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="comment">// Handle the masking aspect of the intrinsic.</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="comment">// We don&#39;t need a select if we know the mask bit is a 1.</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> || !<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getValue()[0]) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="comment">// Cast the mask to an i1 vector and then extract the lowest element.</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;          <span class="keyword">auto</span> *MaskTy = <a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;              IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#aaa74f3583d447a6a45b0906bdb815b8b">getInt1Ty</a>(),</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;              cast&lt;IntegerType&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType())-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>());</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;          <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a06d64f226fabd94d694d6abd82e3c7b3">CreateBitCast</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, MaskTy);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;          <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a5c728ddd7890c015533b42cdd7307b0c">CreateExtractElement</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;          <span class="comment">// Extract the lowest element from the passthru operand.</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *Passthru =</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;              IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a5c728ddd7890c015533b42cdd7307b0c">CreateExtractElement</a>(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, V, Passthru);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="comment">// Insert the result back into the original argument 0.</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        V = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a39b5a72b70df94211893c7fc6bbfe1f5">CreateInsertElement</a>(Arg0, V, (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="comment">// Constant fold ashr( &lt;A x Bi&gt;, Ci ).</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="comment">// Constant fold lshr( &lt;A x Bi&gt;, Ci ).</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="comment">// Constant fold shl( &lt;A x Bi&gt;, Ci ).</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrai_d:</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrai_w:</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrai_d:</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrai_w:</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_q_128:</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_q_256:</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_d_512:</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_q_512:</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrai_w_512:</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrli_d:</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrli_q:</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrli_w:</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrli_d:</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrli_q:</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrli_w:</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrli_d_512:</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrli_q_512:</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrli_w_512:</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pslli_d:</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pslli_q:</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pslli_w:</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pslli_d:</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pslli_q:</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pslli_w:</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pslli_d_512:</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pslli_q_512:</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pslli_w_512:</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a43695b2883d7c018af50a606291e46b1">simplifyX86immShift</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psra_d:</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psra_w:</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psra_d:</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psra_w:</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_q_128:</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_q_256:</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_d_512:</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_q_512:</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psra_w_512:</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrl_d:</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrl_q:</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psrl_w:</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrl_d:</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrl_q:</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrl_w:</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrl_d_512:</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrl_q_512:</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrl_w_512:</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psll_d:</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psll_q:</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_psll_w:</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psll_d:</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psll_q:</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psll_w:</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psll_d_512:</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psll_q_512:</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psll_w_512: {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a43695b2883d7c018af50a606291e46b1">simplifyX86immShift</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">// SSE2/AVX2 uses only the first 64-bits of the 128-bit vector</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">// operand to compute the shift amount.</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Arg1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;           <span class="stringliteral">&quot;Unexpected packed shift size&quot;</span>);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordtype">unsigned</span> VWidth = cast&lt;FixedVectorType&gt;(Arg1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Arg1, VWidth, VWidth / 2)) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 1, V);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_d:</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_d_256:</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_q:</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_q_256:</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_d_512:</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_q_512:</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_w_128:</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_w_256:</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psllv_w_512:</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrav_d:</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrav_d_256:</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_q_128:</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_q_256:</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_d_512:</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_q_512:</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_w_128:</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_w_256:</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrav_w_512:</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_d:</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_d_256:</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_q:</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_q_256:</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_d_512:</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_q_512:</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_w_128:</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_w_256:</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_psrlv_w_512:</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a464ebe507cbf5cd1d772ecd1aacdaff6">simplifyX86varShift</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_packssdw_128:</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_packsswb_128:</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packssdw:</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packsswb:</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packssdw_512:</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packsswb_512:</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a09b36f90a9ee67af8d0cf1597784f518">simplifyX86pack</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_packuswb_128:</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_packusdw:</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packusdw:</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packuswb:</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packusdw_512:</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packuswb_512:</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a09b36f90a9ee67af8d0cf1597784f518">simplifyX86pack</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>, <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_pclmulqdq:</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_pclmulqdq_256:</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_pclmulqdq_512: {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2))) {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getZExtValue();</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keywordtype">unsigned</span> VWidth =</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          cast&lt;FixedVectorType&gt;(Arg0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> UndefElts1(VWidth, 0);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts1 =</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          <a class="code" href="classllvm_1_1APInt.html#a8c55d8510ad4b7cb957d8f5a7cd6944e">APInt::getSplat</a>(VWidth, <a class="code" href="classllvm_1_1APInt.html">APInt</a>(2, (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &amp; 0x01) ? 2 : 1));</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V =</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;              IC.<a class="code" href="classllvm_1_1InstCombiner.html#a7bbbdfd451adf8eb62a5dc6bcec8a3f0">SimplifyDemandedVectorElts</a>(Arg0, DemandedElts1, UndefElts1)) {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> UndefElts2(VWidth, 0);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts2 =</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;          <a class="code" href="classllvm_1_1APInt.html#a8c55d8510ad4b7cb957d8f5a7cd6944e">APInt::getSplat</a>(VWidth, <a class="code" href="classllvm_1_1APInt.html">APInt</a>(2, (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &amp; 0x10) ? 2 : 1));</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V =</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;              IC.<a class="code" href="classllvm_1_1InstCombiner.html#a7bbbdfd451adf8eb62a5dc6bcec8a3f0">SimplifyDemandedVectorElts</a>(Arg1, DemandedElts2, UndefElts2)) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 1, V);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="comment">// If either input elements are undef, the result is zero.</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">if</span> (DemandedElts1.<a class="code" href="classllvm_1_1APInt.html#acfae9bdee6027ffa8ffe244cc22e3a76">isSubsetOf</a>(UndefElts1) ||</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          DemandedElts2.<a class="code" href="classllvm_1_1APInt.html#acfae9bdee6027ffa8ffe244cc22e3a76">isSubsetOf</a>(UndefElts2)) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II,</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                      <a class="code" href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">ConstantAggregateZero::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="keywordflow">if</span> (MadeChange) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">return</span> &amp;II;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_insertps:</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a2636ba332d036d0143eec07de82c7136">simplifyX86insertps</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_extrq: {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordtype">unsigned</span> VWidth0 = cast&lt;FixedVectorType&gt;(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordtype">unsigned</span> VWidth1 = cast&lt;FixedVectorType&gt;(Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;           Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp; VWidth0 == 2 &amp;&amp;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;           VWidth1 == 16 &amp;&amp; <span class="stringliteral">&quot;Unexpected operand sizes&quot;</span>);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">// See if we&#39;re dealing with constant values.</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = dyn_cast&lt;Constant&gt;(Op1);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keyword">auto</span> *CILength =</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> ? dyn_cast_or_null&lt;ConstantInt&gt;(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;getAggregateElement((<span class="keywordtype">unsigned</span>)0))</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;           : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keyword">auto</span> *CIIndex =</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> ? dyn_cast_or_null&lt;ConstantInt&gt;(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;getAggregateElement((<span class="keywordtype">unsigned</span>)1))</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;           : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="comment">// Attempt to simplify to a constant, shuffle vector or EXTRQI call.</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#aee284a557cb4df418d8a665a5e4ace3c">simplifyX86extrq</a>(II, Op0, CILength, CIIndex, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// EXTRQ only uses the lowest 64-bits of the first 128-bit vector</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="comment">// operands and the lowest 16-bits of the second.</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Op0, VWidth0, 1)) {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Op1, VWidth1, 2)) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 1, V);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (MadeChange) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">return</span> &amp;II;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_extrqi: {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">// EXTRQI: Extract Length bits starting from Index. Zero pad the remaining</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">// bits of the lower 64-bits. The upper 64-bits are undefined.</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordtype">unsigned</span> VWidth = cast&lt;FixedVectorType&gt;(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp; VWidth == 2 &amp;&amp;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;           <span class="stringliteral">&quot;Unexpected operand size&quot;</span>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">// See if we&#39;re dealing with constant values.</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keyword">auto</span> *CILength = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keyword">auto</span> *CIIndex = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// Attempt to simplify to a constant or shuffle vector.</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#aee284a557cb4df418d8a665a5e4ace3c">simplifyX86extrq</a>(II, Op0, CILength, CIIndex, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">// EXTRQI only uses the lowest 64-bits of the first 128-bit vector</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// operand.</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Op0, VWidth, 1)) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_insertq: {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordtype">unsigned</span> VWidth = cast&lt;FixedVectorType&gt;(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;           Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp; VWidth == 2 &amp;&amp;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;           cast&lt;FixedVectorType&gt;(Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements() == 2 &amp;&amp;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;           <span class="stringliteral">&quot;Unexpected operand size&quot;</span>);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// See if we&#39;re dealing with constant values.</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = dyn_cast&lt;Constant&gt;(Op1);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keyword">auto</span> *CI11 =</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> ? dyn_cast_or_null&lt;ConstantInt&gt;(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;getAggregateElement((<span class="keywordtype">unsigned</span>)1))</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;           : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// Attempt to simplify to a constant, shuffle vector or INSERTQI call.</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">if</span> (CI11) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;V11 = CI11-&gt;getValue();</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Len = V11.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Idx = V11.<a class="code" href="classllvm_1_1APInt.html#af34549c39d6f741fbdaf9a795aa306e9">lshr</a>(8).<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a6ec81729c2f0ec00aaa1a7c8560f6b8c">simplifyX86insertq</a>(II, Op0, Op1, Len, Idx, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">// INSERTQ only uses the lowest 64-bits of the first 128-bit vector</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// operand.</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Op0, VWidth, 1)) {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_insertqi: {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">// INSERTQI: Extract lowest Length bits from lower half of second source and</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// insert over first source starting at Index bit. The upper 64-bits are</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="comment">// undefined.</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordtype">unsigned</span> VWidth0 = cast&lt;FixedVectorType&gt;(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordtype">unsigned</span> VWidth1 = cast&lt;FixedVectorType&gt;(Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Op0-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;           Op1-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() == 128 &amp;&amp; VWidth0 == 2 &amp;&amp;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;           VWidth1 == 2 &amp;&amp; <span class="stringliteral">&quot;Unexpected operand sizes&quot;</span>);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// See if we&#39;re dealing with constant values.</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keyword">auto</span> *CILength = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keyword">auto</span> *CIIndex = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3));</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// Attempt to simplify to a constant or shuffle vector.</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span> (CILength &amp;&amp; CIIndex) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Len = CILength-&gt;getValue().zextOrTrunc(6);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> Idx = CIIndex-&gt;getValue().<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(6);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a6ec81729c2f0ec00aaa1a7c8560f6b8c">simplifyX86insertq</a>(II, Op0, Op1, Len, Idx, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">// INSERTQI only uses the lowest 64-bits of the first two 128-bit vector</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">// operands.</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Op0, VWidth0, 1)) {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 0, V);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = SimplifyDemandedVectorEltsLow(Op1, VWidth1, 1)) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">replaceOperand</a>(II, 1, V);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">if</span> (MadeChange) {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">return</span> &amp;II;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_pblendvb:</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_blendvps:</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_blendvpd:</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_blendv_ps_256:</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_blendv_pd_256:</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pblendvb: {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">// fold (blend A, A, Mask) -&gt; A</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span> (Op0 == Op1) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, Op0);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">// Zero Mask - select 1st argument.</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ConstantAggregateZero&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>)) {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, Op0);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// Constant Mask - select 1st/2nd argument lane based on top bit of mask.</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ConstantMask = dyn_cast&lt;ConstantDataVector&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>)) {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *NewSelector = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#afdc88fd3067f332e0080c7dfdf3fbbbb">getNegativeIsTrueBoolVec</a>(ConstantMask);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">SelectInst::Create</a>(NewSelector, Op1, Op0, <span class="stringliteral">&quot;blendv&quot;</span>);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// Convert to a vector select if we can bypass casts and find a boolean</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">// vector condition value.</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *BoolVec;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="classllvm_1_1InstCombiner.html#a2c476f610d4da3bd752816bc918aa146">InstCombiner::peekThroughBitcast</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1PatternMatch.html#aaab494a433fbb23bc68393ee8bcfc5ac">PatternMatch::m_SExt</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">PatternMatch::m_Value</a>(BoolVec))) &amp;&amp;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        BoolVec-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>() &amp;&amp;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        BoolVec-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() == 1) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType()-&gt;getPrimitiveSizeInBits() ==</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                 II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() &amp;&amp;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;             <span class="stringliteral">&quot;Not expecting mask and operands with different sizes&quot;</span>);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="keywordtype">unsigned</span> NumMaskElts =</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          cast&lt;FixedVectorType&gt;(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType())-&gt;getNumElements();</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordtype">unsigned</span> NumOperandElts =</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keywordflow">if</span> (NumMaskElts == NumOperandElts) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">SelectInst::Create</a>(BoolVec, Op1, Op0);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="comment">// If the mask has less elements than the operands, each mask bit maps to</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <span class="comment">// multiple elements of the operands. Bitcast back and forth.</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="keywordflow">if</span> (NumMaskElts &lt; NumOperandElts) {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *CastOp0 = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a06d64f226fabd94d694d6abd82e3c7b3">CreateBitCast</a>(Op0, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType());</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *CastOp1 = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a06d64f226fabd94d694d6abd82e3c7b3">CreateBitCast</a>(Op1, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>-&gt;getType());</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Sel = IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(BoolVec, CastOp1, CastOp0);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(Sel, II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_ssse3_pshuf_b_128:</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pshuf_b:</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pshuf_b_512:</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#afbdcf5b93b5500c5bdb516d47abc5ff4">simplifyX86pshufb</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_ps:</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_ps_256:</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vpermilvar_ps_512:</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_pd:</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_pd_256:</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vpermilvar_pd_512:</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a0b5bb50aa2c37c48ff126baafc9b2989">simplifyX86vpermilvar</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_permd:</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_permps:</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_df_256:</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_df_512:</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_di_256:</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_di_512:</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_hi_128:</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_hi_256:</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_hi_512:</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_qi_128:</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_qi_256:</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_qi_512:</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_sf_512:</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_permvar_si_512:</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a54b9709cc11722284848f2d12e605f9f">simplifyX86vpermv</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskload_ps:</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskload_pd:</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskload_ps_256:</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskload_pd_256:</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskload_d:</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskload_q:</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskload_d_256:</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskload_q_256:</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a8ad21e3937e91bb59d18d2c76915fe5c">simplifyX86MaskedLoad</a>(II, IC)) {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_maskmov_dqu:</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskstore_ps:</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskstore_pd:</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskstore_ps_256:</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_maskstore_pd_256:</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskstore_d:</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskstore_q:</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskstore_d_256:</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_maskstore_q_256:</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="X86InstCombineIntrinsic_8cpp.html#a708996b12b1b5e6ac2555880bdaeda64">simplifyX86MaskedStore</a>(II, IC)) {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_addcarry_32:</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_addcarry_64:</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="X86InstCombineIntrinsic_8cpp.html#a7f9bf3b17f89cfbe4fabd1ac2bdc3712">simplifyX86addcarry</a>(II, IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>)) {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">replaceInstUsesWith</a>(II, V);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;}</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"><a class="line" href="classllvm_1_1X86TTIImpl.html#a49bff27cd8c639d90493b91350d3d9d0"> 1737</a></span>&#160;std::optional&lt;Value *&gt; <a class="code" href="classllvm_1_1X86TTIImpl.html#a49bff27cd8c639d90493b91350d3d9d0">X86TTIImpl::simplifyDemandedUseBitsIntrinsic</a>(</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC, <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II, <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedMask, <a class="code" href="structllvm_1_1KnownBits.html">KnownBits</a> &amp;Known,</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordtype">bool</span> &amp;KnownBitsComputed)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keywordflow">switch</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>()) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_mmx_pmovmskb:</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_movmsk_ps:</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_movmsk_pd:</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_pmovmskb_128:</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_movmsk_ps_256:</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_movmsk_pd_256:</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pmovmskb: {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// MOVMSK copies the vector elements&#39; sign bits to the low bits</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// and zeros the high bits.</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordtype">unsigned</span> ArgWidth;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::x86_mmx_pmovmskb) {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      ArgWidth = 8; <span class="comment">// Arg is x86_mmx, but treated as &lt;8 x i8&gt;.</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keyword">auto</span> *ArgType = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      ArgWidth = ArgType-&gt;getNumElements();</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="comment">// If we don&#39;t need any of low bits then return zero,</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="comment">// we know that DemandedMask is non-zero already.</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts = DemandedMask.<a class="code" href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">zextOrTrunc</a>(ArgWidth);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *VTy = II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">if</span> (DemandedElts.<a class="code" href="classllvm_1_1APInt.html#a49cd5939942c6665aba4cae8c220dff1">isZero</a>()) {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(VTy);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// We know that the upper bits are set to zero.</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    Known.<a class="code" href="structllvm_1_1KnownBits.html#ac67bca6c764da76f5e152330d92ed916">Zero</a>.<a class="code" href="classllvm_1_1APInt.html#a286d4fa2a50c9ac6ac3a8069cccfcd0c">setBitsFrom</a>(ArgWidth);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    KnownBitsComputed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"><a class="line" href="classllvm_1_1X86TTIImpl.html#afd63c73f7201b4ed318ed3a3c56b6cad"> 1777</a></span>&#160;std::optional&lt;Value *&gt; <a class="code" href="classllvm_1_1X86TTIImpl.html#afd63c73f7201b4ed318ed3a3c56b6cad">X86TTIImpl::simplifyDemandedVectorEltsIntrinsic</a>(</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;IC, <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II, <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;UndefElts,</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;UndefElts2, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;UndefElts3,</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">void</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, <span class="keywordtype">unsigned</span>, <a class="code" href="classllvm_1_1APInt.html">APInt</a>, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;)&gt;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        simplifyAndSetOp)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="keywordtype">unsigned</span> VWidth = cast&lt;FixedVectorType&gt;(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getNumElements();</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="keywordflow">switch</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>()) {</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_xop_vfrcz_ss:</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_xop_vfrcz_sd:</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">// The instructions for these intrinsics are speced to zero upper bits not</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">// pass them through like other scalar intrinsics. So we shouldn&#39;t just</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// use Arg0 if DemandedElts[0] is clear like we do for other intrinsics.</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">// Instead we should return a zero vector.</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordflow">if</span> (!DemandedElts[0]) {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#ab86d58ae73173328360a32cbbb0d5b14">addToWorklist</a>(&amp;II);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">ConstantAggregateZero::get</a>(II.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="comment">// Only the lower element is used.</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    DemandedElts = 1;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts, UndefElts);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="comment">// Only the lower element is undefined. The high elements are zero.</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    UndefElts = UndefElts[0];</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="comment">// Unary scalar-as-vector operations that work column-wise.</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_rcp_ss:</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_rsqrt_ss:</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts, UndefElts);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">// If lowest element of a scalar op isn&#39;t used then use Arg0.</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordflow">if</span> (!DemandedElts[0]) {</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#ab86d58ae73173328360a32cbbb0d5b14">addToWorklist</a>(&amp;II);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keywordflow">return</span> II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">// TODO: If only low elt lower SQRT to FSQRT (with rounding/exceptions</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">// checks).</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="comment">// Binary scalar-as-vector operations that work column-wise. The high</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">// elements come from operand 0. The low element is a function of both</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="comment">// operands.</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_min_ss:</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_max_ss:</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse_cmp_ss:</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_min_sd:</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_max_sd:</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_cmp_sd: {</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts, UndefElts);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// If lowest element of a scalar op isn&#39;t used then use Arg0.</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">if</span> (!DemandedElts[0]) {</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#ab86d58ae73173328360a32cbbb0d5b14">addToWorklist</a>(&amp;II);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="keywordflow">return</span> II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">// Only lower element is used for operand 1.</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    DemandedElts = 1;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    simplifyAndSetOp(&amp;II, 1, DemandedElts, UndefElts2);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">// Lower element is undefined if both lower elements are undefined.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">// Consider things like undef&amp;0.  The result is known zero, not undef.</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordflow">if</span> (!UndefElts2[0])</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      UndefElts.<a class="code" href="classllvm_1_1APInt.html#a155466c9ea0a2bd00e09c62fdce2c052">clearBit</a>(0);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="comment">// Binary scalar-as-vector operations that work column-wise. The high</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="comment">// elements come from operand 0 and the low element comes from operand 1.</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_round_ss:</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_round_sd: {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">// Don&#39;t use the low element of operand 0.</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> DemandedElts2 = DemandedElts;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    DemandedElts2.<a class="code" href="classllvm_1_1APInt.html#a155466c9ea0a2bd00e09c62fdce2c052">clearBit</a>(0);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts2, UndefElts);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">// If lowest element of a scalar op isn&#39;t used then use Arg0.</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">if</span> (!DemandedElts[0]) {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#ab86d58ae73173328360a32cbbb0d5b14">addToWorklist</a>(&amp;II);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keywordflow">return</span> II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="comment">// Only lower element is used for operand 1.</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    DemandedElts = 1;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    simplifyAndSetOp(&amp;II, 1, DemandedElts, UndefElts2);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">// Take the high undef elements from operand 0 and take the lower element</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">// from operand 1.</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    UndefElts.<a class="code" href="classllvm_1_1APInt.html#a155466c9ea0a2bd00e09c62fdce2c052">clearBit</a>(0);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    UndefElts |= UndefElts2[0];</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="comment">// Three input scalar-as-vector operations that work column-wise. The high</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="comment">// elements come from operand 0 and the low element is a function of all</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="comment">// three inputs.</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_add_ss_round:</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_div_ss_round:</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_mul_ss_round:</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_sub_ss_round:</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_max_ss_round:</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_min_ss_round:</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_add_sd_round:</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_div_sd_round:</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_mul_sd_round:</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_sub_sd_round:</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_max_sd_round:</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_mask_min_sd_round:</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts, UndefElts);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">// If lowest element of a scalar op isn&#39;t used then use Arg0.</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="keywordflow">if</span> (!DemandedElts[0]) {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#ab86d58ae73173328360a32cbbb0d5b14">addToWorklist</a>(&amp;II);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keywordflow">return</span> II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="comment">// Only lower element is used for operand 1 and 2.</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    DemandedElts = 1;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    simplifyAndSetOp(&amp;II, 1, DemandedElts, UndefElts2);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    simplifyAndSetOp(&amp;II, 2, DemandedElts, UndefElts3);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="comment">// Lower element is undefined if all three lower elements are undefined.</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="comment">// Consider things like undef&amp;0.  The result is known zero, not undef.</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">if</span> (!UndefElts2[0] || !UndefElts3[0])</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      UndefElts.<a class="code" href="classllvm_1_1APInt.html#a155466c9ea0a2bd00e09c62fdce2c052">clearBit</a>(0);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="comment">// TODO: Add fmaddsub support?</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse3_addsub_pd:</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse3_addsub_ps:</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_addsub_pd_256:</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_addsub_ps_256: {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// If none of the even or none of the odd lanes are required, turn this</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// into a generic FP math instruction.</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> SubMask = <a class="code" href="classllvm_1_1APInt.html#a8c55d8510ad4b7cb957d8f5a7cd6944e">APInt::getSplat</a>(VWidth, <a class="code" href="classllvm_1_1APInt.html">APInt</a>(2, 0x1));</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> AddMask = <a class="code" href="classllvm_1_1APInt.html#a8c55d8510ad4b7cb957d8f5a7cd6944e">APInt::getSplat</a>(VWidth, <a class="code" href="classllvm_1_1APInt.html">APInt</a>(2, 0<a class="code" href="README-SSE_8txt.html#a95f2850bc8948fe1629b4395cc3eac8a">x2</a>));</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordtype">bool</span> IsSubOnly = DemandedElts.<a class="code" href="classllvm_1_1APInt.html#acfae9bdee6027ffa8ffe244cc22e3a76">isSubsetOf</a>(SubMask);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordtype">bool</span> IsAddOnly = DemandedElts.<a class="code" href="classllvm_1_1APInt.html#acfae9bdee6027ffa8ffe244cc22e3a76">isSubsetOf</a>(AddMask);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (IsSubOnly || IsAddOnly) {</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IsSubOnly ^ IsAddOnly) &amp;&amp; <span class="stringliteral">&quot;Can&#39;t be both add-only and sub-only&quot;</span>);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <a class="code" href="classllvm_1_1IRBuilderBase_1_1InsertPointGuard.html">IRBuilderBase::InsertPointGuard</a> Guard(IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(&amp;II);</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Arg0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Arg1 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keywordflow">return</span> IC.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a6332d31d71917ede8e7c557a226947f3">CreateBinOp</a>(</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;          IsSubOnly ? Instruction::FSub : Instruction::FAdd, Arg0, Arg1);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; </div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts, UndefElts);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    simplifyAndSetOp(&amp;II, 1, DemandedElts, UndefElts2);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    UndefElts &amp;= UndefElts2;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">// General per-element vector operations.</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_d:</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_d_256:</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_q:</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psllv_q_256:</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_d:</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_d_256:</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_q:</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrlv_q_256:</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrav_d:</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_psrav_d_256: {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    simplifyAndSetOp(&amp;II, 0, DemandedElts, UndefElts);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    simplifyAndSetOp(&amp;II, 1, DemandedElts, UndefElts2);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    UndefElts &amp;= UndefElts2;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_packssdw_128:</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_packsswb_128:</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse2_packuswb_128:</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse41_packusdw:</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packssdw:</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packsswb:</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packusdw:</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_packuswb:</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packssdw_512:</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packsswb_512:</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packusdw_512:</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_packuswb_512: {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keyword">auto</span> *Ty0 = II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordtype">unsigned</span> InnerVWidth = cast&lt;FixedVectorType&gt;(Ty0)-&gt;getNumElements();</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VWidth == (InnerVWidth * 2) &amp;&amp; <span class="stringliteral">&quot;Unexpected input size&quot;</span>);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordtype">unsigned</span> NumLanes = Ty0-&gt;getPrimitiveSizeInBits() / 128;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordtype">unsigned</span> VWidthPerLane = VWidth / NumLanes;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordtype">unsigned</span> InnerVWidthPerLane = InnerVWidth / NumLanes;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">// Per lane, pack the elements of the first input and then the second.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">// e.g.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="comment">// v8i16 PACK(v4i32 X, v4i32 Y) - (X[0..3],Y[0..3])</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// v32i8 PACK(v16i16 X, v16i16 Y) - (X[0..7],Y[0..7]),(X[8..15],Y[8..15])</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> OpNum = 0; OpNum != 2; ++OpNum) {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> OpDemandedElts(InnerVWidth, 0);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Lane = 0; Lane != NumLanes; ++Lane) {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordtype">unsigned</span> LaneIdx = Lane * VWidthPerLane;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Elt = 0; Elt != InnerVWidthPerLane; ++Elt) {</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          <span class="keywordtype">unsigned</span> Idx = LaneIdx + Elt + InnerVWidthPerLane * OpNum;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;          <span class="keywordflow">if</span> (DemandedElts[Idx])</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            OpDemandedElts.<a class="code" href="classllvm_1_1APInt.html#a33f9f862dca8ee0f23bff5941bf433d8">setBit</a>((Lane * InnerVWidthPerLane) + Elt);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="comment">// Demand elements from the operand.</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> OpUndefElts(InnerVWidth, 0);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      simplifyAndSetOp(&amp;II, OpNum, OpDemandedElts, OpUndefElts);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <span class="comment">// Pack the operand&#39;s UNDEF elements, one lane at a time.</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      OpUndefElts = OpUndefElts.<a class="code" href="classllvm_1_1APInt.html#a1dc76cc8bf703e6ada68bededcbb9573">zext</a>(VWidth);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Lane = 0; Lane != NumLanes; ++Lane) {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <a class="code" href="classllvm_1_1APInt.html">APInt</a> LaneElts = OpUndefElts.<a class="code" href="classllvm_1_1APInt.html#af34549c39d6f741fbdaf9a795aa306e9">lshr</a>(InnerVWidthPerLane * Lane);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        LaneElts = LaneElts.<a class="code" href="classllvm_1_1APInt.html#a0fa9845f80fa0642b31c238f4ab0d5ef">getLoBits</a>(InnerVWidthPerLane);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        LaneElts &lt;&lt;= InnerVWidthPerLane * (2 * Lane + OpNum);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        UndefElts |= LaneElts;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="comment">// PSHUFB</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_ssse3_pshuf_b_128:</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_pshuf_b:</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_pshuf_b_512:</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <span class="comment">// PERMILVAR</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_ps:</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_ps_256:</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vpermilvar_ps_512:</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_pd:</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx_vpermilvar_pd_256:</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx512_vpermilvar_pd_512:</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">// PERMV</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_permd:</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_avx2_permps: {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    simplifyAndSetOp(&amp;II, 1, DemandedElts, UndefElts);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="comment">// SSE4A instructions leave the upper 64-bits of the 128-bit result</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="comment">// in an undefined state.</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_extrq:</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_extrqi:</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_insertq:</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_sse4a_insertqi:</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    UndefElts.<a class="code" href="classllvm_1_1APInt.html#a2780c5606880394d3f07cd2079a27697">setHighBits</a>(VWidth / 2);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ace45cae6925c65e9d6916e09dd5b17cc"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">llvm::IRBuilderBase::SetInsertPoint</a></div><div class="ttdeci">void SetInsertPoint(BasicBlock *TheBB)</div><div class="ttdoc">This specifies that created instructions should be appended to the end of the specified block.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00180">IRBuilder.h:180</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="aInstCombiner_8h_html"><div class="ttname"><a href="InstCombiner_8h.html">InstCombiner.h</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html_a9b35c622a902a7a7dc93b807a9fa9265"><div class="ttname"><a href="structllvm_1_1KnownBits.html#a9b35c622a902a7a7dc93b807a9fa9265">llvm::KnownBits::getMinValue</a></div><div class="ttdeci">APInt getMinValue() const</div><div class="ttdoc">Return the minimal unsigned value possible given these KnownBits.</div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00120">KnownBits.h:120</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html_a7ff64b3625b6f9020556ed05a5f72af4"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">llvm::IntrinsicInst::getIntrinsicID</a></div><div class="ttdeci">Intrinsic::ID getIntrinsicID() const</div><div class="ttdoc">Return the intrinsic ID of this intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00054">IntrinsicInst.h:54</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a6ec81729c2f0ec00aaa1a7c8560f6b8c"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a6ec81729c2f0ec00aaa1a7c8560f6b8c">simplifyX86insertq</a></div><div class="ttdeci">static Value * simplifyX86insertq(IntrinsicInst &amp;II, Value *Op0, Value *Op1, APInt APLength, APInt APIndex, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdoc">Attempt to simplify SSE4A INSERTQ/INSERTQI instructions using constant folding or conversion to a shu...</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00710">X86InstCombineIntrinsic.cpp:710</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html_a050a395d1656e546679d8b144d951bb2"><div class="ttname"><a href="classllvm_1_1PointerType.html#a050a395d1656e546679d8b144d951bb2">llvm::PointerType::get</a></div><div class="ttdeci">static PointerType * get(Type *ElementType, unsigned AddressSpace)</div><div class="ttdoc">This constructs a pointer to an object of the specified type in a numbered address space.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00729">Type.cpp:729</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a0b5bb50aa2c37c48ff126baafc9b2989"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a0b5bb50aa2c37c48ff126baafc9b2989">simplifyX86vpermilvar</a></div><div class="ttdeci">static Value * simplifyX86vpermilvar(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdoc">Attempt to convert vpermilvar* to shufflevector if the mask is constant.</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00848">X86InstCombineIntrinsic.cpp:848</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05258">Instructions.h:5258</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html_ac67bca6c764da76f5e152330d92ed916"><div class="ttname"><a href="structllvm_1_1KnownBits.html#ac67bca6c764da76f5e152330d92ed916">llvm::KnownBits::Zero</a></div><div class="ttdeci">APInt Zero</div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00024">KnownBits.h:24</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00263">README.txt:263</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a4b001d9b458035fbbfc154d52d354ee9"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const</div><div class="ttdoc">Return the constant as an APInt value reference.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00132">Constants.h:132</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a09b36f90a9ee67af8d0cf1597784f518"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a09b36f90a9ee67af8d0cf1597784f518">simplifyX86pack</a></div><div class="ttdeci">static Value * simplifyX86pack(IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder, bool IsSigned)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00438">X86InstCombineIntrinsic.cpp:438</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_ae1d331bc844ecb92bdeb0b706ae04396"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">llvm::InstCombiner::Builder</a></div><div class="ttdeci">BuilderTy &amp; Builder</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00058">InstCombiner.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a68fce0638c5ec7b96b8572cad9c20488"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a68fce0638c5ec7b96b8572cad9c20488">llvm::ConstantExpr::getICmp</a></div><div class="ttdeci">static Constant * getICmp(unsigned short pred, Constant *LHS, Constant *RHS, bool OnlyIfReduced=false)</div><div class="ttdoc">get* - Return some common constants without having to specify the full Instruction::OPCODE identifier...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02523">Constants.cpp:2523</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt; TargetFolder, IRBuilderCallbackInserter &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a2ed912a28808268e35bd58e8f11251aa"><div class="ttname"><a href="classllvm_1_1APInt.html#a2ed912a28808268e35bd58e8f11251aa">llvm::APInt::zextOrTrunc</a></div><div class="ttdeci">APInt zextOrTrunc(unsigned width) const</div><div class="ttdoc">Zero extend or truncate to width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00994">APInt.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_ae79d05dd3d0b05e080e08f8c5c33f880"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">llvm::ConstantExpr::getBitCast</a></div><div class="ttdeci">static Constant * getBitCast(Constant *C, Type *Ty, bool OnlyIfReduced=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02229">Constants.cpp:2229</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a46ceedee591f92727b85641794a96061"><div class="ttname"><a href="classllvm_1_1APInt.html#a46ceedee591f92727b85641794a96061">llvm::APInt::getBitsSet</a></div><div class="ttdeci">static APInt getBitsSet(unsigned numBits, unsigned loBit, unsigned hiBit)</div><div class="ttdoc">Get a value with a block of bits set.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00241">APInt.h:241</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a">llvm::CmpInst::ICMP_SGT</a></div><div class="ttdeci">@ ICMP_SGT</div><div class="ttdoc">signed greater than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00745">InstrTypes.h:745</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a562c9513409b74f02cb3a5c9bae672ea"><div class="ttname"><a href="classllvm_1_1APInt.html#a562c9513409b74f02cb3a5c9bae672ea">llvm::APInt::getSignedMaxValue</a></div><div class="ttdeci">static APInt getSignedMaxValue(unsigned numBits)</div><div class="ttdoc">Gets maximum signed value of APInt for a specific bit width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00189">APInt.h:189</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a8db36c82f32d6f6a4d35a00e55be03a8"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a></div><div class="ttdeci">bool Shift</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00468">README.txt:468</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantAggregateZero_html"><div class="ttname"><a href="classllvm_1_1ConstantAggregateZero.html">llvm::ConstantAggregateZero</a></div><div class="ttdoc">All zero aggregate value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00336">Constants.h:336</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a17689bb6df5ac02081d2adc9f5c3d282"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a17689bb6df5ac02081d2adc9f5c3d282">llvm::IRBuilderBase::CreateFSub</a></div><div class="ttdeci">Value * CreateFSub(Value *L, Value *R, const Twine &amp;Name=&quot;&quot;, MDNode *FPMD=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01475">IRBuilder.h:1475</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html_a1620c017d995c7ccbcb59e0212618017"><div class="ttname"><a href="structllvm_1_1KnownBits.html#a1620c017d995c7ccbcb59e0212618017">llvm::KnownBits::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">Returns true if value is all zero.</div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00072">KnownBits.h:72</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_ab86d58ae73173328360a32cbbb0d5b14"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#ab86d58ae73173328360a32cbbb0d5b14">llvm::InstCombiner::addToWorklist</a></div><div class="ttdeci">void addToWorklist(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00367">InstCombiner.h:367</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a39b5a72b70df94211893c7fc6bbfe1f5"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a39b5a72b70df94211893c7fc6bbfe1f5">llvm::IRBuilderBase::CreateInsertElement</a></div><div class="ttdeci">Value * CreateInsertElement(Type *VecTy, Value *NewElt, Value *Idx, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02353">IRBuilder.h:2353</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_af34549c39d6f741fbdaf9a795aa306e9"><div class="ttname"><a href="classllvm_1_1APInt.html#af34549c39d6f741fbdaf9a795aa306e9">llvm::APInt::lshr</a></div><div class="ttdeci">APInt lshr(unsigned shiftAmt) const</div><div class="ttdoc">Logical right-shift function.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00839">APInt.h:839</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7ba5de75f50bb4a4ba920698edf39b28"><div class="ttname"><a href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">llvm::Type::getInt8Ty</a></div><div class="ttdeci">static IntegerType * getInt8Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00239">Type.cpp:239</a></div></div>
<div class="ttc" id="aclassllvm_1_1X86TTIImpl_html_a49bff27cd8c639d90493b91350d3d9d0"><div class="ttname"><a href="classllvm_1_1X86TTIImpl.html#a49bff27cd8c639d90493b91350d3d9d0">llvm::X86TTIImpl::simplifyDemandedUseBitsIntrinsic</a></div><div class="ttdeci">std::optional&lt; Value * &gt; simplifyDemandedUseBitsIntrinsic(InstCombiner &amp;IC, IntrinsicInst &amp;II, APInt DemandedMask, KnownBits &amp;Known, bool &amp;KnownBitsComputed) const</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l01737">X86InstCombineIntrinsic.cpp:1737</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_add4e37b60ea64faafbc9a5bf3e27280f"><div class="ttname"><a href="classllvm_1_1APInt.html#add4e37b60ea64faafbc9a5bf3e27280f">llvm::APInt::getZero</a></div><div class="ttdeci">static APInt getZero(unsigned numBits)</div><div class="ttdoc">Get the '0' value for the specified bit-width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00177">APInt.h:177</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aKnownBits_8h_html"><div class="ttname"><a href="KnownBits_8h.html">KnownBits.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a6332d31d71917ede8e7c557a226947f3"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a6332d31d71917ede8e7c557a226947f3">llvm::IRBuilderBase::CreateBinOp</a></div><div class="ttdeci">Value * CreateBinOp(Instruction::BinaryOps Opc, Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, MDNode *FPMathTag=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01581">IRBuilder.h:1581</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a2780c5606880394d3f07cd2079a27697"><div class="ttname"><a href="classllvm_1_1APInt.html#a2780c5606880394d3f07cd2079a27697">llvm::APInt::setHighBits</a></div><div class="ttdeci">void setHighBits(unsigned hiBits)</div><div class="ttdoc">Set the top hiBits bits.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01370">APInt.h:1370</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a91efa71de05b0c2d00730a0279f58658"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">llvm::BitmaskEnumDetail::Mask</a></div><div class="ttdeci">constexpr std::underlying_type_t&lt; E &gt; Mask()</div><div class="ttdoc">Get a bitmask with 1s in all places up to the high-order bit of E's largest value.</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00080">BitmaskEnum.h:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_af4b1ccc0b78f9da9f3f3944e06007f1d"><div class="ttname"><a href="classllvm_1_1APInt.html#af4b1ccc0b78f9da9f3f3944e06007f1d">llvm::APInt::uge</a></div><div class="ttdeci">bool uge(const APInt &amp;RHS) const</div><div class="ttdoc">Unsigned greater or equal comparison.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01199">APInt.h:1199</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_afbdcf5b93b5500c5bdb516d47abc5ff4"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#afbdcf5b93b5500c5bdb516d47abc5ff4">simplifyX86pshufb</a></div><div class="ttdeci">static Value * simplifyX86pshufb(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdoc">Attempt to convert pshufb* to shufflevector if the mask is constant.</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00803">X86InstCombineIntrinsic.cpp:803</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a11ca92463dc5dfc09bbe2ba2f3ea0c96"><div class="ttname"><a href="README-SSE_8txt.html#a11ca92463dc5dfc09bbe2ba2f3ea0c96">x3</a></div><div class="ttdeci">In x86 we generate this spiffy xmm0 xmm0 ret in x86 we generate this which could be xmm1 movss xmm1 xmm0 ret In sse4 we could use insertps to make both better Here s another testcase that could use x3</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00547">README-SSE.txt:547</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a490a5df5a9f49b5648d251cda2f7c428"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a490a5df5a9f49b5648d251cda2f7c428">llvm::IRBuilderBase::CreateFMul</a></div><div class="ttdeci">Value * CreateFMul(Value *L, Value *R, const Twine &amp;Name=&quot;&quot;, MDNode *FPMD=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01502">IRBuilder.h:1502</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_abc13043585e5845ce7fc26b858851ec9"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#abc13043585e5845ce7fc26b858851ec9">llvm::InstCombiner::replaceOperand</a></div><div class="ttdeci">Instruction * replaceOperand(Instruction &amp;I, unsigned OpNum, Value *V)</div><div class="ttdoc">Replace operand of instruction and add old operand to the worklist.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00442">InstCombiner.h:442</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_aa55fb74dd22008fdcc26a63f44576022"><div class="ttname"><a href="classllvm_1_1SelectInst.html#aa55fb74dd22008fdcc26a63f44576022">llvm::SelectInst::Create</a></div><div class="ttdeci">static SelectInst * Create(Value *C, Value *S1, Value *S2, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr, Instruction *MDFrom=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01777">Instructions.h:1777</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a464ebe507cbf5cd1d772ecd1aacdaff6"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a464ebe507cbf5cd1d772ecd1aacdaff6">simplifyX86varShift</a></div><div class="ttdeci">static Value * simplifyX86varShift(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00302">X86InstCombineIntrinsic.cpp:302</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a33f9f862dca8ee0f23bff5941bf433d8"><div class="ttname"><a href="classllvm_1_1APInt.html#a33f9f862dca8ee0f23bff5941bf433d8">llvm::APInt::setBit</a></div><div class="ttdeci">void setBit(unsigned BitPosition)</div><div class="ttdoc">Set the given bit to 1 whose position is given as &quot;bitPosition&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01308">APInt.h:1308</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_af338e23a90c301183968435e80cd6a27"><div class="ttname"><a href="classllvm_1_1APInt.html#af338e23a90c301183968435e80cd6a27">llvm::APInt::lshrInPlace</a></div><div class="ttdeci">void lshrInPlace(unsigned ShiftAmt)</div><div class="ttdoc">Logical right-shift this APInt by ShiftAmt in place.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00846">APInt.h:846</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a49cd5939942c6665aba4cae8c220dff1"><div class="ttname"><a href="classllvm_1_1APInt.html#a49cd5939942c6665aba4cae8c220dff1">llvm::APInt::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">Determine if this value is zero, i.e. all bits are clear.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00366">APInt.h:366</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a5823441d951ade391206be8c839f8f3e"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a5823441d951ade391206be8c839f8f3e">getBoolVecFromMask</a></div><div class="ttdeci">static Value * getBoolVecFromMask(Value *Mask)</div><div class="ttdoc">Convert the x86 XMM integer vector mask to a vector of bools based on each element's most significant...</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00039">X86InstCombineIntrinsic.cpp:39</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a3217063f680fa8e35dea3c59b6e52b18"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a3217063f680fa8e35dea3c59b6e52b18">int</a></div><div class="ttdeci">Clang compiles this i1 i64 store i64 i64 store i64 i64 store i64 i64 store i64 align Which gets codegen d xmm0 movaps rbp movaps rbp movaps rbp movaps rbp rbp rbp rbp rbp It would be better to have movq s of instead of the movaps s LLVM produces ret int</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00536">README.txt:536</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html_a7fdb2317662e3e901e47544a40190f12"><div class="ttname"><a href="classllvm_1_1VectorType.html#a7fdb2317662e3e901e47544a40190f12">llvm::VectorType::getInteger</a></div><div class="ttdeci">static VectorType * getInteger(VectorType *VTy)</div><div class="ttdoc">This static method gets a VectorType with the same number of elements as the input type,...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00440">DerivedTypes.h:440</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_aee284a557cb4df418d8a665a5e4ace3c"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#aee284a557cb4df418d8a665a5e4ace3c">simplifyX86extrq</a></div><div class="ttdeci">static Value * simplifyX86extrq(IntrinsicInst &amp;II, Value *Op0, ConstantInt *CILength, ConstantInt *CIIndex, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdoc">Attempt to simplify SSE4A EXTRQ/EXTRQI instructions using constant folding or conversion to a shuffle...</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00619">X86InstCombineIntrinsic.cpp:619</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a72e7e99bed226a41d93b4afb6f24a264"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a72e7e99bed226a41d93b4afb6f24a264">simplifyX86movmsk</a></div><div class="ttdeci">static Value * simplifyX86movmsk(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00504">X86InstCombineIntrinsic.cpp:504</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a1bc022868b23918efa44df511f4d5b61"><div class="ttname"><a href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const</div><div class="ttdoc">True if this is an instance of VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00258">Type.h:258</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a9f382207d841377156d4c7868b66b9a5"><div class="ttname"><a href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits() const LLVM_READONLY</div><div class="ttdoc">If this is a vector type, return the getPrimitiveSizeInBits value for the element type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00188">Type.cpp:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_a271d5063c18ca60e0e96a0f916096148"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a271d5063c18ca60e0e96a0f916096148">llvm::InstCombiner::eraseInstFromFunction</a></div><div class="ttdeci">virtual Instruction * eraseInstFromFunction(Instruction &amp;I)=0</div><div class="ttdoc">Combiner aware instruction erasure.</div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a217e0207d9cc8e046c2dccbf0e4bb198"><div class="ttname"><a href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Get zero extended value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01494">APInt.h:1494</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_a7bbbdfd451adf8eb62a5dc6bcec8a3f0"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a7bbbdfd451adf8eb62a5dc6bcec8a3f0">llvm::InstCombiner::SimplifyDemandedVectorElts</a></div><div class="ttdeci">virtual Value * SimplifyDemandedVectorElts(Value *V, APInt DemandedElts, APInt &amp;UndefElts, unsigned Depth=0, bool AllowMultipleUsers=false)=0</div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01740">Constants.cpp:1740</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a043cdaf7b89aaeeb127be5d93411637f"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a></div><div class="ttdeci">uint64_t Align</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00082">ELFObjHandler.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html_af9a870d5df50fe0133a410b7c9114c80"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">llvm::FixedVectorType::get</a></div><div class="ttdeci">static FixedVectorType * get(Type *ElementType, unsigned NumElts)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00686">Type.cpp:686</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a13e877ef779ba7a0688081079f4f9b03"><div class="ttname"><a href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">llvm::Type::getIntegerBitWidth</a></div><div class="ttdeci">unsigned getIntegerBitWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00097">DerivedTypes.h:97</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_af5a702ee0c9fcfdb2f18c91eb0499bf2"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#af5a702ee0c9fcfdb2f18c91eb0499bf2">llvm::IRBuilderBase::CreateAnd</a></div><div class="ttdeci">Value * CreateAnd(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01390">IRBuilder.h:1390</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_acfae9bdee6027ffa8ffe244cc22e3a76"><div class="ttname"><a href="classllvm_1_1APInt.html#acfae9bdee6027ffa8ffe244cc22e3a76">llvm::APInt::isSubsetOf</a></div><div class="ttdeci">bool isSubsetOf(const APInt &amp;RHS) const</div><div class="ttdoc">This operation checks that all bits set in this APInt are also set in RHS.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01235">APInt.h:1235</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_aec662ee6ab1490a4cabebf2812e5b9ca"><div class="ttname"><a href="classllvm_1_1APInt.html#aec662ee6ab1490a4cabebf2812e5b9ca">llvm::APInt::getOneBitSet</a></div><div class="ttdeci">static APInt getOneBitSet(unsigned numBits, unsigned BitNo)</div><div class="ttdoc">Return an APInt with exactly one bit set in the result.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00222">APInt.h:222</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_afdc88fd3067f332e0080c7dfdf3fbbbb"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#afdc88fd3067f332e0080c7dfdf3fbbbb">getNegativeIsTrueBoolVec</a></div><div class="ttdeci">static Constant * getNegativeIsTrueBoolVec(Constant *V)</div><div class="ttdoc">Return a constant boolean vector that has true elements in all positions where the input constant dat...</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00029">X86InstCombineIntrinsic.cpp:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html"><div class="ttname"><a href="classllvm_1_1VectorType.html">llvm::VectorType</a></div><div class="ttdoc">Base class of all SIMD vector types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00389">DerivedTypes.h:389</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a0037e4c509dde63e30ae3e0287c5ee69"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a0037e4c509dde63e30ae3e0287c5ee69">llvm::IRBuilderBase::CreateFAdd</a></div><div class="ttdeci">Value * CreateFAdd(Value *L, Value *R, const Twine &amp;Name=&quot;&quot;, MDNode *FPMD=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01448">IRBuilder.h:1448</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a894d9a647d9e28d6332ebd0b48c5a0b2"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a894d9a647d9e28d6332ebd0b48c5a0b2">llvm::IRBuilderBase::CreateFDiv</a></div><div class="ttdeci">Value * CreateFDiv(Value *L, Value *R, const Twine &amp;Name=&quot;&quot;, MDNode *FPMD=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01529">IRBuilder.h:1529</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a708996b12b1b5e6ac2555880bdaeda64"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a708996b12b1b5e6ac2555880bdaeda64">simplifyX86MaskedStore</a></div><div class="ttdeci">static bool simplifyX86MaskedStore(IntrinsicInst &amp;II, InstCombiner &amp;IC)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00087">X86InstCombineIntrinsic.cpp:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a06d64f226fabd94d694d6abd82e3c7b3"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a06d64f226fabd94d694d6abd82e3c7b3">llvm::IRBuilderBase::CreateBitCast</a></div><div class="ttdeci">Value * CreateBitCast(Value *V, Type *DestTy, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02008">IRBuilder.h:2008</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a95f2850bc8948fe1629b4395cc3eac8a"><div class="ttname"><a href="README-SSE_8txt.html#a95f2850bc8948fe1629b4395cc3eac8a">x2</a></div><div class="ttdeci">gcc mainline compiles it x2(%rip)</div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_aef61945034b9431b804748fc317c5548"><div class="ttname"><a href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a></div><div class="ttdeci">uint32_t Index</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00083">ELFObjHandler.cpp:83</a></div></div>
<div class="ttc" id="aclassllvm_1_1X86TTIImpl_html_a47cb7185e35282131b486036ff7c45df"><div class="ttname"><a href="classllvm_1_1X86TTIImpl.html#a47cb7185e35282131b486036ff7c45df">llvm::X86TTIImpl::instCombineIntrinsic</a></div><div class="ttdeci">std::optional&lt; Instruction * &gt; instCombineIntrinsic(InstCombiner &amp;IC, IntrinsicInst &amp;II) const</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00929">X86InstCombineIntrinsic.cpp:929</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a49b228f797f9b3563256da446100c3ac"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a49b228f797f9b3563256da446100c3ac">llvm::IRBuilderBase::CreateSelect</a></div><div class="ttdeci">Value * CreateSelect(Value *C, Value *True, Value *False, const Twine &amp;Name=&quot;&quot;, Instruction *MDFrom=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8cpp_source.html#l01126">IRBuilder.cpp:1126</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdoc">Class to represent pointers.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00632">DerivedTypes.h:632</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html_a825476b2436eb817b735fdd34ee521c4"><div class="ttname"><a href="structllvm_1_1KnownBits.html#a825476b2436eb817b735fdd34ee521c4">llvm::KnownBits::getMaxValue</a></div><div class="ttdeci">APInt getMaxValue() const</div><div class="ttdoc">Return the maximal unsigned value possible given these KnownBits.</div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00136">KnownBits.h:136</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa1f8f0633edd8b9a1c5ec15bb9fc5640"><div class="ttname"><a href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">llvm::computeKnownBits</a></div><div class="ttdeci">void computeKnownBits(const Value *V, KnownBits &amp;Known, const DataLayout &amp;DL, unsigned Depth=0, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr, OptimizationRemarkEmitter *ORE=nullptr, bool UseInstrInfo=true)</div><div class="ttdoc">Determine which bits of V are known to be either zero or one and return them in the KnownZero/KnownOn...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00186">ValueTracking.cpp:186</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a5c728ddd7890c015533b42cdd7307b0c"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a5c728ddd7890c015533b42cdd7307b0c">llvm::IRBuilderBase::CreateExtractElement</a></div><div class="ttdeci">Value * CreateExtractElement(Value *Vec, Value *Idx, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02341">IRBuilder.h:2341</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">llvm::Length</a></div><div class="ttdeci">@ Length</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aaab494a433fbb23bc68393ee8bcfc5ac"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aaab494a433fbb23bc68393ee8bcfc5ac">llvm::PatternMatch::m_SExt</a></div><div class="ttdeci">CastClass_match&lt; OpTy, Instruction::SExt &gt; m_SExt(const OpTy &amp;Op)</div><div class="ttdoc">Matches SExt.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01623">PatternMatch.h:1623</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a15d34f8dc07013df378e0fb3d0134c08"><div class="ttname"><a href="classllvm_1_1Type.html#a15d34f8dc07013df378e0fb3d0134c08">llvm::Type::getStructElementType</a></div><div class="ttdeci">Type * getStructElementType(unsigned N) const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00352">DerivedTypes.h:352</a></div></div>
<div class="ttc" id="aX86TargetTransformInfo_8h_html"><div class="ttname"><a href="X86TargetTransformInfo_8h.html">X86TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_acd530d0571f320d47d37e7ae51cf70ff"><div class="ttname"><a href="classllvm_1_1Constant.html#acd530d0571f320d47d37e7ae51cf70ff">llvm::Constant::getAggregateElement</a></div><div class="ttdeci">Constant * getAggregateElement(unsigned Elt) const</div><div class="ttdoc">For aggregates (struct/array/vector) return the constant that corresponds to the specified element if...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00418">Constants.cpp:418</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_1_1InsertPointGuard_html"><div class="ttname"><a href="classllvm_1_1IRBuilderBase_1_1InsertPointGuard.html">llvm::IRBuilderBase::InsertPointGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00361">IRBuilder.h:361</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantVector_html_ade9fa017ca3aa82f7694a47090547bc1"><div class="ttname"><a href="classllvm_1_1ConstantVector.html#ade9fa017ca3aa82f7694a47090547bc1">llvm::ConstantVector::get</a></div><div class="ttdeci">static Constant * get(ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01356">Constants.cpp:1356</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a545e8d5dfa1688acea0d0e275b03682f"><div class="ttname"><a href="classllvm_1_1APInt.html#a545e8d5dfa1688acea0d0e275b03682f">llvm::APInt::ult</a></div><div class="ttdeci">bool ult(const APInt &amp;RHS) const</div><div class="ttdoc">Unsigned less than comparison.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01089">APInt.h:1089</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a155466c9ea0a2bd00e09c62fdce2c052"><div class="ttname"><a href="classllvm_1_1APInt.html#a155466c9ea0a2bd00e09c62fdce2c052">llvm::APInt::clearBit</a></div><div class="ttdeci">void clearBit(unsigned BitPosition)</div><div class="ttdoc">Set a given bit to 0.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01385">APInt.h:1385</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_aefa39f6b622360ce4e947feb9f671b73"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=std::nullopt)</div><div class="ttdoc">Create or insert an LLVM Function declaration for an intrinsic, and return it.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l01502">Function.cpp:1502</a></div></div>
<div class="ttc" id="anamespacellvm_html_a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083"><div class="ttname"><a href="namespacellvm.html#a766456df1dd21e804cd4596304e10764ae8b4b40ec3622e371789b790caabc083">llvm::ComplexDeinterleavingOperation::Shuffle</a></div><div class="ttdeci">@ Shuffle</div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_aa00031e59684d793baa874f11ddaf189"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#aa00031e59684d793baa874f11ddaf189">llvm::InstCombiner::replaceInstUsesWith</a></div><div class="ttdeci">Instruction * replaceInstUsesWith(Instruction &amp;I, Value *V)</div><div class="ttdoc">A combiner-aware RAUW-like routine.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00418">InstCombiner.h:418</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a1dc76cc8bf703e6ada68bededcbb9573"><div class="ttname"><a href="classllvm_1_1APInt.html#a1dc76cc8bf703e6ada68bededcbb9573">llvm::APInt::zext</a></div><div class="ttdeci">APInt zext(unsigned width) const</div><div class="ttdoc">Zero extend to a new width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00973">APInt.cpp:973</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca24244a27b634ef3e256ab3c64c6fecd4">llvm::NVPTX::PTXLdStInstCode::V2</a></div><div class="ttdeci">@ V2</div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00124">NVPTX.h:124</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a05186fa23e4d11b9855a9599ba87a4b7"><div class="ttname"><a href="classllvm_1_1Type.html#a05186fa23e4d11b9855a9599ba87a4b7">llvm::Type::getInt64Ty</a></div><div class="ttdeci">static IntegerType * getInt64Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00242">Type.cpp:242</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a2636ba332d036d0143eec07de82c7136"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a2636ba332d036d0143eec07de82c7136">simplifyX86insertps</a></div><div class="ttdeci">static Value * simplifyX86insertps(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00560">X86InstCombineIntrinsic.cpp:560</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdoc">Constructor to create a '0' constant of arbitrary type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00356">Constants.cpp:356</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html"><div class="ttname"><a href="structllvm_1_1KnownBits.html">llvm::KnownBits</a></div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00023">KnownBits.h:23</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a34ee40bb2f4f5ece47ef19e5f1f57e3c"><div class="ttname"><a href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">llvm::Type::isIntOrIntVectorTy</a></div><div class="ttdeci">bool isIntOrIntVectorTy() const</div><div class="ttdoc">Return true if this is an integer type or a vector of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00228">Type.h:228</a></div></div>
<div class="ttc" id="aclassllvm_1_1X86TTIImpl_html_afd63c73f7201b4ed318ed3a3c56b6cad"><div class="ttname"><a href="classllvm_1_1X86TTIImpl.html#afd63c73f7201b4ed318ed3a3c56b6cad">llvm::X86TTIImpl::simplifyDemandedVectorEltsIntrinsic</a></div><div class="ttdeci">std::optional&lt; Value * &gt; simplifyDemandedVectorEltsIntrinsic(InstCombiner &amp;IC, IntrinsicInst &amp;II, APInt DemandedElts, APInt &amp;UndefElts, APInt &amp;UndefElts2, APInt &amp;UndefElts3, std::function&lt; void(Instruction *, unsigned, APInt, APInt &amp;)&gt; SimplifyAndSetOp) const</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l01777">X86InstCombineIntrinsic.cpp:1777</a></div></div>
<div class="ttc" id="anamespacellvm_html_abee0df5f7f703bb4462aba260ba0a60f"><div class="ttname"><a href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">llvm::BitWidth</a></div><div class="ttdeci">constexpr unsigned BitWidth</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00147">BitmaskEnum.h:147</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a0fa9845f80fa0642b31c238f4ab0d5ef"><div class="ttname"><a href="classllvm_1_1APInt.html#a0fa9845f80fa0642b31c238f4ab0d5ef">llvm::APInt::getLoBits</a></div><div class="ttdeci">APInt getLoBits(unsigned numBits) const</div><div class="ttdoc">Compute an APInt containing numBits lowbits from this APInt.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00605">APInt.cpp:605</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a8c55d8510ad4b7cb957d8f5a7cd6944e"><div class="ttname"><a href="classllvm_1_1APInt.html#a8c55d8510ad4b7cb957d8f5a7cd6944e">llvm::APInt::getSplat</a></div><div class="ttdeci">static APInt getSplat(unsigned NewLen, const APInt &amp;V)</div><div class="ttdoc">Return a value containing V broadcasted over NewLen bits.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00612">APInt.cpp:612</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a54b9709cc11722284848f2d12e605f9f"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a54b9709cc11722284848f2d12e605f9f">simplifyX86vpermv</a></div><div class="ttdeci">static Value * simplifyX86vpermv(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdoc">Attempt to convert vpermd/vpermps to shufflevector if the mask is constant.</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00895">X86InstCombineIntrinsic.cpp:895</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a874d53817a4923de8e58af6b278c09b0"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a874d53817a4923de8e58af6b278c09b0">llvm::PatternMatch::m_ZeroInt</a></div><div class="ttdeci">cst_pred_ty&lt; is_zero_int &gt; m_ZeroInt()</div><div class="ttdoc">Match an integer 0 or a vector with all elements equal to 0.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00524">PatternMatch.h:524</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a8f877403433892e14ff0c692cbe9efdf"><div class="ttname"><a href="classllvm_1_1APInt.html#a8f877403433892e14ff0c692cbe9efdf">llvm::APInt::getSignedMinValue</a></div><div class="ttdeci">static APInt getSignedMinValue(unsigned numBits)</div><div class="ttdoc">Gets minimum signed value of APInt for a specific bit width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00199">APInt.h:199</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html"><div class="ttname"><a href="classllvm_1_1InstCombiner.html">llvm::InstCombiner</a></div><div class="ttdoc">The core instruction combiner logic.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00045">InstCombiner.h:45</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6467ebe1e09a75203dd5f14bdfe21d11"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">llvm::AMDGPU::Hwreg::Width</a></div><div class="ttdeci">Width</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00449">SIDefines.h:449</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_aca8fce65eb69a82aa10a635e2e79877a"><div class="ttname"><a href="classllvm_1_1APInt.html#aca8fce65eb69a82aa10a635e2e79877a">llvm::APInt::sext</a></div><div class="ttdeci">APInt sext(unsigned width) const</div><div class="ttdoc">Sign extend to a new width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00946">APInt.cpp:946</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVMatInt_html_a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c"><div class="ttname"><a href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">llvm::RISCVMatInt::Imm</a></div><div class="ttdeci">@ Imm</div><div class="ttdef"><b>Definition:</b> <a href="RISCVMatInt_8h_source.html#l00023">RISCVMatInt.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_aaa74f3583d447a6a45b0906bdb815b8b"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#aaa74f3583d447a6a45b0906bdb815b8b">llvm::IRBuilderBase::getInt1Ty</a></div><div class="ttdeci">IntegerType * getInt1Ty()</div><div class="ttdoc">Fetch the type representing a single bit.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00497">IRBuilder.h:497</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_a0154da1d06b29a1d5649607ae2dfc389"><div class="ttname"><a href="classllvm_1_1Constant.html#a0154da1d06b29a1d5649607ae2dfc389">llvm::Constant::getIntegerValue</a></div><div class="ttdeci">static Constant * getIntegerValue(Type *Ty, const APInt &amp;V)</div><div class="ttdoc">Return the value for an integer or pointer constant, or a vector thereof, with the given scalar value...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00386">Constants.cpp:386</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a7f9bf3b17f89cfbe4fabd1ac2bdc3712"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a7f9bf3b17f89cfbe4fabd1ac2bdc3712">simplifyX86addcarry</a></div><div class="ttdeci">static Value * simplifyX86addcarry(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00533">X86InstCombineIntrinsic.cpp:533</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ae7f65cf79c9900a2b0504fbc25db1428"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ae7f65cf79c9900a2b0504fbc25db1428">llvm::IRBuilderBase::CreateLShr</a></div><div class="ttdeci">Value * CreateLShr(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, bool isExact=false)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01352">IRBuilder.h:1352</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_aad07e3e0fa03f6c780e13d924325d8d0"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#aad07e3e0fa03f6c780e13d924325d8d0">llvm::IRBuilderBase::CreateMaskedStore</a></div><div class="ttdeci">CallInst * CreateMaskedStore(Value *Val, Value *Ptr, Align Alignment, Value *Mask)</div><div class="ttdoc">Create a call to Masked Store intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8cpp_source.html#l00609">IRBuilder.cpp:609</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a8ad21e3937e91bb59d18d2c76915fe5c"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a8ad21e3937e91bb59d18d2c76915fe5c">simplifyX86MaskedLoad</a></div><div class="ttdeci">static Instruction * simplifyX86MaskedLoad(IntrinsicInst &amp;II, InstCombiner &amp;IC)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00057">X86InstCombineIntrinsic.cpp:57</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ae69ee83570f05c1d5fb5026c11145d6b"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ae69ee83570f05c1d5fb5026c11145d6b">llvm::IRBuilderBase::CreateShl</a></div><div class="ttdeci">Value * CreateShl(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;, bool HasNUW=false, bool HasNSW=false)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01331">IRBuilder.h:1331</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntegerType_html_a90b790ccb1af4ea5ccd69db4b8cd2d81"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">llvm::IntegerType::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const</div><div class="ttdoc">Get the number of bits in this IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00072">DerivedTypes.h:72</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab9c6b351507d3c0730f4290919d43a12"><div class="ttname"><a href="namespacellvm.html#ab9c6b351507d3c0730f4290919d43a12">llvm::ArrayRef</a></div><div class="ttdeci">ArrayRef(const T &amp;OneElt) -&gt; ArrayRef&lt; T &gt;</div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_ad960e1ff48d25c382b6d28e7961f074e"><div class="ttname"><a href="classllvm_1_1APInt.html#ad960e1ff48d25c382b6d28e7961f074e">llvm::APInt::getLowBitsSet</a></div><div class="ttdeci">static APInt getLowBitsSet(unsigned numBits, unsigned loBitsSet)</div><div class="ttdoc">Constructs an APInt value that has the bottom loBitsSet bits set.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00289">APInt.h:289</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a286d4fa2a50c9ac6ac3a8069cccfcd0c"><div class="ttname"><a href="classllvm_1_1APInt.html#a286d4fa2a50c9ac6ac3a8069cccfcd0c">llvm::APInt::setBitsFrom</a></div><div class="ttdeci">void setBitsFrom(unsigned loBit)</div><div class="ttdoc">Set the top bits starting from loBit.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01364">APInt.h:1364</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_a2c476f610d4da3bd752816bc918aa146"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#a2c476f610d4da3bd752816bc918aa146">llvm::InstCombiner::peekThroughBitcast</a></div><div class="ttdeci">static Value * peekThroughBitcast(Value *V, bool OneUseOnly=false)</div><div class="ttdoc">Return the source operand of a potentially bitcasted value while optionally checking if it has one us...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00101">InstCombiner.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_acb9c55b6986369948507ca5241b4e411"><div class="ttname"><a href="classllvm_1_1APInt.html#acb9c55b6986369948507ca5241b4e411">llvm::APInt::shl</a></div><div class="ttdeci">APInt shl(unsigned shiftAmt) const</div><div class="ttdoc">Left-shift function.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00861">APInt.h:861</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantAggregateZero_html_abfa1cf8b4348407b167f93bc7c01055f"><div class="ttname"><a href="classllvm_1_1ConstantAggregateZero.html#abfa1cf8b4348407b167f93bc7c01055f">llvm::ConstantAggregateZero::get</a></div><div class="ttdeci">static ConstantAggregateZero * get(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01595">Constants.cpp:1595</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a483f68557374e8fc58f8a294e7f1268e"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a483f68557374e8fc58f8a294e7f1268e">llvm::IRBuilderBase::CreateMaskedLoad</a></div><div class="ttdeci">CallInst * CreateMaskedLoad(Type *Ty, Value *Ptr, Align Alignment, Value *Mask, Value *PassThru=nullptr, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdoc">Create a call to Masked Load intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8cpp_source.html#l00588">IRBuilder.cpp:588</a></div></div>
<div class="ttc" id="aX86InstCombineIntrinsic_8cpp_html_a43695b2883d7c018af50a606291e46b1"><div class="ttname"><a href="X86InstCombineIntrinsic_8cpp.html#a43695b2883d7c018af50a606291e46b1">simplifyX86immShift</a></div><div class="ttdeci">static Value * simplifyX86immShift(const IntrinsicInst &amp;II, InstCombiner::BuilderTy &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="X86InstCombineIntrinsic_8cpp_source.html#l00120">X86InstCombineIntrinsic.cpp:120</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a833daf718a49c5cd637d8c9ddeaebe07"><div class="ttname"><a href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">TypeSize getPrimitiveSizeInBits() const LLVM_READONLY</div><div class="ttdoc">Return the basic size of this type if it is a primitive type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00163">Type.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_a80add6b3b1cdaec560907995127adc16"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">llvm::Intrinsic::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00039">TargetTransformInfo.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1PoisonValue_html_a1bf08613fb664a2e377a9a72c59a6b66"><div class="ttname"><a href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">llvm::PoisonValue::get</a></div><div class="ttdeci">static PoisonValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'poison' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01759">Constants.cpp:1759</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:21:59 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
