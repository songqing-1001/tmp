<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Support/CachePruning.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_f0dc79bace318df7ec0fa0bdb179ed95.html">Support</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CachePruning.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CachePruning_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-CachePruning.cpp - LLVM Cache Directory Pruning ---------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements the pruning of a directory based on least recently used.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CachePruning_8h.html">llvm/Support/CachePruning.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Errc_8h.html">llvm/Support/Errc.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2Error_8h.html">llvm/Support/Error.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FileSystem_8h.html">llvm/Support/FileSystem.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Path_8h.html">llvm/Support/Path.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="WithColor_8h.html">llvm/Support/WithColor.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="CachePruning_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   23</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;cache-pruning&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;system_error&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">struct </span>FileInfo {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="namespacellvm_1_1sys.html#a54c339022277c7ea5975fa8f087a5b04">sys::TimePoint&lt;&gt;</a> Time;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  std::string Path;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">  /// Used to determine which files to prune first. Also used to determine</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">  /// set membership, so must take into account all fields.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">operator&lt;</a>(<span class="keyword">const</span> FileInfo &amp;<a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">return</span> std::tie(Time, <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Size, Path) &lt;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;           std::tie(<a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Time, Size, <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Path);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;};</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/// Write a new timestamp file with the given path. This is used for the pruning</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/// interval option.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="CachePruning_8cpp.html#ab9f0418e712e930d9aa516ac08860491">   47</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CachePruning_8cpp.html#ab9f0418e712e930d9aa516ac08860491">writeTimestampFile</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> TimestampFile) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  std::error_code EC;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classllvm_1_1raw__fd__ostream.html">raw_fd_ostream</a> Out(TimestampFile.<a class="code" href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">str</a>(), EC, <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695a8ae6a0a158ab49e5bbe92cbc2cabcbcd">sys::fs::OF_None</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="CachePruning_8cpp.html#afd0f47810608ab64a76c6ec0679949e5">   52</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Expected.html">Expected&lt;std::chrono::seconds&gt;</a> <a class="code" href="CachePruning_8cpp.html#afd0f47810608ab64a76c6ec0679949e5">parseDuration</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="classllvm_1_1Duration.html">Duration</a>) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Duration.html">Duration</a>.empty())</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;Duration must not be empty&quot;</span>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                   <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> NumStr = <a class="code" href="classllvm_1_1Duration.html">Duration</a>.slice(0, <a class="code" href="classllvm_1_1Duration.html">Duration</a>.size()-1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Num;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (NumStr.<a class="code" href="classllvm_1_1StringRef.html#a1881146f2dcc2ca57c9c5f77f938db9d">getAsInteger</a>(0, Num))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + NumStr + <span class="stringliteral">&quot;&#39; not an integer&quot;</span>,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                   <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="classllvm_1_1Duration.html">Duration</a>.back()) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> std::chrono::seconds(Num);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> std::chrono::minutes(Num);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> std::chrono::hours(Num);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + <a class="code" href="classllvm_1_1Duration.html">Duration</a> +</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                       <span class="stringliteral">&quot;&#39; must end with one of &#39;s&#39;, &#39;m&#39; or &#39;h&#39;&quot;</span>,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                   <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<a class="code" href="classllvm_1_1Expected.html">Expected&lt;CachePruningPolicy&gt;</a></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="namespacellvm.html#a4accb2c6a0d7504200a547f2284ff106">   78</a></span>&#160;<a class="code" href="namespacellvm.html#a4accb2c6a0d7504200a547f2284ff106">llvm::parseCachePruningPolicy</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> PolicyStr) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="structllvm_1_1CachePruningPolicy.html">CachePruningPolicy</a> Policy;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  std::pair&lt;StringRef, StringRef&gt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = {<span class="stringliteral">&quot;&quot;</span>, PolicyStr};</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.second.empty()) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.second.split(<span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>, <a class="code" href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">Value</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::tie(<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>, <a class="code" href="classllvm_1_1Value.html">Value</a>) = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.first.split(<span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> == <span class="stringliteral">&quot;prune_interval&quot;</span>) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keyword">auto</span> DurationOrErr = <a class="code" href="CachePruning_8cpp.html#afd0f47810608ab64a76c6ec0679949e5">parseDuration</a>(<a class="code" href="classllvm_1_1Value.html">Value</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> (!DurationOrErr)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">return</span> DurationOrErr.takeError();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a26f65d4efd088dd6f035a970ef350628">Interval</a> = *DurationOrErr;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> == <span class="stringliteral">&quot;prune_after&quot;</span>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keyword">auto</span> DurationOrErr = <a class="code" href="CachePruning_8cpp.html#afd0f47810608ab64a76c6ec0679949e5">parseDuration</a>(<a class="code" href="classllvm_1_1Value.html">Value</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">if</span> (!DurationOrErr)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">return</span> DurationOrErr.takeError();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a4e4e128e83c615ca4ed425980b41e64f">Expiration</a> = *DurationOrErr;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> == <span class="stringliteral">&quot;cache_size&quot;</span>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a>.back() != <span class="charliteral">&#39;%&#39;</span>)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + <a class="code" href="classllvm_1_1Value.html">Value</a> + <span class="stringliteral">&quot;&#39; must be a percentage&quot;</span>,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                       <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SizeStr = <a class="code" href="classllvm_1_1Value.html">Value</a>.drop_back();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> (SizeStr.<a class="code" href="classllvm_1_1StringRef.html#a1881146f2dcc2ca57c9c5f77f938db9d">getAsInteger</a>(0, Size))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + SizeStr + <span class="stringliteral">&quot;&#39; not an integer&quot;</span>,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                       <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (Size &gt; 100)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + SizeStr +</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                           <span class="stringliteral">&quot;&#39; must be between 0 and 100&quot;</span>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                       <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> = Size;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> == <span class="stringliteral">&quot;cache_size_bytes&quot;</span>) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2">Mult</a> = 1;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">switch</span> (tolower(<a class="code" href="classllvm_1_1Value.html">Value</a>.back())) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>:</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2">Mult</a> = 1024;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="classllvm_1_1Value.html">Value</a>.drop_back();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2">Mult</a> = 1024 * 1024;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="classllvm_1_1Value.html">Value</a>.drop_back();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2">Mult</a> = 1024 * 1024 * 1024;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="classllvm_1_1Value.html">Value</a>.drop_back();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a>.getAsInteger(0, Size))</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + <a class="code" href="classllvm_1_1Value.html">Value</a> + <span class="stringliteral">&quot;&#39; not an integer&quot;</span>,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                       <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a> = Size * <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2">Mult</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> == <span class="stringliteral">&quot;cache_size_files&quot;</span>) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a>.getAsInteger(0, Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a>))</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + <a class="code" href="classllvm_1_1Value.html">Value</a> + <span class="stringliteral">&quot;&#39; not an integer&quot;</span>,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                       <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">return</span> make_error&lt;StringError&gt;(<span class="stringliteral">&quot;Unknown key: &#39;&quot;</span> + <a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> + <span class="stringliteral">&quot;&#39;&quot;</span>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                     <a class="code" href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">inconvertibleErrorCode</a>());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">return</span> Policy;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">/// Prune the cache of files that haven&#39;t been accessed in a long time.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="namespacellvm.html#ae704a0ed8c4554c58dfb9e0f20225924">  145</a></span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#ae704a0ed8c4554c58dfb9e0f20225924">llvm::pruneCache</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Path, <a class="code" href="structllvm_1_1CachePruningPolicy.html">CachePruningPolicy</a> Policy,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                      <span class="keyword">const</span> std::vector&lt;std::unique_ptr&lt;MemoryBuffer&gt;&gt; &amp;Files) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">using namespace </span>std::chrono;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">if</span> (Path.empty())</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">bool</span> isPathDir;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sys_1_1fs.html#afed705977bd3f8af4b19b0fd57c0adf4">sys::fs::is_directory</a>(Path, isPathDir))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">if</span> (!isPathDir)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> =</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a>, 100u);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a4e4e128e83c615ca4ed425980b41e64f">Expiration</a> == seconds(0) &amp;&amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> == 0 &amp;&amp;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a> == 0 &amp;&amp; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a> == 0) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;No pruning settings set, exit early\n&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// Nothing will be pruned, early exit</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// Try to stat() the timestamp file.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;128&gt;</a> TimestampFile(Path);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="namespacellvm_1_1sys_1_1path.html#acb80894344c78dacf8d5ff8c23be697d">sys::path::append</a>(TimestampFile, <span class="stringliteral">&quot;llvmcache.timestamp&quot;</span>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="classllvm_1_1sys_1_1fs_1_1file__status.html">sys::fs::file_status</a> FileStatus;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> CurrentTime = <a class="code" href="ArchiveWriter_8cpp.html#aba400c73bd6b6fcc6a245293571962a6">system_clock::now</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> EC = <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">sys::fs::status</a>(TimestampFile, FileStatus)) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (EC == <a class="code" href="namespacellvm.html#a59739a4f15fb2ec57a6b7fcfe938546ba2e70fc89b08f26fa3fc77694c91e8f7a">errc::no_such_file_or_directory</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">// If the timestamp file wasn&#39;t there, create one now.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="CachePruning_8cpp.html#ab9f0418e712e930d9aa516ac08860491">writeTimestampFile</a>(TimestampFile);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// Unknown error?</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (!Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a26f65d4efd088dd6f035a970ef350628">Interval</a>)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a26f65d4efd088dd6f035a970ef350628">Interval</a> != seconds(0)) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// Check whether the time stamp is older than our pruning interval.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// If not, do nothing.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> TimeStampModTime = FileStatus.<a class="code" href="classllvm_1_1sys_1_1fs_1_1basic__file__status.html#ae807b50b0b414d8a9195cdc0ee23b86a">getLastModificationTime</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">auto</span> TimeStampAge = CurrentTime - TimeStampModTime;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">if</span> (TimeStampAge &lt;= *Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a26f65d4efd088dd6f035a970ef350628">Interval</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Timestamp file too recent (&quot;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                          &lt;&lt; duration_cast&lt;seconds&gt;(TimeStampAge).<a class="code" href="namespacellvm.html#ab1772fd431decccb7926d484ea223db7">count</a>()</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;s old), do not prune.\n&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// Write a new timestamp file so that nobody else attempts to prune.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// There is a benign race condition here, if two processes happen to</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// notice at the same time that the timestamp is out-of-date.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="CachePruning_8cpp.html#ab9f0418e712e930d9aa516ac08860491">writeTimestampFile</a>(TimestampFile);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Keep track of files to delete to get below the size limit.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Order by time of last use so that recently used files are preserved.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  std::set&lt;FileInfo&gt; FileInfos;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TotalSize = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// Walk the entire directory cache, looking for unused files.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  std::error_code EC;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;128&gt;</a> CachePathNative;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="namespacellvm_1_1sys_1_1path.html#ab071132a634a15df871b6901c1375c90">sys::path::native</a>(Path, CachePathNative);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Walk all of the files within this directory.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1sys_1_1fs_1_1directory__iterator.html">sys::fs::directory_iterator</a> File(CachePathNative, EC), FileEnd;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       File != FileEnd &amp;&amp; !EC; File.increment(EC)) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// Ignore filenames not beginning with &quot;llvmcache-&quot; or &quot;Thin-&quot;. This</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// includes the timestamp file as well as any files created by the user.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// This acts as a safeguard against data loss if the user specifies the</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// wrong directory as their cache directory.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1sys_1_1path.html#a5ab6bf136f12ce0bfe2a9754cf1644c7">filename</a> = <a class="code" href="namespacellvm_1_1sys_1_1path.html#a5ab6bf136f12ce0bfe2a9754cf1644c7">sys::path::filename</a>(File-&gt;path());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1sys_1_1path.html#a5ab6bf136f12ce0bfe2a9754cf1644c7">filename</a>.<a class="code" href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">startswith</a>(<span class="stringliteral">&quot;llvmcache-&quot;</span>) &amp;&amp; !<a class="code" href="namespacellvm_1_1sys_1_1path.html#a5ab6bf136f12ce0bfe2a9754cf1644c7">filename</a>.<a class="code" href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">startswith</a>(<span class="stringliteral">&quot;Thin-&quot;</span>))</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// Look at this file. If we can&#39;t stat it, there&#39;s nothing interesting</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// there.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classllvm_1_1ErrorOr.html">ErrorOr&lt;sys::fs::basic_file_status&gt;</a> StatusOrErr = File-&gt;status();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (!StatusOrErr) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Ignore &quot;</span> &lt;&lt; File-&gt;path() &lt;&lt; <span class="stringliteral">&quot; (can&#39;t stat)\n&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// If the file hasn&#39;t been used recently enough, delete it</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> FileAccessTime = StatusOrErr-&gt;getLastAccessedTime();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">auto</span> FileAge = CurrentTime - FileAccessTime;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a4e4e128e83c615ca4ed425980b41e64f">Expiration</a> != seconds(0) &amp;&amp; FileAge &gt; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a4e4e128e83c615ca4ed425980b41e64f">Expiration</a>) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Remove &quot;</span> &lt;&lt; File-&gt;path() &lt;&lt; <span class="stringliteral">&quot; (&quot;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        &lt;&lt; duration_cast&lt;seconds&gt;(FileAge).count()</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;s old)\n&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a921e0b01f22f9a37012450f9b5f0ccb7">sys::fs::remove</a>(File-&gt;path());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Leave it here for now, but add it to the list of size-based pruning.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    TotalSize += StatusOrErr-&gt;getSize();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    FileInfos.insert({FileAccessTime, StatusOrErr-&gt;getSize(), File-&gt;path()});</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">auto</span> FileInfo = FileInfos.begin();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">size_t</span> NumFiles = FileInfos.size();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">auto</span> RemoveCacheFile = [&amp;]() {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Remove the file.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a921e0b01f22f9a37012450f9b5f0ccb7">sys::fs::remove</a>(FileInfo-&gt;Path);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Update size</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    TotalSize -= FileInfo-&gt;Size;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    NumFiles--;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; - Remove &quot;</span> &lt;&lt; FileInfo-&gt;Path &lt;&lt; <span class="stringliteral">&quot; (size &quot;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                      &lt;&lt; FileInfo-&gt;Size &lt;&lt; <span class="stringliteral">&quot;), new occupancy is &quot;</span> &lt;&lt; TotalSize</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;%\n&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    ++FileInfo;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  };</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// files.size() is greater the number of inputs  by one. However, a timestamp</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// file is created and stored in the cache directory if --thinlto-cache-policy</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// option is used. Therefore, files.size() is used as ActualNums.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">size_t</span> ActualNums = Files.size();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a> &amp;&amp; ActualNums &gt; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a>)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classllvm_1_1WithColor.html#a237ad6eae22f6b2746a542c02d309a5b">WithColor::warning</a>()</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ThinLTO cache pruning happens since the number of created files (&quot;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        &lt;&lt; ActualNums &lt;&lt; <span class="stringliteral">&quot;) exceeds the maximum number of files (&quot;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        &lt;&lt; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;); consider adjusting --thinlto-cache-policy\n&quot;</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Prune for number of files.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">while</span> (NumFiles &gt; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">MaxSizeFiles</a>)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      RemoveCacheFile();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Prune for size now if needed</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> &gt; 0 || Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a> &gt; 0) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">auto</span> ErrOrSpaceInfo = <a class="code" href="namespacellvm_1_1sys_1_1fs.html#acfeea8deca8739aecb36f9ab29544b95">sys::fs::disk_space</a>(Path);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (!ErrOrSpaceInfo) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(<span class="stringliteral">&quot;Can&#39;t get available size&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="structllvm_1_1sys_1_1fs_1_1space__info.html">sys::fs::space_info</a> SpaceInfo = ErrOrSpaceInfo.get();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keyword">auto</span> AvailableSpace = TotalSize + SpaceInfo.<a class="code" href="structllvm_1_1sys_1_1fs_1_1space__info.html#a64d6950ffda5357afe511fea80360427">free</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> == 0)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> = 100;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a> == 0)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a> = AvailableSpace;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">auto</span> TotalSizeTarget = std::min&lt;uint64_t&gt;(</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        AvailableSpace * Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> / 100ull,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Occupancy: &quot;</span> &lt;&lt; ((100 * TotalSize) / AvailableSpace)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;% target is: &quot;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                      &lt;&lt; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">MaxSizePercentageOfAvailableSpace</a> &lt;&lt; <span class="stringliteral">&quot;%, &quot;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                      &lt;&lt; Policy.<a class="code" href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">MaxSizeBytes</a> &lt;&lt; <span class="stringliteral">&quot; bytes\n&quot;</span>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">size_t</span> ActualSizes = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;File : Files)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">if</span> (File)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        ActualSizes += File-&gt;getBufferSize();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (ActualSizes &gt; TotalSizeTarget)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="classllvm_1_1WithColor.html#a237ad6eae22f6b2746a542c02d309a5b">WithColor::warning</a>()</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;ThinLTO cache pruning happens since the total size of the cache &quot;</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;             <span class="stringliteral">&quot;files consumed by the current link job (&quot;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          &lt;&lt; ActualSizes &lt;&lt; <span class="stringliteral">&quot;  bytes) exceeds maximum cache size (&quot;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          &lt;&lt; TotalSizeTarget</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; bytes); consider adjusting --thinlto-cache-policy\n&quot;</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Remove the oldest accessed files first, till we get below the threshold.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">while</span> (TotalSize &gt; TotalSizeTarget &amp;&amp; FileInfo != FileInfos.end())</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      RemoveCacheFile();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aFileSystem_8h_html"><div class="ttname"><a href="FileSystem_8h.html">FileSystem.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a662978c0cdf81de0d448032f142a3695a8ae6a0a158ab49e5bbe92cbc2cabcbcd"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695a8ae6a0a158ab49e5bbe92cbc2cabcbcd">llvm::sys::fs::OF_None</a></div><div class="ttdeci">@ OF_None</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00757">FileSystem.h:757</a></div></div>
<div class="ttc" id="astructllvm_1_1sys_1_1fs_1_1space__info_html"><div class="ttname"><a href="structllvm_1_1sys_1_1fs_1_1space__info.html">llvm::sys::fs::space_info</a></div><div class="ttdoc">space_info - Self explanatory.</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00080">FileSystem.h:80</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aPath_8h_html"><div class="ttname"><a href="Path_8h.html">Path.h</a></div></div>
<div class="ttc" id="aSupport_2Error_8h_html"><div class="ttname"><a href="Support_2Error_8h.html">Error.h</a></div></div>
<div class="ttc" id="astructllvm_1_1CachePruningPolicy_html_a26f65d4efd088dd6f035a970ef350628"><div class="ttname"><a href="structllvm_1_1CachePruningPolicy.html#a26f65d4efd088dd6f035a970ef350628">llvm::CachePruningPolicy::Interval</a></div><div class="ttdeci">std::optional&lt; std::chrono::seconds &gt; Interval</div><div class="ttdoc">The pruning interval.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8h_source.html#l00033">CachePruning.h:33</a></div></div>
<div class="ttc" id="aErrc_8h_html"><div class="ttname"><a href="Errc_8h.html">Errc.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_ab071132a634a15df871b6901c1375c90"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#ab071132a634a15df871b6901c1375c90">llvm::sys::path::native</a></div><div class="ttdeci">void native(const Twine &amp;path, SmallVectorImpl&lt; char &gt; &amp;result, Style style=Style::native)</div><div class="ttdoc">Convert path to the native form.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00540">Path.cpp:540</a></div></div>
<div class="ttc" id="anamespacellvm_html_a59739a4f15fb2ec57a6b7fcfe938546ba2e70fc89b08f26fa3fc77694c91e8f7a"><div class="ttname"><a href="namespacellvm.html#a59739a4f15fb2ec57a6b7fcfe938546ba2e70fc89b08f26fa3fc77694c91e8f7a">llvm::errc::no_such_file_or_directory</a></div><div class="ttdeci">@ no_such_file_or_directory</div></div>
<div class="ttc" id="aclassllvm_1_1Expected_html"><div class="ttname"><a href="classllvm_1_1Expected.html">llvm::Expected</a></div><div class="ttdoc">Tagged union holding either a T or a Error.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00041">APFloat.h:41</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a54c339022277c7ea5975fa8f087a5b04"><div class="ttname"><a href="namespacellvm_1_1sys.html#a54c339022277c7ea5975fa8f087a5b04">llvm::sys::TimePoint</a></div><div class="ttdeci">std::chrono::time_point&lt; std::chrono::system_clock, D &gt; TimePoint</div><div class="ttdoc">A time point on the system clock.</div><div class="ttdef"><b>Definition:</b> <a href="Chrono_8h_source.html#l00034">Chrono.h:34</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_acb80894344c78dacf8d5ff8c23be697d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#acb80894344c78dacf8d5ff8c23be697d">llvm::sys::path::append</a></div><div class="ttdeci">void append(SmallVectorImpl&lt; char &gt; &amp;path, const Twine &amp;a, const Twine &amp;b=&quot;&quot;, const Twine &amp;c=&quot;&quot;, const Twine &amp;d=&quot;&quot;)</div><div class="ttdoc">Append to path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00456">Path.cpp:456</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aCachePruning_8h_html"><div class="ttname"><a href="CachePruning_8h.html">CachePruning.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a84cd09ccc918883d51a387f0e0f374f3"><div class="ttname"><a href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">llvm::StringRef::startswith</a></div><div class="ttdeci">bool startswith(StringRef Prefix) const</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00261">StringRef.h:261</a></div></div>
<div class="ttc" id="astructllvm_1_1CachePruningPolicy_html_a8c514fa2ef23ee2f092cedf2691886dd"><div class="ttname"><a href="structllvm_1_1CachePruningPolicy.html#a8c514fa2ef23ee2f092cedf2691886dd">llvm::CachePruningPolicy::MaxSizeBytes</a></div><div class="ttdeci">uint64_t MaxSizeBytes</div><div class="ttdoc">The maximum size for the cache directory in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8h_source.html#l00050">CachePruning.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1Duration_html"><div class="ttname"><a href="classllvm_1_1Duration.html">llvm::Duration</a></div><div class="ttdef"><b>Definition:</b> <a href="Duration_8h_source.html#l00020">Duration.h:20</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a1881146f2dcc2ca57c9c5f77f938db9d"><div class="ttname"><a href="classllvm_1_1StringRef.html#a1881146f2dcc2ca57c9c5f77f938db9d">llvm::StringRef::getAsInteger</a></div><div class="ttdeci">bool getAsInteger(unsigned Radix, T &amp;Result) const</div><div class="ttdoc">Parse the current string as an integer of the specified radix.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00469">StringRef.h:469</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1PALMD_html_af892c75285b0f64d58ca76cb73059adf"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">llvm::AMDGPU::PALMD::Key</a></div><div class="ttdeci">Key</div><div class="ttdoc">PAL metadata keys.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00486">AMDGPUMetadata.h:486</a></div></div>
<div class="ttc" id="astructllvm_1_1CachePruningPolicy_html_a4e4e128e83c615ca4ed425980b41e64f"><div class="ttname"><a href="structllvm_1_1CachePruningPolicy.html#a4e4e128e83c615ca4ed425980b41e64f">llvm::CachePruningPolicy::Expiration</a></div><div class="ttdeci">std::chrono::seconds Expiration</div><div class="ttdoc">The expiration for a file.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8h_source.html#l00038">CachePruning.h:38</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7f2a3d4dcfee70225988aec53ff1e173"><div class="ttname"><a href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">llvm::report_fatal_error</a></div><div class="ttdeci">void report_fatal_error(Error Err, bool gen_crash_diag=true)</div><div class="ttdoc">Report a serious error, calling any installed error handler.</div><div class="ttdef"><b>Definition:</b> <a href="Testing_2Support_2Error_8cpp_source.html#l00145">Error.cpp:145</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae704a0ed8c4554c58dfb9e0f20225924"><div class="ttname"><a href="namespacellvm.html#ae704a0ed8c4554c58dfb9e0f20225924">llvm::pruneCache</a></div><div class="ttdeci">bool pruneCache(StringRef Path, CachePruningPolicy Policy, const std::vector&lt; std::unique_ptr&lt; MemoryBuffer &gt;&gt; &amp;Files={})</div><div class="ttdoc">Peform pruning using the supplied policy, returns true if pruning occurred, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8cpp_source.html#l00145">CachePruning.cpp:145</a></div></div>
<div class="ttc" id="aArchiveWriter_8cpp_html_aba400c73bd6b6fcc6a245293571962a6"><div class="ttname"><a href="ArchiveWriter_8cpp.html#aba400c73bd6b6fcc6a245293571962a6">now</a></div><div class="ttdeci">static sys::TimePoint&lt; std::chrono::seconds &gt; now(bool Deterministic)</div><div class="ttdef"><b>Definition:</b> <a href="ArchiveWriter_8cpp_source.html#l00327">ArchiveWriter.cpp:327</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html"><div class="ttname"><a href="classllvm_1_1SmallString.html">llvm::SmallString&lt; 128 &gt;</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aCachePruning_8cpp_html_ab9f0418e712e930d9aa516ac08860491"><div class="ttname"><a href="CachePruning_8cpp.html#ab9f0418e712e930d9aa516ac08860491">writeTimestampFile</a></div><div class="ttdeci">static void writeTimestampFile(StringRef TimestampFile)</div><div class="ttdoc">Write a new timestamp file with the given path.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8cpp_source.html#l00047">CachePruning.cpp:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1WithColor_html_a237ad6eae22f6b2746a542c02d309a5b"><div class="ttname"><a href="classllvm_1_1WithColor.html#a237ad6eae22f6b2746a542c02d309a5b">llvm::WithColor::warning</a></div><div class="ttdeci">static raw_ostream &amp; warning()</div><div class="ttdoc">Convenience method for printing &quot;warning: &quot; to stderr.</div><div class="ttdef"><b>Definition:</b> <a href="WithColor_8cpp_source.html#l00085">WithColor.cpp:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1sys_1_1fs_1_1file__status_html"><div class="ttname"><a href="classllvm_1_1sys_1_1fs_1_1file__status.html">llvm::sys::fs::file_status</a></div><div class="ttdoc">Represents the result of a call to sys::fs::status().</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00226">FileSystem.h:226</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab1772fd431decccb7926d484ea223db7"><div class="ttname"><a href="namespacellvm.html#ab1772fd431decccb7926d484ea223db7">llvm::count</a></div><div class="ttdeci">auto count(R &amp;&amp;Range, const E &amp;Element)</div><div class="ttdoc">Wrapper function around std::count to count the number of times an element Element occurs in the give...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01896">STLExtras.h:1896</a></div></div>
<div class="ttc" id="anamespacellvm_html_a061b224a1a3c3486fd854e5009a858c9"><div class="ttname"><a href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">llvm::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(int64_t V1, const APSInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APSInt_8h_source.html#l00361">APSInt.h:361</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a921e0b01f22f9a37012450f9b5f0ccb7"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a921e0b01f22f9a37012450f9b5f0ccb7">llvm::sys::fs::remove</a></div><div class="ttdeci">std::error_code remove(const Twine &amp;path, bool IgnoreNonExisting=true)</div><div class="ttdoc">Remove path.</div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="astructllvm_1_1CachePruningPolicy_html_ac13a6c169c6b44529d9f6bae76c8b4ed"><div class="ttname"><a href="structllvm_1_1CachePruningPolicy.html#ac13a6c169c6b44529d9f6bae76c8b4ed">llvm::CachePruningPolicy::MaxSizePercentageOfAvailableSpace</a></div><div class="ttdeci">unsigned MaxSizePercentageOfAvailableSpace</div><div class="ttdoc">The maximum size for the cache directory, in terms of percentage of the available space on the disk.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8h_source.html#l00045">CachePruning.h:45</a></div></div>
<div class="ttc" id="astructllvm_1_1CachePruningPolicy_html"><div class="ttname"><a href="structllvm_1_1CachePruningPolicy.html">llvm::CachePruningPolicy</a></div><div class="ttdoc">Policy for the pruneCache() function.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8h_source.html#l00028">CachePruning.h:28</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__fd__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__fd__ostream.html">llvm::raw_fd_ostream</a></div><div class="ttdoc">A raw_ostream that writes to a file descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00454">raw_ostream.h:454</a></div></div>
<div class="ttc" id="astructllvm_1_1sys_1_1fs_1_1space__info_html_a64d6950ffda5357afe511fea80360427"><div class="ttname"><a href="structllvm_1_1sys_1_1fs_1_1space__info.html#a64d6950ffda5357afe511fea80360427">llvm::sys::fs::space_info::free</a></div><div class="ttdeci">uint64_t free</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00082">FileSystem.h:82</a></div></div>
<div class="ttc" id="aWithColor_8h_html"><div class="ttname"><a href="WithColor_8h.html">WithColor.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba489c5c03b43333daa30af69d887fc1f2">llvm::MipsISD::Mult</a></div><div class="ttdeci">@ Mult</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00135">MipsISelLowering.h:135</a></div></div>
<div class="ttc" id="astructllvm_1_1CachePruningPolicy_html_a0b73cd4206ae3e5edc07c24afb2057ac"><div class="ttname"><a href="structllvm_1_1CachePruningPolicy.html#a0b73cd4206ae3e5edc07c24afb2057ac">llvm::CachePruningPolicy::MaxSizeFiles</a></div><div class="ttdeci">uint64_t MaxSizeFiles</div><div class="ttdoc">The maximum number of files in the cache directory.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8h_source.html#l00061">CachePruning.h:61</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2b43c21951d0948b34bcf7019949032d"><div class="ttname"><a href="namespacellvm.html#a2b43c21951d0948b34bcf7019949032d">llvm::inconvertibleErrorCode</a></div><div class="ttdeci">std::error_code inconvertibleErrorCode()</div><div class="ttdoc">The value returned by this function can be returned from convertToErrorCode for Error values where no...</div><div class="ttdef"><b>Definition:</b> <a href="Testing_2Support_2Error_8cpp_source.html#l00079">Error.cpp:79</a></div></div>
<div class="ttc" id="anamespacellvm_1_1TargetStackID_html_a71392100eb15ba746b1f898986f5d8a5"><div class="ttname"><a href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">llvm::TargetStackID::Value</a></div><div class="ttdeci">Value</div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00027">TargetFrameLowering.h:27</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_afed705977bd3f8af4b19b0fd57c0adf4"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#afed705977bd3f8af4b19b0fd57c0adf4">llvm::sys::fs::is_directory</a></div><div class="ttdeci">bool is_directory(const basic_file_status &amp;status)</div><div class="ttdoc">Does status represent a directory?</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l01092">Path.cpp:1092</a></div></div>
<div class="ttc" id="aclassllvm_1_1sys_1_1fs_1_1directory__iterator_html"><div class="ttname"><a href="classllvm_1_1sys_1_1fs_1_1directory__iterator.html">llvm::sys::fs::directory_iterator</a></div><div class="ttdoc">directory_iterator - Iterates through the entries in path.</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l01423">FileSystem.h:1423</a></div></div>
<div class="ttc" id="aELFYAML_8cpp_html_a941c34da9850676ce3380813c636cff2"><div class="ttname"><a href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a></div><div class="ttdeci">std::optional&lt; std::vector&lt; StOtherPiece &gt; &gt; Other</div><div class="ttdef"><b>Definition:</b> <a href="ELFYAML_8cpp_source.html#l01260">ELFYAML.cpp:1260</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a5ab6bf136f12ce0bfe2a9754cf1644c7"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a5ab6bf136f12ce0bfe2a9754cf1644c7">llvm::sys::path::filename</a></div><div class="ttdeci">StringRef filename(StringRef path, Style style=Style::native)</div><div class="ttdoc">Get filename.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00577">Path.cpp:577</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a5f126cc7b64d31cd709215b48656d83d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">llvm::sys::fs::status</a></div><div class="ttdeci">std::error_code status(const Twine &amp;path, file_status &amp;result, bool follow=true)</div><div class="ttdoc">Get file status as if by POSIX stat().</div></div>
<div class="ttc" id="aclassllvm_1_1ErrorOr_html"><div class="ttname"><a href="classllvm_1_1ErrorOr.html">llvm::ErrorOr</a></div><div class="ttdoc">Represents either an error or a value T.</div><div class="ttdef"><b>Definition:</b> <a href="ErrorOr_8h_source.html#l00056">ErrorOr.h:56</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a223dd14e7d12bc5cea01889b972a98b2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">str - Get the contents as an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00222">StringRef.h:222</a></div></div>
<div class="ttc" id="aCachePruning_8cpp_html_afd0f47810608ab64a76c6ec0679949e5"><div class="ttname"><a href="CachePruning_8cpp.html#afd0f47810608ab64a76c6ec0679949e5">parseDuration</a></div><div class="ttdeci">static Expected&lt; std::chrono::seconds &gt; parseDuration(StringRef Duration)</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8cpp_source.html#l00052">CachePruning.cpp:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1sys_1_1fs_1_1basic__file__status_html_ae807b50b0b414d8a9195cdc0ee23b86a"><div class="ttname"><a href="classllvm_1_1sys_1_1fs_1_1basic__file__status.html#ae807b50b0b414d8a9195cdc0ee23b86a">llvm::sys::fs::basic_file_status::getLastModificationTime</a></div><div class="ttdeci">TimePoint getLastModificationTime() const</div><div class="ttdoc">The file modification time as reported from the underlying file system.</div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4accb2c6a0d7504200a547f2284ff106"><div class="ttname"><a href="namespacellvm.html#a4accb2c6a0d7504200a547f2284ff106">llvm::parseCachePruningPolicy</a></div><div class="ttdeci">Expected&lt; CachePruningPolicy &gt; parseCachePruningPolicy(StringRef PolicyStr)</div><div class="ttdoc">Parse the given string as a cache pruning policy.</div><div class="ttdef"><b>Definition:</b> <a href="CachePruning_8cpp_source.html#l00078">CachePruning.cpp:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_acfeea8deca8739aecb36f9ab29544b95"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#acfeea8deca8739aecb36f9ab29544b95">llvm::sys::fs::disk_space</a></div><div class="ttdeci">ErrorOr&lt; space_info &gt; disk_space(const Twine &amp;Path)</div><div class="ttdoc">Get disk space usage information.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:07:17 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
