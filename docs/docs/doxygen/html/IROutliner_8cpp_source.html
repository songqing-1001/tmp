<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/IPO/IROutliner.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_13abb262e9c52ddea8d07639819afd6c.html">IPO</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IROutliner.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="IROutliner_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- IROutliner.cpp -- Outline Similar Regions ----------------*- C++ -*-===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span><span class="comment">// Implementation for the IROutliner which is used by the IROutliner Pass.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IROutliner_8h.html">llvm/Transforms/IPO/IROutliner.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRSimilarityIdentifier_8h.html">llvm/Analysis/IRSimilarityIdentifier.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Attributes_8h.html">llvm/IR/Attributes.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DIBuilder_8h.html">llvm/IR/DIBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2DebugInfo_8h.html">llvm/IR/DebugInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DebugInfoMetadata_8h.html">llvm/IR/DebugInfoMetadata.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Mangler_8h.html">llvm/IR/Mangler.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2IPO_8h.html">llvm/Transforms/IPO.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   32</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;iroutliner&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span>IRSimilarity;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// A command flag to be used for debugging to exclude branches from similarity</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// matching and outlining.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespacellvm.html#a93b773511cf2c25df41bdd74e8718bd3">   40</a></span>&#160;<span class="keyword">extern</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="namespacellvm.html#a93b773511cf2c25df41bdd74e8718bd3">DisableBranches</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// A command flag to be used for debugging to indirect calls from similarity</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// matching and outlining.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespacellvm.html#a59a51d46c30287fc47551914e29de21e">   44</a></span>&#160;<span class="keyword">extern</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="namespacellvm.html#a59a51d46c30287fc47551914e29de21e">DisableIndirectCalls</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// A command flag to be used for debugging to exclude intrinsics from similarity</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// matching and outlining.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespacellvm.html#a98fea048f88b5fe74294b5bf72acb93c">   48</a></span>&#160;<span class="keyword">extern</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="namespacellvm.html#a98fea048f88b5fe74294b5bf72acb93c">DisableIntrinsics</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;} <span class="comment">// namespace llvm</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// Set to true if the user wants the ir outliner to run on linkonceodr linkage</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// functions. This is false by default because the linker can dedupe linkonceodr</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// functions. Since the outliner is confined to a single module (modulo LTO),</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// this is off by default. It should, however, be the default behavior in</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// LTO.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="IROutliner_8cpp.html#a21da4953c61d301ca9402aed0ed89bd2">EnableLinkOnceODRIROutlining</a>(</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="stringliteral">&quot;enable-linkonceodr-ir-outlining&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable the IR outliner on linkonceodr functions&quot;</span>),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// This is a debug option to test small pieces of code to ensure that outlining</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// works correctly.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="IROutliner_8cpp.html#a05efe971c4e940f01a5e34bc41cd602a">NoCostModel</a>(</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="stringliteral">&quot;ir-outlining-no-cost&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">cl::ReallyHidden</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Debug option to outline greedily, without restriction that &quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;             <span class="stringliteral">&quot;calculated benefit outweighs cost&quot;</span>));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/// The OutlinableGroup holds all the overarching information for outlining</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">/// a set of regions that are structurally similar to one another, such as the</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/// types of the overall function, the output blocks, the sets of stores needed</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">/// and a list of the different regions. This information is used in the</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/// deduplication of extracted regions with the same structure.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html">   74</a></span>&#160;<span class="comment"></span><span class="keyword">struct </span><a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> {<span class="comment"></span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">  /// The sections that could be outlined</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">   76</a></span>&#160;<span class="comment"></span>  std::vector&lt;OutlinableRegion *&gt; <a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">  /// The argument types for the function created as the overall function to</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">  /// replace the extracted function for each region.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">   80</a></span>&#160;<span class="comment"></span>  std::vector&lt;Type *&gt; <a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>;<span class="comment"></span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">  /// The FunctionType for the overall function.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#aab2165e523387ae034bc2117b13c5d51">   82</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *OutlinedFunctionType = <span class="keyword">nullptr</span>;<span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">  /// The Function for the collective overall function.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">   84</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Function.html">Function</a> *OutlinedFunction = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">  /// Flag for whether we should not consider this group of OutlinableRegions</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  /// for extraction.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a7bf6409b01dd04465404d268beec0898">   88</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> IgnoreGroup = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">  /// The return blocks for the overall function.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">   91</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> <a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">  /// The PHIBlocks with their corresponding return block based on the return</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">  /// value as the key.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">   95</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> <a class="code" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">PHIBlocks</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">  /// A set containing the different GVN store sets needed. Each array contains</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">  /// a sorted list of the different values that need to be stored into output</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">  /// registers.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">  100</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;ArrayRef&lt;unsigned&gt;</a>&gt; <a class="code" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutputGVNCombinations</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">  /// Flag for whether the \ref ArgumentTypes have been defined after the</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  /// extraction of the first region.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a9fabb6e6f74e4ef23575f45ea098b827">  104</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> InputTypesSet = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  /// The number of input values in \ref ArgumentTypes.  Anything after this</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  /// index in ArgumentTypes is an output argument.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#aeab6020692f93361cff45734711204fc">  108</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> NumAggregateInputs = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">  /// The mapping of the canonical numbering of the values in outlined sections</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  /// to specific arguments.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">  112</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, unsigned&gt;</a> <a class="code" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">CanonicalNumberToAggArg</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">  /// The number of branches in the region target a basic block that is outside</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">  /// of the region.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a8ef219d66e525d2c9fbb7f54e5869ad3">  116</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> BranchesToOutside = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  /// Tracker counting backwards from the highest unsigned value possible to</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">  /// avoid conflicting with the GVNs of assigned values.  We start at -3 since</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  /// -2 and -1 are assigned by the DenseMap.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a72b89466c3b2fd45331e2c315e2c33e5">  121</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> PHINodeGVNTracker = -3;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap</a>&lt;<a class="code" href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;           std::pair&lt;std::pair&lt;unsigned, unsigned&gt;, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 2&gt;</a>&gt;&gt;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a704926b49e550b25585651aea32b389b">  125</a></span>&#160;      <a class="code" href="structOutlinableGroup.html#a704926b49e550b25585651aea32b389b">PHINodeGVNToGVNs</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a78f1513d0fadc0e72c1c7373c2003666">  126</a></span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;hash_code, unsigned&gt;</a> <a class="code" href="structOutlinableGroup.html#a78f1513d0fadc0e72c1c7373c2003666">GVNsToPHINodeGVN</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  /// The number of instructions that will be outlined by extracting \ref</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  /// Regions.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">  130</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Benefit = 0;<span class="comment"></span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  /// The number of added instructions needed for the outlining of the \ref</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  /// Regions.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">  133</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">  /// The argument that needs to be marked with the swifterr attribute.  If not</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">  /// needed, there is no value.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">  137</a></span>&#160;<span class="comment"></span>  std::optional&lt;unsigned&gt; <a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">  /// For the \ref Regions, we look at every Value.  If it is a constant,</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">  /// we check whether it is the same in Region.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">  /// \param [in,out] NotSame contains the global value numbers where the</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">  /// constant is not always the same, and must be passed in as an argument.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> findSameConstants(<a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> &amp;NotSame);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">  /// For the regions, look at each set of GVN stores needed and account for</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">  /// each combination.  Add an argument to the argument types if there is</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  /// more than one combination.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">  /// \param [in] M - The module we are outlining from.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> collectGVNStoreSets(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;};</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">/// Move the contents of \p SourceBB to before the last instruction of \p</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/// TargetBB.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">/// \param SourceBB - the BasicBlock to pull Instructions from.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/// \param TargetBB - the BasicBlock to put Instruction into.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">  158</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">moveBBContents</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;SourceBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;TargetBB) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(SourceBB))</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.moveBefore(TargetBB, TargetBB.<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/// A function to sort the keys of \p Map, which must be a mapping of constant</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/// values to basic blocks and return it in \p SortedKeys</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/// \param SortedKeys - The vector the keys will be return in and sorted.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">/// \param Map - The DenseMap containing keys to sort.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a8ad786f21829d9e92d31cc0b80c53dbb">  168</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a8ad786f21829d9e92d31cc0b80c53dbb">getSortedConstantKeys</a>(std::vector&lt;Value *&gt; &amp;SortedKeys,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;Map) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;VtoBB : Map)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    SortedKeys.push_back(VtoBB.first);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Here we expect to have either 1 value that is void (nullptr) or multiple</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// values that are all constant integers.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (SortedKeys.size() == 1) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!SortedKeys[0] &amp;&amp; <span class="stringliteral">&quot;Expected a single void value.&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(SortedKeys, [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> &amp;&amp; <span class="stringliteral">&quot;Expected non void values.&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LHSC = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *RHSC = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RHSC &amp;&amp; <span class="stringliteral">&quot;Not a constant integer in return value?&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LHSC &amp;&amp; <span class="stringliteral">&quot;Not a constant integer in return value?&quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> LHSC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a31e8da5adf63afd38b4ab94bca823150">getLimitedValue</a>() &lt; RHSC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a31e8da5adf63afd38b4ab94bca823150">getLimitedValue</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  });</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="structllvm_1_1OutlinableRegion.html#a7e03ba3e02776435b130c487f13289be">  191</a></span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="structllvm_1_1OutlinableRegion.html#a7e03ba3e02776435b130c487f13289be">OutlinableRegion::findCorrespondingValueIn</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;Other,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                  <a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  std::optional&lt;unsigned&gt; GVN = Candidate-&gt;getGVN(V);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GVN &amp;&amp; <span class="stringliteral">&quot;No GVN for incoming value&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  std::optional&lt;unsigned&gt; CanonNum = Candidate-&gt;getCanonicalNum(*GVN);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  std::optional&lt;unsigned&gt; FirstGVN =</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Candidate-&gt;fromCanonicalNum(*CanonNum);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  std::optional&lt;Value *&gt; FoundValueOpt = <a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>.Candidate-&gt;fromGVN(*FirstGVN);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">return</span> FoundValueOpt.value_or(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="structllvm_1_1OutlinableRegion.html#a84b80673b9748e75da40fa84cca3a630">  203</a></span>&#160;<a class="code" href="structllvm_1_1OutlinableRegion.html#a84b80673b9748e75da40fa84cca3a630">OutlinableRegion::findCorrespondingBlockIn</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;Other,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                           <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FirstNonPHI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstNonPHI();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FirstNonPHI &amp;&amp; <span class="stringliteral">&quot;block is empty?&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CorrespondingVal = findCorrespondingValueIn(<a class="code" href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a>, FirstNonPHI);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">if</span> (!CorrespondingVal)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CorrespondingBlock =</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      cast&lt;Instruction&gt;(CorrespondingVal)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">return</span> CorrespondingBlock;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">/// Rewrite the BranchInsts in the incoming blocks to \p PHIBlock that are found</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">/// in \p Included to branch to BasicBlock \p Replace if they currently branch</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">/// to the BasicBlock \p Find.  This is used to fix up the incoming basic blocks</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">/// when PHINodes are included in outlined regions.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">/// \param PHIBlock - The BasicBlock containing the PHINodes that need to be</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">/// checked.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">/// \param Find - The successor block to be replaced.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/// \param Replace - The new succesor block to branch to.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/// \param Included - The set of blocks about to be outlined.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">  225</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">replaceTargetsFromPHINode</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PHIBlock, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="MCSubtargetInfo_8cpp.html#a2b9bd65fb349f4c42139c994b31c2080">Find</a>,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Replace,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                      <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> &amp;Included) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN : PHIBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, PNEnd = PN.getNumIncomingValues(); Idx != PNEnd;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;         ++Idx) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// Check if the incoming block is included in the set of blocks being</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="comment">// outlined.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Incoming = PN.getIncomingBlock(Idx);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (!Included.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(Incoming))</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI = dyn_cast&lt;BranchInst&gt;(Incoming-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BI &amp;&amp; <span class="stringliteral">&quot;Not a branch instruction?&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="comment">// Look over the branching instructions into this block to see if we</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">// used to branch to Find in this outlined block.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Succ = 0, End = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a96b8f11f6f21ca0321294669dab83b35">getNumSuccessors</a>(); Succ != End;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;           Succ++) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// If we have found the block to replace, we do so here.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(Succ) != <a class="code" href="MCSubtargetInfo_8cpp.html#a2b9bd65fb349f4c42139c994b31c2080">Find</a>)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#adc5e7f9c460c68455e826783d77f9a99">setSuccessor</a>(Succ, Replace);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="structllvm_1_1OutlinableRegion.html#a761b3c02cd196cb5f6fb019bcd86866e">  253</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structllvm_1_1OutlinableRegion.html#a761b3c02cd196cb5f6fb019bcd86866e">OutlinableRegion::splitCandidate</a>() {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!CandidateSplit &amp;&amp; <span class="stringliteral">&quot;Candidate already split!&quot;</span>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BackInst = Candidate-&gt;backInstruction();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *EndInst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// Check whether the last instruction is a terminator, if it is, we do</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// not split on the following instruction. We leave the block as it is.  We</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// also check that this is not the last instruction in the Module, otherwise</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// the check for whether the current following instruction matches the</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// previously recorded instruction will be incorrect.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (!BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">isTerminator</a>() ||</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != &amp;BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a7eee4666052bd481591092aa25a62d92">back</a>()) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    EndInst = Candidate-&gt;end()-&gt;Inst;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndInst &amp;&amp; <span class="stringliteral">&quot;Expected an end instruction?&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// We check if the current instruction following the last instruction in the</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// region is the same as the recorded instruction following the last</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// instruction. If they do not match, there could be problems in rewriting</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// the program after outlining, so we ignore it.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">if</span> (!BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">isTerminator</a>() &amp;&amp;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      EndInst != BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a91bd28adea418a08cec78b72413d9d45">getNextNonDebugInstruction</a>())</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StartInst = (*Candidate-&gt;begin()).Inst;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StartInst &amp;&amp; <span class="stringliteral">&quot;Expected a start instruction?&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  StartBB = StartInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  PrevBB = StartBB;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> BBSet;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  Candidate-&gt;getBasicBlocks(BBSet);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// We iterate over the instructions in the region, if we find a PHINode, we</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// check if there are predecessors outside of the region, if there are,</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// we ignore this region since we are unable to handle the severing of the</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// phi node right now.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// TODO: Handle extraneous inputs for PHINodes through variable number of</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// inputs, similar to how outputs are handled.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> It = StartInst-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  EndBB = BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IBlock;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PHIPredBlock = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">bool</span> EndBBTermAndBackInstDifferent = EndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>() != BackInst;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast&lt;PHINode&gt;(&amp;*It)) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">unsigned</span> NumPredsOutsideRegion = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = PN-&gt;getNumIncomingValues(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">if</span> (!BBSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(PN-&gt;getIncomingBlock(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        PHIPredBlock = PN-&gt;getIncomingBlock(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        ++NumPredsOutsideRegion;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="comment">// We must consider the case there the incoming block to the PHINode is</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// the same as the final block of the OutlinableRegion.  If this is the</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">// case, the branch from this block must also be outlined to be valid.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      IBlock = PN-&gt;getIncomingBlock(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span> (IBlock == EndBB &amp;&amp; EndBBTermAndBackInstDifferent) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        PHIPredBlock = PN-&gt;getIncomingBlock(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        ++NumPredsOutsideRegion;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (NumPredsOutsideRegion &gt; 1)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    It++;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// If the region starts with a PHINode, but is not the initial instruction of</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// the BasicBlock, we ignore this region for now.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(StartInst) &amp;&amp; StartInst != &amp;*StartBB-&gt;begin())</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// If the region ends with a PHINode, but does not contain all of the phi node</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// instructions of the region, we ignore it for now.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(BackInst) &amp;&amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      BackInst != &amp;*std::prev(EndBB-&gt;getFirstInsertionPt()))</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// The basic block gets split like so:</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// block:                 block:</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">//   inst1                  inst1</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">//   inst2                  inst2</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">//   region1               br block_to_outline</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">//   region2              block_to_outline:</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">//   region3          -&gt;    region1</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">//   region4                region2</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">//   inst3                  region3</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">//   inst4                  region4</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">//                          br block_after_outline</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">//                        block_after_outline:</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">//                          inst3</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">//                          inst4</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  std::string OriginalName = PrevBB-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">str</a>();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  StartBB = PrevBB-&gt;splitBasicBlock(StartInst, OriginalName + <span class="stringliteral">&quot;_to_outline&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  PrevBB-&gt;replaceSuccessorsPhiUsesWith(PrevBB, StartBB);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// If there was a PHINode with an incoming block outside the region,</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// make sure is correctly updated in the newly split block.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">if</span> (PHIPredBlock)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    PrevBB-&gt;replaceSuccessorsPhiUsesWith(PHIPredBlock, PrevBB);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  CandidateSplit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (!BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">isTerminator</a>()) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    EndBB = EndInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    FollowBB = EndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(EndInst, OriginalName + <span class="stringliteral">&quot;_after_outline&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    EndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a089e003bb688e55b9a91ed4e7fed3678">replaceSuccessorsPhiUsesWith</a>(EndBB, FollowBB);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    FollowBB-&gt;replaceSuccessorsPhiUsesWith(PrevBB, FollowBB);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    EndBB = BackInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    EndsInBranch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    FollowBB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// Refind the basic block set.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  BBSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a1fbf4d66a9eeaa9ade03e8febee097ee">clear</a>();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  Candidate-&gt;getBasicBlocks(BBSet);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// For the phi nodes in the new starting basic block of the region, we</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// reassign the targets of the basic blocks branching instructions.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">replaceTargetsFromPHINode</a>(StartBB, PrevBB, StartBB, BBSet);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> (FollowBB)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">replaceTargetsFromPHINode</a>(FollowBB, EndBB, FollowBB, BBSet);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="structllvm_1_1OutlinableRegion.html#af5d7aa7988108e9377f154cf6a22f02b">  380</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structllvm_1_1OutlinableRegion.html#af5d7aa7988108e9377f154cf6a22f02b">OutlinableRegion::reattachCandidate</a>() {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CandidateSplit &amp;&amp; <span class="stringliteral">&quot;Candidate is not split!&quot;</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// The basic block gets reattached like so:</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// block:                        block:</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">//   inst1                         inst1</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">//   inst2                         inst2</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//   br block_to_outline           region1</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// block_to_outline:        -&gt;     region2</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">//   region1                       region3</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">//   region2                       region4</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">//   region3                       inst3</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">//   region4                       inst4</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">//   br block_after_outline</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// block_after_outline:</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">//   inst3</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">//   inst4</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StartBB != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;StartBB for Candidate is not defined!&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PrevBB-&gt;getTerminator() &amp;&amp; <span class="stringliteral">&quot;Terminator removed from PrevBB!&quot;</span>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// Make sure PHINode references to the block we are merging into are</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// updated to be incoming blocks from the predecessor to the current block.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// NOTE: If this is updated such that the outlined block can have more than</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// one incoming block to a PHINode, this logic will have to updated</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// to handle multiple precessors instead.</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// We only need to update this if the outlined section contains a PHINode, if</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// it does not, then the incoming block was never changed in the first place.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// On the other hand, if PrevBB has no predecessors, it means that all</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// incoming blocks to the first block are contained in the region, and there</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// will be nothing to update.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StartInst = (*Candidate-&gt;begin()).Inst;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(StartInst) &amp;&amp; !PrevBB-&gt;hasNPredecessors(0)) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!PrevBB-&gt;hasNPredecessorsOrMore(2) &amp;&amp;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;         <span class="stringliteral">&quot;PrevBB has more than one predecessor. Should be 0 or 1.&quot;</span>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BeforePrevBB = PrevBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    PrevBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a089e003bb688e55b9a91ed4e7fed3678">replaceSuccessorsPhiUsesWith</a>(PrevBB, BeforePrevBB);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  PrevBB-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">// If we reattaching after outlining, we iterate over the phi nodes to</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// the initial block, and reassign the branch instructions of the incoming</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// blocks to the block we are remerging into.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (!ExtractedFunction) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> BBSet;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    Candidate-&gt;getBasicBlocks(BBSet);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">replaceTargetsFromPHINode</a>(StartBB, StartBB, PrevBB, BBSet);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (!EndsInBranch)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <a class="code" href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">replaceTargetsFromPHINode</a>(FollowBB, FollowBB, EndBB, BBSet);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">moveBBContents</a>(*StartBB, *PrevBB);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PlacementBB = PrevBB;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">if</span> (StartBB != EndBB)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    PlacementBB = EndBB;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">if</span> (!EndsInBranch &amp;&amp; PlacementBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">getUniqueSuccessor</a>() != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FollowBB != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;FollowBB for Candidate is not defined!&quot;</span>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PlacementBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>() &amp;&amp; <span class="stringliteral">&quot;Terminator removed from EndBB!&quot;</span>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    PlacementBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">moveBBContents</a>(*FollowBB, *PlacementBB);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    PlacementBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a089e003bb688e55b9a91ed4e7fed3678">replaceSuccessorsPhiUsesWith</a>(FollowBB, PlacementBB);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    FollowBB-&gt;eraseFromParent();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  PrevBB-&gt;replaceSuccessorsPhiUsesWith(StartBB, PrevBB);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  StartBB-&gt;eraseFromParent();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// Make sure to save changes back to the StartBB.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  StartBB = PrevBB;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  EndBB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  PrevBB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  FollowBB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  CandidateSplit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">/// Find whether \p V matches the Constants previously found for the \p GVN.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">/// \param V - The value to check for consistency.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">/// \param GVN - The global value number assigned to \p V.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">/// \param GVNToConstant - The mapping of global value number to Constants.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">/// \returns true if the Value matches the Constant mapped to by V and false if</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">/// it \p V is a Constant but does not match.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">/// \returns std::nullopt if \p V is not a Constant.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::optional&lt;bool&gt;</div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a74dd543598519cd7f1438aa76f2c1687">  468</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a74dd543598519cd7f1438aa76f2c1687">constantMatches</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> GVN,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, Constant *&gt;</a> &amp;GVNToConstant) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// See if we have a constants</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CST = dyn_cast&lt;Constant&gt;(V);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">if</span> (!CST)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">// Holds a mapping from a global value number to a Constant.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, Constant *&gt;::iterator</a> GVNToConstantIt;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">bool</span> Inserted;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// If we have a constant, try to make a new entry in the GVNToConstant.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  std::tie(GVNToConstantIt, Inserted) =</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      GVNToConstant.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(GVN, CST));</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// If it was found and is not equal, it is not the same. We do not</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// handle this case yet, and exit early.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">if</span> (Inserted || (GVNToConstantIt-&gt;second == CST))</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="structllvm_1_1OutlinableRegion.html#a086b69a5012fff81b179e92d137aae33">  491</a></span>&#160;<a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="structllvm_1_1OutlinableRegion.html#a086b69a5012fff81b179e92d137aae33">OutlinableRegion::getBenefit</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> Benefit = 0;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Estimate the benefit of outlining a specific sections of the program.  We</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// delegate mostly this task to the TargetTransformInfo so that if the target</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// has specific changes, we can have a more accurate estimate.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// However, getInstructionCost delegates the code size calculation for</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// arithmetic instructions to getArithmeticInstrCost in</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// include/Analysis/TargetTransformImpl.h, where it always estimates that the</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// code size for a division and remainder instruction to be equal to 4, and</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// everything else to 1.  This is not an accurate representation of the</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// division instruction for targets that have a native division instruction.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// To be overly conservative, we only add 1 to the number of instructions for</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// each division instruction.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> : *Candidate) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode()) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">case</span> Instruction::FDiv:</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">case</span> Instruction::FRem:</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">case</span> Instruction::SDiv:</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">case</span> Instruction::SRem:</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">case</span> Instruction::UDiv:</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">case</span> Instruction::URem:</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      Benefit += 1;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      Benefit += <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">getInstructionCost</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">TargetTransformInfo::TCK_CodeSize</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">return</span> Benefit;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">/// Check the \p OutputMappings structure for value \p Input, if it exists</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">/// it has been used as an output for outlining, and has been renamed, and we</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">/// return the new value, otherwise, we return the same value.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">/// \param OutputMappings [in] - The mapping of values to their renamed value</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">/// after being used as an output for an outlined region.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/// \param Input [in] - The value to find the remapped value of, if it exists.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/// \return The remapped value if it has been renamed, and the same value if has</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">/// not.</span></div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a6a49e446ebdd2bd5e15c9631813c27aa">  535</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="IROutliner_8cpp.html#a6a49e446ebdd2bd5e15c9631813c27aa">findOutputMapping</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> OutputMappings,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                <a class="code" href="classllvm_1_1Value.html">Value</a> *Input) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;::const_iterator</a> OutputMapping =</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Input);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">if</span> (OutputMapping != OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">return</span> OutputMapping-&gt;second;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">return</span> Input;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">/// Find whether \p Region matches the global value numbering to Constant</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">/// mapping found so far.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">/// \param Region - The OutlinableRegion we are checking for constants</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">/// \param GVNToConstant - The mapping of global value number to Constants.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">/// \param NotSame - The set of global value numbers that do not have the same</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">/// constant in each region.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">/// \returns true if all Constants are the same in every use of a Constant in \p</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">/// Region and false if not</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a52a09c04ddc4ec6d039f1f11f01d019e">  554</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a52a09c04ddc4ec6d039f1f11f01d019e">collectRegionsConstants</a>(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, Constant *&gt;</a> &amp;GVNToConstant,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> &amp;NotSame) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordtype">bool</span> ConstantsTheSame = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> : <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// Iterate over the operands in an instruction. If the global value number,</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// assigned by the IRSimilarityCandidate, has been seen before, we check if</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">// the the number has been found to be not the same value in each instance.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.OperVals) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      std::optional&lt;unsigned&gt; GVNOpt = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getGVN(V);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GVNOpt &amp;&amp; <span class="stringliteral">&quot;Expected a GVN for operand?&quot;</span>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordtype">unsigned</span> GVN = *GVNOpt;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="comment">// Check if this global value has been found to not be the same already.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">if</span> (NotSame.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(GVN)) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          ConstantsTheSame = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">// If it has been the same so far, we check the value for if the</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="comment">// associated Constant value match the previous instances of the same</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="comment">// global value number.  If the global value does not map to a Constant,</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">// it is considered to not be the same value.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      std::optional&lt;bool&gt; ConstantMatches =</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          <a class="code" href="IROutliner_8cpp.html#a74dd543598519cd7f1438aa76f2c1687">constantMatches</a>(V, GVN, GVNToConstant);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">if</span> (ConstantMatches) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (*ConstantMatches)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          ConstantsTheSame = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">// While this value is a register, it might not have been previously,</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="comment">// make sure we don&#39;t already have a constant mapped to this global value</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="comment">// number.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">if</span> (GVNToConstant.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(GVN) != GVNToConstant.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        ConstantsTheSame = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      NotSame.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(GVN);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">return</span> ConstantsTheSame;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#a61915f6a6a382f51fd1a8bf3dd188c0c">  603</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structOutlinableGroup.html#a61915f6a6a382f51fd1a8bf3dd188c0c">OutlinableGroup::findSameConstants</a>(<a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> &amp;NotSame) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, Constant *&gt;</a> GVNToConstant;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a> : Regions)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a52a09c04ddc4ec6d039f1f11f01d019e">collectRegionsConstants</a>(*<a class="code" href="classllvm_1_1Region.html">Region</a>, GVNToConstant, NotSame);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="structOutlinableGroup.html#ad67fb96194cff11216803ad74dba5687">  610</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structOutlinableGroup.html#ad67fb96194cff11216803ad74dba5687">OutlinableGroup::collectGVNStoreSets</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> : Regions)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    OutputGVNCombinations.insert(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;GVNStores);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">// We are adding an extracted argument to decide between which output path</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">// to use in the basic block.  It is used in a switch statement and only</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// needs to be an integer.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">if</span> (OutputGVNCombinations.size() &gt; 1)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    ArgumentTypes.push_back(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext()));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">/// Get the subprogram if it exists for one of the outlined regions.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">/// \param [in] Group - The set of regions to find a subprogram for.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">/// \returns the subprogram if it exists, or nullptr.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a0028135ea5d53b4a9b047ef7c72edd57">  625</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *<a class="code" href="IROutliner_8cpp.html#a0028135ea5d53b4a9b047ef7c72edd57">getSubprogramOrNull</a>(<a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> : Group.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;Call-&gt;getFunction())</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *SP = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getSubprogram())</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">return</span> SP;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;}</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<a class="code" href="classllvm_1_1Function.html">Function</a> *IROutliner::createFunction(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                     <span class="keywordtype">unsigned</span> FunctionNameSuffix) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a> &amp;&amp; <span class="stringliteral">&quot;Function is already defined!&quot;</span>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RetTy = <a class="code" href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext());</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// All extracted functions _should_ have the same return type at this point</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// since the similarity identifier ensures that all branches outside of the</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// region occur in the same place.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// NOTE: Should we ever move to the model that uses a switch at every point</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// needed, meaning that we could branch within the region or out, it is</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// possible that we will need to switch to using the most general case all of</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// the time.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *R : Group.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ExtractedFuncType = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;ExtractedFunction-&gt;getReturnType();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> ((RetTy-&gt;<a class="code" href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>() &amp;&amp; !ExtractedFuncType-&gt;<a class="code" href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>()) ||</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        (RetTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(1) &amp;&amp; ExtractedFuncType-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(16)))</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      RetTy = ExtractedFuncType;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  Group.<a class="code" href="structOutlinableGroup.html#aab2165e523387ae034bc2117b13c5d51">OutlinedFunctionType</a> = <a class="code" href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">FunctionType::get</a>(</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      RetTy, Group.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">// These functions will only be called from within the same module, so</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// we can set an internal linkage.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a> = <a class="code" href="classllvm_1_1Function.html#a6adbed68009f582caa84cdfd2adf36f1">Function::Create</a>(</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      Group.<a class="code" href="structOutlinableGroup.html#aab2165e523387ae034bc2117b13c5d51">OutlinedFunctionType</a>, <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="stringliteral">&quot;outlined_ir_func_&quot;</span> + <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(FunctionNameSuffix), M);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// Transfer the swifterr attribute to the correct function parameter.</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">if</span> (Group.<a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a>)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(*Group.<a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a>,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                         Attribute::SwiftError);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::OptimizeForSize);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::MinSize);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// If there&#39;s a DISubprogram associated with this outlined function, then</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">// emit debug info for the outlined function.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *SP = <a class="code" href="IROutliner_8cpp.html#a0028135ea5d53b4a9b047ef7c72edd57">getSubprogramOrNull</a>(Group)) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">// We have a DISubprogram. Get its DICompileUnit.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="classllvm_1_1DICompileUnit.html">DICompileUnit</a> *<a class="code" href="namespaceCU.html">CU</a> = SP-&gt;getUnit();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="classllvm_1_1DIBuilder.html">DIBuilder</a> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">DB</a>(M, <span class="keyword">true</span>, <a class="code" href="namespaceCU.html">CU</a>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="classllvm_1_1DIFile.html">DIFile</a> *Unit = SP-&gt;getFile();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="classllvm_1_1Mangler.html">Mangler</a> Mg;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// Get the mangled name of the function for the linkage name.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    std::string <a class="code" href="namespacellvm_1_1NVPTXISD.html#ab995b6d422b079c863075e073b2eb96ba7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classllvm_1_1raw__string__ostream.html">llvm::raw_string_ostream</a> MangledNameStream(<a class="code" href="namespacellvm_1_1NVPTXISD.html#ab995b6d422b079c863075e073b2eb96ba7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    Mg.<a class="code" href="classllvm_1_1Mangler.html#aa1c9296fd511eb96bb487befbf5e7cea">getNameWithPrefix</a>(MangledNameStream, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *OutlinedSP = <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">DB</a>.createFunction(</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        Unit <span class="comment">/* Context */</span>, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName(), MangledNameStream.str(),</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        Unit <span class="comment">/* File */</span>,</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        0 <span class="comment">/* Line 0 is reserved for compiler-generated code. */</span>,</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">DB</a>.createSubroutineType(</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">DB</a>.getOrCreateTypeArray(std::nullopt)), <span class="comment">/* void type */</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        0, <span class="comment">/* Line 0 is reserved for compiler-generated code. */</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        DINode::DIFlags::FlagArtificial <span class="comment">/* Compiler-generated code. */</span>,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">/* Outlined code is optimized code by definition. */</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        DISubprogram::SPFlagDefinition | DISubprogram::SPFlagOptimized);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// Don&#39;t add any new variables to the subprogram.</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">DB</a>.finalizeSubprogram(OutlinedSP);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">// Attach subprogram to the function.</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;setSubprogram(OutlinedSP);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// We&#39;re done with the DIBuilder.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">DB</a>.finalize();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">return</span> Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">/// Move each BasicBlock in \p Old to \p New.</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">/// \param [in] Old - The function to move the basic blocks from.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">/// \param [in] New - The function to move the basic blocks to.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">/// \param [out] NewEnds - The return blocks of the new overall function.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a4047976de351f78967fba27df7a6361f">  713</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a4047976de351f78967fba27df7a6361f">moveFunctionData</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Old, <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;New,</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                             <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;NewEnds) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;CurrBB : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(Old)) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    CurrBB.removeFromParent();</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    CurrBB.insertInto(&amp;New);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = CurrBB.getTerminator();</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// For each block we find a return instruction is, it is a potential exit</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">// path for the function.  We keep track of each block based on the return</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// value here.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ReturnInst.html">ReturnInst</a> *RI = dyn_cast&lt;ReturnInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      NewEnds.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(RI-&gt;getReturnValue(), &amp;CurrBB));</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    std::vector&lt;Instruction *&gt; DebugInsts;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Val : CurrBB) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">// We must handle the scoping of called functions differently than</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="comment">// other outlined instructions.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;CallInst&gt;(&amp;Val)) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// Remove the debug information for outlined functions.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        Val.setDebugLoc(<a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>());</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="comment">// Loop info metadata may contain line locations. Update them to have no</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="comment">// value in the new subprogram since the outlined code could be from</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">// several locations.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keyword">auto</span> updateLoopInfoLoc = [&amp;New](<a class="code" href="classllvm_1_1Metadata.html">Metadata</a> *MD) -&gt; <a class="code" href="classllvm_1_1Metadata.html">Metadata</a> * {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *SP = New.getSubprogram())</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Loc = dyn_cast_or_null&lt;DILocation&gt;(MD))</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">DILocation::get</a>(New.getContext(), Loc-&gt;getLine(),</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                     Loc-&gt;getColumn(), SP, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="keywordflow">return</span> MD;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        };</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="namespacellvm.html#aecd4ed57fa6a20d048310d43f5c96da9">updateLoopMetadataDebugLocations</a>(Val, updateLoopInfoLoc);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="comment">// From this point we are only handling call instructions.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = cast&lt;CallInst&gt;(&amp;Val);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="comment">// We add any debug statements here, to be removed after.  Since the</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// instructions originate from many different locations in the program,</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">// it will cause incorrect reporting from a debugger if we keep the</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">// same debug instructions.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (isa&lt;DbgInfoIntrinsic&gt;(CI)) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        DebugInsts.push_back(&amp;Val);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="comment">// Edit the scope of called functions inside of outlined functions.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *SP = New.getSubprogram()) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="classllvm_1_1DILocation.html">DILocation</a> *DI = <a class="code" href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">DILocation::get</a>(New.getContext(), 0, 0, SP);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        Val.setDebugLoc(DI);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : DebugInsts)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">/// Find the the constants that will need to be lifted into arguments</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">/// as they are not the same in each instance of the region.</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">/// \param [in] C - The IRSimilarityCandidate containing the region we are</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">/// analyzing.</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">/// \param [in] NotSame - The set of global value numbers that do not have a</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">/// single Constant across all OutlinableRegions similar to \p C.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">/// \param [out] Inputs - The list containing the global value numbers of the</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">/// arguments needed for the region of code.</span></div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#acda959f961048eba09125aba48d1142e">  782</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#acda959f961048eba09125aba48d1142e">findConstants</a>(<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> &amp;NotSame,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                          std::vector&lt;unsigned&gt; &amp;Inputs) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> Seen;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="comment">// Iterate over the instructions, and find what constants will need to be</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// extracted into arguments.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1simple__ilist.html#a1ca0d3bb44034ff5937d97824d53b0be">IRInstructionDataList::iterator</a> IDIt = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.begin(), EndIDIt = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.end();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;       IDIt != EndIDIt; IDIt++) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : (*IDIt).OperVals) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="comment">// Since these are stored before any outlining, they will be in the</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="comment">// global value numbering.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordtype">unsigned</span> GVN = *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getGVN(V);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">if</span> (NotSame.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(GVN) &amp;&amp; !Seen.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(GVN)) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          Inputs.push_back(GVN);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          Seen.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(GVN);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">/// Find the GVN for the inputs that have been found by the CodeExtractor.</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">/// \param [in] C - The IRSimilarityCandidate containing the region we are</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">/// analyzing.</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">/// \param [in] CurrentInputs - The set of inputs found by the</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">/// CodeExtractor.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">/// \param [in] OutputMappings - The mapping of values that have been replaced</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">/// by a new output value.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">/// \param [out] EndInputNumbers - The global value numbers for the extracted</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">/// arguments.</span></div>
<div class="line"><a name="l00812"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a9165dd298666d75ed2e5be7d5d8b50e5">  812</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a9165dd298666d75ed2e5be7d5d8b50e5">mapInputsToGVNs</a>(<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>,</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                            <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;CurrentInputs,</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                            std::vector&lt;unsigned&gt; &amp;EndInputNumbers) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// Get the Global Value Number for each input.  We check if the Value has been</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// replaced by a different value at output, and use the original value before</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">// replacement.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Input : CurrentInputs) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Input &amp;&amp; <span class="stringliteral">&quot;Have a nullptr as an input&quot;</span>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Input) != OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      Input = OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Input)-&gt;second;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getGVN(Input) &amp;&amp; <span class="stringliteral">&quot;Could not find a numbering for the given input&quot;</span>);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    EndInputNumbers.push_back(*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getGVN(Input));</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;}</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">/// Find the original value for the \p ArgInput values if any one of them was</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">/// replaced during a previous extraction.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">/// \param [in] ArgInputs - The inputs to be extracted by the code extractor.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">/// \param [in] OutputMappings - The mapping of values that have been replaced</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">/// by a new output value.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">/// \param [out] RemappedArgInputs - The remapped values according to</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">/// \p OutputMappings that will be extracted.</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00837"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a09e9f16b4a1aaf539000b95bf5442155">  837</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a09e9f16b4a1aaf539000b95bf5442155">remapExtractedInputs</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> ArgInputs,</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                     <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;RemappedArgInputs) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// Get the global value number for each input that will be extracted as an</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// argument by the code extractor, remapping if needed for reloaded values.</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Input : ArgInputs) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Input) != OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      Input = OutputMappings.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Input)-&gt;second;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    RemappedArgInputs.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(Input);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">/// Find the input GVNs and the output values for a region of Instructions.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">/// Using the code extractor, we collect the inputs to the extracted function.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">/// The \p Region can be identified as needing to be ignored in this function.</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">/// It should be checked whether it should be ignored after a call to this</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">/// function.</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">/// \param [in,out] Region - The region of code to be analyzed.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">/// \param [out] InputGVNs - The global value numbers for the extracted</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">/// arguments.</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">/// \param [in] NotSame - The global value numbers in the region that do not</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">/// have the same constant value in the regions structurally similar to</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">/// \p Region.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">/// \param [in] OutputMappings - The mapping of values that have been replaced</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">/// by a new output value after extraction.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">/// \param [out] ArgInputs - The values of the inputs to the extracted function.</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">/// \param [out] Outputs - The set of values extracted by the CodeExtractor</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">/// as outputs.</span></div>
<div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a48d81e3f58b8db143bc85763d25dbc7a">  867</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a48d81e3f58b8db143bc85763d25dbc7a">getCodeExtractorArguments</a>(</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>, std::vector&lt;unsigned&gt; &amp;InputGVNs,</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> &amp;NotSame, <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;ArgInputs, <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;Outputs) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">// OverallInputs are the inputs to the region found by the CodeExtractor,</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">// SinkCands and HoistCands are used by the CodeExtractor to find sunken</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// allocas of values whose lifetimes are contained completely within the</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// outlined region. PremappedInputs are the arguments found by the</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">// CodeExtractor, removing conditions such as sunken allocas, but that</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// may need to be remapped due to the extracted output values replacing</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// the original values. We use DummyOutputs for this first run of finding</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="comment">// inputs and outputs since the outputs could change during findAllocas,</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="comment">// the correct set of extracted outputs will be in the final Outputs ValueSet.</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> OverallInputs, PremappedInputs, SinkCands, HoistCands,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      DummyOutputs;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">// Use the code extractor to get the inputs and outputs, without sunken</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// allocas or removing llvm.assumes.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <a class="code" href="classllvm_1_1CodeExtractor.html">CodeExtractor</a> *CE = <a class="code" href="classllvm_1_1Region.html">Region</a>.CE;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  CE-&gt;findInputsOutputs(OverallInputs, DummyOutputs, SinkCands);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB &amp;&amp; <span class="stringliteral">&quot;Region must have a start BasicBlock!&quot;</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *OrigF = <a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">getParent</a>();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> CEAC(*OrigF);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="namespacellvm_1_1NVPTXISD.html#ab995b6d422b079c863075e073b2eb96ba7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">// The region may be ineligible due to VarArgs in the parent function. In this</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// case we ignore the region.</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">if</span> (!CE-&gt;isEligible()) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.IgnoreRegion = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// Find if any values are going to be sunk into the function when extracted</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  CE-&gt;findAllocas(CEAC, SinkCands, HoistCands, <a class="code" href="namespacellvm_1_1NVPTXISD.html#ab995b6d422b079c863075e073b2eb96ba7cff9cc4a40fe2b19129ee8e9b0ec645">Dummy</a>);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  CE-&gt;findInputsOutputs(PremappedInputs, Outputs, SinkCands);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="comment">// TODO: Support regions with sunken allocas: values whose lifetimes are</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// contained completely within the outlined region.  These are not guaranteed</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// to be the same in every region, so we must elevate them all to arguments</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// when they appear.  If these values are not equal, it means there is some</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// Input in OverallInputs that was removed for ArgInputs.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">if</span> (OverallInputs.<a class="code" href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">size</a>() != PremappedInputs.<a class="code" href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">size</a>()) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.IgnoreRegion = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="IROutliner_8cpp.html#acda959f961048eba09125aba48d1142e">findConstants</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, NotSame, InputGVNs);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a9165dd298666d75ed2e5be7d5d8b50e5">mapInputsToGVNs</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, OverallInputs, OutputMappings, InputGVNs);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a09e9f16b4a1aaf539000b95bf5442155">remapExtractedInputs</a>(PremappedInputs.<a class="code" href="classllvm_1_1SetVector.html#a55ffacfbd9b6de5eb90a9f443001e3a6">getArrayRef</a>(), OutputMappings,</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                       ArgInputs);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">// Sort the GVNs, since we now have constants included in the \ref InputGVNs</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">// we need to make sure they are in a deterministic order.</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(InputGVNs);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">/// Look over the inputs and map each input argument to an argument in the</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">/// overall function for the OutlinableRegions.  This creates a way to replace</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">/// the arguments of the extracted function with the arguments of the new</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">/// overall function.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">/// \param [in,out] Region - The region of code to be analyzed.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">/// \param [in] InputGVNs - The global value numbering of the input values</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">/// collected.</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">/// \param [in] ArgInputs - The values of the arguments to the extracted</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">/// function.</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a9148948069532c9a5e1b59e3668b8cc3">  938</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a9148948069532c9a5e1b59e3668b8cc3">findExtractedInputToOverallInputMapping</a>(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                        std::vector&lt;unsigned&gt; &amp;InputGVNs,</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                        <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;ArgInputs) {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">// This counts the argument number in the overall function.</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordtype">unsigned</span> TypeIndex = 0;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">// This counts the argument number in the extracted function.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordtype">unsigned</span> OriginalIndex = 0;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// Find the mapping of the extracted arguments to the arguments for the</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// overall function. Since there may be extra arguments in the overall</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">// function to account for the extracted constants, we have two different</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">// counters as we find extracted arguments, and as we come across overall</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// arguments.</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment">// Additionally, in our first pass, for the first extracted function,</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">// we find argument locations for the canonical value numbering.  This</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">// numbering overrides any discovered location for the extracted code.</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> InputVal : InputGVNs) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    std::optional&lt;unsigned&gt; CanonicalNumberOpt = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getCanonicalNum(InputVal);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CanonicalNumberOpt &amp;&amp; <span class="stringliteral">&quot;Canonical number not found?&quot;</span>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">unsigned</span> CanonicalNumber = *CanonicalNumberOpt;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    std::optional&lt;Value *&gt; InputOpt = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.fromGVN(InputVal);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InputOpt &amp;&amp; <span class="stringliteral">&quot;Global value number not found?&quot;</span>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Input = *InputOpt;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, unsigned&gt;::iterator</a> AggArgIt =</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        Group.<a class="code" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">CanonicalNumberToAggArg</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(CanonicalNumber);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (!Group.<a class="code" href="structOutlinableGroup.html#a9fabb6e6f74e4ef23575f45ea098b827">InputTypesSet</a>) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      Group.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>.push_back(Input-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="comment">// If the input value has a swifterr attribute, make sure to mark the</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">// argument in the overall function.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">if</span> (Input-&gt;<a class="code" href="classllvm_1_1Value.html#a98897a3d01f6a4d7f10a5ac8fe862c82">isSwiftError</a>()) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            !Group.<a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a> &amp;&amp;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="stringliteral">&quot;Argument already marked with swifterr for this OutlinableGroup!&quot;</span>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        Group.<a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a> = TypeIndex;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">// Check if we have a constant. If we do add it to the overall argument</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// number to Constant map for the region, and continue to the next input.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *CST = dyn_cast&lt;Constant&gt;(Input)) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">if</span> (AggArgIt != Group.<a class="code" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">CanonicalNumberToAggArg</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.insert(std::make_pair(AggArgIt-&gt;second, CST));</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        Group.<a class="code" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">CanonicalNumberToAggArg</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            std::make_pair(CanonicalNumber, TypeIndex));</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.insert(std::make_pair(TypeIndex, CST));</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      TypeIndex++;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// It is not a constant, we create the mapping from extracted argument list</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// to the overall argument list, using the canonical location, if it exists.</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgInputs.<a class="code" href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">count</a>(Input) &amp;&amp; <span class="stringliteral">&quot;Input cannot be found!&quot;</span>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">if</span> (AggArgIt != Group.<a class="code" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">CanonicalNumberToAggArg</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keywordflow">if</span> (OriginalIndex != AggArgIt-&gt;second)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.ChangedArgOrder = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.insert(</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          std::make_pair(OriginalIndex, AggArgIt-&gt;second));</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.insert(</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          std::make_pair(AggArgIt-&gt;second, OriginalIndex));</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      Group.<a class="code" href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">CanonicalNumberToAggArg</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          std::make_pair(CanonicalNumber, TypeIndex));</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.insert(std::make_pair(OriginalIndex, TypeIndex));</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.insert(std::make_pair(TypeIndex, OriginalIndex));</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    OriginalIndex++;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    TypeIndex++;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">// If the function type definitions for the OutlinableGroup holding the region</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="comment">// have not been set, set the length of the inputs here.  We should have the</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">// same inputs for all of the different regions contained in the</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// OutlinableGroup since they are all structurally similar to one another.</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">if</span> (!Group.<a class="code" href="structOutlinableGroup.html#a9fabb6e6f74e4ef23575f45ea098b827">InputTypesSet</a>) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    Group.<a class="code" href="structOutlinableGroup.html#aeab6020692f93361cff45734711204fc">NumAggregateInputs</a> = TypeIndex;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    Group.<a class="code" href="structOutlinableGroup.html#a9fabb6e6f74e4ef23575f45ea098b827">InputTypesSet</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.NumExtractedInputs = OriginalIndex;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">/// Check if the \p V has any uses outside of the region other than \p PN.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">/// \param V [in] - The value to check.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">/// \param PHILoc [in] - The location in the PHINode of \p V.</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">/// \param PN [in] - The PHINode using \p V.</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">/// \param Exits [in] - The potential blocks we exit to from the outlined</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">/// region.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">/// \param BlocksInRegion [in] - The basic blocks contained in the region.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">/// \returns true if \p V has any use soutside its region other than \p PN.</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a84e785627d5ab55370b5fa402ad7193f"> 1040</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IROutliner_8cpp.html#a84e785627d5ab55370b5fa402ad7193f">outputHasNonPHI</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> PHILoc, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN,</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                            <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 1&gt;</a> &amp;Exits,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                            <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> &amp;BlocksInRegion) {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">// We check to see if the value is used by the PHINode from some other</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="comment">// predecessor not included in the region.  If it is, we make sure</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="comment">// to keep it as an output.</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(llvm::seq&lt;unsigned&gt;(0, PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>()),</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;             [PHILoc, &amp;PN, V, &amp;BlocksInRegion](<span class="keywordtype">unsigned</span> Idx) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;               return (Idx != PHILoc &amp;&amp; V == PN.getIncomingValue(Idx) &amp;&amp;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                       !BlocksInRegion.contains(PN.getIncomingBlock(Idx)));</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;             }))</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="comment">// Check if the value is used by any other instructions outside the region.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>(), [&amp;Exits, &amp;BlocksInRegion](<a class="code" href="classllvm_1_1User.html">User</a> *U) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    Instruction *I = dyn_cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    if (!I)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      return false;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">// If the use of the item is inside the region, we skip it.  Uses</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">// inside the region give us useful information about how the item could be</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">// used as an output.</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    BasicBlock *Parent = I-&gt;getParent();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    if (BlocksInRegion.contains(Parent))</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      return false;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">// If it&#39;s not a PHINode then we definitely know the use matters.  This</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// output value will not completely combined with another item in a PHINode</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">// as it is directly reference by another non-phi instruction</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    if (!isa&lt;PHINode&gt;(I))</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      return true;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// If we have a PHINode outside one of the exit locations, then it</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">// can be considered an outside use as well.  If there is a PHINode</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// contained in the Exit where this values use matters, it will be</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">// caught when we analyze that PHINode.</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    if (!Exits.contains(Parent))</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      return true;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    return false;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  });</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;}</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">/// Test whether \p CurrentExitFromRegion contains any PhiNodes that should be</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">/// considered outputs. A PHINodes is an output when more than one incoming</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">/// value has been marked by the CodeExtractor as an output.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">/// \param CurrentExitFromRegion [in] - The block to analyze.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">/// \param PotentialExitsFromRegion [in] - The potential exit blocks from the</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">/// region.</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">/// \param RegionBlocks [in] - The basic blocks in the region.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">/// \param Outputs [in, out] - The existing outputs for the region, we may add</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">/// PHINodes to this as we find that they replace output values.</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">/// \param OutputsReplacedByPHINode [out] - A set containing outputs that are</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">/// totally replaced  by a PHINode.</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">/// \param OutputsWithNonPhiUses [out] - A set containing outputs that are used</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">/// in PHINodes, but have other uses, and should still be considered outputs.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a882dcfc2455d525e78a8bbf46863ace2"> 1097</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a882dcfc2455d525e78a8bbf46863ace2">analyzeExitPHIsForOutputUses</a>(</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurrentExitFromRegion,</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 1&gt;</a> &amp;PotentialExitsFromRegion,</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> &amp;RegionBlocks, <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;Outputs,</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> &amp;OutputsReplacedByPHINode,</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> &amp;OutputsWithNonPhiUses) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN : CurrentExitFromRegion-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">// Find all incoming values from the outlining region.</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 2&gt;</a> IncomingVals;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = PN.getNumIncomingValues(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">if</span> (RegionBlocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(PN.getIncomingBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)))</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        IncomingVals.push_back(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">// Do not process PHI if there are no predecessors from region.</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordtype">unsigned</span> NumIncomingVals = IncomingVals.size();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">if</span> (NumIncomingVals == 0)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// If there is one predecessor, we mark it as a value that needs to be kept</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// as an output.</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> (NumIncomingVals == 1) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = PN.getIncomingValue(*IncomingVals.begin());</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      OutputsWithNonPhiUses.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(V);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      OutputsReplacedByPHINode.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">erase</a>(V);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">// This PHINode will be used as an output value, so we add it to our list.</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    Outputs.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(&amp;PN);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// Not all of the incoming values should be ignored as other inputs and</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="comment">// outputs may have uses in outlined region.  If they have other uses</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">// outside of the single PHINode we should not skip over it.</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx : IncomingVals) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = PN.getIncomingValue(Idx);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IROutliner_8cpp.html#a84e785627d5ab55370b5fa402ad7193f">outputHasNonPHI</a>(V, Idx, PN, PotentialExitsFromRegion, RegionBlocks)) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        OutputsWithNonPhiUses.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(V);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        OutputsReplacedByPHINode.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">erase</a>(V);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="keywordflow">if</span> (!OutputsWithNonPhiUses.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(V))</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        OutputsReplacedByPHINode.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(V);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;}</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">// Represents the type for the unsigned number denoting the output number for</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">// phi node, along with the canonical number for the exit block.</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#ad0fabe111fc0db047a04c21481fa6aab"> 1145</a></span>&#160;<span class="keyword">using</span> <a class="code" href="IROutliner_8cpp.html#ad0fabe111fc0db047a04c21481fa6aab">ArgLocWithBBCanon</a> = std::pair&lt;unsigned, unsigned&gt;;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">// The list of canonical numbers for the incoming values to a PHINode.</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a69893e3a4e9fbee5b5aa9ac4b036dc5c"> 1147</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classllvm_1_1SmallVector.html">CanonList</a> = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 2&gt;</a>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">// The pair type representing the set of canonical values being combined in the</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">// PHINode, along with the location data for the PHINode.</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a0389cc3001a985e14dcff4067684ad70"> 1150</a></span>&#160;<span class="keyword">using</span> <a class="code" href="IROutliner_8cpp.html#a0389cc3001a985e14dcff4067684ad70">PHINodeData</a> = std::pair&lt;ArgLocWithBBCanon, CanonList&gt;;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">/// Encode \p PND as an integer for easy lookup based on the argument location,</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">/// the parent BasicBlock canonical numbering, and the canonical numbering of</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">/// the values stored in the PHINode.</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">/// \param PND - The data to hash.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">/// \returns The hash code of \p PND.</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a652d50395284a0dec463c533709bc231"> 1158</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1hash__code.html">hash_code</a> <a class="code" href="IROutliner_8cpp.html#a652d50395284a0dec463c533709bc231">encodePHINodeData</a>(<a class="code" href="IROutliner_8cpp.html#a0389cc3001a985e14dcff4067684ad70">PHINodeData</a> &amp;PND) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#add71474638430694c84640146383fc44">llvm::hash_combine</a>(</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <a class="code" href="namespacellvm.html#a0e2e479cf4860dc8a00614e36ee3d5e9">llvm::hash_value</a>(PND.first.first), <a class="code" href="namespacellvm.html#a0e2e479cf4860dc8a00614e36ee3d5e9">llvm::hash_value</a>(PND.first.second),</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <a class="code" href="namespacellvm.html#af80edfc5e42059e045aa7bf7fe42bee3">llvm::hash_combine_range</a>(PND.second.begin(), PND.second.end()));</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">/// Create a special GVN for PHINodes that will be used outside of</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">/// the region.  We create a hash code based on the Canonical number of the</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">/// parent BasicBlock, the canonical numbering of the values stored in the</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">/// PHINode and the aggregate argument location.  This is used to find whether</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">/// this PHINode type has been given a canonical numbering already.  If not, we</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">/// assign it a value and store it for later use.  The value is returned to</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">/// identify different output schemes for the set of regions.</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">/// \param Region - The region that \p PN is an output for.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">/// \param PN - The PHINode we are analyzing.</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">/// \param Blocks - The blocks for the region we are analyzing.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">/// \param AggArgIdx - The argument \p PN will be stored into.</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">/// \returns An optional holding the assigned canonical number, or std::nullopt</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">/// if there is some attribute of the PHINode blocking it from being used.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a25ae47427f2c6650aee974be344ca27d"> 1178</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> std::optional&lt;unsigned&gt; <a class="code" href="IROutliner_8cpp.html#a25ae47427f2c6650aee974be344ca27d">getGVNForPHINode</a>(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                                <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                                <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> &amp;Blocks,</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                                <span class="keywordtype">unsigned</span> AggArgIdx) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;Cand = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PHIBB = PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">CanonList</a> PHIGVNs;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Incoming;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IncomingBlock;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, EIdx = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); Idx &lt; EIdx; Idx++) {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    Incoming = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(Idx);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    IncomingBlock = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(Idx);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">// If we cannot find a GVN, and the incoming block is included in the region</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">// this means that the input to the PHINode is not included in the region we</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">// are trying to analyze, meaning, that if it was outlined, we would be</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">// adding an extra input.  We ignore this case for now, and so ignore the</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="comment">// region.</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    std::optional&lt;unsigned&gt; OGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#abb75d7b6c8ca68d35e459834c5616e00">getGVN</a>(Incoming);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">if</span> (!OGVN &amp;&amp; Blocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(IncomingBlock)) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.IgnoreRegion = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">// If the incoming block isn&#39;t in the region, we don&#39;t have to worry about</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">// this incoming value.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">if</span> (!Blocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(IncomingBlock))</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// Collect the canonical numbers of the values in the PHINode.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordtype">unsigned</span> GVN = *OGVN;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    OGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a431c03fe7b1e48d27e7b0ee98bb2010a">getCanonicalNum</a>(GVN);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OGVN &amp;&amp; <span class="stringliteral">&quot;No GVN found for incoming value?&quot;</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    PHIGVNs.push_back(*OGVN);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">// Find the incoming block and use the canonical numbering as well to define</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">// the hash for the PHINode.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    OGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#abb75d7b6c8ca68d35e459834c5616e00">getGVN</a>(IncomingBlock);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">// If there is no number for the incoming block, it is because we have</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">// split the candidate basic blocks.  So we use the previous block that it</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// was split from to find the valid global value numbering for the PHINode.</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">if</span> (!OGVN) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#acdc2a32b416aa0739ab483a4283c5dd2">getStartBB</a>() == IncomingBlock &amp;&amp;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;             <span class="stringliteral">&quot;Unknown basic block used in exit path PHINode.&quot;</span>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PrevBlock = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="comment">// Iterate over the predecessors to the incoming block of the</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="comment">// PHINode, when we find a block that is not contained in the region</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="comment">// we know that this is the first block that we split from, and should</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="comment">// have a valid global value numbering.</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(IncomingBlock))</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordflow">if</span> (!Blocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(Pred)) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;          PrevBlock = Pred;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PrevBlock &amp;&amp; <span class="stringliteral">&quot;Expected a predecessor not in the reigon!&quot;</span>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      OGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#abb75d7b6c8ca68d35e459834c5616e00">getGVN</a>(PrevBlock);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    GVN = *OGVN;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    OGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a431c03fe7b1e48d27e7b0ee98bb2010a">getCanonicalNum</a>(GVN);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OGVN &amp;&amp; <span class="stringliteral">&quot;No GVN found for incoming block?&quot;</span>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    PHIGVNs.push_back(*OGVN);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="comment">// Now that we have the GVNs for the incoming values, we are going to combine</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="comment">// them with the GVN of the incoming bock, and the output location of the</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// PHINode to generate a hash value representing this instance of the PHINode.</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;hash_code, unsigned&gt;::iterator</a> GVNToPHIIt;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, PHINodeData&gt;::iterator</a> PHIToGVNIt;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  std::optional&lt;unsigned&gt; BBGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#abb75d7b6c8ca68d35e459834c5616e00">getGVN</a>(PHIBB);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BBGVN &amp;&amp; <span class="stringliteral">&quot;Could not find GVN for the incoming block!&quot;</span>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  BBGVN = Cand.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a431c03fe7b1e48d27e7b0ee98bb2010a">getCanonicalNum</a>(*BBGVN);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BBGVN &amp;&amp; <span class="stringliteral">&quot;Could not find canonical number for the incoming block!&quot;</span>);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="comment">// Create a pair of the exit block canonical value, and the aggregate</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="comment">// argument location, connected to the canonical numbers stored in the</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="comment">// PHINode.</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a0389cc3001a985e14dcff4067684ad70">PHINodeData</a> TemporaryPair =</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      std::make_pair(std::make_pair(*BBGVN, AggArgIdx), PHIGVNs);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <a class="code" href="classllvm_1_1hash__code.html">hash_code</a> PHINodeDataHash = <a class="code" href="IROutliner_8cpp.html#a652d50395284a0dec463c533709bc231">encodePHINodeData</a>(TemporaryPair);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="comment">// Look for and create a new entry in our connection between canonical</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">// numbers for PHINodes, and the set of objects we just created.</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  GVNToPHIIt = Group.<a class="code" href="structOutlinableGroup.html#a78f1513d0fadc0e72c1c7373c2003666">GVNsToPHINodeGVN</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(PHINodeDataHash);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="keywordflow">if</span> (GVNToPHIIt == Group.<a class="code" href="structOutlinableGroup.html#a78f1513d0fadc0e72c1c7373c2003666">GVNsToPHINodeGVN</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordtype">bool</span> Inserted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    std::tie(PHIToGVNIt, Inserted) = Group.<a class="code" href="structOutlinableGroup.html#a704926b49e550b25585651aea32b389b">PHINodeGVNToGVNs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        std::make_pair(Group.<a class="code" href="structOutlinableGroup.html#a72b89466c3b2fd45331e2c315e2c33e5">PHINodeGVNTracker</a>, TemporaryPair));</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    std::tie(GVNToPHIIt, Inserted) = Group.<a class="code" href="structOutlinableGroup.html#a78f1513d0fadc0e72c1c7373c2003666">GVNsToPHINodeGVN</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        std::make_pair(PHINodeDataHash, Group.<a class="code" href="structOutlinableGroup.html#a72b89466c3b2fd45331e2c315e2c33e5">PHINodeGVNTracker</a>--));</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keywordflow">return</span> GVNToPHIIt-&gt;second;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;}</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">/// Create a mapping of the output arguments for the \p Region to the output</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">/// arguments of the overall outlined function.</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">/// \param [in,out] Region - The region of code to be analyzed.</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">/// \param [in] Outputs - The values found by the code extractor.</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a4eb66b98a828331ed6cb79ae82c0336f"> 1280</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a4eb66b98a828331ed6cb79ae82c0336f">findExtractedOutputToOverallOutputMapping</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                          <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> &amp;Outputs) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *&gt;</a> BE;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> BlocksInRegion;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getBasicBlocks(BlocksInRegion, BE);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// Find the exits to the region.</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 1&gt;</a> Exits;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Block : BE)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(Block))</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">if</span> (!BlocksInRegion.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(Succ))</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        Exits.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(Succ);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// After determining which blocks exit to PHINodes, we add these PHINodes to</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="comment">// the set of outputs to be processed.  We also check the incoming values of</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">// the PHINodes for whether they should no longer be considered outputs.</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> OutputsReplacedByPHINode;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> OutputsWithNonPhiUses;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBB : Exits)</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a882dcfc2455d525e78a8bbf46863ace2">analyzeExitPHIsForOutputUses</a>(ExitBB, Exits, BlocksInRegion, Outputs,</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                 OutputsReplacedByPHINode,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                 OutputsWithNonPhiUses);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="comment">// This counts the argument number in the extracted function.</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordtype">unsigned</span> OriginalIndex = <a class="code" href="classllvm_1_1Region.html">Region</a>.NumExtractedInputs;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">// This counts the argument number in the overall function.</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordtype">unsigned</span> TypeIndex = Group.<a class="code" href="structOutlinableGroup.html#aeab6020692f93361cff45734711204fc">NumAggregateInputs</a>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordtype">bool</span> TypeFound;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> AggArgsUsed;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// Iterate over the output types and identify if there is an aggregate pointer</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="comment">// type whose base type matches the current output type. If there is, we mark</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">// that we will use this output register for this value. If not we add another</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">// type to the overall argument type list. We also store the GVNs used for</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="comment">// stores to identify which values will need to be moved into an special</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="comment">// block that holds the stores to the output registers.</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Output : Outputs) {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    TypeFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">// We can do this since it is a result value, and will have a number</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// that is necessarily the same. BUT if in the future, the instructions</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// do not have to be in same order, but are functionally the same, we will</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">// have to use a different scheme, as one-to-one correspondence is not</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">// guaranteed.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordtype">unsigned</span> ArgumentSize = Group.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>.size();</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">// If the output is combined in a PHINode, we make sure to skip over it.</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">if</span> (OutputsReplacedByPHINode.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(Output))</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordtype">unsigned</span> AggArgIdx = 0;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Jdx = TypeIndex; Jdx &lt; ArgumentSize; Jdx++) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;PointerType&gt;(Group.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>[Jdx]))</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="keywordflow">if</span> (AggArgsUsed.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(Jdx))</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      TypeFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      AggArgsUsed.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(Jdx);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.insert(std::make_pair(OriginalIndex, Jdx));</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.insert(std::make_pair(Jdx, OriginalIndex));</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      AggArgIdx = Jdx;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">// We were unable to find an unused type in the output type set that matches</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">// the output, so we add a pointer type to the argument types of the overall</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">// function to handle this output and create a mapping to it.</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">if</span> (!TypeFound) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      Group.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>.push_back(Output-&gt;getType()-&gt;getPointerTo(</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getDataLayout().getAllocaAddrSpace()));</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="comment">// Mark the new pointer type as the last value in the aggregate argument</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="comment">// list.</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordtype">unsigned</span> ArgTypeIdx = Group.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>.size() - 1;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      AggArgsUsed.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(ArgTypeIdx);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.insert(</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          std::make_pair(OriginalIndex, ArgTypeIdx));</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.insert(</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          std::make_pair(ArgTypeIdx, OriginalIndex));</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      AggArgIdx = ArgTypeIdx;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="comment">// TODO: Adapt to the extra input from the PHINode.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast&lt;PHINode&gt;(Output);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    std::optional&lt;unsigned&gt; GVN;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">if</span> (PN &amp;&amp; !BlocksInRegion.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>())) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="comment">// Values outside the region can be combined into PHINode when we</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="comment">// have multiple exits. We collect both of these into a list to identify</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="comment">// which values are being used in the PHINode. Each list identifies a</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="comment">// different PHINode, and a different output. We store the PHINode as it&#39;s</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="comment">// own canonical value.  These canonical values are also dependent on the</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="comment">// output argument it is saved to.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="comment">// If two PHINodes have the same canonical values, but different aggregate</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="comment">// argument locations, then they will have distinct Canonical Values.</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      GVN = <a class="code" href="IROutliner_8cpp.html#a25ae47427f2c6650aee974be344ca27d">getGVNForPHINode</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>, PN, BlocksInRegion, AggArgIdx);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordflow">if</span> (!GVN)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="comment">// If we do not have a PHINode we use the global value numbering for the</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="comment">// output value, to find the canonical number to add to the set of stored</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="comment">// values.</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      GVN = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getGVN(Output);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      GVN = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.getCanonicalNum(*GVN);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// Each region has a potentially unique set of outputs.  We save which</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">// values are output in a list of canonical values so we can differentiate</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">// among the different store schemes.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.GVNStores.push_back(*GVN);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    OriginalIndex++;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    TypeIndex++;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">// We sort the stored values to make sure that we are not affected by analysis</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="comment">// order when determining what combination of items were stored.</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.GVNStores);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="keywordtype">void</span> IROutliner::findAddInputsOutputs(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                      <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> &amp;NotSame) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  std::vector&lt;unsigned&gt; Inputs;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> ArgInputs, Outputs;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a48d81e3f58b8db143bc85763d25dbc7a">getCodeExtractorArguments</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>, Inputs, NotSame, OutputMappings, ArgInputs,</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                            Outputs);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.IgnoreRegion)</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="comment">// Map the inputs found by the CodeExtractor to the arguments found for</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="comment">// the overall function.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a9148948069532c9a5e1b59e3668b8cc3">findExtractedInputToOverallInputMapping</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>, Inputs, ArgInputs);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="comment">// Map the outputs found by the CodeExtractor to the arguments found for</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="comment">// the overall function.</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a4eb66b98a828331ed6cb79ae82c0336f">findExtractedOutputToOverallOutputMapping</a>(M, <a class="code" href="classllvm_1_1Region.html">Region</a>, Outputs);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;}</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">/// Replace the extracted function in the Region with a call to the overall</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">/// function constructed from the deduplicated similar regions, replacing and</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">/// remapping the values passed to the extracted function as arguments to the</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">/// new arguments of the overall function.</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">/// \param [in] M - The module to outline from.</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">/// \param [in] Region - The regions of extracted code to be replaced with a new</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">/// function.</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">/// \returns a call instruction with the replaced function.</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a4f3c175c90b9439d52ad07ecda521c2f"> 1434</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="IROutliner_8cpp.html#a4f3c175c90b9439d52ad07ecda521c2f">replaceCalledFunction</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  std::vector&lt;Value *&gt; NewCallArgs;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, unsigned&gt;::iterator</a> ArgPair;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Call = <a class="code" href="classllvm_1_1Region.html">Region</a>.Call;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Call &amp;&amp; <span class="stringliteral">&quot;Call to replace is nullptr?&quot;</span>);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *AggFunc = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AggFunc &amp;&amp; <span class="stringliteral">&quot;Function to replace with is nullptr?&quot;</span>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="comment">// If the arguments are the same size, there are not values that need to be</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="comment">// made into an argument, the argument ordering has not been change, or</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="comment">// different output registers to handle.  We can simply replace the called</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">// function in this case.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Region.html">Region</a>.ChangedArgOrder &amp;&amp; AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#ac6baa801e4aea800984e760d5460662f">arg_size</a>() == Call-&gt;arg_size()) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replace call to &quot;</span> &lt;&lt; *Call &lt;&lt; <span class="stringliteral">&quot; with call to &quot;</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                      &lt;&lt; *AggFunc &lt;&lt; <span class="stringliteral">&quot; with same number of arguments\n&quot;</span>);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    Call-&gt;setCalledFunction(AggFunc);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">return</span> Call;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">// We have a different number of arguments than the new function, so</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">// we need to use our previously mappings off extracted argument to overall</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="comment">// function argument, and constants to overall function argument to create the</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="comment">// new argument list.</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> AggArgIdx = 0; AggArgIdx &lt; AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#ac6baa801e4aea800984e760d5460662f">arg_size</a>(); AggArgIdx++) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">if</span> (AggArgIdx == AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#ac6baa801e4aea800984e760d5460662f">arg_size</a>() - 1 &amp;&amp;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        Group.<a class="code" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutputGVNCombinations</a>.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a9a025cb106832026cd05c2b4648a699f">size</a>() &gt; 1) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="comment">// If we are on the last argument, and we need to differentiate between</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="comment">// output blocks, add an integer to the argument list to determine</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="comment">// what block to take</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Set switch block argument to &quot;</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                        &lt;&lt; <a class="code" href="classllvm_1_1Region.html">Region</a>.OutputBlockNum &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      NewCallArgs.push_back(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext()),</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                             <a class="code" href="classllvm_1_1Region.html">Region</a>.OutputBlockNum));</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    ArgPair = <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.find(AggArgIdx);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (ArgPair != <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>()) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ArgumentValue = Call-&gt;getArgOperand(ArgPair-&gt;second);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="comment">// If we found the mapping from the extracted function to the overall</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="comment">// function, we simply add it to the argument list.  We use the same</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="comment">// value, it just needs to honor the new order of arguments.</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Setting argument &quot;</span> &lt;&lt; AggArgIdx &lt;&lt; <span class="stringliteral">&quot; to value &quot;</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                        &lt;&lt; *ArgumentValue &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      NewCallArgs.push_back(ArgumentValue);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// If it is a constant, we simply add it to the argument list as a value.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.find(AggArgIdx) !=</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>()) {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CST = <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.find(AggArgIdx)-&gt;second;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Setting argument &quot;</span> &lt;&lt; AggArgIdx &lt;&lt; <span class="stringliteral">&quot; to value &quot;</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        &lt;&lt; *CST &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      NewCallArgs.push_back(CST);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// Add a nullptr value if the argument is not found in the extracted</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// function.  If we cannot find a value, it means it is not in use</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// for the region, so we should not pass anything to it.</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Setting argument &quot;</span> &lt;&lt; AggArgIdx &lt;&lt; <span class="stringliteral">&quot; to nullptr\n&quot;</span>);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    NewCallArgs.push_back(<a class="code" href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *<span class="keyword">&gt;</span>(AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(AggArgIdx)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())));</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replace call to &quot;</span> &lt;&lt; *Call &lt;&lt; <span class="stringliteral">&quot; with call to &quot;</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    &lt;&lt; *AggFunc &lt;&lt; <span class="stringliteral">&quot; with new set of arguments\n&quot;</span>);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="comment">// Create the new call instruction and erase the old one.</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  Call = <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#adf50671db83d2813e0d897ea2cfc9102">getFunctionType</a>(), AggFunc, NewCallArgs, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                          Call);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="comment">// It is possible that the call to the outlined function is either the first</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="comment">// instruction is in the new block, the last instruction, or both.  If either</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">// of these is the case, we need to make sure that we replace the instruction</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">// in the IRInstructionData struct with the new call.</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *OldCall = <a class="code" href="classllvm_1_1Region.html">Region</a>.Call;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.NewFront-&gt;Inst == OldCall)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.NewFront-&gt;Inst = Call;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.NewBack-&gt;Inst == OldCall)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.NewBack-&gt;Inst = Call;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">// Transfer any debug information.</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  Call-&gt;setDebugLoc(<a class="code" href="classllvm_1_1Region.html">Region</a>.Call-&gt;getDebugLoc());</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="comment">// Since our output may determine which branch we go to, we make sure to</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="comment">// propogate this new call value through the module.</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  OldCall-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Call);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="comment">// Remove the old instruction.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  OldCall-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.Call = Call;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">// Make sure that the argument in the new function has the SwiftError</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">// argument.</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">if</span> (Group.<a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a>)</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    Call-&gt;addParamAttr(*Group.<a class="code" href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">SwiftErrorArgument</a>, Attribute::SwiftError);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">return</span> Call;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;}</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">/// Find or create a BasicBlock in the outlined function containing PhiBlocks</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">/// for \p RetVal.</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">/// \param Group - The OutlinableGroup containing the information about the</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment">/// overall outlined function.</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">/// \param RetVal - The return value or exit option that we are currently</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">/// evaluating.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">/// \returns The found or newly created BasicBlock to contain the needed</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">/// PHINodes to be used as outputs.</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#aa6ba58912bb6dedee6cc22f00c521525"> 1546</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="IROutliner_8cpp.html#aa6ba58912bb6dedee6cc22f00c521525">findOrCreatePHIBlock</a>(<a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group, <a class="code" href="classllvm_1_1Value.html">Value</a> *RetVal) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;::iterator</a> PhiBlockForRetVal,</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      ReturnBlockForRetVal;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  PhiBlockForRetVal = Group.<a class="code" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">PHIBlocks</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(RetVal);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  ReturnBlockForRetVal = Group.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(RetVal);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ReturnBlockForRetVal != Group.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;         <span class="stringliteral">&quot;Could not find output value!&quot;</span>);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ReturnBB = ReturnBlockForRetVal-&gt;second;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">// Find if a PHIBlock exists for this return value already.  If it is</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">// the first time we are analyzing this, we will not, so we record it.</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  PhiBlockForRetVal = Group.<a class="code" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">PHIBlocks</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(RetVal);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> (PhiBlockForRetVal != Group.<a class="code" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">PHIBlocks</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">return</span> PhiBlockForRetVal-&gt;second;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="comment">// If we did not find a block, we create one, and insert it into the</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">// overall function and record it.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordtype">bool</span> Inserted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PHIBlock = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(ReturnBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), <span class="stringliteral">&quot;phi_block&quot;</span>,</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                                            ReturnBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>());</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  std::tie(PhiBlockForRetVal, Inserted) =</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      Group.<a class="code" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">PHIBlocks</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(RetVal, PHIBlock));</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">// We find the predecessors of the return block in the newly created outlined</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="comment">// function in order to point them to the new PHIBlock rather than the already</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="comment">// existing return block.</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BranchInst *, 2&gt;</a> BranchesToChange;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(ReturnBB))</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    BranchesToChange.push_back(cast&lt;BranchInst&gt;(Pred-&gt;getTerminator()));</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="comment">// Now we mark the branch instructions found, and change the references of the</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="comment">// return block to the newly created PHIBlock.</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI : BranchesToChange)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Succ = 0, End = BI-&gt;getNumSuccessors(); Succ &lt; End; Succ++) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">if</span> (BI-&gt;getSuccessor(Succ) != ReturnBB)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      BI-&gt;setSuccessor(Succ, PHIBlock);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(ReturnBB, PHIBlock);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">return</span> PhiBlockForRetVal-&gt;second;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;}</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">/// For the function call now representing the \p Region, find the passed value</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">/// to that call that represents Argument \p A at the call location if the</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">/// call has already been replaced with a call to the  overall, aggregate</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">/// function.</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">/// \param A - The Argument to get the passed value for.</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">/// \param Region - The extracted Region corresponding to the outlined function.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">/// \returns The Value representing \p A at the call site.</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *</div>
<div class="line"><a name="l01599"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a3ec78a759f1f4420da6201c3010954f8"> 1599</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a3ec78a759f1f4420da6201c3010954f8">getPassedArgumentInAlreadyOutlinedFunction</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Argument.html">Argument</a> *A,</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="comment">// If we don&#39;t need to adjust the argument number at all (since the call</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="comment">// has already been replaced by a call to the overall outlined function)</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">// we can just get the specified argument.</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Region.html">Region</a>.Call-&gt;getArgOperand(A-&gt;getArgNo());</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;}</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">/// For the function call now representing the \p Region, find the passed value</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">/// to that call that represents Argument \p A at the call location if the</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">/// call has only been replaced by the call to the aggregate function.</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="comment">/// \param A - The Argument to get the passed value for.</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">/// \param Region - The extracted Region corresponding to the outlined function.</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">/// \returns The Value representing \p A at the call site.</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *</div>
<div class="line"><a name="l01615"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a0c2ca86fa35cc4ff2d6d1b073916191b"> 1615</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a0c2ca86fa35cc4ff2d6d1b073916191b">getPassedArgumentAndAdjustArgumentLocation</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Argument.html">Argument</a> *A,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="keywordtype">unsigned</span> ArgNum = A-&gt;getArgNo();</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="comment">// If it is a constant, we can look at our mapping from when we created</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// the outputs to figure out what the constant value is.</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.count(ArgNum))</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant.find(ArgNum)-&gt;second;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">// If it is not a constant, and we are not looking at the overall function, we</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="comment">// need to adjust which argument we are looking at.</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  ArgNum = <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToExtracted.find(ArgNum)-&gt;second;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Region.html">Region</a>.Call-&gt;getArgOperand(ArgNum);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;}</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">/// Find the canonical numbering for the incoming Values into the PHINode \p PN.</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">/// \param PN [in] - The PHINode that we are finding the canonical numbers for.</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">/// \param Region [in] - The OutlinableRegion containing \p PN.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">/// \param OutputMappings [in] - The mapping of output values from outlined</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">/// region to their original values.</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">/// \param CanonNums [out] - The canonical numbering for the incoming values to</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">/// \p PN paired with their incoming block.</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">/// \param ReplacedWithOutlinedCall - A flag to use the extracted function call</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">/// of \p Region rather than the overall function&#39;s call.</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#ab0fcb9c00a8bc3f94f45d301d163452f"> 1640</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#ab0fcb9c00a8bc3f94f45d301d163452f">findCanonNumsForPHI</a>(</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN, <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;std::pair&lt;unsigned, BasicBlock *&gt;&gt; &amp;CanonNums,</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordtype">bool</span> ReplacedWithOutlinedCall = <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="comment">// Iterate over the incoming values.</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, EIdx = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); Idx &lt; EIdx; Idx++) {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IVal = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(Idx);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IBlock = PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(Idx);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">// If we have an argument as incoming value, we need to grab the passed</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="comment">// value from the call itself.</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> *A = dyn_cast&lt;Argument&gt;(IVal)) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">if</span> (ReplacedWithOutlinedCall)</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        IVal = <a class="code" href="IROutliner_8cpp.html#a3ec78a759f1f4420da6201c3010954f8">getPassedArgumentInAlreadyOutlinedFunction</a>(A, <a class="code" href="classllvm_1_1Region.html">Region</a>);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        IVal = <a class="code" href="IROutliner_8cpp.html#a0c2ca86fa35cc4ff2d6d1b073916191b">getPassedArgumentAndAdjustArgumentLocation</a>(A, <a class="code" href="classllvm_1_1Region.html">Region</a>);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">// Get the original value if it has been replaced by an output value.</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    IVal = <a class="code" href="IROutliner_8cpp.html#a6a49e446ebdd2bd5e15c9631813c27aa">findOutputMapping</a>(OutputMappings, IVal);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// Find and add the canonical number for the incoming value.</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    std::optional&lt;unsigned&gt; GVN = <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;getGVN(IVal);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GVN &amp;&amp; <span class="stringliteral">&quot;No GVN for incoming value&quot;</span>);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    std::optional&lt;unsigned&gt; CanonNum = <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;getCanonicalNum(*GVN);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CanonNum &amp;&amp; <span class="stringliteral">&quot;No Canonical Number for GVN&quot;</span>);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    CanonNums.push_back(std::make_pair(*CanonNum, IBlock));</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;}</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">/// Find, or add PHINode \p PN to the combined PHINode Block \p OverallPHIBlock</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">/// in order to condense the number of instructions added to the outlined</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="comment">/// function.</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="comment">/// \param PN [in] - The PHINode that we are finding the canonical numbers for.</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">/// \param Region [in] - The OutlinableRegion containing \p PN.</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">/// \param OverallPhiBlock [in] - The overall PHIBlock we are trying to find</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">/// \p PN in.</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">/// \param OutputMappings [in] - The mapping of output values from outlined</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">/// region to their original values.</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">/// \param UsedPHIs [in, out] - The PHINodes in the block that have already been</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">/// matched.</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">/// \return the newly found or created PHINode in \p OverallPhiBlock.</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a>*</div>
<div class="line"><a name="l01684"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a7872b7ab88d188303cd6764e8061fe7b"> 1684</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a7872b7ab88d188303cd6764e8061fe7b">findOrCreatePHIInBlock</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN, <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                       <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OverallPhiBlock,</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                       <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> &amp;UsedPHIs) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="comment">// A list of the canonical numbering assigned to each incoming value, paired</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="comment">// with the incoming block for the PHINode passed into this function.</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;unsigned, BasicBlock *&gt;</a>&gt; PNCanonNums;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="comment">// We have to use the extracted function since we have merged this region into</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="comment">// the overall function yet.  We make sure to reassign the argument numbering</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="comment">// since it is possible that the argument ordering is different between the</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="comment">// functions.</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <a class="code" href="IROutliner_8cpp.html#ab0fcb9c00a8bc3f94f45d301d163452f">findCanonNumsForPHI</a>(&amp;PN, <a class="code" href="classllvm_1_1Region.html">Region</a>, OutputMappings, PNCanonNums,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                      <span class="comment">/* ReplacedWithOutlinedCall = */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *FirstRegion = Group.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0];</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">// A list of the canonical numbering assigned to each incoming value, paired</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="comment">// with the incoming block for the PHINode that we are currently comparing</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="comment">// the passed PHINode to.</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;unsigned, BasicBlock *&gt;</a>&gt; CurrentCanonNums;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="comment">// Find the Canonical Numbering for each PHINode, if it matches, we replace</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="comment">// the uses of the PHINode we are searching for, with the found PHINode.</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;CurrPN : OverallPhiBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="comment">// If this PHINode has already been matched to another PHINode to be merged,</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">// we skip it.</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordflow">if</span> (UsedPHIs.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(&amp;CurrPN))</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    CurrentCanonNums.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="IROutliner_8cpp.html#ab0fcb9c00a8bc3f94f45d301d163452f">findCanonNumsForPHI</a>(&amp;CurrPN, *FirstRegion, OutputMappings, CurrentCanonNums,</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                        <span class="comment">/* ReplacedWithOutlinedCall = */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">// If the list of incoming values is not the same length, then they cannot</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="comment">// match since there is not an analogue for each incoming value.</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">if</span> (PNCanonNums.size() != CurrentCanonNums.size())</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordtype">bool</span> FoundMatch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">// We compare the canonical value for each incoming value in the passed</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">// in PHINode to one already present in the outlined region.  If the</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// incoming values do not match, then the PHINodes do not match.</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">// We also check to make sure that the incoming block matches as well by</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="comment">// finding the corresponding incoming block in the combined outlined region</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">// for the current outlined region.</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, Edx = PNCanonNums.size(); Idx &lt; Edx; ++Idx) {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      std::pair&lt;unsigned, BasicBlock *&gt; ToCompareTo = CurrentCanonNums[Idx];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      std::pair&lt;unsigned, BasicBlock *&gt; ToAdd = PNCanonNums[Idx];</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keywordflow">if</span> (ToCompareTo.first != ToAdd.first) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        FoundMatch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CorrespondingBlock =</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;          <a class="code" href="classllvm_1_1Region.html">Region</a>.findCorrespondingBlockIn(*FirstRegion, ToAdd.second);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CorrespondingBlock &amp;&amp; <span class="stringliteral">&quot;Found block is nullptr&quot;</span>);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keywordflow">if</span> (CorrespondingBlock != ToCompareTo.second) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        FoundMatch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// If all incoming values and branches matched, then we can merge</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="comment">// into the found PHINode.</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">if</span> (FoundMatch) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      UsedPHIs.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(&amp;CurrPN);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordflow">return</span> &amp;CurrPN;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="comment">// If we&#39;ve made it here, it means we weren&#39;t able to replace the PHINode, so</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="comment">// we must insert it ourselves.</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = cast&lt;PHINode&gt;(PN.<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  NewPN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(&amp;*OverallPhiBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, Edx = NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); Idx &lt; Edx;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;       Idx++) {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IncomingVal = NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(Idx);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IncomingBlock = NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(Idx);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// Find corresponding basic block in the overall function for the incoming</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// block.</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BlockToUse =</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.findCorrespondingBlockIn(*FirstRegion, IncomingBlock);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">setIncomingBlock</a>(Idx, BlockToUse);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// If we have an argument we make sure we replace using the argument from</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="comment">// the correct function.</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> *A = dyn_cast&lt;Argument&gt;(IncomingVal)) {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(A-&gt;getArgNo());</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(Idx, Val);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">// Find the corresponding value in the overall function.</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    IncomingVal = <a class="code" href="IROutliner_8cpp.html#a6a49e446ebdd2bd5e15c9631813c27aa">findOutputMapping</a>(OutputMappings, IncomingVal);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = <a class="code" href="classllvm_1_1Region.html">Region</a>.findCorrespondingValueIn(*FirstRegion, IncomingVal);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Val &amp;&amp; <span class="stringliteral">&quot;Value is nullptr?&quot;</span>);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;::iterator</a> RemappedIt =</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        FirstRegion-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#aa6e8e852e322a0a5383c6f0fce17daa2">RemappedArguments</a>.find(Val);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordflow">if</span> (RemappedIt != FirstRegion-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#aa6e8e852e322a0a5383c6f0fce17daa2">RemappedArguments</a>.end())</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      Val = RemappedIt-&gt;second;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(Idx, Val);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">return</span> NewPN;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;}</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">// Within an extracted function, replace the argument uses of the extracted</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">// region with the arguments of the function for an OutlinableGroup.</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">/// \param [in] Region - The region of extracted code to be changed.</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">/// \param [in,out] OutputBBs - The BasicBlock for the output stores for this</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">/// region.</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">/// \param [in] FirstFunction - A flag to indicate whether we are using this</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">/// function to define the overall outlined function for all the regions, or</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">/// if we are operating on one of the following regions.</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a96b5bd50d8e96b4c76ffc26508ce774d"> 1806</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a96b5bd50d8e96b4c76ffc26508ce774d">replaceArgumentUses</a>(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;OutputBBs,</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                    <span class="keywordtype">bool</span> FirstFunction = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction &amp;&amp; <span class="stringliteral">&quot;Region has no extracted function?&quot;</span>);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *DominatingFunction = <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordflow">if</span> (FirstFunction)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    DominatingFunction = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(*DominatingFunction);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> UsedPHIs;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgIdx = 0; ArgIdx &lt; <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction-&gt;arg_size();</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;       ArgIdx++) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.find(ArgIdx) !=</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;               <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>() &amp;&amp;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;           <span class="stringliteral">&quot;No mapping from extracted to outlined?&quot;</span>);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="keywordtype">unsigned</span> AggArgIdx = <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedArgToAgg.find(ArgIdx)-&gt;second;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <a class="code" href="classllvm_1_1Argument.html">Argument</a> *AggArg = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(AggArgIdx);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <a class="code" href="classllvm_1_1Argument.html">Argument</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction-&gt;getArg(ArgIdx);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// The argument is an input, so we can simply replace it with the overall</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">// argument value</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="keywordflow">if</span> (ArgIdx &lt; <a class="code" href="classllvm_1_1Region.html">Region</a>.NumExtractedInputs) {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replacing uses of input &quot;</span> &lt;&lt; *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> &lt;&lt; <span class="stringliteral">&quot; in function &quot;</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                        &lt;&lt; *<a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; *AggArg</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; in function &quot;</span> &lt;&lt; *Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;replaceAllUsesWith(AggArg);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="classllvm_1_1Region.html">Region</a>.Call-&gt;getArgOperand(ArgIdx);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.RemappedArguments.insert(std::make_pair(V, AggArg));</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">// If we are replacing an output, we place the store value in its own</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">// block inside the overall function before replacing the use of the output</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">// in the function.</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;hasOneUse() &amp;&amp; <span class="stringliteral">&quot;Output argument can only have one use&quot;</span>);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a> *InstAsUser = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;user_back();</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InstAsUser &amp;&amp; <span class="stringliteral">&quot;User is nullptr!&quot;</span>);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(InstAsUser);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 4&gt;</a> Descendants;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a406e4a6b7277aab7efd423ae30a9fb12">getDescendants</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, Descendants);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordtype">bool</span> EdgeAdded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">if</span> (Descendants.size() == 0) {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      EdgeAdded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a51145a3ae24ea73b3692a17088edea7b">insertEdge</a>(&amp;DominatingFunction-&gt;<a class="code" href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">getEntryBlock</a>(), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a406e4a6b7277aab7efd423ae30a9fb12">getDescendants</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, Descendants);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">// Iterate over the following blocks, looking for return instructions,</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">// if we find one, find the corresponding output block for the return value</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="comment">// and move our store instruction there.</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *DescendBB : Descendants) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <a class="code" href="classllvm_1_1ReturnInst.html">ReturnInst</a> *RI = dyn_cast&lt;ReturnInst&gt;(DescendBB-&gt;getTerminator());</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (!RI)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *RetVal = RI-&gt;<a class="code" href="classllvm_1_1ReturnInst.html#a87e923648048258a6e8376d6cf4ce565">getReturnValue</a>();</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="keyword">auto</span> VBBIt = OutputBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(RetVal);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VBBIt != OutputBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp; <span class="stringliteral">&quot;Could not find output value!&quot;</span>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <span class="comment">// If this is storing a PHINode, we must make sure it is included in the</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">// overall function.</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ValueOperand = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand();</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *NewI = cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;clone());</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      NewI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a>());</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OutputBB = VBBIt-&gt;second;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      NewI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ad8c5093a18a40f863d4fc5fa6eefefa8">insertInto</a>(OutputBB, OutputBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Move store for instruction &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                        &lt;&lt; *OutputBB &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="comment">// If this is storing a PHINode, we must make sure it is included in the</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="comment">// overall function.</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;PHINode&gt;(ValueOperand) ||</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;          <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;getGVN(ValueOperand).has_value()) {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keywordflow">if</span> (FirstFunction)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *CorrVal =</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <a class="code" href="classllvm_1_1Region.html">Region</a>.findCorrespondingValueIn(*Group.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0], ValueOperand);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CorrVal &amp;&amp; <span class="stringliteral">&quot;Value is nullptr?&quot;</span>);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        NewI-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, CorrVal);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      }</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = cast&lt;PHINode&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="comment">// If it has a value, it was not split by the code extractor, which</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="comment">// is what we are looking for.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;getGVN(PN))</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">// We record the parent block for the PHINode in the Region so that</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="comment">// we can exclude it from checks later on.</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.PHIBlocks.insert(std::make_pair(RetVal, PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()));</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="comment">// If this is the first function, we do not need to worry about mergiing</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="comment">// this with any other block in the overall outlined function, so we can</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="comment">// just continue.</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordflow">if</span> (FirstFunction) {</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PHIBlock = PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        Group.<a class="code" href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">PHIBlocks</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(RetVal, PHIBlock));</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      }</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="comment">// We look for the aggregate block that contains the PHINodes leading into</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="comment">// this exit path. If we can&#39;t find one, we create one.</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OverallPhiBlock = <a class="code" href="IROutliner_8cpp.html#aa6ba58912bb6dedee6cc22f00c521525">findOrCreatePHIBlock</a>(Group, RetVal);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      <span class="comment">// For our PHINode, we find the combined canonical numbering, and</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="comment">// attempt to find a matching PHINode in the overall PHIBlock.  If we</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="comment">// cannot, we copy the PHINode and move it into this new block.</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = <a class="code" href="IROutliner_8cpp.html#a7872b7ab88d188303cd6764e8061fe7b">findOrCreatePHIInBlock</a>(*PN, <a class="code" href="classllvm_1_1Region.html">Region</a>, OverallPhiBlock,</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                                              OutputMappings, UsedPHIs);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      NewI-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, NewPN);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="comment">// If we added an edge for basic blocks without a predecessor, we remove it</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">// here.</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordflow">if</span> (EdgeAdded)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#ab0f09aefdf088f84a0bff7cba86454b4">deleteEdge</a>(&amp;DominatingFunction-&gt;<a class="code" href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">getEntryBlock</a>(), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replacing uses of output &quot;</span> &lt;&lt; *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> &lt;&lt; <span class="stringliteral">&quot; in function &quot;</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                      &lt;&lt; *<a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; *AggArg</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; in function &quot;</span> &lt;&lt; *Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;replaceAllUsesWith(AggArg);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;}</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">/// Within an extracted function, replace the constants that need to be lifted</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">/// into arguments with the actual argument.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">/// \param Region [in] - The region of extracted code to be changed.</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#ace02ac07a3f704ffd345301bff92e5a8"> 1941</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#ace02ac07a3f704ffd345301bff92e5a8">replaceConstants</a>(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;Group = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="comment">// Iterate over the constants that need to be elevated into arguments</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">for</span> (std::pair&lt;unsigned, Constant *&gt; &amp;Const : <a class="code" href="classllvm_1_1Region.html">Region</a>.AggArgToConstant) {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordtype">unsigned</span> AggArgIdx = Const.first;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *OutlinedFunction = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFunction &amp;&amp; <span class="stringliteral">&quot;Overall Function is not defined?&quot;</span>);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CST = Const.second;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <a class="code" href="classllvm_1_1Argument.html">Argument</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = Group.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(AggArgIdx);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="comment">// Identify the argument it will be elevated to, and replace instances of</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="comment">// that constant in the function.</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; </div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// TODO: If in the future constants do not have one global value number,</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="comment">// i.e. a constant 1 could be mapped to several values, this check will</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">// have to be more strict.  It cannot be using only replaceUsesWithIf.</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replacing uses of constant &quot;</span> &lt;&lt; *CST</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; in function &quot;</span> &lt;&lt; *OutlinedFunction &lt;&lt; <span class="stringliteral">&quot; with &quot;</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                      &lt;&lt; *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    CST-&gt;<a class="code" href="classllvm_1_1Value.html#a7e8dad1701aa6445be4a29f654b0473c">replaceUsesWithIf</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, [OutlinedFunction](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>()))</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getFunction() == OutlinedFunction;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    });</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;}</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">/// It is possible that there is a basic block that already performs the same</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">/// stores. This returns a duplicate block, if it exists</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">/// \param OutputBBs [in] the blocks we are looking for a duplicate of.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">/// \param OutputStoreBBs [in] The existing output blocks.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">/// \returns an optional value with the number output block if there is a match.</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a9f6ba11268c4835030bef08cba90383d"> 1974</a></span>&#160;<span class="comment"></span>std::optional&lt;unsigned&gt; <a class="code" href="IROutliner_8cpp.html#a9f6ba11268c4835030bef08cba90383d">findDuplicateOutputBlock</a>(</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;OutputBBs,</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    std::vector&lt;<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a>&gt; &amp;OutputStoreBBs) {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordtype">bool</span> Mismatch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordtype">unsigned</span> MatchingNum = 0;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="comment">// We compare the new set output blocks to the other sets of output blocks.</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="comment">// If they are the same number, and have identical instructions, they are</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="comment">// considered to be the same.</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;CompBBs : OutputStoreBBs) {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    Mismatch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;VToB : CompBBs) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;::iterator</a> OutputBBIt =</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          OutputBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(VToB.first);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keywordflow">if</span> (OutputBBIt == OutputBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        Mismatch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      }</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CompBB = VToB.second;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OutputBB = OutputBBIt-&gt;second;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordflow">if</span> (CompBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">size</a>() - 1 != OutputBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">size</a>()) {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        Mismatch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> NIt = OutputBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *CompBB) {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keywordflow">if</span> (isa&lt;BranchInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isIdenticalTo(&amp;(*NIt))) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          Mismatch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        NIt++;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">if</span> (!Mismatch)</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keywordflow">return</span> MatchingNum;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    MatchingNum++;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;}</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">/// Remove empty output blocks from the outlined region.</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">/// \param BlocksToPrune - Mapping of return values output blocks for the \p</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">/// Region.</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">/// \param Region - The OutlinableRegion we are analyzing.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a57d54880afa1fb74833cc7c43ad33377"> 2029</a></span>&#160;<a class="code" href="IROutliner_8cpp.html#a57d54880afa1fb74833cc7c43ad33377">analyzeAndPruneOutputBlocks</a>(<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;BlocksToPrune,</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                            <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordtype">bool</span> AllRemoved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RetValueForBB;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> <a class="code" href="ARMLowOverheadLoops_8cpp.html#a3bf42baf773b375802538951c88d8e12">ToRemove</a>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="comment">// Iterate over the output blocks created in the outlined section.</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;VtoBB : BlocksToPrune) {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    RetValueForBB = VtoBB.first;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    NewBB = VtoBB.second;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="comment">// If there are no instructions, we remove it from the module, and also</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="comment">// mark the value for removal from the return value to output block mapping.</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">if</span> (NewBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">size</a>() == 0) {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      NewBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8dd327a937563afdb08250abc43820b0">eraseFromParent</a>();</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <a class="code" href="ARMLowOverheadLoops_8cpp.html#a3bf42baf773b375802538951c88d8e12">ToRemove</a>.push_back(RetValueForBB);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">// Mark that we could not remove all the blocks since they were not all</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="comment">// empty.</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    AllRemoved = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="comment">// Remove the return value from the mapping.</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="ARMLowOverheadLoops_8cpp.html#a3bf42baf773b375802538951c88d8e12">ToRemove</a>)</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    BlocksToPrune.erase(V);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">// Mark the region as having the no output scheme.</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keywordflow">if</span> (AllRemoved)</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.OutputBlockNum = -1;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="keywordflow">return</span> AllRemoved;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;}</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">/// For the outlined section, move needed the StoreInsts for the output</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">/// registers into their own block. Then, determine if there is a duplicate</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">/// output block already created.</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">/// \param [in] OG - The OutlinableGroup of regions to be outlined.</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">/// \param [in] Region - The OutlinableRegion that is being analyzed.</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">/// \param [in,out] OutputBBs - the blocks that stores for this region will be</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">/// placed in.</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">/// \param [in] EndBBs - the final blocks of the extracted function.</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">/// \param [in] OutputMappings - OutputMappings the mapping of values that have</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">/// been replaced by a new output value.</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">/// \param [in,out] OutputStoreBBs - The existing output blocks.</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#aa7f3e8558af85938c396b6843a35dd8d"> 2076</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#aa7f3e8558af85938c396b6843a35dd8d">alignOutputBlockWithAggFunc</a>(</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;OG, <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;OutputBBs,</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;EndBBs,</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    std::vector&lt;<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a>&gt; &amp;OutputStoreBBs) {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="comment">// If none of the output blocks have any instructions, this means that we do</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="comment">// not have to determine if it matches any of the other output schemes, and we</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="comment">// don&#39;t have to do anything else.</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IROutliner_8cpp.html#a57d54880afa1fb74833cc7c43ad33377">analyzeAndPruneOutputBlocks</a>(OutputBBs, <a class="code" href="classllvm_1_1Region.html">Region</a>))</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="comment">// Determine is there is a duplicate set of blocks.</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  std::optional&lt;unsigned&gt; MatchingBB =</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      <a class="code" href="IROutliner_8cpp.html#a9f6ba11268c4835030bef08cba90383d">findDuplicateOutputBlock</a>(OutputBBs, OutputStoreBBs);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="comment">// If there is, we remove the new output blocks.  If it does not,</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="comment">// we add it to our list of sets of output blocks.</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">if</span> (MatchingBB) {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Set output block for region in function&quot;</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                      &lt;&lt; <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; *MatchingBB);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.OutputBlockNum = *MatchingBB;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;VtoBB : OutputBBs)</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      VtoBB.second-&gt;eraseFromParent();</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.OutputBlockNum = OutputStoreBBs.size();</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160; </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RetValueForBB;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  OutputStoreBBs.push_back(<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a>());</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;VtoBB : OutputBBs) {</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    RetValueForBB = VtoBB.first;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    NewBB = VtoBB.second;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;::iterator</a> VBBIt =</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        EndBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(RetValueForBB);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Create output block for region in&quot;</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                      &lt;&lt; <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                      &lt;&lt; *NewBB);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(VBBIt-&gt;second, NewBB);</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    OutputStoreBBs.back().insert(std::make_pair(RetValueForBB, NewBB));</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;}</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">/// Takes in a mapping, \p OldMap of ConstantValues to BasicBlocks, sorts keys,</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">/// before creating a basic block for each \p NewMap, and inserting into the new</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">/// block. Each BasicBlock is named with the scheme &quot;&lt;basename&gt;_&lt;key_idx&gt;&quot;.</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">/// \param OldMap [in] - The mapping to base the new mapping off of.</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment">/// \param NewMap [out] - The output mapping using the keys of \p OldMap.</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">/// \param ParentFunc [in] - The function to put the new basic block in.</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">/// \param BaseName [in] - The start of the BasicBlock names to be appended to</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">/// by an index value.</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a8120984c169f2ea17e785e7c6887702a"> 2131</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a8120984c169f2ea17e785e7c6887702a">createAndInsertBasicBlocks</a>(<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;OldMap,</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                                       <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;NewMap,</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                                       <a class="code" href="classllvm_1_1Function.html">Function</a> *ParentFunc, <a class="code" href="classllvm_1_1Twine.html">Twine</a> BaseName) {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="keywordtype">unsigned</span> Idx = 0;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  std::vector&lt;Value *&gt; SortedKeys;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a8ad786f21829d9e92d31cc0b80c53dbb">getSortedConstantKeys</a>(SortedKeys, OldMap);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *RetVal : SortedKeys) {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        ParentFunc-&gt;<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>(),</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        <a class="code" href="classllvm_1_1Twine.html">Twine</a>(BaseName) + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;_&quot;</span>) + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(Idx++)),</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        ParentFunc);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    NewMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(RetVal, NewBB));</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;}</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">/// Create the switch statement for outlined function to differentiate between</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">/// all the output blocks.</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">/// For the outlined section, determine if an outlined block already exists that</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment">/// matches the needed stores for the extracted section.</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">/// \param [in] M - The module we are outlining from.</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">/// \param [in] OG - The group of regions to be outlined.</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment">/// \param [in] EndBBs - The final blocks of the extracted function.</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment">/// \param [in,out] OutputStoreBBs - The existing output blocks.</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#abd03d0c420bf064355d328a784f3ae00"> 2157</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#abd03d0c420bf064355d328a784f3ae00">createSwitchStatement</a>(</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;OG, <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;EndBBs,</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    std::vector&lt;<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a>&gt; &amp;OutputStoreBBs) {</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="comment">// We only need the switch statement if there is more than one store</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="comment">// combination, or there is more than one set of output blocks.  The first</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="comment">// will occur when we store different sets of values for two different</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="comment">// regions.  The second will occur when we have two outputs that are combined</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="comment">// in a PHINode outside of the region in one outlined instance, and are used</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="comment">// seaparately in another. This will create the same set of OutputGVNs, but</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="comment">// will generate two different output schemes.</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keywordflow">if</span> (OG.<a class="code" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutputGVNCombinations</a>.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a9a025cb106832026cd05c2b4648a699f">size</a>() &gt; 1) {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *AggFunc = OG.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">// Create a final block for each different return block.</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> ReturnBBs;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a8120984c169f2ea17e785e7c6887702a">createAndInsertBasicBlocks</a>(OG.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>, ReturnBBs, AggFunc, <span class="stringliteral">&quot;final_block&quot;</span>);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;RetBlockPair : ReturnBBs) {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      std::pair&lt;Value *, BasicBlock *&gt; &amp;OutputBlock =</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;          *OG.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(RetBlockPair.first);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ReturnBlock = RetBlockPair.second;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EndBB = OutputBlock.second;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a> = EndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="comment">// Move the return value to the final block instead of the original exit</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <span class="comment">// stub.</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;moveBefore(*ReturnBlock, ReturnBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <span class="comment">// Put the switch statement in the old end basic block for the function</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      <span class="comment">// with a fall through to the new return block.</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Create switch statement in &quot;</span> &lt;&lt; *AggFunc &lt;&lt; <span class="stringliteral">&quot; for &quot;</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                        &lt;&lt; OutputStoreBBs.<a class="code" href="classllvm_1_1Function.html#a969eb757b1e43b455d4a8d0f603e695b">size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      <a class="code" href="classllvm_1_1SwitchInst.html">SwitchInst</a> *SwitchI =</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;          <a class="code" href="classllvm_1_1SwitchInst.html#a68553b9dbdbf2d12b5c9511fd62c2ef7">SwitchInst::Create</a>(AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">getArg</a>(AggFunc-&gt;<a class="code" href="classllvm_1_1Function.html#ac6baa801e4aea800984e760d5460662f">arg_size</a>() - 1),</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                             ReturnBlock, OutputStoreBBs.<a class="code" href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">size</a>(), EndBB);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <span class="keywordtype">unsigned</span> Idx = 0;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> &amp;OutputStoreBB : OutputStoreBBs) {</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;::iterator</a> OSBBIt =</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            OutputStoreBB.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(OutputBlock.first);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <span class="keywordflow">if</span> (OSBBIt == OutputStoreBB.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = OSBBIt-&gt;second;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        SwitchI-&gt;<a class="code" href="classllvm_1_1SwitchInst.html#a62abc2475d09c01d583ba24a487898fd">addCase</a>(</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext()), Idx), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;setSuccessor(0, ReturnBlock);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        Idx++;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutputStoreBBs.size() &lt; 2 &amp;&amp; <span class="stringliteral">&quot;Different store sets not handled!&quot;</span>);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="comment">// If there needs to be stores, move them from the output blocks to their</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="comment">// corresponding ending block.  We do not check that the OutputGVNCombinations</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="comment">// is equal to 1 here since that could just been the case where there are 0</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <span class="comment">// outputs. Instead, we check whether there is more than one set of output</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="comment">// blocks since this is the only case where we would have to move the</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="comment">// stores, and erase the extraneous blocks.</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="keywordflow">if</span> (OutputStoreBBs.size() == 1) {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Move store instructions to the end block in &quot;</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                      &lt;&lt; *OG.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> OutputBlocks = OutputStoreBBs[0];</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;VBPair : OutputBlocks) {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;::iterator</a> EndBBIt =</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;          EndBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(VBPair.first);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndBBIt != EndBBs.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp; <span class="stringliteral">&quot;Could not find end block&quot;</span>);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EndBB = EndBBIt-&gt;second;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OutputBB = VBPair.second;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a> = OutputBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a> = EndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <a class="code" href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">moveBBContents</a>(*OutputBB, *EndBB);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;moveBefore(*EndBB, EndBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      OutputBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8dd327a937563afdb08250abc43820b0">eraseFromParent</a>();</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  }</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;}</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">/// Fill the new function that will serve as the replacement function for all of</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">/// the extracted regions of a certain structure from the first region in the</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">/// list of regions.  Replace this first region&#39;s extracted function with the</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">/// new overall function.</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">/// \param [in] M - The module we are outlining from.</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">/// \param [in] CurrentGroup - The group of regions to be outlined.</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">/// \param [in,out] OutputStoreBBs - The output blocks for each different</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">/// set of stores needed for the different functions.</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">/// \param [in,out] FuncsToRemove - Extracted functions to erase from module</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">/// once outlining is complete.</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">/// \param [in] OutputMappings - Extracted functions to erase from module</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">/// once outlining is complete.</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a16d01bf2cfdeedd5c8989f5d13da8feb"> 2250</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="IROutliner_8cpp.html#a16d01bf2cfdeedd5c8989f5d13da8feb">fillOverallFunction</a>(</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup,</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    std::vector&lt;<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a>&gt; &amp;OutputStoreBBs,</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    std::vector&lt;Function *&gt; &amp;FuncsToRemove,</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;OutputMappings) {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *CurrentOS = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0];</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="comment">// Move first extracted function&#39;s instructions into new function.</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Move instructions from &quot;</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    &lt;&lt; *CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">ExtractedFunction</a> &lt;&lt; <span class="stringliteral">&quot; to instruction &quot;</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                    &lt;&lt; *CurrentGroup.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a4047976de351f78967fba27df7a6361f">moveFunctionData</a>(*CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">ExtractedFunction</a>,</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                   *CurrentGroup.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>, CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="comment">// Transfer the attributes from the function to the new function.</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Attribute.html">Attribute</a> A : CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">ExtractedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeList.html#a1cf553641e8527095ae4c8ec88a2cd92">getFnAttrs</a>())</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>-&gt;<a class="code" href="classllvm_1_1Function.html#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(A);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <span class="comment">// Create a new set of output blocks for the first extracted function.</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> NewBBs;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a8120984c169f2ea17e785e7c6887702a">createAndInsertBasicBlocks</a>(CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>, NewBBs,</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                             CurrentGroup.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>, <span class="stringliteral">&quot;output_block_0&quot;</span>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#a262d2672038afdeba85e23a30ea4c22d">OutputBlockNum</a> = 0;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a96b5bd50d8e96b4c76ffc26508ce774d">replaceArgumentUses</a>(*CurrentOS, NewBBs, OutputMappings, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <a class="code" href="IROutliner_8cpp.html#ace02ac07a3f704ffd345301bff92e5a8">replaceConstants</a>(*CurrentOS);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <span class="comment">// We first identify if any output blocks are empty, if they are we remove</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="comment">// them. We then create a branch instruction to the basic block to the return</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="comment">// block for the function for each non empty output block.</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="IROutliner_8cpp.html#a57d54880afa1fb74833cc7c43ad33377">analyzeAndPruneOutputBlocks</a>(NewBBs, *CurrentOS)) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    OutputStoreBBs.push_back(<a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a>());</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">for</span> (std::pair&lt;Value *, BasicBlock *&gt; &amp;VToBB : NewBBs) {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;::iterator</a> VBBIt =</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;          CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(VToBB.first);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EndBB = VBBIt-&gt;second;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(EndBB, VToBB.second);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      OutputStoreBBs.back().insert(VToBB);</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  }</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="comment">// Replace the call to the extracted function with the outlined function.</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#a018669f7b1d6a21106f47398a087c30a">Call</a> = <a class="code" href="IROutliner_8cpp.html#a4f3c175c90b9439d52ad07ecda521c2f">replaceCalledFunction</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, *CurrentOS);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="comment">// We only delete the extracted functions at the end since we may need to</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="comment">// reference instructions contained in them for mapping purposes.</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  FuncsToRemove.push_back(CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">ExtractedFunction</a>);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;}</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="keywordtype">void</span> IROutliner::deduplicateExtractedSections(</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup,</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    std::vector&lt;Function *&gt; &amp;FuncsToRemove, <span class="keywordtype">unsigned</span> &amp;OutlinedFunctionNum) {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  createFunction(M, CurrentGroup, OutlinedFunctionNum);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  std::vector&lt;DenseMap&lt;Value *, BasicBlock *&gt;&gt; OutputStoreBBs;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *CurrentOS;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <a class="code" href="IROutliner_8cpp.html#a16d01bf2cfdeedd5c8989f5d13da8feb">fillOverallFunction</a>(M, CurrentGroup, OutputStoreBBs, FuncsToRemove,</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                      OutputMappings);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  std::vector&lt;Value *&gt; SortedKeys;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 1; Idx &lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size(); Idx++) {</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    CurrentOS = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[Idx];</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <a class="code" href="namespacellvm_1_1AttributeFuncs.html#aab96d8eec2287f142354ff6d8f3bba27">AttributeFuncs::mergeAttributesForOutlining</a>(*CurrentGroup.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>,</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                                               *CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">ExtractedFunction</a>);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">// Create a set of BasicBlocks, one for each return block, to hold the</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="comment">// needed store instructions.</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, BasicBlock *&gt;</a> NewBBs;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a8120984c169f2ea17e785e7c6887702a">createAndInsertBasicBlocks</a>(</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>, NewBBs, CurrentGroup.<a class="code" href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinedFunction</a>,</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="stringliteral">&quot;output_block_&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(Idx)));</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a96b5bd50d8e96b4c76ffc26508ce774d">replaceArgumentUses</a>(*CurrentOS, NewBBs, OutputMappings);</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <a class="code" href="IROutliner_8cpp.html#aa7f3e8558af85938c396b6843a35dd8d">alignOutputBlockWithAggFunc</a>(CurrentGroup, *CurrentOS, NewBBs,</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                                CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>, OutputMappings,</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                                OutputStoreBBs);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#a018669f7b1d6a21106f47398a087c30a">Call</a> = <a class="code" href="IROutliner_8cpp.html#a4f3c175c90b9439d52ad07ecda521c2f">replaceCalledFunction</a>(M, *CurrentOS);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    FuncsToRemove.push_back(CurrentOS-&gt;<a class="code" href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">ExtractedFunction</a>);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="comment">// Create a switch statement to handle the different output schemes.</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  <a class="code" href="IROutliner_8cpp.html#abd03d0c420bf064355d328a784f3ae00">createSwitchStatement</a>(M, CurrentGroup, CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">EndBBs</a>, OutputStoreBBs);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  OutlinedFunctionNum++;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;}</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="comment">/// Checks that the next instruction in the InstructionDataList matches the</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">/// next instruction in the module.  If they do not, there could be the</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment">/// possibility that extra code has been inserted, and we must ignore it.</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">/// \param ID - The IRInstructionData to check the next instruction of.</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">/// \returns true if the InstructionDataList and actual instruction match.</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a3bc949e06e148a6d2879eb45ca164146"> 2344</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IROutliner_8cpp.html#a3bc949e06e148a6d2879eb45ca164146">nextIRInstructionDataMatchesNextInst</a>(<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="comment">// We check if there is a discrepancy between the InstructionDataList</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="comment">// and the actual next instruction in the module.  If there is, it means</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="comment">// that an extra instruction was added, likely by the CodeExtractor.</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="comment">// Since we do not have any similarity data about this particular</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="comment">// instruction, we cannot confidently outline it, and must discard this</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="comment">// candidate.</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <a class="code" href="classllvm_1_1simple__ilist.html#a1ca0d3bb44034ff5937d97824d53b0be">IRInstructionDataList::iterator</a> NextIDIt = std::next(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.getIterator());</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NextIDLInst = NextIDIt-&gt;Inst;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NextModuleInst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst-&gt;isTerminator())</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    NextModuleInst = <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a91bd28adea418a08cec78b72413d9d45">getNextNonDebugInstruction</a>();</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NextIDLInst != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    NextModuleInst =</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        &amp;*NextIDIt-&gt;Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a2069641f358ef416658a2f321ca19d74">instructionsWithoutDebug</a>().begin();</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="keywordflow">if</span> (NextIDLInst &amp;&amp; NextIDLInst != NextModuleInst)</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; </div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;}</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="keywordtype">bool</span> IROutliner::isCompatibleWithAlreadyOutlinedCode(</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keyword">const</span> <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> *IRSC = <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordtype">unsigned</span> StartIdx = IRSC-&gt;<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#ada960ccf6a96ca62ce5db3af1b7bf7f5">getStartIdx</a>();</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  <span class="keywordtype">unsigned</span> EndIdx = IRSC-&gt;<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a5fd2e1a8a3658307e8c0d87a153d8c24">getEndIdx</a>();</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  <span class="comment">// A check to make sure that we are not about to attempt to outline something</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="comment">// that has already been outlined.</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = StartIdx; Idx &lt;= EndIdx; Idx++)</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="keywordflow">if</span> (Outlined.contains(Idx))</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="comment">// We check if the recorded instruction matches the actual next instruction,</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="comment">// if it does not, we fix it in the InstructionDataList.</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;backInstruction()-&gt;isTerminator()) {</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewEndInst =</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;backInstruction()-&gt;getNextNonDebugInstruction();</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewEndInst &amp;&amp; <span class="stringliteral">&quot;Next instruction is a nullptr?&quot;</span>);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>()-&gt;Inst != NewEndInst) {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionDataList.html">IRInstructionDataList</a> *IDL = <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;front()-&gt;IDL;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      <a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> *NewEndIRID = <span class="keyword">new</span> (InstDataAllocator.Allocate())</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;          <a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a>(*NewEndInst,</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                            InstructionClassifier.visit(*NewEndInst), *IDL);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="comment">// Insert the first IRInstructionData of the new region after the</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="comment">// last IRInstructionData of the IRSimilarityCandidate.</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      IDL-&gt;<a class="code" href="classllvm_1_1simple__ilist.html#a7f4bd492b552181942252ccddc0db26e">insert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>(), *NewEndIRID);</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160; </div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a7dc3069afa2ce5ea62ac2eb183e51c00">none_of</a>(*IRSC, [<span class="keyword">this</span>](<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IROutliner_8cpp.html#a3bc949e06e148a6d2879eb45ca164146">nextIRInstructionDataMatchesNextInst</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>))</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">return</span> !this-&gt;InstructionClassifier.visit(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  });</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;}</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="keywordtype">void</span> IROutliner::pruneIncompatibleRegions(</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    std::vector&lt;IRSimilarityCandidate&gt; &amp;CandidateVec,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup) {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  <span class="keywordtype">bool</span> PreviouslyOutlined;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <span class="comment">// Sort from beginning to end, so the IRSimilarityCandidates are in order.</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(CandidateVec, [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getStartIdx() &lt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getStartIdx();</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  });</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;FirstCandidate = CandidateVec[0];</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="comment">// Since outlining a call and a branch instruction will be the same as only</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="comment">// outlinining a call instruction, we ignore it as a space saving.</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="keywordflow">if</span> (FirstCandidate.getLength() == 2) {</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">if</span> (isa&lt;CallInst&gt;(FirstCandidate.front()-&gt;Inst) &amp;&amp;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        isa&lt;BranchInst&gt;(FirstCandidate.back()-&gt;Inst))</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="keywordtype">unsigned</span> CurrentEndIdx = 0;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;IRSC : CandidateVec) {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    PreviouslyOutlined = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordtype">unsigned</span> StartIdx = IRSC.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#ada960ccf6a96ca62ce5db3af1b7bf7f5">getStartIdx</a>();</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keywordtype">unsigned</span> EndIdx = IRSC.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a5fd2e1a8a3658307e8c0d87a153d8c24">getEndIdx</a>();</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;FnForCurrCand = *IRSC.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a1d8ba16c81726545b0e8503ac784d939">getFunction</a>();</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = StartIdx; Idx &lt;= EndIdx; Idx++)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <span class="keywordflow">if</span> (Outlined.contains(Idx)) {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        PreviouslyOutlined = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; </div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keywordflow">if</span> (PreviouslyOutlined)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="comment">// Check over the instructions, and if the basic block has its address</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="comment">// taken for use somewhere else, we do not outline that block.</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keywordtype">bool</span> BBHasAddressTaken = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(IRSC, [](<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>){</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst-&gt;getParent()-&gt;hasAddressTaken();</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    });</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="keywordflow">if</span> (BBHasAddressTaken)</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="keywordflow">if</span> (FnForCurrCand.<a class="code" href="classllvm_1_1Function.html#a9c38a8cc0a38636c95bd2826de9d72d4">hasOptNone</a>())</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160; </div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="keywordflow">if</span> (FnForCurrCand.<a class="code" href="classllvm_1_1Function.html#afb28a4deafe2954b0534cc6399ce518b">hasFnAttribute</a>(<span class="stringliteral">&quot;nooutline&quot;</span>)) {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;... Skipping function with nooutline attribute: &quot;</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;               &lt;&lt; FnForCurrCand.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      });</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="keywordflow">if</span> (IRSC.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a5745baa68bbd3265433afb11fe7edc6d">front</a>()-&gt;<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html#a8f280453f9963266308cb61e428f5268">Inst</a>-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#ae28d149d03a6ae88267f649bc1dbe42c">hasLinkOnceODRLinkage</a>() &amp;&amp;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        !OutlineFromLinkODRs)</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="comment">// Greedily prune out any regions that will overlap with already chosen</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">// regions.</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="keywordflow">if</span> (CurrentEndIdx != 0 &amp;&amp; StartIdx &lt;= CurrentEndIdx)</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordtype">bool</span> BadInst = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(IRSC, [<span class="keyword">this</span>](<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="IROutliner_8cpp.html#a3bc949e06e148a6d2879eb45ca164146">nextIRInstructionDataMatchesNextInst</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>))</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keywordflow">return</span> !this-&gt;InstructionClassifier.visit(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst);</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    });</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="keywordflow">if</span> (BadInst)</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> = <span class="keyword">new</span> (RegionAllocator.Allocate())</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a>(IRSC, CurrentGroup);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.push_back(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    CurrentEndIdx = EndIdx;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;}</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160; </div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;IROutliner::findBenefitFromAllRegions(<a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup) {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> RegionBenefit = 0;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a> : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> = getTTI(*<a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;StartBB-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">getParent</a>());</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="comment">// We add the number of instructions in the region to the benefit as an</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="comment">// estimate as to how much will be removed.</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    RegionBenefit += <a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;getBenefit(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; RegionBenefit</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; saved instructions to overfall benefit.\n&quot;</span>);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  }</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160; </div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <span class="keywordflow">return</span> RegionBenefit;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;}</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">/// For the \p OutputCanon number passed in find the value represented by this</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">/// canonical number. If it is from a PHINode, we pick the first incoming</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">/// value and return that Value instead.</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">/// \param Region - The OutlinableRegion to get the Value from.</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">/// \param OutputCanon - The canonical number to find the Value from.</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">/// \returns The Value represented by a canonical number \p OutputCanon in \p</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">/// Region.</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a859bfc2d9aaafd3c329d7f3ec7645d70"> 2511</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="IROutliner_8cpp.html#a859bfc2d9aaafd3c329d7f3ec7645d70">findOutputValueInRegion</a>(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                                      <span class="keywordtype">unsigned</span> OutputCanon) {</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup = *<a class="code" href="classllvm_1_1Region.html">Region</a>.Parent;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  <span class="comment">// If the value is greater than the value in the tracker, we have a</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <span class="comment">// PHINode and will instead use one of the incoming values to find the</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <span class="comment">// type.</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  <span class="keywordflow">if</span> (OutputCanon &gt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a72b89466c3b2fd45331e2c315e2c33e5">PHINodeGVNTracker</a>) {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="keyword">auto</span> It = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a704926b49e550b25585651aea32b389b">PHINodeGVNToGVNs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(OutputCanon);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != CurrentGroup.<a class="code" href="structOutlinableGroup.html#a704926b49e550b25585651aea32b389b">PHINodeGVNToGVNs</a>.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;           <span class="stringliteral">&quot;Could not find GVN set for PHINode number!&quot;</span>);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It-&gt;second.second.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;PHINode does not have any values!&quot;</span>);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    OutputCanon = *It-&gt;second.second.begin();</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  std::optional&lt;unsigned&gt; OGVN =</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;fromCanonicalNum(OutputCanon);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OGVN &amp;&amp; <span class="stringliteral">&quot;Could not find GVN for Canonical Number?&quot;</span>);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  std::optional&lt;Value *&gt; OV = <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;fromGVN(*OGVN);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OV &amp;&amp; <span class="stringliteral">&quot;Could not find value for GVN?&quot;</span>);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  <span class="keywordflow">return</span> *OV;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;}</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160; </div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;IROutliner::findCostOutputReloads(<a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup) {</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OverallCost = 0;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a> : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> = getTTI(*<a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;StartBB-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">getParent</a>());</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="comment">// Each output incurs a load after the call, so we add that to the cost.</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> OutputCanon : <a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;GVNStores) {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="IROutliner_8cpp.html#a859bfc2d9aaafd3c329d7f3ec7645d70">findOutputValueInRegion</a>(*<a class="code" href="classllvm_1_1Region.html">Region</a>, OutputCanon);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> LoadCost =</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;          <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), 0,</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;                              <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">TargetTransformInfo::TCK_CodeSize</a>);</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160; </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; LoadCost</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; instructions to cost for output of type &quot;</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                        &lt;&lt; *V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      OverallCost += LoadCost;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    }</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  }</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="keywordflow">return</span> OverallCost;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;}</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">/// Find the extra instructions needed to handle any output values for the</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">/// region.</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">/// \param [in] M - The Module to outline from.</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">/// \param [in] CurrentGroup - The collection of OutlinableRegions to analyze.</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">/// \param [in] TTI - The TargetTransformInfo used to collect information for</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">/// new instruction costs.</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">/// \returns the additional cost to handle the outputs.</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"><a class="line" href="IROutliner_8cpp.html#a8b12ae89227758cb5684cc7cf25a7f43"> 2563</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> <a class="code" href="IROutliner_8cpp.html#a8b12ae89227758cb5684cc7cf25a7f43">findCostForOutputBlocks</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                                               <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup,</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                                               <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>) {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OutputCost = 0;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  <span class="keywordtype">unsigned</span> NumOutputBranches = 0;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160; </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  <a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;FirstRegion = *CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0];</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> &amp;Candidate = *CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0]-&gt;Candidate;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> CandidateBlocks;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  Candidate.<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a93f165686cbc3ed0554ec8431f9c9b21">getBasicBlocks</a>(CandidateBlocks);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="comment">// Count the number of different output branches that point to blocks outside</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="comment">// of the region.</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> FoundBlocks;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a> &amp;<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> : Candidate) {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;BranchInst&gt;(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.Inst))</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>.OperVals) {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<span class="keyword">&gt;</span>(V);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordflow">if</span> (!CandidateBlocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) &amp;&amp; FoundBlocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>).second)</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        NumOutputBranches++;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    }</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  }</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#a8ef219d66e525d2c9fbb7f54e5869ad3">BranchesToOutside</a> = NumOutputBranches;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;unsigned&gt;</a> &amp;OutputUse :</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;       CurrentGroup.<a class="code" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutputGVNCombinations</a>) {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> OutputCanon : OutputUse) {</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="IROutliner_8cpp.html#a859bfc2d9aaafd3c329d7f3ec7645d70">findOutputValueInRegion</a>(FirstRegion, OutputCanon);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> StoreCost =</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;          <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">getMemoryOpCost</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Instruction::Load</a>, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), 0,</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                              <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">TargetTransformInfo::TCK_CodeSize</a>);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="comment">// An instruction cost is added for each store set that needs to occur for</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="comment">// various output combinations inside the function, plus a branch to</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      <span class="comment">// return to the exit block.</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; StoreCost</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; instructions to cost for output of type &quot;</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                        &lt;&lt; *V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      OutputCost += StoreCost * NumOutputBranches;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    }</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160; </div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> BranchCost =</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af7b131843b386c6e3cc39bd6f8141357">getCFInstrCost</a>(Instruction::Br, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">TargetTransformInfo::TCK_CodeSize</a>);</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding &quot;</span> &lt;&lt; BranchCost &lt;&lt; <span class="stringliteral">&quot; to the current cost for&quot;</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; a branch instruction\n&quot;</span>);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    OutputCost += BranchCost * NumOutputBranches;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  <span class="comment">// If there is more than one output scheme, we must have a comparison and</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <span class="comment">// branch for each different item in the switch statement.</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutputGVNCombinations</a>.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a9a025cb106832026cd05c2b4648a699f">size</a>() &gt; 1) {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> ComparisonCost = <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">getCmpSelInstrCost</a>(</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        Instruction::ICmp, <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext()),</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <a class="code" href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext()), <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">CmpInst::BAD_ICMP_PREDICATE</a>,</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">TargetTransformInfo::TCK_CodeSize</a>);</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> BranchCost =</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#af7b131843b386c6e3cc39bd6f8141357">getCFInstrCost</a>(Instruction::Br, <a class="code" href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">TargetTransformInfo::TCK_CodeSize</a>);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160; </div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <span class="keywordtype">unsigned</span> DifferentBlocks = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutputGVNCombinations</a>.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a9a025cb106832026cd05c2b4648a699f">size</a>();</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> TotalCost = ComparisonCost * BranchCost * DifferentBlocks;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; TotalCost</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; instructions for each switch case for each different&quot;</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; output path in a function\n&quot;</span>);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    OutputCost += TotalCost * NumOutputBranches;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="keywordflow">return</span> OutputCost;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;}</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160; </div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="keywordtype">void</span> IROutliner::findCostBenefit(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup) {</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> RegionBenefit = findBenefitFromAllRegions(CurrentGroup);</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a> += RegionBenefit;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Current Benefit: &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> OutputReloadCost = findCostOutputReloads(CurrentGroup);</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> += OutputReloadCost;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Current Cost: &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160; </div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  <a class="code" href="classllvm_1_1InstructionCost.html">InstructionCost</a> AverageRegionBenefit =</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      RegionBenefit / CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size();</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <span class="keywordtype">unsigned</span> OverallArgumentNum = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">ArgumentTypes</a>.size();</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <span class="keywordtype">unsigned</span> NumRegions = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size();</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> =</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      getTTI(*CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0]-&gt;Candidate-&gt;getFunction());</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160; </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="comment">// We add one region to the cost once, to account for the instructions added</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;  <span class="comment">// inside of the newly created function.</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; AverageRegionBenefit</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; instructions to cost for body of new function.\n&quot;</span>);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> += AverageRegionBenefit;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Current Cost: &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  <span class="comment">// For each argument, we must add an instruction for loading the argument</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <span class="comment">// out of the register and into a value inside of the newly outlined function.</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; OverallArgumentNum</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; instructions to cost for each argument in the new&quot;</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; function.\n&quot;</span>);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> +=</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      OverallArgumentNum * <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">TargetTransformInfo::TCC_Basic</a>;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Current Cost: &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160; </div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  <span class="comment">// Each argument needs to either be loaded into a register or onto the stack.</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  <span class="comment">// Some arguments will only be loaded into the stack once the argument</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;  <span class="comment">// registers are filled.</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding: &quot;</span> &lt;&lt; OverallArgumentNum</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; instructions to cost for each argument in the new&quot;</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; function &quot;</span> &lt;&lt; NumRegions &lt;&lt; <span class="stringliteral">&quot; times for the &quot;</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;needed argument handling at the call site.\n&quot;</span>);</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> +=</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      2 * OverallArgumentNum * <a class="code" href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">TargetTransformInfo::TCC_Basic</a> * NumRegions;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Current Cost: &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> += <a class="code" href="IROutliner_8cpp.html#a8b12ae89227758cb5684cc7cf25a7f43">findCostForOutputBlocks</a>(M, CurrentGroup, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Current Cost: &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;}</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160; </div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="keywordtype">void</span> IROutliner::updateOutputMapping(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>,</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                                     <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> Outputs,</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                                     <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI) {</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="comment">// For and load instructions following the call</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Operand = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  std::optional&lt;unsigned&gt; OutputIdx;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  <span class="comment">// Find if the operand it is an output register.</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgIdx = <a class="code" href="classllvm_1_1Region.html">Region</a>.NumExtractedInputs;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;       ArgIdx &lt; Region.Call-&gt;arg_size(); ArgIdx++) {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">if</span> (Operand == <a class="code" href="classllvm_1_1Region.html">Region</a>.Call-&gt;getArgOperand(ArgIdx)) {</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      OutputIdx = ArgIdx - <a class="code" href="classllvm_1_1Region.html">Region</a>.NumExtractedInputs;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    }</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  }</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  <span class="comment">// If we found an output register, place a mapping of the new value</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  <span class="comment">// to the original in the mapping.</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  <span class="keywordflow">if</span> (!OutputIdx)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; </div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <span class="keywordflow">if</span> (OutputMappings.find(Outputs[*OutputIdx]) == OutputMappings.end()) {</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Mapping extracted output &quot;</span> &lt;&lt; *LI &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                      &lt;&lt; *Outputs[*OutputIdx] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    OutputMappings.insert(std::make_pair(LI, Outputs[*OutputIdx]));</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Orig = OutputMappings.find(Outputs[*OutputIdx])-&gt;second;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Mapping extracted output &quot;</span> &lt;&lt; *Orig &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                      &lt;&lt; *Outputs[*OutputIdx] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    OutputMappings.insert(std::make_pair(LI, Orig));</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  }</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;}</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160; </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="keywordtype">bool</span> IROutliner::extractSection(<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> &amp;<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;Value *&gt;</a> ArgInputs, Outputs, SinkCands;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB &amp;&amp; <span class="stringliteral">&quot;StartBB for the OutlinableRegion is nullptr!&quot;</span>);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InitialStart = <a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *OrigF = <a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">getParent</a>();</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <a class="code" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> CEAC(*OrigF);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction =</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>.CE-&gt;extractCodeRegion(CEAC, ArgInputs, Outputs);</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160; </div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  <span class="comment">// If the extraction was successful, find the BasicBlock, and reassign the</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  <span class="comment">// OutlinableRegion blocks</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction) {</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CodeExtractor failed to outline &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.reattachCandidate();</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  }</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160; </div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;  <span class="comment">// Get the block containing the called branch, and reassign the blocks as</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;  <span class="comment">// necessary.  If the original block still exists, it is because we ended on</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  <span class="comment">// a branch instruction, and so we move the contents into the block before</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="comment">// and assign the previous block correctly.</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;  <a class="code" href="classllvm_1_1User.html">User</a> *InstAsUser = <a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction-&gt;user_back();</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RewrittenBB = cast&lt;Instruction&gt;(InstAsUser)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.PrevBB = RewrittenBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.PrevBB &amp;&amp; <span class="stringliteral">&quot;PrevBB is nullptr?&quot;</span>);</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.PrevBB == InitialStart) {</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewPrev = InitialStart-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BI = NewPrev-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    BI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <a class="code" href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">moveBBContents</a>(*InitialStart, *NewPrev);</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a>.PrevBB = NewPrev;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    InitialStart-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8dd327a937563afdb08250abc43820b0">eraseFromParent</a>();</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  }</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160; </div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.StartBB = RewrittenBB;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.EndBB = RewrittenBB;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160; </div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  <span class="comment">// The sequences of outlinable regions has now changed.  We must fix the</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;  <span class="comment">// IRInstructionDataList for consistency.  Although they may not be illegal</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;  <span class="comment">// instructions, they should not be compared with anything else as they</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  <span class="comment">// should not be outlined in this round.  So marking these as illegal is</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  <span class="comment">// allowed.</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;  <a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionDataList.html">IRInstructionDataList</a> *IDL = <a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;front()-&gt;IDL;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BeginRewritten = &amp;*RewrittenBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *EndRewritten = &amp;*RewrittenBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>();</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.NewFront = <span class="keyword">new</span> (InstDataAllocator.Allocate()) <a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a>(</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      *BeginRewritten, InstructionClassifier.visit(*BeginRewritten), *IDL);</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.NewBack = <span class="keyword">new</span> (InstDataAllocator.Allocate()) <a class="code" href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">IRInstructionData</a>(</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      *EndRewritten, InstructionClassifier.visit(*EndRewritten), *IDL);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160; </div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  <span class="comment">// Insert the first IRInstructionData of the new region in front of the</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;  <span class="comment">// first IRInstructionData of the IRSimilarityCandidate.</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  IDL-&gt;<a class="code" href="classllvm_1_1simple__ilist.html#a7f4bd492b552181942252ccddc0db26e">insert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a1aa6c7717f84c6970e22a0938660047f">begin</a>(), *<a class="code" href="classllvm_1_1Region.html">Region</a>.NewFront);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <span class="comment">// Insert the first IRInstructionData of the new region after the</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  <span class="comment">// last IRInstructionData of the IRSimilarityCandidate.</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  IDL-&gt;<a class="code" href="classllvm_1_1simple__ilist.html#a7f4bd492b552181942252ccddc0db26e">insert</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>(), *<a class="code" href="classllvm_1_1Region.html">Region</a>.NewBack);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <span class="comment">// Remove the IRInstructionData from the IRSimilarityCandidate.</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  IDL-&gt;<a class="code" href="classllvm_1_1simple__ilist.html#a4b588a868b58f1ac0917a59e7c48b5cc">erase</a>(<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a1aa6c7717f84c6970e22a0938660047f">begin</a>(), std::prev(<a class="code" href="classllvm_1_1Region.html">Region</a>.Candidate-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">end</a>()));</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RewrittenBB != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;         <span class="stringliteral">&quot;Could not find a predecessor after extraction!&quot;</span>);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <span class="comment">// Iterate over the new set of instructions to find the new call</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <span class="comment">// instruction.</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *RewrittenBB)</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Region.html">Region</a>.ExtractedFunction == CI-&gt;getCalledFunction())</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <a class="code" href="classllvm_1_1Region.html">Region</a>.Call = CI;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      updateOutputMapping(<a class="code" href="classllvm_1_1Region.html">Region</a>, Outputs.<a class="code" href="classllvm_1_1SetVector.html#a55ffacfbd9b6de5eb90a9f443001e3a6">getArrayRef</a>(), LI);</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a>.reattachCandidate();</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;}</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="keywordtype">unsigned</span> IROutliner::doOutline(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <span class="comment">// Find the possible similarity sections.</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  InstructionClassifier.EnableBranches = !<a class="code" href="namespacellvm.html#a93b773511cf2c25df41bdd74e8718bd3">DisableBranches</a>;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  InstructionClassifier.EnableIndirectCalls = !<a class="code" href="namespacellvm.html#a59a51d46c30287fc47551914e29de21e">DisableIndirectCalls</a>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  InstructionClassifier.EnableIntrinsics = !<a class="code" href="namespacellvm.html#a98fea048f88b5fe74294b5bf72acb93c">DisableIntrinsics</a>;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityIdentifier.html">IRSimilarityIdentifier</a> &amp;<a class="code" href="namespacellvm_1_1object.html#a42e5b6ee6f67085d2115b2ea44588c47acfaaa2f9ff08c82a08d647efc1a2964b">Identifier</a> = getIRSI(M);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  <a class="code" href="namespacellvm_1_1IRSimilarity.html#a1e2d2e59b2467bacdc6db54dcc9bc4a1">SimilarityGroupList</a> &amp;SimilarityCandidates = *<a class="code" href="namespacellvm_1_1object.html#a42e5b6ee6f67085d2115b2ea44588c47acfaaa2f9ff08c82a08d647efc1a2964b">Identifier</a>.getSimilarity();</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;  <span class="comment">// Sort them by size of extracted sections</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  <span class="keywordtype">unsigned</span> OutlinedFunctionNum = 0;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;  <span class="comment">// If we only have one SimilarityGroup in SimilarityCandidates, we do not have</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  <span class="comment">// to sort them by the potential number of instructions to be outlined</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <span class="keywordflow">if</span> (SimilarityCandidates.size() &gt; 1)</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a>(SimilarityCandidates,</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                      [](<span class="keyword">const</span> std::vector&lt;IRSimilarityCandidate&gt; &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                         <span class="keyword">const</span> std::vector&lt;IRSimilarityCandidate&gt; &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>[0].getLength() * <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.size() &gt;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                               <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>[0].getLength() * <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.size();</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                      });</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="comment">// Creating OutlinableGroups for each SimilarityCandidate to be used in</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <span class="comment">// each of the following for loops to avoid making an allocator.</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  std::vector&lt;OutlinableGroup&gt; PotentialGroups(SimilarityCandidates.size());</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;unsigned&gt;</a> NotSame;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  std::vector&lt;OutlinableGroup *&gt; NegativeCostGroups;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  std::vector&lt;OutlinableRegion *&gt; OutlinedRegions;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;  <span class="comment">// Iterate over the possible sets of similarity.</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <span class="keywordtype">unsigned</span> PotentialGroupIdx = 0;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacellvm_1_1IRSimilarity.html#a2198f86ce16da838bdeea4de7e59ef31">SimilarityGroup</a> &amp;CandidateVec : SimilarityCandidates) {</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup = PotentialGroups[PotentialGroupIdx++];</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160; </div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="comment">// Remove entries that were previously outlined</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    pruneIncompatibleRegions(CandidateVec, CurrentGroup);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="comment">// We pruned the number of regions to 0 to 1, meaning that it&#39;s not worth</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <span class="comment">// trying to outlined since there is no compatible similar instance of this</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="comment">// code.</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size() &lt; 2)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160; </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="comment">// Determine if there are any values that are the same constant throughout</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="comment">// each section in the set.</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    NotSame.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a1fbf4d66a9eeaa9ade03e8febee097ee">clear</a>();</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a61915f6a6a382f51fd1a8bf3dd188c0c">findSameConstants</a>(NotSame);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160; </div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a7bf6409b01dd04465404d268beec0898">IgnoreGroup</a>)</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="comment">// Create a CodeExtractor for each outlinable region. Identify inputs and</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    <span class="comment">// outputs for each section using the code extractor and create the argument</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="comment">// types for the Aggregate Outlining Function.</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    OutlinedRegions.clear();</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      <span class="comment">// Break the outlinable region out of its parent BasicBlock into its own</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      <span class="comment">// BasicBlocks (see function implementation).</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;splitCandidate();</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160; </div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      <span class="comment">// There&#39;s a chance that when the region is split, extra instructions are</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <span class="comment">// added to the region. This makes the region no longer viable</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      <span class="comment">// to be split, so we ignore it for outlining.</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;CandidateSplit)</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *&gt;</a> BE;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> BlocksInRegion;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;Candidate-&gt;getBasicBlocks(BlocksInRegion, BE);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;CE = <span class="keyword">new</span> (ExtractorAllocator.Allocate())</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;          <a class="code" href="classllvm_1_1CodeExtractor.html">CodeExtractor</a>(BE, <span class="keyword">nullptr</span>, <span class="keyword">false</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                        <span class="keyword">false</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;outlined&quot;</span>);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      findAddInputsOutputs(M, *<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, NotSame);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;IgnoreRegion)</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        OutlinedRegions.push_back(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <span class="comment">// We recombine the blocks together now that we have gathered all the</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="comment">// needed information.</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;reattachCandidate();</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    }</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160; </div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(OutlinedRegions);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.empty())</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160; </div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#ad67fb96194cff11216803ad74dba5687">collectGVNStoreSets</a>(M);</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordflow">if</span> (CostModel)</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      findCostBenefit(M, CurrentGroup);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160; </div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="comment">// If we are adhering to the cost model, skip those groups where the cost</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="comment">// outweighs the benefits.</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &gt;= CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a> &amp;&amp; CostModel) {</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE =</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;          getORE(*CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0]-&gt;Candidate-&gt;getFunction());</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0]-&gt;Candidate;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>(<a class="code" href="IROutliner_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;WouldNotDecreaseSize&quot;</span>,</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                                   <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;frontInstruction());</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> &lt;&lt; <span class="stringliteral">&quot;did not outline &quot;</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;          &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size()))</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; regions due to estimated increase of &quot;</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;          &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;InstructionIncrease&quot;</span>,</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                     CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> - CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a>)</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; instructions at locations &quot;</span>;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        <a class="code" href="namespacellvm.html#a2145da5bde7663d745e9c3ade392809f">interleave</a>(</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;            CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.begin(), CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.end(),</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;            [&amp;R](<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;              R &lt;&lt; ore::NV(</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                  <span class="stringliteral">&quot;DebugLoc&quot;</span>,</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                  Region-&gt;Candidate-&gt;frontInstruction()-&gt;getDebugLoc());</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            },</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;            [&amp;R]() { R &lt;&lt; <span class="stringliteral">&quot; &quot;</span>; });</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      });</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    }</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160; </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    NegativeCostGroups.push_back(&amp;CurrentGroup);</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;  ExtractorAllocator.DestroyAll();</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160; </div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="keywordflow">if</span> (NegativeCostGroups.size() &gt; 1)</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">stable_sort</a>(NegativeCostGroups,</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                [](<span class="keyword">const</span> <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <span class="keyword">const</span> <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                  <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;Benefit - <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;Cost &gt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;Benefit - <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;Cost;</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                });</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  std::vector&lt;Function *&gt; FuncsToRemove;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> *CG : NegativeCostGroups) {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <a class="code" href="structOutlinableGroup.html">OutlinableGroup</a> &amp;CurrentGroup = *CG;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160; </div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    OutlinedRegions.clear();</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a> : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      <span class="comment">// We check whether our region is compatible with what has already been</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <span class="comment">// outlined, and whether we need to ignore this item.</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      <span class="keywordflow">if</span> (!isCompatibleWithAlreadyOutlinedCode(*<a class="code" href="classllvm_1_1Region.html">Region</a>))</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      OutlinedRegions.push_back(<a class="code" href="classllvm_1_1Region.html">Region</a>);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    }</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="keywordflow">if</span> (OutlinedRegions.size() &lt; 2)</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160; </div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="comment">// Reestimate the cost and benefit of the OutlinableGroup. Continue only if</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="comment">// we are still outlining enough regions to make up for the added cost.</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(OutlinedRegions);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordflow">if</span> (CostModel) {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a> = 0;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> = 0;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      findCostBenefit(M, CurrentGroup);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &gt;= CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a>)</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    }</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    OutlinedRegions.clear();</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a> : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;splitCandidate();</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Region.html">Region</a>-&gt;CandidateSplit)</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      OutlinedRegions.push_back(<a class="code" href="classllvm_1_1Region.html">Region</a>);</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    }</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160; </div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(OutlinedRegions);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size() &lt; 2) {</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *R : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>)</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;reattachCandidate();</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    }</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160; </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Outlining regions with cost &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; and benefit &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160; </div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <span class="comment">// Create functions out of all the sections, and mark them as outlined.</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    OutlinedRegions.clear();</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> : CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>) {</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *&gt;</a> BE;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;      <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> BlocksInRegion;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;Candidate-&gt;getBasicBlocks(BlocksInRegion, BE);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;CE = <span class="keyword">new</span> (ExtractorAllocator.Allocate())</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;          <a class="code" href="classllvm_1_1CodeExtractor.html">CodeExtractor</a>(BE, <span class="keyword">nullptr</span>, <span class="keyword">false</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                        <span class="keyword">false</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;outlined&quot;</span>);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      <span class="keywordtype">bool</span> FunctionOutlined = extractSection(*<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      <span class="keywordflow">if</span> (FunctionOutlined) {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;        <span class="keywordtype">unsigned</span> StartIdx = <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;Candidate-&gt;getStartIdx();</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        <span class="keywordtype">unsigned</span> EndIdx = <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>-&gt;Candidate-&gt;getEndIdx();</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = StartIdx; Idx &lt;= EndIdx; Idx++)</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;          Outlined.insert(Idx);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;        OutlinedRegions.push_back(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      }</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    }</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160; </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Outlined &quot;</span> &lt;&lt; OutlinedRegions.size()</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; with benefit &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; and cost &quot;</span> &lt;&lt; CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(OutlinedRegions);</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160; </div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <span class="keywordflow">if</span> (CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.empty())</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160; </div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE =</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        getORE(*CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0]-&gt;Call-&gt;getFunction());</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">IRSimilarityCandidate</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>[0]-&gt;Candidate;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>(<a class="code" href="IROutliner_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;Outlined&quot;</span>, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;front()-&gt;Inst);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> &lt;&lt; <span class="stringliteral">&quot;outlined &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.size()))</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; regions with decrease of &quot;</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Benefit&quot;</span>, CurrentGroup.<a class="code" href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">Benefit</a> - CurrentGroup.<a class="code" href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">Cost</a>)</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; instructions at locations &quot;</span>;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      <a class="code" href="namespacellvm.html#a2145da5bde7663d745e9c3ade392809f">interleave</a>(</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;          CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.begin(), CurrentGroup.<a class="code" href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">Regions</a>.end(),</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;          [&amp;R](<a class="code" href="structllvm_1_1OutlinableRegion.html">OutlinableRegion</a> *<a class="code" href="classllvm_1_1Region.html">Region</a>) {</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            R &lt;&lt; ore::NV(<span class="stringliteral">&quot;DebugLoc&quot;</span>,</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                         Region-&gt;Candidate-&gt;frontInstruction()-&gt;getDebugLoc());</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;          },</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;          [&amp;R]() { R &lt;&lt; <span class="stringliteral">&quot; &quot;</span>; });</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    });</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160; </div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    deduplicateExtractedSections(M, CurrentGroup, FuncsToRemove,</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;                                 OutlinedFunctionNum);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  }</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160; </div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : FuncsToRemove)</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; </div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  <span class="keywordflow">return</span> OutlinedFunctionNum;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;}</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"><a class="line" href="classllvm_1_1IROutliner.html#adc7588dad82317423eb5949ca4bac107"> 3020</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1IROutliner.html#adc7588dad82317423eb5949ca4bac107">IROutliner::run</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  CostModel = !<a class="code" href="IROutliner_8cpp.html#a05efe971c4e940f01a5e34bc41cd602a">NoCostModel</a>;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  OutlineFromLinkODRs = <a class="code" href="IROutliner_8cpp.html#a21da4953c61d301ca9402aed0ed89bd2">EnableLinkOnceODRIROutlining</a>;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160; </div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  <span class="keywordflow">return</span> doOutline(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) &gt; 0;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;}</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160; </div>
<div class="line"><a name="l03027"></a><span class="lineno"><a class="line" href="classllvm_1_1IROutlinerPass.html#a5b9a8fe2c3b6834817b2c12b08441cff"> 3027</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1IROutlinerPass.html#a5b9a8fe2c3b6834817b2c12b08441cff">IROutlinerPass::run</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1InnerAnalysisManagerProxy.html">FunctionAnalysisManagerModuleProxy</a>&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>).getManager();</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160; </div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GTTI =</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      [&amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>](<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp; {</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1TargetIRAnalysis.html">TargetIRAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;  };</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;  <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityIdentifier.html">IRSimilarityIdentifier</a> &amp;(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;)&gt; GIRSI =</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      [&amp;AM](<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) -&gt; <a class="code" href="classllvm_1_1IRSimilarity_1_1IRSimilarityIdentifier.html">IRSimilarityIdentifier</a> &amp; {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="keywordflow">return</span> AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1IRSimilarityAnalysis.html">IRSimilarityAnalysis</a>&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  };</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;  std::unique_ptr&lt;OptimizationRemarkEmitter&gt; ORE;</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GORE =</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      [&amp;ORE](<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp; {</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    ORE.reset(<span class="keyword">new</span> <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="keywordflow">return</span> *ORE;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  };</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IROutliner.html">IROutliner</a>(GTTI, GIRSI, GORE).<a class="code" href="classllvm_1_1IROutliner.html#adc7588dad82317423eb5949ca4bac107">run</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>))</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionCost_html"><div class="ttname"><a href="classllvm_1_1InstructionCost.html">llvm::InstructionCost</a></div><div class="ttdef"><b>Definition:</b> <a href="InstructionCost_8h_source.html#l00029">InstructionCost.h:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a7653277511df1034148a37520a585bb5"><div class="ttname"><a href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">llvm::Instruction::isTerminator</a></div><div class="ttdeci">bool isTerminator() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00171">Instruction.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">This class represents an incoming formal argument to a Function.</div><div class="ttdef"><b>Definition:</b> <a href="Argument_8h_source.html#l00028">Argument.h:28</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_aa7f3e8558af85938c396b6843a35dd8d"><div class="ttname"><a href="IROutliner_8cpp.html#aa7f3e8558af85938c396b6843a35dd8d">alignOutputBlockWithAggFunc</a></div><div class="ttdeci">static void alignOutputBlockWithAggFunc(OutlinableGroup &amp;OG, OutlinableRegion &amp;Region, DenseMap&lt; Value *, BasicBlock * &gt; &amp;OutputBBs, DenseMap&lt; Value *, BasicBlock * &gt; &amp;EndBBs, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, std::vector&lt; DenseMap&lt; Value *, BasicBlock * &gt;&gt; &amp;OutputStoreBBs)</div><div class="ttdoc">For the outlined section, move needed the StoreInsts for the output registers into their own block.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02076">IROutliner.cpp:2076</a></div></div>
<div class="ttc" id="aIROutliner_8h_html"><div class="ttname"><a href="IROutliner_8h.html">IROutliner.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetIRAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetIRAnalysis.html">llvm::TargetIRAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetTransformInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l02626">TargetTransformInfo.h:2626</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="anamespacellvm_html_a98fea048f88b5fe74294b5bf72acb93c"><div class="ttname"><a href="namespacellvm.html#a98fea048f88b5fe74294b5bf72acb93c">llvm::DisableIntrinsics</a></div><div class="ttdeci">cl::opt&lt; bool &gt; DisableIntrinsics(&quot;no-ir-sim-intrinsics&quot;, cl::init(false), cl::ReallyHidden, cl::desc(&quot;Don't match or outline intrinsics&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00048">IROutliner.cpp:48</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a8ad786f21829d9e92d31cc0b80c53dbb"><div class="ttname"><a href="IROutliner_8cpp.html#a8ad786f21829d9e92d31cc0b80c53dbb">getSortedConstantKeys</a></div><div class="ttdeci">static void getSortedConstantKeys(std::vector&lt; Value * &gt; &amp;SortedKeys, DenseMap&lt; Value *, BasicBlock * &gt; &amp;Map)</div><div class="ttdoc">A function to sort the keys of Map, which must be a mapping of constant values to basic blocks and re...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00168">IROutliner.cpp:168</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AttributeFuncs_html_aab96d8eec2287f142354ff6d8f3bba27"><div class="ttname"><a href="namespacellvm_1_1AttributeFuncs.html#aab96d8eec2287f142354ff6d8f3bba27">llvm::AttributeFuncs::mergeAttributesForOutlining</a></div><div class="ttdeci">void mergeAttributesForOutlining(Function &amp;Base, const Function &amp;ToMerge)</div><div class="ttdoc">Merges the functions attributes from ToMerge into function Base.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l02133">Attributes.cpp:2133</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac77dbedcfd916a5c9b58e753b2678a98"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac77dbedcfd916a5c9b58e753b2678a98">llvm::TargetTransformInfo::getInstructionCost</a></div><div class="ttdeci">InstructionCost getInstructionCost(const User *U, ArrayRef&lt; const Value * &gt; Operands, TargetCostKind CostKind) const</div><div class="ttdoc">Estimate the cost of a given IR user when lowered.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00230">TargetTransformInfo.cpp:230</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a3afc8c0c69b0c55edce3be13d5b7cc32"><div class="ttname"><a href="IROutliner_8cpp.html#a3afc8c0c69b0c55edce3be13d5b7cc32">moveBBContents</a></div><div class="ttdeci">static void moveBBContents(BasicBlock &amp;SourceBB, BasicBlock &amp;TargetBB)</div><div class="ttdoc">Move the contents of SourceBB to before the last instruction of TargetBB.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00158">IROutliner.cpp:158</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a25b29490419d6ea97ce7d79dc58f306d"><div class="ttname"><a href="structOutlinableGroup.html#a25b29490419d6ea97ce7d79dc58f306d">OutlinableGroup::ArgumentTypes</a></div><div class="ttdeci">std::vector&lt; Type * &gt; ArgumentTypes</div><div class="ttdoc">The argument types for the function created as the overall function to replace the extracted function...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00080">IROutliner.cpp:80</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7dc3069afa2ce5ea62ac2eb183e51c00"><div class="ttname"><a href="namespacellvm.html#a7dc3069afa2ce5ea62ac2eb183e51c00">llvm::none_of</a></div><div class="ttdeci">bool none_of(R &amp;&amp;Range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::none_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01749">STLExtras.h:1749</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html"><div class="ttname"><a href="classllvm_1_1ReturnInst.html">llvm::ReturnInst</a></div><div class="ttdoc">Return a value (possibly void), from a function.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03057">Instructions.h:3057</a></div></div>
<div class="ttc" id="astructllvm_1_1IRSimilarity_1_1IRInstructionDataList_html"><div class="ttname"><a href="structllvm_1_1IRSimilarity_1_1IRInstructionDataList.html">llvm::IRSimilarity::IRInstructionDataList</a></div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00298">IRSimilarityIdentifier.h:298</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a9b0ebfeb3f47f1ad763e5b184dcb4e03"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a9b0ebfeb3f47f1ad763e5b184dcb4e03">llvm::RegionBase::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00561">RegionInfo.h:561</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a6a49e446ebdd2bd5e15c9631813c27aa"><div class="ttname"><a href="IROutliner_8cpp.html#a6a49e446ebdd2bd5e15c9631813c27aa">findOutputMapping</a></div><div class="ttdeci">static Value * findOutputMapping(const DenseMap&lt; Value *, Value * &gt; OutputMappings, Value *Input)</div><div class="ttdoc">Check the OutputMappings structure for value Input, if it exists it has been used as an output for ou...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00535">IROutliner.cpp:535</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html"><div class="ttname"><a href="classllvm_1_1DIBuilder.html">llvm::DIBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8h_source.html#l00042">DIBuilder.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aDebugInfoMetadata_8h_html"><div class="ttname"><a href="DebugInfoMetadata_8h.html">DebugInfoMetadata.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a9c38a8cc0a38636c95bd2826de9d72d4"><div class="ttname"><a href="classllvm_1_1Function.html#a9c38a8cc0a38636c95bd2826de9d72d4">llvm::Function::hasOptNone</a></div><div class="ttdeci">bool hasOptNone() const</div><div class="ttdoc">Do not optimize this function (-O0).</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00638">Function.h:638</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a3ec78a759f1f4420da6201c3010954f8"><div class="ttname"><a href="IROutliner_8cpp.html#a3ec78a759f1f4420da6201c3010954f8">getPassedArgumentInAlreadyOutlinedFunction</a></div><div class="ttdeci">static Value * getPassedArgumentInAlreadyOutlinedFunction(const Argument *A, const OutlinableRegion &amp;Region)</div><div class="ttdoc">For the function call now representing the Region, find the passed value to that call that represents...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01599">IROutliner.cpp:1599</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_ad67fb96194cff11216803ad74dba5687"><div class="ttname"><a href="structOutlinableGroup.html#ad67fb96194cff11216803ad74dba5687">OutlinableGroup::collectGVNStoreSets</a></div><div class="ttdeci">void collectGVNStoreSets(Module &amp;M)</div><div class="ttdoc">For the regions, look at each set of GVN stores needed and account for each combination.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00610">IROutliner.cpp:610</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af89277d8bd76d6348291e29b6076796a"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af89277d8bd76d6348291e29b6076796a">llvm::TargetTransformInfo::getCmpSelInstrCost</a></div><div class="ttdeci">InstructionCost getCmpSelInstrCost(unsigned Opcode, Type *ValTy, Type *CondTy, CmpInst::Predicate VecPred, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, const Instruction *I=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00897">TargetTransformInfo.cpp:897</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a91bd28adea418a08cec78b72413d9d45"><div class="ttname"><a href="classllvm_1_1Instruction.html#a91bd28adea418a08cec78b72413d9d45">llvm::Instruction::getNextNonDebugInstruction</a></div><div class="ttdeci">const Instruction * getNextNonDebugInstruction(bool SkipPseudoOp=false) const</div><div class="ttdoc">Return a pointer to the next non-debug instruction in the same basic block as 'this',...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00786">Instruction.cpp:786</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a8a8e100a9a4c618756cbfc6286ae0e71"><div class="ttname"><a href="structOutlinableGroup.html#a8a8e100a9a4c618756cbfc6286ae0e71">OutlinableGroup::EndBBs</a></div><div class="ttdeci">DenseMap&lt; Value *, BasicBlock * &gt; EndBBs</div><div class="ttdoc">The return blocks for the overall function.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00091">IROutliner.cpp:91</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html"><div class="ttname"><a href="classllvm_1_1Attribute.html">llvm::Attribute</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00067">Attributes.h:67</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a8120984c169f2ea17e785e7c6887702a"><div class="ttname"><a href="IROutliner_8cpp.html#a8120984c169f2ea17e785e7c6887702a">createAndInsertBasicBlocks</a></div><div class="ttdeci">static void createAndInsertBasicBlocks(DenseMap&lt; Value *, BasicBlock * &gt; &amp;OldMap, DenseMap&lt; Value *, BasicBlock * &gt; &amp;NewMap, Function *ParentFunc, Twine BaseName)</div><div class="ttdoc">Takes in a mapping, OldMap of ConstantValues to BasicBlocks, sorts keys, before creating a basic bloc...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02131">IROutliner.cpp:2131</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a53e3a8f28cb8e7a01334b7560467d9ea"><div class="ttname"><a href="structOutlinableGroup.html#a53e3a8f28cb8e7a01334b7560467d9ea">OutlinableGroup::OutputGVNCombinations</a></div><div class="ttdeci">DenseSet&lt; ArrayRef&lt; unsigned &gt; &gt; OutputGVNCombinations</div><div class="ttdoc">A set containing the different GVN store sets needed.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00100">IROutliner.cpp:100</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__string__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__string__ostream.html">llvm::raw_string_ostream</a></div><div class="ttdoc">A raw_ostream that writes to an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00642">raw_ostream.h:642</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a18b9d328d2490f447589ba60345eba6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">llvm::SetVector::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">Determine the number of elements in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00077">SetVector.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a2069641f358ef416658a2f321ca19d74"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a2069641f358ef416658a2f321ca19d74">llvm::BasicBlock::instructionsWithoutDebug</a></div><div class="ttdeci">iterator_range&lt; filter_iterator&lt; BasicBlock::const_iterator, std::function&lt; bool(const Instruction &amp;)&gt; &gt; &gt; instructionsWithoutDebug(bool SkipPseudoOp=true) const</div><div class="ttdoc">Return a const iterator range over the instructions in the block, skipping any debug instructions.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00103">BasicBlock.cpp:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarityAnalysis_html"><div class="ttname"><a href="classllvm_1_1IRSimilarityAnalysis.html">llvm::IRSimilarityAnalysis</a></div><div class="ttdoc">An analysis pass that runs and returns the IRSimilarityIdentifier run on the Module.</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l01116">IRSimilarityIdentifier.h:1116</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html_a87e923648048258a6e8376d6cf4ce565"><div class="ttname"><a href="classllvm_1_1ReturnInst.html#a87e923648048258a6e8376d6cf4ce565">llvm::ReturnInst::getReturnValue</a></div><div class="ttdeci">Value * getReturnValue() const</div><div class="ttdoc">Convenience accessor. Returns null if there is no return value.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03102">Instructions.h:3102</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; unsigned, 2 &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SwitchInst_html_a68553b9dbdbf2d12b5c9511fd62c2ef7"><div class="ttname"><a href="classllvm_1_1SwitchInst.html#a68553b9dbdbf2d12b5c9511fd62c2ef7">llvm::SwitchInst::Create</a></div><div class="ttdeci">static SwitchInst * Create(Value *Value, BasicBlock *Default, unsigned NumCases, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03472">Instructions.h:3472</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ad8c5093a18a40f863d4fc5fa6eefefa8"><div class="ttname"><a href="classllvm_1_1Instruction.html#ad8c5093a18a40f863d4fc5fa6eefefa8">llvm::Instruction::insertInto</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator insertInto(BasicBlock *ParentBB, SymbolTableList&lt; Instruction &gt;::iterator It)</div><div class="ttdoc">Inserts an unlinked instruction into ParentBB at position It and returns the iterator of the inserted...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00098">Instruction.cpp:98</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_ae6a4da5f41fc6a36735cc1704c01ce60"><div class="ttname"><a href="classllvm_1_1Function.html#ae6a4da5f41fc6a36735cc1704c01ce60">llvm::Function::getEntryBlock</a></div><div class="ttdeci">const BasicBlock &amp; getEntryBlock() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00735">Function.h:735</a></div></div>
<div class="ttc" id="aARMLowOverheadLoops_8cpp_html_a3bf42baf773b375802538951c88d8e12"><div class="ttname"><a href="ARMLowOverheadLoops_8cpp.html#a3bf42baf773b375802538951c88d8e12">ToRemove</a></div><div class="ttdeci">ReachingDefAnalysis InstSet &amp; ToRemove</div><div class="ttdef"><b>Definition:</b> <a href="ARMLowOverheadLoops_8cpp_source.html#l00547">ARMLowOverheadLoops.cpp:547</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a089e003bb688e55b9a91ed4e7fed3678"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a089e003bb688e55b9a91ed4e7fed3678">llvm::BasicBlock::replaceSuccessorsPhiUsesWith</a></div><div class="ttdeci">void replaceSuccessorsPhiUsesWith(BasicBlock *Old, BasicBlock *New)</div><div class="ttdoc">Update all phi nodes in this basic block's successors to refer to basic block New instead of basic bl...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00498">BasicBlock.cpp:498</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_a93f165686cbc3ed0554ec8431f9c9b21"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a93f165686cbc3ed0554ec8431f9c9b21">llvm::IRSimilarity::IRSimilarityCandidate::getBasicBlocks</a></div><div class="ttdeci">void getBasicBlocks(DenseSet&lt; BasicBlock * &gt; &amp;BBSet) const</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00832">IRSimilarityIdentifier.h:832</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a61915f6a6a382f51fd1a8bf3dd188c0c"><div class="ttname"><a href="structOutlinableGroup.html#a61915f6a6a382f51fd1a8bf3dd188c0c">OutlinableGroup::findSameConstants</a></div><div class="ttdeci">void findSameConstants(DenseSet&lt; unsigned &gt; &amp;NotSame)</div><div class="ttdoc">For the Regions, we look at every Value.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00603">IROutliner.cpp:603</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a0d093de2575838ee30b3fbce09a020ff"><div class="ttname"><a href="structOutlinableGroup.html#a0d093de2575838ee30b3fbce09a020ff">OutlinableGroup::SwiftErrorArgument</a></div><div class="ttdeci">std::optional&lt; unsigned &gt; SwiftErrorArgument</div><div class="ttdoc">The argument that needs to be marked with the swifterr attribute.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00137">IROutliner.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a7e89b55242c964ae61b7850e99cacef0"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">llvm::FunctionType::get</a></div><div class="ttdeci">static FunctionType * get(Type *Result, ArrayRef&lt; Type * &gt; Params, bool isVarArg)</div><div class="ttdoc">This static method is the primary way of constructing a FunctionType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00363">Type.cpp:363</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a482498a1c760122fd33c7fc8190dd277"><div class="ttname"><a href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">llvm::Instruction::insertBefore</a></div><div class="ttdeci">void insertBefore(Instruction *InsertPos)</div><div class="ttdoc">Insert an unlinked instruction into a basic block immediately before the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00088">Instruction.cpp:88</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a21da4953c61d301ca9402aed0ed89bd2"><div class="ttname"><a href="IROutliner_8cpp.html#a21da4953c61d301ca9402aed0ed89bd2">EnableLinkOnceODRIROutlining</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableLinkOnceODRIROutlining(&quot;enable-linkonceodr-ir-outlining&quot;, cl::Hidden, cl::desc(&quot;Enable the IR outliner on linkonceodr functions&quot;), cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a706f223f760b55668fbae74202b816bba737cfc93e5a2ff961677d57186167e7c">llvm::TargetTransformInfo::TCK_CodeSize</a></div><div class="ttdeci">@ TCK_CodeSize</div><div class="ttdoc">Instruction code size.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00244">TargetTransformInfo.h:244</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_acda959f961048eba09125aba48d1142e"><div class="ttname"><a href="IROutliner_8cpp.html#acda959f961048eba09125aba48d1142e">findConstants</a></div><div class="ttdeci">static void findConstants(IRSimilarityCandidate &amp;C, DenseSet&lt; unsigned &gt; &amp;NotSame, std::vector&lt; unsigned &gt; &amp;Inputs)</div><div class="ttdoc">Find the the constants that will need to be lifted into arguments as they are not the same in each in...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00782">IROutliner.cpp:782</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a31e8da5adf63afd38b4ab94bca823150"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a31e8da5adf63afd38b4ab94bca823150">llvm::ConstantInt::getLimitedValue</a></div><div class="ttdeci">uint64_t getLimitedValue(uint64_t Limit=~0ULL) const</div><div class="ttdoc">getLimitedValue - If the value is smaller than the specified limit, return it, otherwise return the l...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00243">Constants.h:243</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_aab2165e523387ae034bc2117b13c5d51"><div class="ttname"><a href="structOutlinableGroup.html#aab2165e523387ae034bc2117b13c5d51">OutlinableGroup::OutlinedFunctionType</a></div><div class="ttdeci">FunctionType * OutlinedFunctionType</div><div class="ttdoc">The FunctionType for the overall function.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00082">IROutliner.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocation_html"><div class="ttname"><a href="classllvm_1_1DILocation.html">llvm::DILocation</a></div><div class="ttdoc">Debug location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01605">DebugInfoMetadata.h:1605</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a8e5c4577c64728c435eca5f4f7e163ab"><div class="ttname"><a href="IROutliner_8cpp.html#a8e5c4577c64728c435eca5f4f7e163ab">replaceTargetsFromPHINode</a></div><div class="ttdeci">static void replaceTargetsFromPHINode(BasicBlock *PHIBlock, BasicBlock *Find, BasicBlock *Replace, DenseSet&lt; BasicBlock * &gt; &amp;Included)</div><div class="ttdoc">Rewrite the BranchInsts in the incoming blocks to PHIBlock that are found in Included to branch to Ba...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00225">IROutliner.cpp:225</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a9fffac2512fe651f0d5e37e27f5bd51c"><div class="ttname"><a href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">llvm::Function::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">getContext - Return a reference to the LLVMContext associated with this function.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00315">Function.cpp:315</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_ac6baa801e4aea800984e760d5460662f"><div class="ttname"><a href="classllvm_1_1Function.html#ac6baa801e4aea800984e760d5460662f">llvm::Function::arg_size</a></div><div class="ttdeci">size_t arg_size() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00799">Function.h:799</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a55ffacfbd9b6de5eb90a9f443001e3a6"><div class="ttname"><a href="classllvm_1_1SetVector.html#a55ffacfbd9b6de5eb90a9f443001e3a6">llvm::SetVector::getArrayRef</a></div><div class="ttdeci">ArrayRef&lt; T &gt; getArrayRef() const</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00063">SetVector.h:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8dd327a937563afdb08250abc43820b0"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8dd327a937563afdb08250abc43820b0">llvm::BasicBlock::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; BasicBlock &gt;::iterator eraseFromParent()</div><div class="ttdoc">Unlink 'this' from the containing function and delete it.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00132">BasicBlock.cpp:132</a></div></div>
<div class="ttc" id="anamespacellvm_html_a93b773511cf2c25df41bdd74e8718bd3"><div class="ttname"><a href="namespacellvm.html#a93b773511cf2c25df41bdd74e8718bd3">llvm::DisableBranches</a></div><div class="ttdeci">cl::opt&lt; bool &gt; DisableBranches(&quot;no-ir-sim-branch-matching&quot;, cl::init(false), cl::ReallyHidden, cl::desc(&quot;disable similarity matching, and outlining, &quot; &quot;across branches for debugging purposes.&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00040">IROutliner.cpp:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_a1cf553641e8527095ae4c8ec88a2cd92"><div class="ttname"><a href="classllvm_1_1AttributeList.html#a1cf553641e8527095ae4c8ec88a2cd92">llvm::AttributeList::getFnAttrs</a></div><div class="ttdeci">AttributeSet getFnAttrs() const</div><div class="ttdoc">The function attributes are returned.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01462">Attributes.cpp:1462</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a52c990590792c91dd20b6d45acebe359"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00401">BasicBlock.cpp:401</a></div></div>
<div class="ttc" id="anamespacellvm_1_1IRSimilarity_html_a2198f86ce16da838bdeea4de7e59ef31"><div class="ttname"><a href="namespacellvm_1_1IRSimilarity.html#a2198f86ce16da838bdeea4de7e59ef31">llvm::IRSimilarity::SimilarityGroup</a></div><div class="ttdeci">std::vector&lt; IRSimilarityCandidate &gt; SimilarityGroup</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00953">IRSimilarityIdentifier.h:953</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_af7b131843b386c6e3cc39bd6f8141357"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#af7b131843b386c6e3cc39bd6f8141357">llvm::TargetTransformInfo::getCFInstrCost</a></div><div class="ttdeci">InstructionCost getCFInstrCost(unsigned Opcode, TTI::TargetCostKind CostKind=TTI::TCK_SizeAndLatency, const Instruction *I=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00888">TargetTransformInfo.cpp:888</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a96b8f11f6f21ca0321294669dab83b35"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a96b8f11f6f21ca0321294669dab83b35">llvm::BranchInst::getNumSuccessors</a></div><div class="ttdeci">unsigned getNumSuccessors() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03230">Instructions.h:3230</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a59fb91d1691350f7d1b8e8a114e3f2a4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">llvm::BasicBlock::getSinglePredecessor</a></div><div class="ttdeci">const BasicBlock * getSinglePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a single predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00284">BasicBlock.cpp:284</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_abb75d7b6c8ca68d35e459834c5616e00"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#abb75d7b6c8ca68d35e459834c5616e00">llvm::IRSimilarity::IRSimilarityCandidate::getGVN</a></div><div class="ttdeci">std::optional&lt; unsigned &gt; getGVN(Value *V)</div><div class="ttdoc">Finds the positive number associated with V if it has been mapped.</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00892">IRSimilarityIdentifier.h:892</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_ab0fcb9c00a8bc3f94f45d301d163452f"><div class="ttname"><a href="IROutliner_8cpp.html#ab0fcb9c00a8bc3f94f45d301d163452f">findCanonNumsForPHI</a></div><div class="ttdeci">static void findCanonNumsForPHI(PHINode *PN, OutlinableRegion &amp;Region, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, SmallVector&lt; std::pair&lt; unsigned, BasicBlock * &gt;&gt; &amp;CanonNums, bool ReplacedWithOutlinedCall=true)</div><div class="ttdoc">Find the canonical numbering for the incoming Values into the PHINode PN.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01640">IROutliner.cpp:1640</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00264">Instructions.h:264</a></div></div>
<div class="ttc" id="anamespacellvm_1_1IRSimilarity_html_a1e2d2e59b2467bacdc6db54dcc9bc4a1"><div class="ttname"><a href="namespacellvm_1_1IRSimilarity.html#a1e2d2e59b2467bacdc6db54dcc9bc4a1">llvm::IRSimilarity::SimilarityGroupList</a></div><div class="ttdeci">std::vector&lt; SimilarityGroup &gt; SimilarityGroupList</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00954">IRSimilarityIdentifier.h:954</a></div></div>
<div class="ttc" id="aclassllvm_1_1Mangler_html"><div class="ttname"><a href="classllvm_1_1Mangler.html">llvm::Mangler</a></div><div class="ttdef"><b>Definition:</b> <a href="Mangler_8h_source.html#l00027">Mangler.h:27</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a95133d99b799f98e5c92dacc3028c621"><div class="ttname"><a href="structOutlinableGroup.html#a95133d99b799f98e5c92dacc3028c621">OutlinableGroup::OutlinedFunction</a></div><div class="ttdeci">Function * OutlinedFunction</div><div class="ttdoc">The Function for the collective overall function.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00084">IROutliner.cpp:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a79eed48913651aeedda2eed25201ea84"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">llvm::detail::DenseSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00206">DenseSet.h:206</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a88cdefb709309eddc6e5daca0be6a7b4"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">llvm::PHINode::setIncomingValue</a></div><div class="ttdeci">void setIncomingValue(unsigned i, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02797">Instructions.h:2797</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40ab81f279502bb9ca74e6629cfb62844be">llvm::cl::ReallyHidden</a></div><div class="ttdeci">@ ReallyHidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00139">CommandLine.h:139</a></div></div>
<div class="ttc" id="aclassllvm_1_1IROutlinerPass_html_a5b9a8fe2c3b6834817b2c12b08441cff"><div class="ttname"><a href="classllvm_1_1IROutlinerPass.html#a5b9a8fe2c3b6834817b2c12b08441cff">llvm::IROutlinerPass::run</a></div><div class="ttdeci">PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l03027">IROutliner.cpp:3027</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a406e4a6b7277aab7efd423ae30a9fb12"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a406e4a6b7277aab7efd423ae30a9fb12">llvm::DominatorTreeBase::getDescendants</a></div><div class="ttdeci">void getDescendants(NodeT *R, SmallVectorImpl&lt; NodeT * &gt; &amp;Result) const</div><div class="ttdoc">Get all nodes dominated by R, including R itself.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00390">GenericDomTree.h:390</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a30dd396c5b40cd86c1591872e574ccdf"><div class="ttname"><a href="classllvm_1_1Type.html#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a></div><div class="ttdeci">static IntegerType * getInt32Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00241">Type.cpp:241</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDNode_html_a7d10a7b9b7f40b04d27ed97c38ea1950"><div class="ttname"><a href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">llvm::MDNode::get</a></div><div class="ttdeci">static MDTuple * get(LLVMContext &amp;Context, ArrayRef&lt; Metadata * &gt; MDs)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l01399">Metadata.h:1399</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_adc5e7f9c460c68455e826783d77f9a99"><div class="ttname"><a href="classllvm_1_1BranchInst.html#adc5e7f9c460c68455e826783d77f9a99">llvm::BranchInst::setSuccessor</a></div><div class="ttdeci">void setSuccessor(unsigned idx, BasicBlock *NewSucc)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03237">Instructions.h:3237</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a84e785627d5ab55370b5fa402ad7193f"><div class="ttname"><a href="IROutliner_8cpp.html#a84e785627d5ab55370b5fa402ad7193f">outputHasNonPHI</a></div><div class="ttdeci">static bool outputHasNonPHI(Value *V, unsigned PHILoc, PHINode &amp;PN, SmallPtrSet&lt; BasicBlock *, 1 &gt; &amp;Exits, DenseSet&lt; BasicBlock * &gt; &amp;BlocksInRegion)</div><div class="ttdoc">Check if the V has any uses outside of the region other than PN.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01040">IROutliner.cpp:1040</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a57f1945911ca1e95d0f51d7c3516b529"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">llvm::BasicBlock::getUniqueSuccessor</a></div><div class="ttdeci">const BasicBlock * getUniqueSuccessor() const</div><div class="ttdoc">Return the successor of this block if it has a unique successor.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00322">BasicBlock.cpp:322</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a8a67c950f093761829058d45fbc3f522">llvm::AArch64PACKey::DB</a></div><div class="ttdeci">@ DB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00794">AArch64BaseInfo.h:794</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a98897a3d01f6a4d7f10a5ac8fe862c82"><div class="ttname"><a href="classllvm_1_1Value.html#a98897a3d01f6a4d7f10a5ac8fe862c82">llvm::Value::isSwiftError</a></div><div class="ttdeci">bool isSwiftError() const</div><div class="ttdoc">Return true if this value is a swifterror value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l01015">Value.cpp:1015</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2145da5bde7663d745e9c3ade392809f"><div class="ttname"><a href="namespacellvm.html#a2145da5bde7663d745e9c3ade392809f">llvm::interleave</a></div><div class="ttdeci">void interleave(ForwardIterator begin, ForwardIterator end, UnaryFunctor each_fn, NullaryFunctor between_fn)</div><div class="ttdoc">An STL-style algorithm similar to std::for_each that applies a second functor between every pair of e...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02060">STLExtras.h:2060</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a75bbc3b17e5b70e0e1fac394f26b5c11"><div class="ttname"><a href="structOutlinableGroup.html#a75bbc3b17e5b70e0e1fac394f26b5c11">OutlinableGroup::Regions</a></div><div class="ttdeci">std::vector&lt; OutlinableRegion * &gt; Regions</div><div class="ttdoc">The sections that could be outlined.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00076">IROutliner.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a57d54880afa1fb74833cc7c43ad33377"><div class="ttname"><a href="IROutliner_8cpp.html#a57d54880afa1fb74833cc7c43ad33377">analyzeAndPruneOutputBlocks</a></div><div class="ttdeci">static bool analyzeAndPruneOutputBlocks(DenseMap&lt; Value *, BasicBlock * &gt; &amp;BlocksToPrune, OutlinableRegion &amp;Region)</div><div class="ttdoc">Remove empty output blocks from the outlined region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02029">IROutliner.cpp:2029</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a16c39eb6e60b42a40c399d8d65347bb6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const</div><div class="ttdoc">Return incoming value number x.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02794">Instructions.h:2794</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="IROutliner_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00032">IROutliner.cpp:32</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">InlinePriorityMode::Cost</a></div><div class="ttdeci">@ Cost</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a4eb66b98a828331ed6cb79ae82c0336f"><div class="ttname"><a href="IROutliner_8cpp.html#a4eb66b98a828331ed6cb79ae82c0336f">findExtractedOutputToOverallOutputMapping</a></div><div class="ttdeci">static void findExtractedOutputToOverallOutputMapping(Module &amp;M, OutlinableRegion &amp;Region, SetVector&lt; Value * &gt; &amp;Outputs)</div><div class="ttdoc">Create a mapping of the output arguments for the Region to the output arguments of the overall outlin...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01280">IROutliner.cpp:1280</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a51145a3ae24ea73b3692a17088edea7b"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a51145a3ae24ea73b3692a17088edea7b">llvm::DominatorTreeBase::insertEdge</a></div><div class="ttdeci">void insertEdge(NodeT *From, NodeT *To)</div><div class="ttdoc">Inform the dominator tree about a CFG edge insertion and update the tree.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00601">GenericDomTree.h:601</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a72b89466c3b2fd45331e2c315e2c33e5"><div class="ttname"><a href="structOutlinableGroup.html#a72b89466c3b2fd45331e2c315e2c33e5">OutlinableGroup::PHINodeGVNTracker</a></div><div class="ttdeci">unsigned PHINodeGVNTracker</div><div class="ttdoc">Tracker counting backwards from the highest unsigned value possible to avoid conflicting with the GVN...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00121">IROutliner.cpp:121</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a78f1513d0fadc0e72c1c7373c2003666"><div class="ttname"><a href="structOutlinableGroup.html#a78f1513d0fadc0e72c1c7373c2003666">OutlinableGroup::GVNsToPHINodeGVN</a></div><div class="ttdeci">DenseMap&lt; hash_code, unsigned &gt; GVNsToPHINodeGVN</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00126">IROutliner.cpp:126</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_aeab6020692f93361cff45734711204fc"><div class="ttname"><a href="structOutlinableGroup.html#aeab6020692f93361cff45734711204fc">OutlinableGroup::NumAggregateInputs</a></div><div class="ttdeci">unsigned NumAggregateInputs</div><div class="ttdoc">The number of input values in ArgumentTypes.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00108">IROutliner.cpp:108</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a9148948069532c9a5e1b59e3668b8cc3"><div class="ttname"><a href="IROutliner_8cpp.html#a9148948069532c9a5e1b59e3668b8cc3">findExtractedInputToOverallInputMapping</a></div><div class="ttdeci">static void findExtractedInputToOverallInputMapping(OutlinableRegion &amp;Region, std::vector&lt; unsigned &gt; &amp;InputGVNs, SetVector&lt; Value * &gt; &amp;ArgInputs)</div><div class="ttdoc">Look over the inputs and map each input argument to an argument in the overall function for the Outli...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00938">IROutliner.cpp:938</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_a850d8262cd900958b3153c4aa080b2bb"><div class="ttname"><a href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">llvm::CallInst::Create</a></div><div class="ttdeci">static CallInst * Create(FunctionType *Ty, Value *F, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01528">Instructions.h:1528</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a9fabb6e6f74e4ef23575f45ea098b827"><div class="ttname"><a href="structOutlinableGroup.html#a9fabb6e6f74e4ef23575f45ea098b827">OutlinableGroup::InputTypesSet</a></div><div class="ttdeci">bool InputTypesSet</div><div class="ttdoc">Flag for whether the ArgumentTypes have been defined after the extraction of the first region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00104">IROutliner.cpp:104</a></div></div>
<div class="ttc" id="aclassllvm_1_1Mangler_html_aa1c9296fd511eb96bb487befbf5e7cea"><div class="ttname"><a href="classllvm_1_1Mangler.html#aa1c9296fd511eb96bb487befbf5e7cea">llvm::Mangler::getNameWithPrefix</a></div><div class="ttdeci">void getNameWithPrefix(raw_ostream &amp;OS, const GlobalValue *GV, bool CannotUsePrivateLabel) const</div><div class="ttdoc">Print the appropriate prefix and the specified global variable's name.</div><div class="ttdef"><b>Definition:</b> <a href="Mangler_8cpp_source.html#l00119">Mangler.cpp:119</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a9a025cb106832026cd05c2b4648a699f"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a9a025cb106832026cd05c2b4648a699f">llvm::detail::DenseSetImpl::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00081">DenseSet.h:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_aa6ba58912bb6dedee6cc22f00c521525"><div class="ttname"><a href="IROutliner_8cpp.html#aa6ba58912bb6dedee6cc22f00c521525">findOrCreatePHIBlock</a></div><div class="ttdeci">static BasicBlock * findOrCreatePHIBlock(OutlinableGroup &amp;Group, Value *RetVal)</div><div class="ttdoc">Find or create a BasicBlock in the outlined function containing PhiBlocks for RetVal.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01546">IROutliner.cpp:1546</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a72516971c5734dc0f7546e64affca425"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">llvm::BasicBlock::phis</a></div><div class="ttdeci">iterator_range&lt; const_phi_iterator &gt; phis() const</div><div class="ttdoc">Returns a range that iterates over the phis in the basic block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00372">BasicBlock.h:372</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a50a2e57da274f8d69b9f932977379cdf"><div class="ttname"><a href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">llvm::Use::getUser</a></div><div class="ttdeci">User * getUser() const</div><div class="ttdoc">Returns the User that contains this Use.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00072">Use.h:72</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a9165dd298666d75ed2e5be7d5d8b50e5"><div class="ttname"><a href="IROutliner_8cpp.html#a9165dd298666d75ed2e5be7d5d8b50e5">mapInputsToGVNs</a></div><div class="ttdeci">static void mapInputsToGVNs(IRSimilarityCandidate &amp;C, SetVector&lt; Value * &gt; &amp;CurrentInputs, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, std::vector&lt; unsigned &gt; &amp;EndInputNumbers)</div><div class="ttdoc">Find the GVN for the inputs that have been found by the CodeExtractor.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00812">IROutliner.cpp:812</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_af5d7aa7988108e9377f154cf6a22f02b"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#af5d7aa7988108e9377f154cf6a22f02b">llvm::OutlinableRegion::reattachCandidate</a></div><div class="ttdeci">void reattachCandidate()</div><div class="ttdoc">For the contained region, reattach the BasicBlock at the starting and ending instructions of the cont...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00380">IROutliner.cpp:380</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_a262d2672038afdeba85e23a30ea4c22d"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#a262d2672038afdeba85e23a30ea4c22d">llvm::OutlinableRegion::OutputBlockNum</a></div><div class="ttdeci">unsigned OutputBlockNum</div><div class="ttdoc">The corresponding BasicBlock with the appropriate stores for this OutlinableRegion in the overall fun...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8h_source.html#l00078">IROutliner.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">llvm::GlobalValue::InternalLinkage</a></div><div class="ttdeci">@ InternalLinkage</div><div class="ttdoc">Rename collisions when linking (static functions).</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00055">GlobalValue.h:55</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_a7e03ba3e02776435b130c487f13289be"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#a7e03ba3e02776435b130c487f13289be">llvm::OutlinableRegion::findCorrespondingValueIn</a></div><div class="ttdeci">Value * findCorrespondingValueIn(const OutlinableRegion &amp;Other, Value *V)</div><div class="ttdoc">Find a corresponding value for V in similar OutlinableRegion Other.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00191">IROutliner.cpp:191</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1Metadata_html"><div class="ttname"><a href="classllvm_1_1Metadata.html">llvm::Metadata</a></div><div class="ttdoc">Root of the metadata hierarchy.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00061">Metadata.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aef51af4b490af6b3bf2dfbc8737a8f9f"><div class="ttname"><a href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const</div><div class="ttdoc">Return the number of incoming edges.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02790">Instructions.h:2790</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a09e9f16b4a1aaf539000b95bf5442155"><div class="ttname"><a href="IROutliner_8cpp.html#a09e9f16b4a1aaf539000b95bf5442155">remapExtractedInputs</a></div><div class="ttdeci">static void remapExtractedInputs(const ArrayRef&lt; Value * &gt; ArgInputs, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, SetVector&lt; Value * &gt; &amp;RemappedArgInputs)</div><div class="ttdoc">Find the original value for the ArgInput values if any one of them was replaced during a previous ext...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00837">IROutliner.cpp:837</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a7477aafbbe989ad35b96fac186d8e9fd"><div class="ttname"><a href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the attribute list for this Function.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00313">Function.h:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_a5fd2e1a8a3658307e8c0d87a153d8c24"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a5fd2e1a8a3658307e8c0d87a153d8c24">llvm::IRSimilarity::IRSimilarityCandidate::getEndIdx</a></div><div class="ttdeci">unsigned getEndIdx() const</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00868">IRSimilarityIdentifier.h:868</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_ac3c1798aada6da8b72185545e4944c25"><div class="ttname"><a href="structOutlinableGroup.html#ac3c1798aada6da8b72185545e4944c25">OutlinableGroup::CanonicalNumberToAggArg</a></div><div class="ttdeci">DenseMap&lt; unsigned, unsigned &gt; CanonicalNumberToAggArg</div><div class="ttdoc">The mapping of the canonical numbering of the values in outlined sections to specific arguments.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00112">IROutliner.cpp:112</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_a086b69a5012fff81b179e92d137aae33"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#a086b69a5012fff81b179e92d137aae33">llvm::OutlinableRegion::getBenefit</a></div><div class="ttdeci">InstructionCost getBenefit(TargetTransformInfo &amp;TTI)</div><div class="ttdoc">Get the size of the code removed from the region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00491">IROutliner.cpp:491</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet</a></div><div class="ttdoc">Implements a dense probed hash-table based set.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00268">DenseSet.h:268</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_a1d8ba16c81726545b0e8503ac784d939"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a1d8ba16c81726545b0e8503ac784d939">llvm::IRSimilarity::IRSimilarityCandidate::getFunction</a></div><div class="ttdeci">Function * getFunction()</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00886">IRSimilarityIdentifier.h:886</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_afb28a4deafe2954b0534cc6399ce518b"><div class="ttname"><a href="classllvm_1_1Function.html#afb28a4deafe2954b0534cc6399ce518b">llvm::Function::hasFnAttribute</a></div><div class="ttdeci">bool hasFnAttribute(Attribute::AttrKind Kind) const</div><div class="ttdoc">Return true if the function has the attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00640">Function.cpp:640</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_acdc2a32b416aa0739ab483a4283c5dd2"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#acdc2a32b416aa0739ab483a4283c5dd2">llvm::IRSimilarity::IRSimilarityCandidate::getStartBB</a></div><div class="ttdeci">BasicBlock * getStartBB()</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00881">IRSimilarityIdentifier.h:881</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_ad5dce467e0d3954ba812f2e9611810b4"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#ad5dce467e0d3954ba812f2e9611810b4">llvm::OutlinableRegion::ExtractedFunction</a></div><div class="ttdeci">Function * ExtractedFunction</div><div class="ttdoc">The function for the extracted region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8h_source.html#l00126">IROutliner.h:126</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_aa10ee7493bddf2c751ca6e05451ef410"><div class="ttname"><a href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a25ae47427f2c6650aee974be344ca27d"><div class="ttname"><a href="IROutliner_8cpp.html#a25ae47427f2c6650aee974be344ca27d">getGVNForPHINode</a></div><div class="ttdeci">static std::optional&lt; unsigned &gt; getGVNForPHINode(OutlinableRegion &amp;Region, PHINode *PN, DenseSet&lt; BasicBlock * &gt; &amp;Blocks, unsigned AggArgIdx)</div><div class="ttdoc">Create a special GVN for PHINodes that will be used outside of the region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01178">IROutliner.cpp:1178</a></div></div>
<div class="ttc" id="aclassllvm_1_1simple__ilist_html_a1ca0d3bb44034ff5937d97824d53b0be"><div class="ttname"><a href="classllvm_1_1simple__ilist.html#a1ca0d3bb44034ff5937d97824d53b0be">llvm::simple_ilist&lt; IRInstructionData, ilist_sentinel_tracking&lt; true &gt; &gt;::iterator</a></div><div class="ttdeci">ilist_iterator&lt; OptionsT, false, false &gt; iterator</div><div class="ttdef"><b>Definition:</b> <a href="simple__ilist_8h_source.html#l00095">simple_ilist.h:95</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_a018669f7b1d6a21106f47398a087c30a"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#a018669f7b1d6a21106f47398a087c30a">llvm::OutlinableRegion::Call</a></div><div class="ttdeci">CallInst * Call</div><div class="ttdoc">The call site of the extracted region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8h_source.html#l00123">IROutliner.h:123</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a74dd543598519cd7f1438aa76f2c1687"><div class="ttname"><a href="IROutliner_8cpp.html#a74dd543598519cd7f1438aa76f2c1687">constantMatches</a></div><div class="ttdeci">static std::optional&lt; bool &gt; constantMatches(Value *V, unsigned GVN, DenseMap&lt; unsigned, Constant * &gt; &amp;GVNToConstant)</div><div class="ttdoc">Find whether V matches the Constants previously found for the GVN.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00468">IROutliner.cpp:468</a></div></div>
<div class="ttc" id="aclassllvm_1_1simple__ilist_html_a4b588a868b58f1ac0917a59e7c48b5cc"><div class="ttname"><a href="classllvm_1_1simple__ilist.html#a4b588a868b58f1ac0917a59e7c48b5cc">llvm::simple_ilist::erase</a></div><div class="ttdeci">iterator erase(iterator I)</div><div class="ttdoc">Remove a node by iterator; never deletes.</div><div class="ttdef"><b>Definition:</b> <a href="simple__ilist_8h_source.html#l00194">simple_ilist.h:194</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a5ba57877c55dfdbe6e3bbfdacd9ef8c1"><div class="ttname"><a href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">llvm::PHINode::setIncomingBlock</a></div><div class="ttdeci">void setIncomingBlock(unsigned i, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02833">Instructions.h:2833</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantPointerNull_html_a96f5c85e4022e369266541b2db3fda69"><div class="ttname"><a href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">llvm::ConstantPointerNull::get</a></div><div class="ttdeci">static ConstantPointerNull * get(PointerType *T)</div><div class="ttdoc">Static factory methods - Return objects of the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01707">Constants.cpp:1707</a></div></div>
<div class="ttc" id="aTransforms_2IPO_8h_html"><div class="ttname"><a href="Transforms_2IPO_8h.html">IPO.h</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a38df51256d4b415b6a817b5e1c6d4d36"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03195">Instructions.h:3195</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap&lt; Value *, BasicBlock * &gt;</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_aa4ad3c4db3597f25f2fba7a690a68bc6"><div class="ttname"><a href="structOutlinableGroup.html#aa4ad3c4db3597f25f2fba7a690a68bc6">OutlinableGroup::PHIBlocks</a></div><div class="ttdeci">DenseMap&lt; Value *, BasicBlock * &gt; PHIBlocks</div><div class="ttdoc">The PHIBlocks with their corresponding return block based on the return value as the key.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00095">IROutliner.cpp:95</a></div></div>
<div class="ttc" id="aIR_2DebugInfo_8h_html"><div class="ttname"><a href="IR_2DebugInfo_8h.html">DebugInfo.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aDIBuilder_8h_html"><div class="ttname"><a href="DIBuilder_8h.html">DIBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DICompileUnit_html"><div class="ttname"><a href="classllvm_1_1DICompileUnit.html">llvm::DICompileUnit</a></div><div class="ttdoc">Compile unit.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01363">DebugInfoMetadata.h:1363</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdoc">Class to represent pointers.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00632">DerivedTypes.h:632</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a6adbed68009f582caa84cdfd2adf36f1"><div class="ttname"><a href="classllvm_1_1Function.html#a6adbed68009f582caa84cdfd2adf36f1">llvm::Function::Create</a></div><div class="ttdeci">static Function * Create(FunctionType *Ty, LinkageTypes Linkage, unsigned AddrSpace, const Twine &amp;N=&quot;&quot;, Module *M=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00136">Function.h:136</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a52a09c04ddc4ec6d039f1f11f01d019e"><div class="ttname"><a href="IROutliner_8cpp.html#a52a09c04ddc4ec6d039f1f11f01d019e">collectRegionsConstants</a></div><div class="ttdeci">static bool collectRegionsConstants(OutlinableRegion &amp;Region, DenseMap&lt; unsigned, Constant * &gt; &amp;GVNToConstant, DenseSet&lt; unsigned &gt; &amp;NotSame)</div><div class="ttdoc">Find whether Region matches the global value numbering to Constant mapping found so far.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00554">IROutliner.cpp:554</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="astructllvm_1_1IRSimilarity_1_1IRInstructionData_html"><div class="ttname"><a href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html">llvm::IRSimilarity::IRInstructionData</a></div><div class="ttdoc">This provides the utilities for hashing an Instruction to an unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00115">IRSimilarityIdentifier.h:115</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a882dcfc2455d525e78a8bbf46863ace2"><div class="ttname"><a href="IROutliner_8cpp.html#a882dcfc2455d525e78a8bbf46863ace2">analyzeExitPHIsForOutputUses</a></div><div class="ttdeci">static void analyzeExitPHIsForOutputUses(BasicBlock *CurrentExitFromRegion, SmallPtrSet&lt; BasicBlock *, 1 &gt; &amp;PotentialExitsFromRegion, DenseSet&lt; BasicBlock * &gt; &amp;RegionBlocks, SetVector&lt; Value * &gt; &amp;Outputs, DenseSet&lt; Value * &gt; &amp;OutputsReplacedByPHINode, DenseSet&lt; Value * &gt; &amp;OutputsWithNonPhiUses)</div><div class="ttdoc">Test whether CurrentExitFromRegion contains any PhiNodes that should be considered outputs.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01097">IROutliner.cpp:1097</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">llvm::CmpInst::BAD_ICMP_PREDICATE</a></div><div class="ttdeci">@ BAD_ICMP_PREDICATE</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00751">InstrTypes.h:751</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a7872b7ab88d188303cd6764e8061fe7b"><div class="ttname"><a href="IROutliner_8cpp.html#a7872b7ab88d188303cd6764e8061fe7b">findOrCreatePHIInBlock</a></div><div class="ttdeci">static PHINode * findOrCreatePHIInBlock(PHINode &amp;PN, OutlinableRegion &amp;Region, BasicBlock *OverallPhiBlock, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, DenseSet&lt; PHINode * &gt; &amp;UsedPHIs)</div><div class="ttdoc">Find, or add PHINode PN to the combined PHINode Block OverallPHIBlock in order to condense the number...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01684">IROutliner.cpp:1684</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ae8eaa0b4eeac52a2b2282cb1bfd981ae"><div class="ttname"><a href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const</div><div class="ttdoc">Return true if this is 'void'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00140">Type.h:140</a></div></div>
<div class="ttc" id="anamespacellvm_html_a59a51d46c30287fc47551914e29de21e"><div class="ttname"><a href="namespacellvm.html#a59a51d46c30287fc47551914e29de21e">llvm::DisableIndirectCalls</a></div><div class="ttdeci">cl::opt&lt; bool &gt; DisableIndirectCalls(&quot;no-ir-sim-indirect-calls&quot;, cl::init(false), cl::ReallyHidden, cl::desc(&quot;disable outlining indirect calls.&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00044">IROutliner.cpp:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a0c2ca86fa35cc4ff2d6d1b073916191b"><div class="ttname"><a href="IROutliner_8cpp.html#a0c2ca86fa35cc4ff2d6d1b073916191b">getPassedArgumentAndAdjustArgumentLocation</a></div><div class="ttdeci">static Value * getPassedArgumentAndAdjustArgumentLocation(const Argument *A, const OutlinableRegion &amp;Region)</div><div class="ttdoc">For the function call now representing the Region, find the passed value to that call that represents...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01615">IROutliner.cpp:1615</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_a84b80673b9748e75da40fa84cca3a630"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#a84b80673b9748e75da40fa84cca3a630">llvm::OutlinableRegion::findCorrespondingBlockIn</a></div><div class="ttdeci">BasicBlock * findCorrespondingBlockIn(const OutlinableRegion &amp;Other, BasicBlock *BB)</div><div class="ttdoc">Find a corresponding BasicBlock for BB in similar OutlinableRegion Other.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00203">IROutliner.cpp:203</a></div></div>
<div class="ttc" id="aMCSubtargetInfo_8cpp_html_a2b9bd65fb349f4c42139c994b31c2080"><div class="ttname"><a href="MCSubtargetInfo_8cpp.html#a2b9bd65fb349f4c42139c994b31c2080">Find</a></div><div class="ttdeci">static const T * Find(StringRef S, ArrayRef&lt; T &gt; A)</div><div class="ttdoc">Find KV in array using binary search.</div><div class="ttdef"><b>Definition:</b> <a href="MCSubtargetInfo_8cpp_source.html#l00026">MCSubtargetInfo.cpp:26</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00174">User.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a1fbf4d66a9eeaa9ade03e8febee097ee"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a1fbf4d66a9eeaa9ade03e8febee097ee">llvm::detail::DenseSetImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00092">DenseSet.h:92</a></div></div>
<div class="ttc" id="aMangler_8h_html"><div class="ttname"><a href="Mangler_8h.html">Mangler.h</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a9f6ba11268c4835030bef08cba90383d"><div class="ttname"><a href="IROutliner_8cpp.html#a9f6ba11268c4835030bef08cba90383d">findDuplicateOutputBlock</a></div><div class="ttdeci">std::optional&lt; unsigned &gt; findDuplicateOutputBlock(DenseMap&lt; Value *, BasicBlock * &gt; &amp;OutputBBs, std::vector&lt; DenseMap&lt; Value *, BasicBlock * &gt;&gt; &amp;OutputStoreBBs)</div><div class="ttdoc">It is possible that there is a basic block that already performs the same stores.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01974">IROutliner.cpp:1974</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_a5745baa68bbd3265433afb11fe7edc6d"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a5745baa68bbd3265433afb11fe7edc6d">llvm::IRSimilarity::IRSimilarityCandidate::front</a></div><div class="ttdeci">IRInstructionData * front() const</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00871">IRSimilarityIdentifier.h:871</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a69a17456977b7d8eb5795eb51870d41c"><div class="ttname"><a href="structOutlinableGroup.html#a69a17456977b7d8eb5795eb51870d41c">OutlinableGroup::Cost</a></div><div class="ttdeci">InstructionCost Cost</div><div class="ttdoc">The number of added instructions needed for the outlining of the Regions.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00133">IROutliner.cpp:133</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0a4d51e372293abe5e5f6dac133e80a6"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const</div><div class="ttdoc">Create a copy of 'this' instruction that is identical in all ways except the following:</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00903">Instruction.cpp:903</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTXISD_html_ab995b6d422b079c863075e073b2eb96ba7cff9cc4a40fe2b19129ee8e9b0ec645"><div class="ttname"><a href="namespacellvm_1_1NVPTXISD.html#ab995b6d422b079c863075e073b2eb96ba7cff9cc4a40fe2b19129ee8e9b0ec645">llvm::NVPTXISD::Dummy</a></div><div class="ttdeci">@ Dummy</div><div class="ttdef"><b>Definition:</b> <a href="NVPTXISelLowering_8h_source.html#l00060">NVPTXISelLowering.h:60</a></div></div>
<div class="ttc" id="aclassllvm_1_1IROutliner_html_adc7588dad82317423eb5949ca4bac107"><div class="ttname"><a href="classllvm_1_1IROutliner.html#adc7588dad82317423eb5949ca4bac107">llvm::IROutliner::run</a></div><div class="ttdeci">bool run(Module &amp;M)</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l03020">IROutliner.cpp:3020</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html"><div class="ttname"><a href="structOutlinableGroup.html">OutlinableGroup</a></div><div class="ttdoc">The OutlinableGroup holds all the overarching information for outlining a set of regions that are str...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00074">IROutliner.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="astructllvm_1_1IRSimilarity_1_1IRInstructionData_html_a8f280453f9963266308cb61e428f5268"><div class="ttname"><a href="structllvm_1_1IRSimilarity_1_1IRInstructionData.html#a8f280453f9963266308cb61e428f5268">llvm::IRSimilarity::IRInstructionData::Inst</a></div><div class="ttdeci">Instruction * Inst</div><div class="ttdoc">The source Instruction that is being wrapped.</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00119">IRSimilarityIdentifier.h:119</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_a761b3c02cd196cb5f6fb019bcd86866e"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#a761b3c02cd196cb5f6fb019bcd86866e">llvm::OutlinableRegion::splitCandidate</a></div><div class="ttdeci">void splitCandidate()</div><div class="ttdoc">For the contained region, split the parent BasicBlock at the starting and ending instructions of the ...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00253">IROutliner.cpp:253</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a4f3c175c90b9439d52ad07ecda521c2f"><div class="ttname"><a href="IROutliner_8cpp.html#a4f3c175c90b9439d52ad07ecda521c2f">replaceCalledFunction</a></div><div class="ttdeci">CallInst * replaceCalledFunction(Module &amp;M, OutlinableRegion &amp;Region)</div><div class="ttdoc">Replace the extracted function in the Region with a call to the overall function constructed from the...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01434">IROutliner.cpp:1434</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a859bfc2d9aaafd3c329d7f3ec7645d70"><div class="ttname"><a href="IROutliner_8cpp.html#a859bfc2d9aaafd3c329d7f3ec7645d70">findOutputValueInRegion</a></div><div class="ttdeci">static Value * findOutputValueInRegion(OutlinableRegion &amp;Region, unsigned OutputCanon)</div><div class="ttdoc">For the OutputCanon number passed in find the value represented by this canonical number.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02511">IROutliner.cpp:2511</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6a66ebb3aa12757479a3c88de77d78f8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">llvm::Instruction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const</div><div class="ttdoc">Return the function this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00074">Instruction.cpp:74</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_ae0f753d38671d8138865d30d8cf5720b"><div class="ttname"><a href="structOutlinableGroup.html#ae0f753d38671d8138865d30d8cf5720b">OutlinableGroup::Benefit</a></div><div class="ttdeci">InstructionCost Benefit</div><div class="ttdoc">The number of instructions that will be outlined by extracting Regions.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00130">IROutliner.cpp:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_ad409c2de8502b94c8a0b1193307c63b6"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">llvm::detail::DenseSetImpl::contains</a></div><div class="ttdeci">bool contains(const_arg_type_t&lt; ValueT &gt; V) const</div><div class="ttdoc">Check if the set contains the given element.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00185">DenseSet.h:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ace940beeee97c222f836fe0ac70f6cf5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">llvm::BasicBlock::Create</a></div><div class="ttdeci">static BasicBlock * Create(LLVMContext &amp;Context, const Twine &amp;Name=&quot;&quot;, Function *Parent=nullptr, BasicBlock *InsertBefore=nullptr)</div><div class="ttdoc">Creates a new BasicBlock.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00105">BasicBlock.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a1aa6c7717f84c6970e22a0938660047f"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a1aa6c7717f84c6970e22a0938660047f">llvm::RegionBase::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00560">RegionInfo.h:560</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a3bc949e06e148a6d2879eb45ca164146"><div class="ttname"><a href="IROutliner_8cpp.html#a3bc949e06e148a6d2879eb45ca164146">nextIRInstructionDataMatchesNextInst</a></div><div class="ttdeci">static bool nextIRInstructionDataMatchesNextInst(IRInstructionData &amp;ID)</div><div class="ttdoc">Checks that the next instruction in the InstructionDataList matches the next instruction in the modul...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02344">IROutliner.cpp:2344</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a8b12ae89227758cb5684cc7cf25a7f43"><div class="ttname"><a href="IROutliner_8cpp.html#a8b12ae89227758cb5684cc7cf25a7f43">findCostForOutputBlocks</a></div><div class="ttdeci">static InstructionCost findCostForOutputBlocks(Module &amp;M, OutlinableGroup &amp;CurrentGroup, TargetTransformInfo &amp;TTI)</div><div class="ttdoc">Find the extra instructions needed to handle any output values for the region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02563">IROutliner.cpp:2563</a></div></div>
<div class="ttc" id="aclassllvm_1_1CodeExtractor_html"><div class="ttname"><a href="classllvm_1_1CodeExtractor.html">llvm::CodeExtractor</a></div><div class="ttdoc">Utility class for extracting code into a new function.</div><div class="ttdef"><b>Definition:</b> <a href="CodeExtractor_8h_source.html#l00085">CodeExtractor.h:85</a></div></div>
<div class="ttc" id="anamespacellvm_html_aecd4ed57fa6a20d048310d43f5c96da9"><div class="ttname"><a href="namespacellvm.html#aecd4ed57fa6a20d048310d43f5c96da9">llvm::updateLoopMetadataDebugLocations</a></div><div class="ttdeci">void updateLoopMetadataDebugLocations(Instruction &amp;I, function_ref&lt; Metadata *(Metadata *)&gt; Updater)</div><div class="ttdoc">Update the debug locations contained within the MD_loop metadata attached to the instruction I,...</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00389">DebugInfo.cpp:389</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a7bf6409b01dd04465404d268beec0898"><div class="ttname"><a href="structOutlinableGroup.html#a7bf6409b01dd04465404d268beec0898">OutlinableGroup::IgnoreGroup</a></div><div class="ttdeci">bool IgnoreGroup</div><div class="ttdoc">Flag for whether we should not consider this group of OutlinableRegions for extraction.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00088">IROutliner.cpp:88</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a99f811d53704275b4158c62a2dd138d9"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00207">DenseMap.h:207</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_aa286a0f7f5d38488d593bb7ef0ba183e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">llvm::BasicBlock::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Get the context in which this basic block lives.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00035">BasicBlock.cpp:35</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a05efe971c4e940f01a5e34bc41cd602a"><div class="ttname"><a href="IROutliner_8cpp.html#a05efe971c4e940f01a5e34bc41cd602a">NoCostModel</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; NoCostModel(&quot;ir-outlining-no-cost&quot;, cl::init(false), cl::ReallyHidden, cl::desc(&quot;Debug option to outline greedily, without restriction that &quot; &quot;calculated benefit outweighs cost&quot;))</div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a0028135ea5d53b4a9b047ef7c72edd57"><div class="ttname"><a href="IROutliner_8cpp.html#a0028135ea5d53b4a9b047ef7c72edd57">getSubprogramOrNull</a></div><div class="ttdeci">static DISubprogram * getSubprogramOrNull(OutlinableGroup &amp;Group)</div><div class="ttdoc">Get the subprogram if it exists for one of the outlined regions.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00625">IROutliner.cpp:625</a></div></div>
<div class="ttc" id="aAttributes_8h_html"><div class="ttname"><a href="Attributes_8h.html">Attributes.h</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a96b5bd50d8e96b4c76ffc26508ce774d"><div class="ttname"><a href="IROutliner_8cpp.html#a96b5bd50d8e96b4c76ffc26508ce774d">replaceArgumentUses</a></div><div class="ttdeci">static void replaceArgumentUses(OutlinableRegion &amp;Region, DenseMap&lt; Value *, BasicBlock * &gt; &amp;OutputBBs, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, bool FirstFunction=false)</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01806">IROutliner.cpp:1806</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_aa5087b607af833220d9ebab0c88c83c1"><div class="ttname"><a href="classllvm_1_1Function.html#aa5087b607af833220d9ebab0c88c83c1">llvm::Function::addParamAttr</a></div><div class="ttdeci">void addParamAttr(unsigned ArgNo, Attribute::AttrKind Kind)</div><div class="ttdoc">adds the attribute to the list of attributes for the given arg.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00578">Function.cpp:578</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_ace02ac07a3f704ffd345301bff92e5a8"><div class="ttname"><a href="IROutliner_8cpp.html#ace02ac07a3f704ffd345301bff92e5a8">replaceConstants</a></div><div class="ttdeci">void replaceConstants(OutlinableRegion &amp;Region)</div><div class="ttdoc">Within an extracted function, replace the constants that need to be lifted into arguments with the ac...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01941">IROutliner.cpp:1941</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_ae28d149d03a6ae88267f649bc1dbe42c"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#ae28d149d03a6ae88267f649bc1dbe42c">llvm::GlobalValue::hasLinkOnceODRLinkage</a></div><div class="ttdeci">bool hasLinkOnceODRLinkage() const</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00514">GlobalValue.h:514</a></div></div>
<div class="ttc" id="anamespacellvm_html_a076f93c387f454f0db13d4bc7d4e7f9c"><div class="ttname"><a href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a></div><div class="ttdeci">void stable_sort(R &amp;&amp;Range)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01948">STLExtras.h:1948</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a8052a4f265aa7540f68ca3103a55538d"><div class="ttname"><a href="classllvm_1_1Function.html#a8052a4f265aa7540f68ca3103a55538d">llvm::Function::getArg</a></div><div class="ttdeci">Argument * getArg(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00784">Function.h:784</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a7eee4666052bd481591092aa25a62d92"><div class="ttname"><a href="classllvm_1_1Function.html#a7eee4666052bd481591092aa25a62d92">llvm::Function::back</a></div><div class="ttdeci">const BasicBlock &amp; back() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00760">Function.h:760</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html">llvm::OutlinableRegion</a></div><div class="ttdoc">The OutlinableRegion holds all the information for a specific region, or sequence of instructions.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8h_source.html#l00063">IROutliner.h:63</a></div></div>
<div class="ttc" id="aIRSimilarityIdentifier_8h_html"><div class="ttname"><a href="IRSimilarityIdentifier_8h.html">IRSimilarityIdentifier.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_ada960ccf6a96ca62ce5db3af1b7bf7f5"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#ada960ccf6a96ca62ce5db3af1b7bf7f5">llvm::IRSimilarity::IRSimilarityCandidate::getStartIdx</a></div><div class="ttdeci">unsigned getStartIdx() const</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00865">IRSimilarityIdentifier.h:865</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a21c2c6ae5ec23004dc4020eacf83bbce"><div class="ttname"><a href="classllvm_1_1SetVector.html#a21c2c6ae5ec23004dc4020eacf83bbce">llvm::SetVector::count</a></div><div class="ttdeci">size_type count(const key_type &amp;key) const</div><div class="ttdoc">Count the number of elements of a given key in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00208">SetVector.h:208</a></div></div>
<div class="ttc" id="anamespacellvm_1_1object_html_a42e5b6ee6f67085d2115b2ea44588c47acfaaa2f9ff08c82a08d647efc1a2964b"><div class="ttname"><a href="namespacellvm_1_1object.html#a42e5b6ee6f67085d2115b2ea44588c47acfaaa2f9ff08c82a08d647efc1a2964b">llvm::object::Identifier</a></div><div class="ttdeci">@ Identifier</div><div class="ttdef"><b>Definition:</b> <a href="COFFModuleDefinition_8cpp_source.html#l00034">COFFModuleDefinition.cpp:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_adf50671db83d2813e0d897ea2cfc9102"><div class="ttname"><a href="classllvm_1_1Function.html#adf50671db83d2813e0d897ea2cfc9102">llvm::Function::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType() const</div><div class="ttdoc">Returns the FunctionType for me.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00174">Function.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a34c987c590db0e5cff66d9869a34c556"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a34c987c590db0e5cff66d9869a34c556">llvm::TargetTransformInfo::getMemoryOpCost</a></div><div class="ttdeci">InstructionCost getMemoryOpCost(unsigned Opcode, Type *Src, Align Alignment, unsigned AddressSpace, TTI::TargetCostKind CostKind=TTI::TCK_RecipThroughput, OperandValueInfo OpdInfo={OK_AnyValue, OP_None}, const Instruction *I=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00941">TargetTransformInfo.cpp:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html">llvm::IRSimilarity::IRSimilarityCandidate</a></div><div class="ttdoc">This is a class that wraps a range of IRInstructionData from one point to another in the vector of IR...</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00649">IRSimilarityIdentifier.h:649</a></div></div>
<div class="ttc" id="aclassllvm_1_1CodeExtractorAnalysisCache_html"><div class="ttname"><a href="classllvm_1_1CodeExtractorAnalysisCache.html">llvm::CodeExtractorAnalysisCache</a></div><div class="ttdoc">A cache for the CodeExtractor analysis.</div><div class="ttdef"><b>Definition:</b> <a href="CodeExtractor_8h_source.html#l00046">CodeExtractor.h:46</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a48d81e3f58b8db143bc85763d25dbc7a"><div class="ttname"><a href="IROutliner_8cpp.html#a48d81e3f58b8db143bc85763d25dbc7a">getCodeExtractorArguments</a></div><div class="ttdeci">static void getCodeExtractorArguments(OutlinableRegion &amp;Region, std::vector&lt; unsigned &gt; &amp;InputGVNs, DenseSet&lt; unsigned &gt; &amp;NotSame, DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings, SetVector&lt; Value * &gt; &amp;ArgInputs, SetVector&lt; Value * &gt; &amp;Outputs)</div><div class="ttdoc">Find the input GVNs and the output values for a region of Instructions.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00867">IROutliner.cpp:867</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0e2e479cf4860dc8a00614e36ee3d5e9"><div class="ttname"><a href="namespacellvm.html#a0e2e479cf4860dc8a00614e36ee3d5e9">llvm::hash_value</a></div><div class="ttdeci">hash_code hash_value(const FixedPointSemantics &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="APFixedPoint_8h_source.html#l00128">APFixedPoint.h:128</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a6e20e76960d952de088354cbcd14c3ab"><div class="ttname"><a href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">llvm::Type::getVoidTy</a></div><div class="ttdeci">static Type * getVoidTy(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00224">Type.cpp:224</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a16d01bf2cfdeedd5c8989f5d13da8feb"><div class="ttname"><a href="IROutliner_8cpp.html#a16d01bf2cfdeedd5c8989f5d13da8feb">fillOverallFunction</a></div><div class="ttdeci">static void fillOverallFunction(Module &amp;M, OutlinableGroup &amp;CurrentGroup, std::vector&lt; DenseMap&lt; Value *, BasicBlock * &gt;&gt; &amp;OutputStoreBBs, std::vector&lt; Function * &gt; &amp;FuncsToRemove, const DenseMap&lt; Value *, Value * &gt; &amp;OutputMappings)</div><div class="ttdoc">Fill the new function that will serve as the replacement function for all of the extracted regions of...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02250">IROutliner.cpp:2250</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aELFYAML_8cpp_html_a941c34da9850676ce3380813c636cff2"><div class="ttname"><a href="ELFYAML_8cpp.html#a941c34da9850676ce3380813c636cff2">Other</a></div><div class="ttdeci">std::optional&lt; std::vector&lt; StOtherPiece &gt; &gt; Other</div><div class="ttdef"><b>Definition:</b> <a href="ELFYAML_8cpp_source.html#l01260">ELFYAML.cpp:1260</a></div></div>
<div class="ttc" id="anamespacellvm_html_add71474638430694c84640146383fc44"><div class="ttname"><a href="namespacellvm.html#add71474638430694c84640146383fc44">llvm::hash_combine</a></div><div class="ttdeci">hash_code hash_combine(const Ts &amp;...args)</div><div class="ttdoc">Combine values into a single hash_code.</div><div class="ttdef"><b>Definition:</b> <a href="Hashing_8h_source.html#l00613">Hashing.h:613</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_af80edfc5e42059e045aa7bf7fe42bee3"><div class="ttname"><a href="namespacellvm.html#af80edfc5e42059e045aa7bf7fe42bee3">llvm::hash_combine_range</a></div><div class="ttdeci">hash_code hash_combine_range(InputIteratorT first, InputIteratorT last)</div><div class="ttdoc">Compute a hash_code for a sequence of values.</div><div class="ttdef"><b>Definition:</b> <a href="Hashing_8h_source.html#l00491">Hashing.h:491</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab9f68be0e2bcdf14f503f45edea63023"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab9f68be0e2bcdf14f503f45edea63023">llvm::BasicBlock::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00324">BasicBlock.h:324</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="anamespacellvm_html_a13c1b5a253da5da49ce33d03dc1efc07"><div class="ttname"><a href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">llvm::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;Value)</div><div class="ttdef"><b>Definition:</b> <a href="ScopedPrinter_8h_source.html#l00085">ScopedPrinter.h:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a8ce0c4746a1ec805e66409d20ae93922"><div class="ttname"><a href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const</div><div class="ttdoc">Return incoming basic block number i.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02814">Instructions.h:2814</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a01875e4204852069dd4b7938cab4140b"><div class="ttname"><a href="classllvm_1_1Function.html#a01875e4204852069dd4b7938cab4140b">llvm::Function::addFnAttr</a></div><div class="ttdeci">void addFnAttr(Attribute::AttrKind Kind)</div><div class="ttdoc">Add function attributes to this function.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00550">Function.cpp:550</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_ad0fabe111fc0db047a04c21481fa6aab"><div class="ttname"><a href="IROutliner_8cpp.html#ad0fabe111fc0db047a04c21481fa6aab">ArgLocWithBBCanon</a></div><div class="ttdeci">std::pair&lt; unsigned, unsigned &gt; ArgLocWithBBCanon</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01145">IROutliner.cpp:1145</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_af972d87e15b5f6ed61bd5c3956c5213d"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">llvm::detail::DenseSetImpl::erase</a></div><div class="ttdeci">bool erase(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00101">DenseSet.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1DISubprogram_html"><div class="ttname"><a href="classllvm_1_1DISubprogram.html">llvm::DISubprogram</a></div><div class="ttdoc">Subprogram description.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01851">DebugInfoMetadata.h:1851</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a4047976de351f78967fba27df7a6361f"><div class="ttname"><a href="IROutliner_8cpp.html#a4047976de351f78967fba27df7a6361f">moveFunctionData</a></div><div class="ttdeci">static void moveFunctionData(Function &amp;Old, Function &amp;New, DenseMap&lt; Value *, BasicBlock * &gt; &amp;NewEnds)</div><div class="ttdoc">Move each BasicBlock in Old to New.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00713">IROutliner.cpp:713</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a223dd14e7d12bc5cea01889b972a98b2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">str - Get the contents as an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00222">StringRef.h:222</a></div></div>
<div class="ttc" id="aclassllvm_1_1InnerAnalysisManagerProxy_html"><div class="ttname"><a href="classllvm_1_1InnerAnalysisManagerProxy.html">llvm::InnerAnalysisManagerProxy</a></div><div class="ttdoc">An analysis over an &quot;outer&quot; IR unit that provides access to an analysis manager over an &quot;inner&quot; IR un...</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00931">PassManager.h:931</a></div></div>
<div class="ttc" id="aclassllvm_1_1IROutliner_html"><div class="ttname"><a href="classllvm_1_1IROutliner.html">llvm::IROutliner</a></div><div class="ttdoc">This class is a pass that identifies similarity in a Module, extracts instances of the similarity,...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8h_source.html#l00199">IROutliner.h:199</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityIdentifier_html"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityIdentifier.html">llvm::IRSimilarity::IRSimilarityIdentifier</a></div><div class="ttdoc">This class puts all the pieces of the IRInstructionData, IRInstructionMapper, IRSimilarityCandidate t...</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00979">IRSimilarityIdentifier.h:979</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a7e8dad1701aa6445be4a29f654b0473c"><div class="ttname"><a href="classllvm_1_1Value.html#a7e8dad1701aa6445be4a29f654b0473c">llvm::Value::replaceUsesWithIf</a></div><div class="ttdeci">void replaceUsesWithIf(Value *New, llvm::function_ref&lt; bool(Use &amp;U)&gt; ShouldReplace)</div><div class="ttdoc">Go through the uses list for this definition and make each use point to &quot;V&quot; if the callback ShouldRep...</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00540">Value.cpp:540</a></div></div>
<div class="ttc" id="aclassllvm_1_1simple__ilist_html_a7f4bd492b552181942252ccddc0db26e"><div class="ttname"><a href="classllvm_1_1simple__ilist.html#a7f4bd492b552181942252ccddc0db26e">llvm::simple_ilist::insert</a></div><div class="ttdeci">iterator insert(iterator I, reference Node)</div><div class="ttdoc">Insert a node by reference; never copies.</div><div class="ttdef"><b>Definition:</b> <a href="simple__ilist_8h_source.html#l00157">simple_ilist.h:157</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ac44f6b9fdbb5f9cc199f8329cb0b272cae46c9eecc49bd2dc253c607e78a0fb86">llvm::TargetTransformInfo::TCC_Basic</a></div><div class="ttdeci">@ TCC_Basic</div><div class="ttdoc">The cost of a typical 'add' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00268">TargetTransformInfo.h:268</a></div></div>
<div class="ttc" id="aclassllvm_1_1SwitchInst_html"><div class="ttname"><a href="classllvm_1_1SwitchInst.html">llvm::SwitchInst</a></div><div class="ttdoc">Multiway switch.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03283">Instructions.h:3283</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdoc">A debug info location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00033">DebugLoc.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1SwitchInst_html_a62abc2475d09c01d583ba24a487898fd"><div class="ttname"><a href="classllvm_1_1SwitchInst.html#a62abc2475d09c01d583ba24a487898fd">llvm::SwitchInst::addCase</a></div><div class="ttdeci">void addCase(ConstantInt *OnVal, BasicBlock *Dest)</div><div class="ttdoc">Add an entry to the switch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l04532">Instructions.cpp:4532</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1Region_html"><div class="ttname"><a href="classllvm_1_1Region.html">llvm::Region</a></div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00889">RegionInfo.h:889</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="anamespacellvm_1_1M68kBeads_html_a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd"><div class="ttname"><a href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">llvm::M68kBeads::Term</a></div><div class="ttdeci">@ Term</div><div class="ttdef"><b>Definition:</b> <a href="M68kBaseInfo_8h_source.html#l00090">M68kBaseInfo.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRSimilarity_1_1IRSimilarityCandidate_html_a431c03fe7b1e48d27e7b0ee98bb2010a"><div class="ttname"><a href="classllvm_1_1IRSimilarity_1_1IRSimilarityCandidate.html#a431c03fe7b1e48d27e7b0ee98bb2010a">llvm::IRSimilarity::IRSimilarityCandidate::getCanonicalNum</a></div><div class="ttdeci">std::optional&lt; unsigned &gt; getCanonicalNum(unsigned N)</div><div class="ttdoc">Find the canonical number from the global value number N stored in the candidate.</div><div class="ttdef"><b>Definition:</b> <a href="IRSimilarityIdentifier_8h_source.html#l00918">IRSimilarityIdentifier.h:918</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a0389cc3001a985e14dcff4067684ad70"><div class="ttname"><a href="IROutliner_8cpp.html#a0389cc3001a985e14dcff4067684ad70">PHINodeData</a></div><div class="ttdeci">std::pair&lt; ArgLocWithBBCanon, CanonList &gt; PHINodeData</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01150">IROutliner.cpp:1150</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector&lt; Value * &gt;</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a704926b49e550b25585651aea32b389b"><div class="ttname"><a href="structOutlinableGroup.html#a704926b49e550b25585651aea32b389b">OutlinableGroup::PHINodeGVNToGVNs</a></div><div class="ttdeci">DenseMap&lt; unsigned, std::pair&lt; std::pair&lt; unsigned, unsigned &gt;, SmallVector&lt; unsigned, 2 &gt; &gt; &gt; PHINodeGVNToGVNs</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00125">IROutliner.cpp:125</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_a652d50395284a0dec463c533709bc231"><div class="ttname"><a href="IROutliner_8cpp.html#a652d50395284a0dec463c533709bc231">encodePHINodeData</a></div><div class="ttdeci">static hash_code encodePHINodeData(PHINodeData &amp;PND)</div><div class="ttdoc">Encode PND as an integer for easy lookup based on the argument location, the parent BasicBlock canoni...</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l01158">IROutliner.cpp:1158</a></div></div>
<div class="ttc" id="astructllvm_1_1OutlinableRegion_html_aa6e8e852e322a0a5383c6f0fce17daa2"><div class="ttname"><a href="structllvm_1_1OutlinableRegion.html#aa6e8e852e322a0a5383c6f0fce17daa2">llvm::OutlinableRegion::RemappedArguments</a></div><div class="ttdeci">DenseMap&lt; Value *, Value * &gt; RemappedArguments</div><div class="ttdoc">Values in the outlined functions will often be replaced by arguments.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8h_source.html#l00093">IROutliner.h:93</a></div></div>
<div class="ttc" id="anamespaceCU_html"><div class="ttname"><a href="namespaceCU.html">CU</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64AsmBackend_8cpp_source.html#l00505">AArch64AsmBackend.cpp:505</a></div></div>
<div class="ttc" id="astructOutlinableGroup_html_a8ef219d66e525d2c9fbb7f54e5869ad3"><div class="ttname"><a href="structOutlinableGroup.html#a8ef219d66e525d2c9fbb7f54e5869ad3">OutlinableGroup::BranchesToOutside</a></div><div class="ttdeci">unsigned BranchesToOutside</div><div class="ttdoc">The number of branches in the region target a basic block that is outside of the region.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l00116">IROutliner.cpp:116</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_ab0f09aefdf088f84a0bff7cba86454b4"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#ab0f09aefdf088f84a0bff7cba86454b4">llvm::DominatorTreeBase::deleteEdge</a></div><div class="ttdeci">void deleteEdge(NodeT *From, NodeT *To)</div><div class="ttdoc">Inform the dominator tree about a CFG edge deletion and update the tree.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00619">GenericDomTree.h:619</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIFile_html"><div class="ttname"><a href="classllvm_1_1DIFile.html">llvm::DIFile</a></div><div class="ttdoc">File.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00562">DebugInfoMetadata.h:562</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html"><div class="ttname"><a href="classllvm_1_1FunctionType.html">llvm::FunctionType</a></div><div class="ttdoc">Class to represent function types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00103">DerivedTypes.h:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aIROutliner_8cpp_html_abd03d0c420bf064355d328a784f3ae00"><div class="ttname"><a href="IROutliner_8cpp.html#abd03d0c420bf064355d328a784f3ae00">createSwitchStatement</a></div><div class="ttdeci">void createSwitchStatement(Module &amp;M, OutlinableGroup &amp;OG, DenseMap&lt; Value *, BasicBlock * &gt; &amp;EndBBs, std::vector&lt; DenseMap&lt; Value *, BasicBlock * &gt;&gt; &amp;OutputStoreBBs)</div><div class="ttdoc">Create the switch statement for outlined function to differentiate between all the output blocks.</div><div class="ttdef"><b>Definition:</b> <a href="IROutliner_8cpp_source.html#l02157">IROutliner.cpp:2157</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a969eb757b1e43b455d4a8d0f603e695b"><div class="ttname"><a href="classllvm_1_1Function.html#a969eb757b1e43b455d4a8d0f603e695b">llvm::Function::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00756">Function.h:756</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a001c71505d9c3f8d39aed9227a0a6e74"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">llvm::RegionBase::getParent</a></div><div class="ttdeci">RegionT * getParent() const</div><div class="ttdoc">Get the parent of the Region.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00364">RegionInfo.h:364</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="aclassllvm_1_1hash__code_html"><div class="ttname"><a href="classllvm_1_1hash__code.html">llvm::hash_code</a></div><div class="ttdoc">An opaque object representing a hash code.</div><div class="ttdef"><b>Definition:</b> <a href="Hashing_8h_source.html#l00074">Hashing.h:74</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:27:05 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
