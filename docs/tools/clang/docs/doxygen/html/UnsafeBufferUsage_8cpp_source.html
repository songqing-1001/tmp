<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>clang: lib/Analysis/UnsafeBufferUsage.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">clang
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a25db018342d3ae6c7e6779086c18378.html">Analysis</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">UnsafeBufferUsage.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="UnsafeBufferUsage_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- UnsafeBufferUsage.cpp - Replace pointers with modern C++ -----------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="UnsafeBufferUsage_8h.html">clang/Analysis/Analyses/UnsafeBufferUsage.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RecursiveASTVisitor_8h.html">clang/AST/RecursiveASTVisitor.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ASTMatchFinder_8h.html">clang/ASTMatchers/ASTMatchFinder.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Preprocessor_8h.html">clang/Lex/Preprocessor.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Lexer_8h.html">clang/Lex/Lexer.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;llvm/ADT/SmallVector.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceclang.html">clang</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using namespace </span>ast_matchers;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceclang_1_1ast__matchers.html">clang::ast_matchers</a> {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// A `RecursiveASTVisitor` that traverses all descendants of a given node &quot;n&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// except for those belonging to a different callable of &quot;n&quot;.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html">   25</a></span>&#160;<span class="keyword">class </span><a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html">MatchDescendantVisitor</a></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    : <span class="keyword">public</span> <a class="code" href="classclang_1_1RecursiveASTVisitor.html">RecursiveASTVisitor</a>&lt;MatchDescendantVisitor&gt; {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a56b323dc7ad2e66076b5a8cd9bd2618f">   28</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classclang_1_1RecursiveASTVisitor.html">RecursiveASTVisitor&lt;MatchDescendantVisitor&gt;</a> <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a56b323dc7ad2e66076b5a8cd9bd2618f">VisitorBase</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">// Creates an AST visitor that matches `Matcher` on all</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">// descendants of a given node &quot;n&quot; except for the ones</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">// belonging to a different callable of &quot;n&quot;.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a9d3ab53f09416772b1cdaee6cc34b181">   33</a></span>&#160;  <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a9d3ab53f09416772b1cdaee6cc34b181">MatchDescendantVisitor</a>(<span class="keyword">const</span> internal::DynTypedMatcher *Matcher,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                         internal::ASTMatchFinder *Finder,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                         internal::BoundNodesTreeBuilder *Builder,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                         internal::ASTMatchFinder::BindKind Bind)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      : Matcher(Matcher), Finder(Finder), Builder(Builder), Bind(Bind),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        Matches(<a class="code" href="stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>) {}</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// Returns true if a match is found in a subtree of `DynNode`, which belongs</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">// to the same callable of `DynNode`.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a00e1dc910659e678ad0dc0f59609b43f">   42</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a00e1dc910659e678ad0dc0f59609b43f">findMatch</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1DynTypedNode.html">DynTypedNode</a> &amp;DynNode) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    Matches = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *StmtNode = DynNode.<a class="code" href="classclang_1_1DynTypedNode.html#a41a5256f73db43cca950c049e5cbcb65">get</a>&lt;<a class="code" href="classclang_1_1Stmt.html">Stmt</a>&gt;()) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      TraverseStmt(<span class="keyword">const_cast&lt;</span><a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<span class="keyword">&gt;</span>(StmtNode));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      *Builder = ResultBindings;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">return</span> Matches;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// The following are overriding methods from the base visitor class.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">// They are public only to allow CRTP to work. They are *not *part</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// of the public API of this class.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// For the matchers so far used in safe buffers, we only need to match</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">// `Stmt`s.  To override more as needed.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a284d389fa91819abb5e37d4f5f45c16a">   59</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a284d389fa91819abb5e37d4f5f45c16a">TraverseDecl</a>(<a class="code" href="classclang_1_1Decl.html">Decl</a> *<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceclang_1_1ast__matchers.html#a58409ce605d979d1d1e0a600ec417a0a">match</a>(*<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>))</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// To skip callables:</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (isa&lt;FunctionDecl, BlockDecl, ObjCMethodDecl&gt;(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>))</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// Traverse descendants</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">return</span> VisitorBase::TraverseDecl(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#aec80fc903341a34de9858cc705228730">   71</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#aec80fc903341a34de9858cc705228730">TraverseStmt</a>(<a class="code" href="classclang_1_1Stmt.html">Stmt</a> *<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>, <a class="code" href="classllvm_1_1SmallVectorImpl.html">DataRecursionQueue</a> *Queue = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceclang_1_1ast__matchers.html#a58409ce605d979d1d1e0a600ec417a0a">match</a>(*<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>))</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// To skip callables:</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (isa&lt;LambdaExpr&gt;(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>))</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">return</span> VisitorBase::TraverseStmt(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#ad607f8e868c26e106740f5cb7f19f240">   82</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#ad607f8e868c26e106740f5cb7f19f240">shouldVisitTemplateInstantiations</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a1de5b1e597ef9c8598a3923e785c9499">   83</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a1de5b1e597ef9c8598a3923e785c9499">shouldVisitImplicitCode</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// TODO: let&#39;s ignore implicit code for now</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// Sets &#39;Matched&#39; to true if &#39;Matcher&#39; matches &#39;Node&#39;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// Returns &#39;true&#39; if traversal should continue after this function</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// returns, i.e. if no match is found or &#39;Bind&#39; is &#39;BK_All&#39;.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#a58409ce605d979d1d1e0a600ec417a0a">match</a>(<span class="keyword">const</span> T &amp;<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    internal::BoundNodesTreeBuilder RecursiveBuilder(*Builder);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (Matcher-&gt;matches(<a class="code" href="namespaceclang_1_1serialized__diags.html#afb25f8afb2155dc94a6885bca5cb2213">DynTypedNode::create</a>(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>), Finder,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                         &amp;RecursiveBuilder)) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      ResultBindings.addMatch(RecursiveBuilder);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      Matches = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> (Bind != internal::ASTMatchFinder::BK_All)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Abort as soon as a match is found.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">const</span> internal::DynTypedMatcher *<span class="keyword">const</span> Matcher;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  internal::ASTMatchFinder *<span class="keyword">const</span> Finder;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  internal::BoundNodesTreeBuilder *<span class="keyword">const</span> Builder;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  internal::BoundNodesTreeBuilder ResultBindings;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">const</span> internal::ASTMatchFinder::BindKind Bind;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">bool</span> Matches;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;};</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespaceclang_1_1ast__matchers.html#ac2e48489a1625d80278e3caae380719a">  114</a></span>&#160;<a class="code" href="ASTMatchersMacros_8h.html#ae9c7f3955d5fdd516853af78dea0ac9c">AST_MATCHER_P</a>(<a class="code" href="classclang_1_1Stmt.html">Stmt</a>, forEveryDescendant, internal::Matcher&lt;Stmt&gt;, innerMatcher) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">const</span> DynTypedMatcher &amp;DTM = <span class="keyword">static_cast&lt;</span>DynTypedMatcher<span class="keyword">&gt;</span>(innerMatcher);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html">MatchDescendantVisitor</a> Visitor(&amp;DTM, Finder, Builder, ASTMatchFinder::BK_All);  </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">return</span> Visitor.<a class="code" href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a00e1dc910659e678ad0dc0f59609b43f">findMatch</a>(<a class="code" href="namespaceclang_1_1serialized__diags.html#afb25f8afb2155dc94a6885bca5cb2213">DynTypedNode::create</a>(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// Matches a `Stmt` node iff the node is in a safe-buffer opt-out region</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="namespaceclang_1_1ast__matchers.html#a175e2f007ac6f824f5065f327888da7e">  122</a></span>&#160;<a class="code" href="ASTMatchersMacros_8h.html#ae9c7f3955d5fdd516853af78dea0ac9c">AST_MATCHER_P</a>(<a class="code" href="classclang_1_1Stmt.html">Stmt</a>, notInSafeBufferOptOut, <span class="keyword">const</span> <a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html">UnsafeBufferUsageHandler</a> *, Handler) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">return</span> !Handler-&gt;isSafeBufferOptOut(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>.getBeginLoc());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="namespaceclang_1_1ast__matchers.html#a53acf25e01b459fcfc83884da2d8d7f7">  126</a></span>&#160;<a class="code" href="ASTMatchersMacros_8h.html#ae9c7f3955d5fdd516853af78dea0ac9c">AST_MATCHER_P</a>(<a class="code" href="classclang_1_1CastExpr.html">CastExpr</a>, castSubExpr, internal::Matcher&lt;Expr&gt;, innerMatcher) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span> innerMatcher.matches(*<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>.getSubExpr(), Finder, Builder);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">// Returns a matcher that matches any expression &#39;e&#39; such that `innerMatcher`</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">// matches &#39;e&#39; and &#39;e&#39; is in an Unspecified Lvalue Context.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">static</span> internal::Matcher&lt;Stmt&gt;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespaceclang_1_1ast__matchers.html#a497f598be79aeb12a5efe58d2157edd0">  133</a></span>&#160;<a class="code" href="namespaceclang_1_1ast__matchers.html#a497f598be79aeb12a5efe58d2157edd0">isInUnspecifiedLvalueContext</a>(internal::Matcher&lt;Expr&gt; innerMatcher) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#a28b1bdd70cca95686345d5a96d97071a">implicitCastExpr</a>(hasCastKind(CastKind::CK_LValueToRValue),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                          castSubExpr(innerMatcher));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// FIXME: add assignmentTo context...</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;} <span class="comment">// namespace clang::ast_matchers</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// Because the analysis revolves around variables and their types, we&#39;ll need to</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">// track uses of variables (aka DeclRefExprs).</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">using</span> DeclUseList = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const DeclRefExpr *, 1&gt;</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// Convenience typedef.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">using</span> FixItList = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;FixItHint, 4&gt;</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">// Defined below.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">class </span>Strategy;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">// Because we&#39;re dealing with raw pointers, let&#39;s define what we mean by that.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">  153</a></span>&#160;<span class="keyword">static</span> <span class="keyword">auto</span> <a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>() {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> hasType(hasCanonicalType(<a class="code" href="namespaceclang_1_1ast__matchers.html#a34b0467fd444a7daa8a8aa79ec045765">pointerType</a>()));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#a0e4bc071c0823385f333bf16e21b4a74">  157</a></span>&#160;<span class="keyword">static</span> <span class="keyword">auto</span> <a class="code" href="UnsafeBufferUsage_8cpp.html#a0e4bc071c0823385f333bf16e21b4a74">hasArrayType</a>() {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> hasType(hasCanonicalType(<a class="code" href="namespaceclang_1_1ast__matchers.html#a6733c0e2dab3236688140fb7e73db035">arrayType</a>()));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/// Gadget is an individual operation in the code that may be of interest to</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/// this analysis. Each (non-abstract) subclass corresponds to a specific</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/// rigid AST structure that constitutes an operation on a pointer-type object.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">/// Discovery of a gadget in the code corresponds to claiming that we understand</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/// what this part of code is doing well enough to potentially improve it.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">/// Gadgets can be warning (immediately deserving a warning) or fixable (not</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">/// always deserving a warning per se, but requires our attention to identify</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">/// it warrants a fixit).</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span><span class="keyword">class </span>Gadget {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">enum class</span> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> {</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#abe429430c7efe651b37bd0fee87d9c2f">  173</a></span>&#160;<span class="preprocessor">#define GADGET(x) x,</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#include &quot;clang/Analysis/Analyses/UnsafeBufferUsageGadgets.def&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  };</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  /// Common type of ASTMatchers used for discovering gadgets.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">  /// Useful for implementing the static matcher() methods</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">  /// that are expected from all non-abstract subclasses.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span>  <span class="keyword">using</span> Matcher = decltype(<a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>());</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  Gadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> K) : K(K) {}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> <a class="code" href="DeclBase_8cpp.html#a37d13911f1772d0ed90b6b2e89cf3c60">getKind</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> K; }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isWarningGadget() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *getBaseStmt() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">  /// Returns the list of pointer-type variables on which this gadget performs</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">  /// its operation. Typically, there&#39;s only one variable. This isn&#39;t a list</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">  /// of all DeclRefExprs in the gadget&#39;s AST!</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> DeclUseList getClaimedVarUseSites() <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">virtual</span> ~Gadget() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> K;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;};</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">/// Warning gadgets correspond to unsafe code patterns that warrants</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">/// an immediate warning.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span><span class="keyword">class </span>WarningGadget : <span class="keyword">public</span> Gadget {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  WarningGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> K) : Gadget(K) {}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) { <span class="keywordflow">return</span> G-&gt;isWarningGadget(); }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">bool</span> isWarningGadget() const final { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;};</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">/// Fixable gadgets correspond to code patterns that aren&#39;t always unsafe but need to be</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/// properly recognized in order to emit fixes. For example, if a raw pointer-type</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/// variable is replaced by a safe C++ container, every use of such variable must be</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/// carefully considered and possibly updated.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span><span class="keyword">class </span>FixableGadget : <span class="keyword">public</span> Gadget {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  FixableGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> K) : Gadget(K) {}</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) { <span class="keywordflow">return</span> !G-&gt;isWarningGadget(); }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">bool</span> isWarningGadget() const final { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">  /// Returns a fixit that would fix the current gadget according to</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  /// the current strategy. Returns None if the fix cannot be produced;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  /// returns an empty list if no fixes are necessary.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> std::optional&lt;FixItList&gt; getFixits(<span class="keyword">const</span> Strategy &amp;)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;};</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keyword">using</span> FixableGadgetList = std::vector&lt;std::unique_ptr&lt;FixableGadget&gt;&gt;;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword">using</span> WarningGadgetList = std::vector&lt;std::unique_ptr&lt;WarningGadget&gt;&gt;;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">/// An increment of a pointer-type value is unsafe as it may run the pointer</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/// out of bounds.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span><span class="keyword">class </span>IncrementGadget : <span class="keyword">public</span> WarningGadget {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> OpTag = <span class="stringliteral">&quot;op&quot;</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1UnaryOperator.html">UnaryOperator</a> *Op;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  IncrementGadget(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      : WarningGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>::Increment),</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        Op(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1UnaryOperator.html">UnaryOperator</a>&gt;(OpTag)) {}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> G-&gt;getKind() == Kind::Increment;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">static</span> Matcher matcher() {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a71ac1ea4304cca5a3d773782c45e3a9d">unaryOperator</a>(</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      hasOperatorName(<span class="stringliteral">&quot;++&quot;</span>),</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      hasUnaryOperand(ignoringParenImpCasts(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>()))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    ).bind(OpTag));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1UnaryOperator.html">UnaryOperator</a> *getBaseStmt()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> Op; }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  DeclUseList getClaimedVarUseSites()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const DeclRefExpr *, 2&gt;</a> Uses;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE =</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            dyn_cast&lt;DeclRefExpr&gt;(Op-&gt;<a class="code" href="classclang_1_1UnaryOperator.html#a804929b99cee522ce0fe5b33fa544e77">getSubExpr</a>()-&gt;<a class="code" href="classclang_1_1Expr.html#a54036c75e73ecdf081729210fa53e582">IgnoreParenImpCasts</a>())) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      Uses.push_back(DRE);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span> std::move(Uses);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;};</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/// A decrement of a pointer-type value is unsafe as it may run the pointer</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/// out of bounds.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span><span class="keyword">class </span>DecrementGadget : <span class="keyword">public</span> WarningGadget {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> OpTag = <span class="stringliteral">&quot;op&quot;</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1UnaryOperator.html">UnaryOperator</a> *Op;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  DecrementGadget(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      : WarningGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>::Decrement),</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        Op(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1UnaryOperator.html">UnaryOperator</a>&gt;(OpTag)) {}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span> G-&gt;getKind() == Kind::Decrement;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keyword">static</span> Matcher matcher() {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a71ac1ea4304cca5a3d773782c45e3a9d">unaryOperator</a>(</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      hasOperatorName(<span class="stringliteral">&quot;--&quot;</span>),</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      hasUnaryOperand(ignoringParenImpCasts(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>()))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    ).bind(OpTag));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1UnaryOperator.html">UnaryOperator</a> *getBaseStmt()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> Op; }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  DeclUseList getClaimedVarUseSites()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE =</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            dyn_cast&lt;DeclRefExpr&gt;(Op-&gt;<a class="code" href="classclang_1_1UnaryOperator.html#a804929b99cee522ce0fe5b33fa544e77">getSubExpr</a>()-&gt;<a class="code" href="classclang_1_1Expr.html#a54036c75e73ecdf081729210fa53e582">IgnoreParenImpCasts</a>())) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">return</span> {DRE};</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/// Array subscript expressions on raw pointers as if they&#39;re arrays. Unsafe as</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/// it doesn&#39;t have any bounds checks for the array.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span><span class="keyword">class </span>ArraySubscriptGadget : <span class="keyword">public</span> WarningGadget {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> ArraySubscrTag = <span class="stringliteral">&quot;ArraySubscript&quot;</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1ArraySubscriptExpr.html">ArraySubscriptExpr</a> *ASE;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  ArraySubscriptGadget(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      : WarningGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>::ArraySubscript),</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        ASE(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1ArraySubscriptExpr.html">ArraySubscriptExpr</a>&gt;(ArraySubscrTag)) {}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> G-&gt;getKind() == Kind::ArraySubscript;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keyword">static</span> Matcher matcher() {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// FIXME: What if the index is integer literal 0? Should this be</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// a safe gadget in this case?</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="comment">// clang-format off</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a770b1eeabaf13b5ab1547634f8fef742">arraySubscriptExpr</a>(</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            hasBase(ignoringParenImpCasts(</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;              <a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>(), <a class="code" href="UnsafeBufferUsage_8cpp.html#a0e4bc071c0823385f333bf16e21b4a74">hasArrayType</a>()))),</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <a class="code" href="namespaceclang_1_1ast__matchers.html#a183ba07d4205e38e5d960a99062722dc">unless</a>(hasIndex(<a class="code" href="namespaceclang_1_1ast__matchers.html#ad2109e16a4a151dc8f6416a66a750eac">integerLiteral</a>(<a class="code" href="namespaceclang_1_1threadSafety_1_1sx.html#ad163b9a49653a53393b228df283f89f1">equals</a>(0)))))</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            .bind(ArraySubscrTag));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">// clang-format on</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1ArraySubscriptExpr.html">ArraySubscriptExpr</a> *getBaseStmt()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> ASE; }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  DeclUseList getClaimedVarUseSites()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE =</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            dyn_cast&lt;DeclRefExpr&gt;(ASE-&gt;<a class="code" href="classclang_1_1ArraySubscriptExpr.html#ad303686acb8af8aa3d7169ba7e15f9fd">getBase</a>()-&gt;<a class="code" href="classclang_1_1Expr.html#a54036c75e73ecdf081729210fa53e582">IgnoreParenImpCasts</a>())) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">return</span> {DRE};</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;};</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/// A pointer arithmetic expression of one of the forms:</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">///  \code</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">///  ptr + n | n + ptr | ptr - n | ptr += n | ptr -= n</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">///  \endcode</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span><span class="keyword">class </span>PointerArithmeticGadget : <span class="keyword">public</span> WarningGadget {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> PointerArithmeticTag = <span class="stringliteral">&quot;ptrAdd&quot;</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> PointerArithmeticPointerTag = <span class="stringliteral">&quot;ptrAddPtr&quot;</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1BinaryOperator.html">BinaryOperator</a> *PA; <span class="comment">// pointer arithmetic expression</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> * Ptr;         <span class="comment">// the pointer expression in `PA`</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    PointerArithmeticGadget(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      : WarningGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>::PointerArithmetic),</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        PA(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1BinaryOperator.html">BinaryOperator</a>&gt;(PointerArithmeticTag)),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        Ptr(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1Expr.html">Expr</a>&gt;(PointerArithmeticPointerTag)) {}</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> G-&gt;getKind() == Kind::PointerArithmetic;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">static</span> Matcher matcher() {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">auto</span> HasIntegerType = <a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          hasType(isInteger()), hasType(<a class="code" href="namespaceclang_1_1ast__matchers.html#a1182014746912db21f315121c2ed6098">enumType</a>()));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">auto</span> PtrAtRight = <a class="code" href="namespaceclang_1_1ast__matchers.html#ab7f7f0b785ca07327256931286ebc99f">allOf</a>(hasOperatorName(<span class="stringliteral">&quot;+&quot;</span>),</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                            hasRHS(<a class="code" href="namespaceclang_1_1ast__matchers.html#adfc0ccd398780d345e2c541cc716cc66">expr</a>(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>()).bind(PointerArithmeticPointerTag)),</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            hasLHS(HasIntegerType));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">auto</span> PtrAtLeft = <a class="code" href="namespaceclang_1_1ast__matchers.html#ab7f7f0b785ca07327256931286ebc99f">allOf</a>(</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;           <a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(hasOperatorName(<span class="stringliteral">&quot;+&quot;</span>), hasOperatorName(<span class="stringliteral">&quot;-&quot;</span>),</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                 hasOperatorName(<span class="stringliteral">&quot;+=&quot;</span>), hasOperatorName(<span class="stringliteral">&quot;-=&quot;</span>)),</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;           hasLHS(<a class="code" href="namespaceclang_1_1ast__matchers.html#adfc0ccd398780d345e2c541cc716cc66">expr</a>(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>()).bind(PointerArithmeticPointerTag)),</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;           hasRHS(HasIntegerType));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a92d236ec1064f604664b1e9123249e01">binaryOperator</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(PtrAtLeft, PtrAtRight)).bind(PointerArithmeticTag));</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *getBaseStmt()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> PA; }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  DeclUseList getClaimedVarUseSites()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE =</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            dyn_cast&lt;DeclRefExpr&gt;(Ptr-&gt;<a class="code" href="classclang_1_1Expr.html#a54036c75e73ecdf081729210fa53e582">IgnoreParenImpCasts</a>())) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">return</span> {DRE};</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// FIXME: pointer adding zero should be fine</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//FIXME: this gadge will need a fix-it</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;};</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">/// A call of a function or method that performs unchecked buffer operations</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/// over one of its pointer parameters.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span><span class="keyword">class </span>UnsafeBufferUsageAttrGadget : <span class="keyword">public</span> WarningGadget {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    constexpr <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> OpTag = <span class="stringliteral">&quot;call_expr&quot;</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">const</span> <a class="code" href="classclang_1_1CallExpr.html">CallExpr</a> *Op;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    UnsafeBufferUsageAttrGadget(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      : WarningGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>::UnsafeBufferUsageAttr),</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        Op(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1CallExpr.html">CallExpr</a>&gt;(OpTag)) {}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span> G-&gt;getKind() == Kind::UnsafeBufferUsageAttr;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keyword">static</span> Matcher matcher() {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a460801cda670b9a3ccc3d42f51f3bd5c">callExpr</a>(callee(<a class="code" href="namespaceclang_1_1ast__matchers.html#ab95624c30888b0c7688e3a6171ed49cc">functionDecl</a>(<a class="code" href="SemaCUDA_8cpp.html#a6d28c44d89e5f716fbc724a19a6c9b6b">hasAttr</a>(attr::UnsafeBufferUsage))))</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                          .bind(OpTag));</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *getBaseStmt()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> Op; }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  DeclUseList getClaimedVarUseSites()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;};</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">// Represents expressions of the form `DRE[*]` in the Unspecified Lvalue</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">// Context (see `isInUnspecifiedLvalueContext`).</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">// Note here `[]` is the built-in subscript operator.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keyword">class </span>ULCArraySubscriptGadget : <span class="keyword">public</span> FixableGadget {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> ULCArraySubscriptTag = <span class="stringliteral">&quot;ArraySubscriptUnderULC&quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1ArraySubscriptExpr.html">ArraySubscriptExpr</a> *<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  ULCArraySubscriptGadget(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      : FixableGadget(<a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a>::ULCArraySubscript),</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>(Result.<a class="code" href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a>.getNodeAs&lt;<a class="code" href="classclang_1_1ArraySubscriptExpr.html">ArraySubscriptExpr</a>&gt;(ULCArraySubscriptTag)) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    assert(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a> != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;Expecting a non-null matching result&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> classof(<span class="keyword">const</span> Gadget *G) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> G-&gt;getKind() == Kind::ULCArraySubscript;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keyword">static</span> Matcher matcher() {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keyword">auto</span> ArrayOrPtr = <a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>(), <a class="code" href="UnsafeBufferUsage_8cpp.html#a0e4bc071c0823385f333bf16e21b4a74">hasArrayType</a>());</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keyword">auto</span> BaseIsArrayOrPtrDRE =</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        hasBase(ignoringParenImpCasts(<a class="code" href="namespaceclang_1_1ast__matchers.html#a0781cbe6d50bd620cb6f8f0627378be6">declRefExpr</a>(ArrayOrPtr)));</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespaceclang.html#acdf88ec6c845aa781824469fcb0af66cac41a31890959544c6523af684561abe5">Target</a> =</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="namespaceclang_1_1ast__matchers.html#a770b1eeabaf13b5ab1547634f8fef742">arraySubscriptExpr</a>(BaseIsArrayOrPtrDRE).bind(ULCArraySubscriptTag);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceclang_1_1ast__matchers.html#adfc0ccd398780d345e2c541cc716cc66">expr</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#a497f598be79aeb12a5efe58d2157edd0">isInUnspecifiedLvalueContext</a>(Target));</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keyword">virtual</span> std::optional&lt;FixItList&gt; getFixits(<span class="keyword">const</span> Strategy &amp;S) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classclang_1_1Stmt.html">Stmt</a> *getBaseStmt()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>; }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">virtual</span> DeclUseList getClaimedVarUseSites()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE = dyn_cast&lt;DeclRefExpr&gt;(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>-&gt;getBase()-&gt;IgnoreImpCasts())) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">return</span> {DRE};</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;};</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">// An auxiliary tracking facility for the fixit analysis. It helps connect</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">// declarations to its and make sure we&#39;ve covered all uses with our analysis</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">// before we try to fix the declaration.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">class </span>DeclUseTracker {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">using</span> UseSetTy = SmallSet&lt;const DeclRefExpr *, 16&gt;;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">using</span> DefMapTy = DenseMap&lt;const VarDecl *, const DeclStmt *&gt;;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// Allocate on the heap for easier move.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  std::unique_ptr&lt;UseSetTy&gt; Uses{std::make_unique&lt;UseSetTy&gt;()};</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  DefMapTy Defs{};</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  DeclUseTracker() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  DeclUseTracker(<span class="keyword">const</span> DeclUseTracker &amp;) = <span class="keyword">delete</span>; <span class="comment">// Let&#39;s avoid copies.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  DeclUseTracker(DeclUseTracker &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  DeclUseTracker &amp;operator=(DeclUseTracker &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// Start tracking a freshly discovered DRE.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordtype">void</span> discoverUse(<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *DRE) { Uses-&gt;insert(DRE); }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">// Stop tracking the DRE as it&#39;s been fully figured out.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">void</span> claimUse(<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *DRE) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    assert(Uses-&gt;count(DRE) &amp;&amp;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;           <span class="stringliteral">&quot;DRE not found or claimed by multiple matchers!&quot;</span>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    Uses-&gt;erase(DRE);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// A variable is unclaimed if at least one use is unclaimed.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">bool</span> hasUnclaimedUses(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// FIXME: Can this be less linear? Maybe maintain a map from VDs to DREs?</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">return</span> any_of(*Uses, [VD](<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *DRE) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">return</span> DRE-&gt;<a class="code" href="classclang_1_1DeclRefExpr.html#a22eec021070f5d0733e90b6c5c127a25">getDecl</a>()-&gt;<a class="code" href="IndexingContext_8cpp.html#a35cbf522872a806ddf6a0b69a764bb33">getCanonicalDecl</a>() == VD-&gt;<a class="code" href="classclang_1_1VarDecl.html#a41b791be900d5c37eea9fd8ead366308">getCanonicalDecl</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    });</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">void</span> discoverDecl(<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclStmt.html">DeclStmt</a> *DS) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1Decl.html">Decl</a> *D : DS-&gt;<a class="code" href="classclang_1_1DeclStmt.html#a7cec819a5719da508935ab626d02ddc1">decls</a>()) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *VD = dyn_cast&lt;VarDecl&gt;(D)) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">// FIXME: Assertion temporarily disabled due to a bug in</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// ASTMatcher internal behavior in presence of GNU</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// statement-expressions. We need to properly investigate this</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// because it can screw up our algorithm in other ways.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">// assert(Defs.count(VD) == 0 &amp;&amp; &quot;Definition already discovered!&quot;);</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        Defs[VD] = DS;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1DeclStmt.html">DeclStmt</a> *lookupDecl(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keyword">auto</span> It = Defs.find(VD);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    assert(It != Defs.end() &amp;&amp; <span class="stringliteral">&quot;Definition never discovered!&quot;</span>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> It-&gt;second;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;};</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">// Strategy is a map from variables to the way we plan to emit fixes for</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">// these variables. It is figured out gradually by trying different fixes</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">// for different variables depending on gadgets in which these variables</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">// participate.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keyword">class </span>Strategy {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keyword">enum class</span> <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    Wontfix,    <span class="comment">// We don&#39;t plan to emit a fixit for this variable.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    Span,       <span class="comment">// We recommend replacing the variable with std::span.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    Iterator,   <span class="comment">// We recommend replacing the variable with std::span::iterator.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    Array,      <span class="comment">// We recommend replacing the variable with std::array.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="namespaceclang_1_1RISCV.html#a1612a397775abd89925c4d75ffd8ff6ba57dea6f5039281b7fee517fc43bf3110">Vector</a>      <span class="comment">// We recommend replacing the variable with std::vector.</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  };</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">using</span> <a class="code" href="ParentMap_8cpp.html#a9678f6646317beaaf39f5b01eba500a4">MapTy</a> = llvm::DenseMap&lt;const VarDecl *, Kind&gt;;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="ParentMap_8cpp.html#a9678f6646317beaaf39f5b01eba500a4">MapTy</a> Map;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  Strategy() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  Strategy(<span class="keyword">const</span> Strategy &amp;) = <span class="keyword">delete</span>; <span class="comment">// Let&#39;s avoid copies.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  Strategy(Strategy &amp;&amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="lib_2Analysis_2plugins_2CheckerDependencyHandling_2CMakeLists_8txt.html#a683a3174a12f54668fcda805c841439b">set</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD, <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> K) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    Map[VD] = K;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <a class="code" href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">Kind</a> lookup(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keyword">auto</span> I = Map.find(VD);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (I == Map.end())</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">return</span> Kind::Wontfix;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span> I-&gt;second;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;};</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">/// Scan the function and return a list of gadgets found with provided kits.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::tuple&lt;FixableGadgetList, WarningGadgetList, DeclUseTracker&gt;</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#ac8762f4d953c676db02e3f6ff5db1a13">  558</a></span>&#160;<a class="code" href="UnsafeBufferUsage_8cpp.html#ac8762f4d953c676db02e3f6ff5db1a13">findGadgets</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1Decl.html">Decl</a> *D, <span class="keyword">const</span> <a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html">UnsafeBufferUsageHandler</a> &amp;Handler) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keyword">struct </span>GadgetFinderCallback : <a class="code" href="classclang_1_1ast__matchers_1_1MatchFinder_1_1MatchCallback.html">MatchFinder::MatchCallback</a> {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    FixableGadgetList FixableGadgets;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    WarningGadgetList WarningGadgets;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    DeclUseTracker Tracker;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="namespaceclang_1_1transformer.html#a921e8ddbba8c309497d048a702b819e9">run</a>(<span class="keyword">const</span> <a class="code" href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">MatchFinder::MatchResult</a> &amp;Result)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">// In debug mode, assert that we&#39;ve found exactly one gadget.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="comment">// This helps us avoid conflicts in .bind() tags.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#if NDEBUG</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">#define NEXT return</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      [[maybe_unused]] <span class="keywordtype">int</span> numFound = 0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">#define NEXT ++numFound</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE = Result.Nodes.getNodeAs&lt;<a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a>&gt;(<span class="stringliteral">&quot;any_dre&quot;</span>)) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        Tracker.discoverUse(DRE);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="UnsafeBufferUsage_8cpp.html#a2be29dbf95b4a2c822f307a5b8141184">NEXT</a>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DS = Result.Nodes.getNodeAs&lt;<a class="code" href="classclang_1_1DeclStmt.html">DeclStmt</a>&gt;(<span class="stringliteral">&quot;any_ds&quot;</span>)) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        Tracker.discoverDecl(DS);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="UnsafeBufferUsage_8cpp.html#a2be29dbf95b4a2c822f307a5b8141184">NEXT</a>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="comment">// Figure out which matcher we&#39;ve found, and call the appropriate</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="comment">// subclass constructor.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">// FIXME: Can we do this more logarithmically?</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">#define FIXABLE_GADGET(name)                                                           \</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">      if (Result.Nodes.getNodeAs&lt;Stmt&gt;(#name)) {                               \</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">        FixableGadgets.push_back(std::make_unique&lt;name ## Gadget&gt;(Result));           \</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor">        NEXT;                                                                  \</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">      }</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#include &quot;clang/Analysis/Analyses/UnsafeBufferUsageGadgets.def&quot;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#define WARNING_GADGET(name)                                                           \</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">      if (Result.Nodes.getNodeAs&lt;Stmt&gt;(#name)) {                               \</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor">        WarningGadgets.push_back(std::make_unique&lt;name ## Gadget&gt;(Result));           \</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">        NEXT;                                                                  \</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">      }</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">#include &quot;clang/Analysis/Analyses/UnsafeBufferUsageGadgets.def&quot;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      assert(numFound &gt;= 1 &amp;&amp; <span class="stringliteral">&quot;Gadgets not found in match result!&quot;</span>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      assert(numFound &lt;= 1 &amp;&amp; <span class="stringliteral">&quot;Conflicting bind tags in gadgets!&quot;</span>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  };</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <a class="code" href="classclang_1_1ast__matchers_1_1MatchFinder.html">MatchFinder</a> M;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  GadgetFinderCallback CB;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// clang-format off</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  M.<a class="code" href="classclang_1_1ast__matchers_1_1MatchFinder.html#a5db879ac2c5df2b4e124946e0c5995e9">addMatcher</a>(</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(forEveryDescendant(</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="namespaceclang_1_1ast__matchers.html#ab0c3c535f34a336b4e966342d44a631d">eachOf</a>(</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="comment">// A `FixableGadget` matcher and a `WarningGadget` matcher should not disable</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="comment">// each other (they could if they were put in the same `anyOf` group).</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// We also should make sure no two `FixableGadget` (resp. `WarningGadget`) matchers</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="comment">// match for the same node, so that we can group them</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">// in one `anyOf` group (for better performance via short-circuiting).</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;#define <a class="code" href="UnsafeBufferUsage_8cpp.html#a63ae729f58bcaa164d079f52f60ff8e8">FIXABLE_GADGET</a>(<a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a>)                                                              \</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a> ## Gadget::matcher().bind(#<a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a>),</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;#<a class="code" href="lib_2DirectoryWatcher_2CMakeLists_8txt.html#ac5a22097d514692a50f9f31ff3cd503a">include</a> <span class="stringliteral">&quot;clang/Analysis/Analyses/UnsafeBufferUsageGadgets.def&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// Also match DeclStmts because we&#39;ll need them when fixing</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// their underlying VarDecls that otherwise don&#39;t have</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">// any backreferences to DeclStmts.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="namespaceclang_1_1ast__matchers.html#adc3d4ad0df1926038d75178efe06dcd8">declStmt</a>().bind(<span class="stringliteral">&quot;any_ds&quot;</span>)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      )),</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">stmt</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">// Add Gadget::matcher() for every gadget in the registry.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;#define <a class="code" href="UnsafeBufferUsage_8cpp.html#a8297f008a299509c494ee2152be49cf6">WARNING_GADGET</a>(<a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a>)                                                              \</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <a class="code" href="namespaceclang_1_1ast__matchers.html#ab7f7f0b785ca07327256931286ebc99f">allOf</a>(<a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a> ## Gadget::matcher().bind(#<a class="code" href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a>), notInSafeBufferOptOut(&amp;Handler)),</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;#<a class="code" href="lib_2DirectoryWatcher_2CMakeLists_8txt.html#ac5a22097d514692a50f9f31ff3cd503a">include</a> <span class="stringliteral">&quot;clang/Analysis/Analyses/UnsafeBufferUsageGadgets.def&quot;</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">// In parallel, match all DeclRefExprs so that to find out</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment">// whether there are any uncovered by gadgets.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="namespaceclang_1_1ast__matchers.html#a0781cbe6d50bd620cb6f8f0627378be6">declRefExpr</a>(<a class="code" href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">anyOf</a>(<a class="code" href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a>(), <a class="code" href="UnsafeBufferUsage_8cpp.html#a0e4bc071c0823385f333bf16e21b4a74">hasArrayType</a>()), to(<a class="code" href="namespaceclang_1_1ast__matchers.html#a056e81429237736b6458df18bb538c82">varDecl</a>())).bind(<span class="stringliteral">&quot;any_dre&quot;</span>)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      )))</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    )),</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    &amp;CB</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// clang-format on</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  M.<a class="code" href="classclang_1_1ast__matchers_1_1MatchFinder.html#a8b5a0b1b4d21c32009ad9e75ef8d5502">match</a>(*D-&gt;<a class="code" href="classclang_1_1Decl.html#a3fea7c6b02a9f1f5ef8b9a2f16f02342">getBody</a>(), D-&gt;<a class="code" href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">getASTContext</a>());</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// Gadgets &quot;claim&quot; variables they&#39;re responsible for. Once this loop finishes,</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// the tracker will only track DREs that weren&#39;t claimed by any gadgets,</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// i.e. not understood by the analysis.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;G : CB.FixableGadgets) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE : G-&gt;getClaimedVarUseSites()) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      CB.Tracker.claimUse(DRE);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">return</span> {std::move(CB.FixableGadgets), std::move(CB.WarningGadgets), std::move(CB.Tracker)};</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="structWarningGadgetSets.html">  655</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structWarningGadgetSets.html">WarningGadgetSets</a> {</div>
<div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="structWarningGadgetSets.html#a360b732aeba1e4908d415af11a8718ef">  656</a></span>&#160;  std::map&lt;const VarDecl *, std::set&lt;std::unique_ptr&lt;WarningGadget&gt;&gt;&gt; <a class="code" href="structWarningGadgetSets.html#a360b732aeba1e4908d415af11a8718ef">byVar</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">// These Gadgets are not related to pointer variables (e. g. temporaries).</span></div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="structWarningGadgetSets.html#a4357142dcb3c8e994c75a4903f1b890d">  658</a></span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt;std::unique_ptr&lt;WarningGadget&gt;</a>, 16&gt; <a class="code" href="structWarningGadgetSets.html#a4357142dcb3c8e994c75a4903f1b890d">noVar</a>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;};</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keyword">static</span> <a class="code" href="structWarningGadgetSets.html">WarningGadgetSets</a></div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#ae1eb8d21748b1d2445214a4ac77f34b6">  662</a></span>&#160;<a class="code" href="UnsafeBufferUsage_8cpp.html#ae1eb8d21748b1d2445214a4ac77f34b6">groupWarningGadgetsByVar</a>(WarningGadgetList &amp;&amp;AllUnsafeOperations) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <a class="code" href="structWarningGadgetSets.html">WarningGadgetSets</a> result;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// If some gadgets cover more than one</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// variable, they&#39;ll appear more than once in the map.</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;G : AllUnsafeOperations) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    DeclUseList ClaimedVarUseSites = G-&gt;getClaimedVarUseSites();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordtype">bool</span> AssociatedWithVarDecl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *DRE : ClaimedVarUseSites) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *VD = dyn_cast&lt;VarDecl&gt;(DRE-&gt;<a class="code" href="classclang_1_1DeclRefExpr.html#a22eec021070f5d0733e90b6c5c127a25">getDecl</a>())) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        result.<a class="code" href="structWarningGadgetSets.html#a360b732aeba1e4908d415af11a8718ef">byVar</a>[VD].emplace(std::move(G));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        AssociatedWithVarDecl = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (!AssociatedWithVarDecl) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      result.<a class="code" href="structWarningGadgetSets.html#a4357142dcb3c8e994c75a4903f1b890d">noVar</a>.emplace_back(std::move(G));</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="structFixableGadgetSets.html">  685</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structFixableGadgetSets.html">FixableGadgetSets</a> {</div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">  686</a></span>&#160;  std::map&lt;const VarDecl *, std::set&lt;std::unique_ptr&lt;FixableGadget&gt;&gt;&gt; <a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;};</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keyword">static</span> <a class="code" href="structFixableGadgetSets.html">FixableGadgetSets</a></div>
<div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#aec92c5c52f7659f98d048d72e32d70ba">  690</a></span>&#160;<a class="code" href="UnsafeBufferUsage_8cpp.html#aec92c5c52f7659f98d048d72e32d70ba">groupFixablesByVar</a>(FixableGadgetList &amp;&amp;AllFixableOperations) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="structFixableGadgetSets.html">FixableGadgetSets</a> FixablesForUnsafeVars;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;F : AllFixableOperations) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    DeclUseList DREs = F-&gt;getClaimedVarUseSites();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1DeclRefExpr.html">DeclRefExpr</a> *DRE : DREs) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *VD = dyn_cast&lt;VarDecl&gt;(DRE-&gt;<a class="code" href="classclang_1_1DeclRefExpr.html#a22eec021070f5d0733e90b6c5c127a25">getDecl</a>())) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        FixablesForUnsafeVars.<a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>[VD].emplace(std::move(F));</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">return</span> FixablesForUnsafeVars;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="namespaceclang_1_1internal.html#aa470c7cd6c3664bdd468857c8a43ff5b">  704</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceclang_1_1internal.html#aa470c7cd6c3664bdd468857c8a43ff5b">clang::internal::anyConflict</a>(</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;FixItHint&gt;</a> &amp;FixIts, <span class="keyword">const</span> <a class="code" href="classclang_1_1SourceManager.html">SourceManager</a> &amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="comment">// A simple interval overlap detection algorithm.  Sorts all ranges by their</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// begin location then finds the first overlap in one pass.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  std::vector&lt;const FixItHint *&gt; All; <span class="comment">// a copy of `FixIts`</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1FixItHint.html">FixItHint</a> &amp;H : FixIts)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    All.push_back(&amp;H);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  std::sort(All.begin(), All.end(),</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            [&amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>](<span class="keyword">const</span> <a class="code" href="classclang_1_1FixItHint.html">FixItHint</a> *H1, <span class="keyword">const</span> <a class="code" href="classclang_1_1FixItHint.html">FixItHint</a> *H2) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              return SM.isBeforeInTranslationUnit(H1-&gt;RemoveRange.getBegin(),</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                                  H2-&gt;RemoveRange.getBegin());</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            });</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1FixItHint.html">FixItHint</a> *CurrHint = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1FixItHint.html">FixItHint</a> *Hint : All) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span> (!CurrHint ||</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>.isBeforeInTranslationUnit(CurrHint-&gt;<a class="code" href="classclang_1_1FixItHint.html#a5f7f3e68c26742c35764ebd1b0e94abb">RemoveRange</a>.<a class="code" href="classclang_1_1CharSourceRange.html#a7f0959555c02fe4f43bbc325c33238e4">getEnd</a>(),</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                     Hint-&gt;RemoveRange.getBegin())) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">// Either to initialize `CurrHint` or `CurrHint` does not</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="comment">// overlap with `Hint`:</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      CurrHint = Hint;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="comment">// In case `Hint` overlaps the `CurrHint`, we found at least one</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">// conflict:</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;std::optional&lt;FixItList&gt;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;ULCArraySubscriptGadget::getFixits(<span class="keyword">const</span> Strategy &amp;S)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *DRE = dyn_cast&lt;DeclRefExpr&gt;(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>-&gt;getBase()-&gt;IgnoreImpCasts()))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *VD = dyn_cast&lt;VarDecl&gt;(DRE-&gt;<a class="code" href="classclang_1_1DeclRefExpr.html#a22eec021070f5d0733e90b6c5c127a25">getDecl</a>())) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">switch</span> (S.lookup(VD)) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">case</span> Strategy::Kind::Span: {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="comment">// If the index has a negative constant value, we give up as no valid</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment">// fix-it can be generated:</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keyword">const</span> <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx = <span class="comment">// FIXME: we need ASTContext to be passed in!</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            VD-&gt;<a class="code" href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">getASTContext</a>();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> ConstVal = <a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>-&gt;getIdx()-&gt;getIntegerConstantExpr(Ctx)) {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="keywordflow">if</span> (ConstVal-&gt;isNegative())</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>-&gt;getIdx()-&gt;getType()-&gt;isUnsignedIntegerType())</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="comment">// no-op is a good fix-it, otherwise</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">return</span> FixItList{};</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">case</span> Strategy::Kind::Wontfix:</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">case</span> Strategy::Kind::Iterator:</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">case</span> Strategy::Kind::Array:</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">case</span> Strategy::Kind::Vector:</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        llvm_unreachable(<span class="stringliteral">&quot;unsupported strategies for FixableGadgets&quot;</span>);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;}</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">// Return the text representation of the given `APInt Val`:</span></div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#aed4bd58dbb8c51de9f6e744054ea1fb9">  764</a></span>&#160;<span class="keyword">static</span> <a class="code" href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">std::string</a> <a class="code" href="UnsafeBufferUsage_8cpp.html#aed4bd58dbb8c51de9f6e744054ea1fb9">getAPIntText</a>(<a class="code" href="namespaceclang_1_1interp.html#a16635f6b52b1f71a033528c95bc58274">APInt</a> Val) {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;char&gt;</a> Txt;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  Val.toString(Txt, 10, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">// APInt::toString does not add &#39;\0&#39; to the end of the string for us:</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  Txt.push_back(<span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">return</span> Txt.data();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">// Return the source location of the last character of the AST `Node`.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NodeTy&gt;</div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#ae8d3398374a3efe38a50eb6b5e3620f0">  774</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classclang_1_1SourceLocation.html">SourceLocation</a> <a class="code" href="UnsafeBufferUsage_8cpp.html#ae8d3398374a3efe38a50eb6b5e3620f0">getEndCharLoc</a>(<span class="keyword">const</span> NodeTy *<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>, <span class="keyword">const</span> <a class="code" href="classclang_1_1SourceManager.html">SourceManager</a> &amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classclang_1_1LangOptions.html">LangOptions</a> &amp;LangOpts) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">return</span> Lexer::getLocForEndOfToken(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>-&gt;getEndLoc(), 1, <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>, LangOpts);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">// Return the source location just past the last character of the AST `Node`.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NodeTy&gt;</div>
<div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#acd683bba36f6481a7058b3a031545e23">  781</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classclang_1_1SourceLocation.html">SourceLocation</a> <a class="code" href="UnsafeBufferUsage_8cpp.html#acd683bba36f6481a7058b3a031545e23">getPastLoc</a>(<span class="keyword">const</span> NodeTy *<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>, <span class="keyword">const</span> <a class="code" href="classclang_1_1SourceManager.html">SourceManager</a> &amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classclang_1_1LangOptions.html">LangOptions</a> &amp;LangOpts) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">return</span> Lexer::getLocForEndOfToken(<a class="code" href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a>-&gt;getEndLoc(), 0, <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>, LangOpts);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">// Return text representation of an `Expr`.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#a5eedcfd9f44c186fca93b0fb695e0d6a">  787</a></span>&#160;<span class="keyword">static</span> StringRef <a class="code" href="UnsafeBufferUsage_8cpp.html#a5eedcfd9f44c186fca93b0fb695e0d6a">getExprText</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *E, <span class="keyword">const</span> <a class="code" href="classclang_1_1SourceManager.html">SourceManager</a> &amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classclang_1_1LangOptions.html">LangOptions</a> &amp;LangOpts) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="classclang_1_1SourceLocation.html">SourceLocation</a> LastCharLoc = <a class="code" href="UnsafeBufferUsage_8cpp.html#acd683bba36f6481a7058b3a031545e23">getPastLoc</a>(E, <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>, LangOpts);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">return</span> Lexer::getSourceText(</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      CharSourceRange::getCharRange(E-&gt;<a class="code" href="classclang_1_1Stmt.html#ae1bc6287562ce48c56562a69e7f637de">getBeginLoc</a>(), LastCharLoc), <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>,</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      LangOpts);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;}</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">// For a non-null initializer `Init` of `T *` type, this function returns</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">// `FixItHint`s producing a list initializer `{Init,  S}` as a part of a fix-it</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">// to output stream.</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">// In many cases, this function cannot figure out the actual extent `S`.  It</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">// then will use a place holder to replace `S` to ask users to fill `S` in.  The</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">// initializer shall be used to initialize a variable of type `std::span&lt;T&gt;`.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">// FIXME: Support multi-level pointers</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">// Parameters:</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">//   `Init` a pointer to the initializer expression</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">//   `Ctx` a reference to the ASTContext</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keyword">static</span> FixItList</div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#ae1bca80e04c5ab998b43400a97d54260">  809</a></span>&#160;<a class="code" href="UnsafeBufferUsage_8cpp.html#ae1bca80e04c5ab998b43400a97d54260">populateInitializerFixItWithSpan</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Init, <span class="keyword">const</span> <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx,</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                 <span class="keyword">const</span> StringRef UserFillPlaceHolder) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  FixItList FixIts{};</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1SourceManager.html">SourceManager</a> &amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a> = Ctx.<a class="code" href="classclang_1_1ASTContext.html#a091e2575135f7f9f1aeb25ba0090bfde">getSourceManager</a>();</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1LangOptions.html">LangOptions</a> &amp;LangOpts = Ctx.<a class="code" href="classclang_1_1ASTContext.html#a5d08520048c29a58b06a07f1bfb69b77">getLangOpts</a>();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">std::string</a> ExtentText = UserFillPlaceHolder.data();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  StringRef One = <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// Insert `{` before `Init`:</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  FixIts.push_back(FixItHint::CreateInsertion(Init-&gt;getBeginLoc(), <span class="stringliteral">&quot;{&quot;</span>));</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// Try to get the data extent. Break into different cases:</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> CxxNew = dyn_cast&lt;CXXNewExpr&gt;(Init-&gt;IgnoreImpCasts())) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// In cases `Init` is `new T[n]` and there is no explicit cast over</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// `Init`, we know that `Init` must evaluates to a pointer to `n` objects</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">// of `T`. So the extent is `n` unless `n` has side effects.  Similar but</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">// simpler for the case where `Init` is `new T`.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Ext = CxxNew-&gt;getArraySize().value_or(<span class="keyword">nullptr</span>)) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">if</span> (!Ext-&gt;HasSideEffects(Ctx))</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        ExtentText = <a class="code" href="UnsafeBufferUsage_8cpp.html#a5eedcfd9f44c186fca93b0fb695e0d6a">getExprText</a>(Ext, <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>, LangOpts);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!CxxNew-&gt;isArray())</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// Although the initializer is not allocating a buffer, the pointer</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="comment">// variable could still be used in buffer access operations.</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      ExtentText = One;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *CArrTy = Ctx.<a class="code" href="classclang_1_1ASTContext.html#a54d2386e12cd16689dd812d63b85560f">getAsConstantArrayType</a>(</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                 Init-&gt;IgnoreImpCasts()-&gt;getType())) {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// In cases `Init` is of an array type after stripping off implicit casts,</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// the extent is the array size.  Note that if the array size is not a</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// constant, we cannot use it as the extent.</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    ExtentText = <a class="code" href="UnsafeBufferUsage_8cpp.html#aed4bd58dbb8c51de9f6e744054ea1fb9">getAPIntText</a>(CArrTy-&gt;getSize());</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// In cases `Init` is of the form `&amp;Var` after stripping of implicit</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// casts, where `&amp;` is the built-in operator, the extent is 1.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> AddrOfExpr = dyn_cast&lt;UnaryOperator&gt;(Init-&gt;IgnoreImpCasts()))</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">if</span> (AddrOfExpr-&gt;getOpcode() == UnaryOperatorKind::UO_AddrOf &amp;&amp;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          isa_and_present&lt;DeclRefExpr&gt;(AddrOfExpr-&gt;getSubExpr()))</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        ExtentText = One;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// TODO: we can handle more cases, e.g., `&amp;a[0]`, `&amp;a`, `std::addressof`, and explicit casting, etc.</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">// etc.</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;32&gt;</a> StrBuffer{};</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <a class="code" href="classclang_1_1SourceLocation.html">SourceLocation</a> LocPassInit = <a class="code" href="UnsafeBufferUsage_8cpp.html#acd683bba36f6481a7058b3a031545e23">getPastLoc</a>(Init, <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>, LangOpts);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  StrBuffer.append(<span class="stringliteral">&quot;, &quot;</span>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  StrBuffer.append(ExtentText);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  StrBuffer.append(<span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  FixIts.push_back(FixItHint::CreateInsertion(LocPassInit, StrBuffer.str()));</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">return</span> FixIts;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">// For a `VarDecl` of the form `T  * var (= Init)?`, this</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">// function generates a fix-it for the declaration, which re-declares `var` to</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">// be of `span&lt;T&gt;` type and transforms the initializer, if present, to a span</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">// constructor---`span&lt;T&gt; var {Init, Extent}`, where `Extent` may need the user</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">// to fill in.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">// FIXME: support Multi-level pointers</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">// Parameters:</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">//   `D` a pointer the variable declaration node</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//   `Ctx` a reference to the ASTContext</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">// Returns:</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">//    the generated fix-it</span></div>
<div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#a211f1a537c20983d8d02bf96ef475c2e">  872</a></span>&#160;<span class="keyword">static</span> FixItList <a class="code" href="UnsafeBufferUsage_8cpp.html#a211f1a537c20983d8d02bf96ef475c2e">fixVarDeclWithSpan</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *D, <span class="keyword">const</span> <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx,</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                    <span class="keyword">const</span> StringRef UserFillPlaceHolder) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1QualType.html">QualType</a> &amp;SpanEltT = D-&gt;<a class="code" href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">getType</a>()-&gt;<a class="code" href="classclang_1_1Type.html#a56c474868f4027b847f181f99b226f47">getPointeeType</a>();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  assert(!SpanEltT.<a class="code" href="classclang_1_1QualType.html#a54127635d2ca4754e91ee96b594eff74">isNull</a>() &amp;&amp; <span class="stringliteral">&quot;Trying to fix a non-pointer type variable!&quot;</span>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  FixItList FixIts{};</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <a class="code" href="classclang_1_1SourceLocation.html">SourceLocation</a></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      ReplacementLastLoc; <span class="comment">// the inclusive end location of the replacement</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1SourceManager.html">SourceManager</a> &amp;<a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a> = Ctx.<a class="code" href="classclang_1_1ASTContext.html#a091e2575135f7f9f1aeb25ba0090bfde">getSourceManager</a>();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1Expr.html">Expr</a> *Init = D-&gt;<a class="code" href="classclang_1_1VarDecl.html#ad8df9632390e9a81716f89a7beb65131">getInit</a>()) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    FixItList InitFixIts =</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <a class="code" href="UnsafeBufferUsage_8cpp.html#ae1bca80e04c5ab998b43400a97d54260">populateInitializerFixItWithSpan</a>(Init, Ctx, UserFillPlaceHolder);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (InitFixIts.empty())</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">return</span> {}; <span class="comment">// Something wrong with fixing initializer, give up</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">// The loc right before the initializer:</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    ReplacementLastLoc = Init-&gt;getBeginLoc().getLocWithOffset(-1);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    FixIts.insert(FixIts.end(), std::make_move_iterator(InitFixIts.begin()),</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                  std::make_move_iterator(InitFixIts.end()));</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    ReplacementLastLoc = <a class="code" href="UnsafeBufferUsage_8cpp.html#ae8d3398374a3efe38a50eb6b5e3620f0">getEndCharLoc</a>(D, <a class="code" href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a>, Ctx.<a class="code" href="classclang_1_1ASTContext.html#a5d08520048c29a58b06a07f1bfb69b77">getLangOpts</a>());</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// Producing fix-it for variable declaration---make `D` to be of span type:</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;32&gt;</a> Replacement;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  raw_svector_ostream OS(Replacement);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  OS &lt;&lt; <span class="stringliteral">&quot;std::span&lt;&quot;</span> &lt;&lt; SpanEltT.<a class="code" href="classclang_1_1QualType.html#ae248b51eebdb65da5c48bfd8694c7e51">getAsString</a>() &lt;&lt; <span class="stringliteral">&quot;&gt; &quot;</span> &lt;&lt; D-&gt;<a class="code" href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">getName</a>();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  FixIts.push_back(FixItHint::CreateReplacement(</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <a class="code" href="classclang_1_1SourceRange.html">SourceRange</a>{D-&gt;<a class="code" href="classclang_1_1DeclaratorDecl.html#a73cead379a984c4b4ddb6e0d308725f6">getBeginLoc</a>(), ReplacementLastLoc}, OS.str()));</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">return</span> FixIts;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#a1ac3fce44c27e1806333d5fc90472252">  905</a></span>&#160;<span class="keyword">static</span> FixItList <a class="code" href="UnsafeBufferUsage_8cpp.html#a1ac3fce44c27e1806333d5fc90472252">fixVariableWithSpan</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                     <span class="keyword">const</span> DeclUseTracker &amp;Tracker,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                     <a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html">UnsafeBufferUsageHandler</a> &amp;Handler) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keyword">const</span> <a class="code" href="classclang_1_1DeclStmt.html">DeclStmt</a> *DS = Tracker.lookupDecl(VD);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  assert(DS &amp;&amp; <span class="stringliteral">&quot;Fixing non-local variables not implemented yet!&quot;</span>);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span> (!DS-&gt;<a class="code" href="classclang_1_1DeclStmt.html#a2a861b27beb9a32ef27be89e0853f038">isSingleDecl</a>()) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// FIXME: to support handling multiple `VarDecl`s in a single `DeclStmt`</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">return</span>{};</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// Currently DS is an unused variable but we&#39;ll need it when</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// non-single decls are implemented, where the pointee type name</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">// and the &#39;*&#39; are spread around the place.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  (void)DS;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">// FIXME: handle cases where DS has multiple declarations</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="UnsafeBufferUsage_8cpp.html#a211f1a537c20983d8d02bf96ef475c2e">fixVarDeclWithSpan</a>(VD, Ctx, Handler.<a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html#a0af3be049655676899fa150863a99de1">getUserFillPlaceHolder</a>());</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;}</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#a7969107fde82a4eebf050dacbdc6ba1e">  924</a></span>&#160;<span class="keyword">static</span> FixItList <a class="code" href="UnsafeBufferUsage_8cpp.html#a7969107fde82a4eebf050dacbdc6ba1e">fixVariable</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD, Strategy::Kind K,</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                             <span class="keyword">const</span> DeclUseTracker &amp;Tracker,</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx,</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                             <a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html">UnsafeBufferUsageHandler</a> &amp;Handler) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">switch</span> (K) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">case</span> Strategy::Kind::Span: {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span> (VD-&gt;<a class="code" href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">getType</a>()-&gt;<a class="code" href="classclang_1_1Type.html#a3688f77a02d79959b912ca2f28cc4bb9">isPointerType</a>() &amp;&amp; VD-&gt;<a class="code" href="classclang_1_1VarDecl.html#ad734ca1c27c30a24888eaa14c33bd3e0">isLocalVarDecl</a>())</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="UnsafeBufferUsage_8cpp.html#a1ac3fce44c27e1806333d5fc90472252">fixVariableWithSpan</a>(VD, Tracker, Ctx, Handler);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">case</span> Strategy::Kind::Iterator:</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">case</span> Strategy::Kind::Array:</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">case</span> Strategy::Kind::Vector:</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    llvm_unreachable(<span class="stringliteral">&quot;Strategy not implemented yet!&quot;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">case</span> Strategy::Kind::Wontfix:</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    llvm_unreachable(<span class="stringliteral">&quot;Invalid strategy!&quot;</span>);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  llvm_unreachable(<span class="stringliteral">&quot;Unknown strategy!&quot;</span>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">// Returns true iff there exists a `FixItHint` &#39;h&#39; in `FixIts` such that the</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">// `RemoveRange` of &#39;h&#39; overlaps with a macro use.</span></div>
<div class="line"><a name="l00946"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#ab36462d5ee9aa0a96656a59871c9af47">  946</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="UnsafeBufferUsage_8cpp.html#ab36462d5ee9aa0a96656a59871c9af47">overlapWithMacro</a>(<span class="keyword">const</span> FixItList &amp;FixIts) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// FIXME: For now we only check if the range (or the first token) is (part of)</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">// a macro expansion.  Ideally, we want to check for all tokens in the range.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">return</span> llvm::any_of(FixIts, [](<span class="keyword">const</span> <a class="code" href="classclang_1_1FixItHint.html">FixItHint</a> &amp;Hint) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keyword">auto</span> BeginLoc = Hint.<a class="code" href="classclang_1_1FixItHint.html#a5f7f3e68c26742c35764ebd1b0e94abb">RemoveRange</a>.<a class="code" href="classclang_1_1CharSourceRange.html#a83f70cf7266fbd1fc0b9c868593000ec">getBegin</a>();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span> (BeginLoc.isMacroID())</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="comment">// If the range (or the first token) is (part of) a macro expansion:</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  });</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;}</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="keyword">static</span> std::map&lt;const VarDecl *, FixItList&gt;</div>
<div class="line"><a name="l00959"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#aec3710e80b9e0e975de929c9152c2639">  959</a></span>&#160;<a class="code" href="UnsafeBufferUsage_8cpp.html#aec3710e80b9e0e975de929c9152c2639">getFixIts</a>(<a class="code" href="structFixableGadgetSets.html">FixableGadgetSets</a> &amp;FixablesForUnsafeVars, <span class="keyword">const</span> Strategy &amp;S,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          <span class="keyword">const</span> DeclUseTracker &amp;Tracker, <span class="keyword">const</span> <a class="code" href="classclang_1_1ASTContext.html">ASTContext</a> &amp;Ctx,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          <a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html">UnsafeBufferUsageHandler</a> &amp;Handler) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  std::map&lt;const VarDecl *, FixItList&gt; FixItsForVariable;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[VD, Fixables] : FixablesForUnsafeVars.<a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>) {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    FixItsForVariable[VD] = <a class="code" href="UnsafeBufferUsage_8cpp.html#a7969107fde82a4eebf050dacbdc6ba1e">fixVariable</a>(VD, S.lookup(VD), Tracker, Ctx, Handler);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// If we fail to produce Fix-It for the declaration we have to skip the</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// variable entirely.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (FixItsForVariable[VD].empty()) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      FixItsForVariable.erase(VD);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordtype">bool</span> ImpossibleToFix = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt;FixItHint, 16&gt;</a> FixItsForVD;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;F : Fixables) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      std::optional&lt;FixItList&gt; Fixits = F-&gt;getFixits(S);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keywordflow">if</span> (!Fixits) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        ImpossibleToFix = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keyword">const</span> FixItList CorrectFixes = Fixits.value();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        FixItsForVD.insert(FixItsForVD.end(), CorrectFixes.begin(),</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                           CorrectFixes.end());</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> (ImpossibleToFix)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      FixItsForVariable.erase(VD);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      FixItsForVariable[VD].insert(FixItsForVariable[VD].end(),</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                   FixItsForVD.begin(), FixItsForVD.end());</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">// We conservatively discard fix-its of a variable if</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// a fix-it overlaps with macros; or</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// a fix-it conflicts with another one</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="UnsafeBufferUsage_8cpp.html#ab36462d5ee9aa0a96656a59871c9af47">overlapWithMacro</a>(FixItsForVariable[VD]) ||</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <a class="code" href="namespaceclang_1_1internal.html#aa470c7cd6c3664bdd468857c8a43ff5b">clang::internal::anyConflict</a>(FixItsForVariable[VD],</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                     Ctx.<a class="code" href="classclang_1_1ASTContext.html#a091e2575135f7f9f1aeb25ba0090bfde">getSourceManager</a>())) {      </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      FixItsForVariable.erase(VD);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">return</span> FixItsForVariable;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keyword">static</span> Strategy</div>
<div class="line"><a name="l01002"></a><span class="lineno"><a class="line" href="UnsafeBufferUsage_8cpp.html#ab3370ff4edb3561c9578000fc13895cc"> 1002</a></span>&#160;<a class="code" href="UnsafeBufferUsage_8cpp.html#ab3370ff4edb3561c9578000fc13895cc">getNaiveStrategy</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl&lt;const VarDecl *&gt;</a> &amp;UnsafeVars) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  Strategy S;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classclang_1_1VarDecl.html">VarDecl</a> *VD : UnsafeVars) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    S.set(VD, Strategy::Kind::Span);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">return</span> S;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"><a class="line" href="namespaceclang.html#ad047b4f5648c4140b8a9e100d947185f"> 1010</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceclang.html#ad047b4f5648c4140b8a9e100d947185f">clang::checkUnsafeBufferUsage</a>(<span class="keyword">const</span> <a class="code" href="classclang_1_1Decl.html">Decl</a> *D,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                   <a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html">UnsafeBufferUsageHandler</a> &amp;Handler,</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                   <span class="keywordtype">bool</span> EmitFixits) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  assert(D &amp;&amp; D-&gt;<a class="code" href="classclang_1_1Decl.html#a3fea7c6b02a9f1f5ef8b9a2f16f02342">getBody</a>());</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="structWarningGadgetSets.html">WarningGadgetSets</a> UnsafeOps;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="structFixableGadgetSets.html">FixableGadgetSets</a> FixablesForUnsafeVars;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  DeclUseTracker Tracker;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">// FIXME: We could skip even matching Fixables&#39; matchers if EmitFixits ==</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// false.</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keyword">auto</span> [FixableGadgets, WarningGadgets, TrackerRes] = <a class="code" href="UnsafeBufferUsage_8cpp.html#ac8762f4d953c676db02e3f6ff5db1a13">findGadgets</a>(D, Handler);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    UnsafeOps = <a class="code" href="UnsafeBufferUsage_8cpp.html#ae1eb8d21748b1d2445214a4ac77f34b6">groupWarningGadgetsByVar</a>(std::move(WarningGadgets));</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    FixablesForUnsafeVars = <a class="code" href="UnsafeBufferUsage_8cpp.html#aec92c5c52f7659f98d048d72e32d70ba">groupFixablesByVar</a>(std::move(FixableGadgets));</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    Tracker = std::move(TrackerRes);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  std::map&lt;const VarDecl *, FixItList&gt; FixItsForVariable;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">if</span> (EmitFixits) {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">// Filter out non-local vars and vars with unclaimed DeclRefExpr-s.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = FixablesForUnsafeVars.<a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>.cbegin();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         it != FixablesForUnsafeVars.<a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>.cend();) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="comment">// FIXME: Support ParmVarDecl as well.</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">if</span> (!it-&gt;first-&gt;isLocalVarDecl() || Tracker.hasUnclaimedUses(it-&gt;first)) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        it = FixablesForUnsafeVars.<a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>.erase(it);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        ++it;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt;const VarDecl *, 16&gt;</a> UnsafeVars;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[VD, ignore] : FixablesForUnsafeVars.<a class="code" href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">byVar</a>)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      UnsafeVars.push_back(VD);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    Strategy NaiveStrategy = <a class="code" href="UnsafeBufferUsage_8cpp.html#ab3370ff4edb3561c9578000fc13895cc">getNaiveStrategy</a>(UnsafeVars);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    FixItsForVariable = <a class="code" href="UnsafeBufferUsage_8cpp.html#aec3710e80b9e0e975de929c9152c2639">getFixIts</a>(FixablesForUnsafeVars, NaiveStrategy, Tracker,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                  D-&gt;<a class="code" href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">getASTContext</a>(), Handler);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">// FIXME Detect overlapping FixIts.</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;G : UnsafeOps.<a class="code" href="structWarningGadgetSets.html#a4357142dcb3c8e994c75a4903f1b890d">noVar</a>) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    Handler.<a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html#a02ca7bb25b2f284eaa3b603fbd427291">handleUnsafeOperation</a>(G-&gt;getBaseStmt(), <span class="comment">/*IsRelatedToDecl=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[VD, WarningGadgets] : UnsafeOps.<a class="code" href="structWarningGadgetSets.html#a360b732aeba1e4908d415af11a8718ef">byVar</a>) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keyword">auto</span> FixItsIt =</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        EmitFixits ? FixItsForVariable.find(VD) : FixItsForVariable.end();</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    Handler.<a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html#aec1af70d2635ed66eead94f1a3a5e149">handleFixableVariable</a>(VD, FixItsIt != FixItsForVariable.end()</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                                          ? std::move(FixItsIt-&gt;second)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                          : FixItList{});</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;G : WarningGadgets) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      Handler.<a class="code" href="classclang_1_1UnsafeBufferUsageHandler.html#a02ca7bb25b2f284eaa3b603fbd427291">handleUnsafeOperation</a>(G-&gt;getBaseStmt(), <span class="comment">/*IsRelatedToDecl=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassclang_1_1Decl_html_a213239e747fb0b3a0cacd86267339af2"><div class="ttname"><a href="classclang_1_1Decl.html#a213239e747fb0b3a0cacd86267339af2">clang::Decl::getASTContext</a></div><div class="ttdeci">ASTContext &amp; getASTContext() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8cpp_source.html#l00428">DeclBase.cpp:428</a></div></div>
<div class="ttc" id="aSemaCUDA_8cpp_html_a6d28c44d89e5f716fbc724a19a6c9b6b"><div class="ttname"><a href="SemaCUDA_8cpp.html#a6d28c44d89e5f716fbc724a19a6c9b6b">hasAttr</a></div><div class="ttdeci">static bool hasAttr(const FunctionDecl *D, bool IgnoreImplicitAttr)</div><div class="ttdef"><b>Definition:</b> <a href="SemaCUDA_8cpp_source.html#l00108">SemaCUDA.cpp:108</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a5c1b7f433984fa223f8cfa1224b7006d"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a5c1b7f433984fa223f8cfa1224b7006d">hasPointerType</a></div><div class="ttdeci">static auto hasPointerType()</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00153">UnsafeBufferUsage.cpp:153</a></div></div>
<div class="ttc" id="anamespaceclang_1_1threadSafety_1_1sx_html_ad163b9a49653a53393b228df283f89f1"><div class="ttname"><a href="namespaceclang_1_1threadSafety_1_1sx.html#ad163b9a49653a53393b228df283f89f1">clang::threadSafety::sx::equals</a></div><div class="ttdeci">bool equals(const til::SExpr *E1, const til::SExpr *E2)</div><div class="ttdef"><b>Definition:</b> <a href="ThreadSafetyCommon_8h_source.html#l00065">ThreadSafetyCommon.h:65</a></div></div>
<div class="ttc" id="aclassclang_1_1UnsafeBufferUsageHandler_html"><div class="ttname"><a href="classclang_1_1UnsafeBufferUsageHandler.html">clang::UnsafeBufferUsageHandler</a></div><div class="ttdoc">The interface that lets the caller handle unsafe buffer usage analysis results by overriding this cla...</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8h_source.html#l00024">UnsafeBufferUsage.h:24</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">YAML serialization mapping.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00030">Dominators.h:30</a></div></div>
<div class="ttc" id="anamespaceclang_html_ad047b4f5648c4140b8a9e100d947185f"><div class="ttname"><a href="namespaceclang.html#ad047b4f5648c4140b8a9e100d947185f">clang::checkUnsafeBufferUsage</a></div><div class="ttdeci">void checkUnsafeBufferUsage(const Decl *D, UnsafeBufferUsageHandler &amp;Handler, bool EmitFixits)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l01010">UnsafeBufferUsage.cpp:1010</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_ae1eb8d21748b1d2445214a4ac77f34b6"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#ae1eb8d21748b1d2445214a4ac77f34b6">groupWarningGadgetsByVar</a></div><div class="ttdeci">static WarningGadgetSets groupWarningGadgetsByVar(WarningGadgetList &amp;&amp;AllUnsafeOperations)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00662">UnsafeBufferUsage.cpp:662</a></div></div>
<div class="ttc" id="anamespaceclang_1_1interp_html_a16635f6b52b1f71a033528c95bc58274"><div class="ttname"><a href="namespaceclang_1_1interp.html#a16635f6b52b1f71a033528c95bc58274">clang::interp::APInt</a></div><div class="ttdeci">llvm::APInt APInt</div><div class="ttdef"><b>Definition:</b> <a href="Integral_8h_source.html#l00029">Integral.h:29</a></div></div>
<div class="ttc" id="aclassclang_1_1CharSourceRange_html_a83f70cf7266fbd1fc0b9c868593000ec"><div class="ttname"><a href="classclang_1_1CharSourceRange.html#a83f70cf7266fbd1fc0b9c868593000ec">clang::CharSourceRange::getBegin</a></div><div class="ttdeci">SourceLocation getBegin() const</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00283">SourceLocation.h:283</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclaratorDecl_html_a73cead379a984c4b4ddb6e0d308725f6"><div class="ttname"><a href="classclang_1_1DeclaratorDecl.html#a73cead379a984c4b4ddb6e0d308725f6">clang::DeclaratorDecl::getBeginLoc</a></div><div class="ttdeci">SourceLocation getBeginLoc() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00819">Decl.h:819</a></div></div>
<div class="ttc" id="aASTMatchFinder_8cpp_html_a2efebf59722498358b342545b0e3b8ba"><div class="ttname"><a href="ASTMatchFinder_8cpp.html#a2efebf59722498358b342545b0e3b8ba">Nodes</a></div><div class="ttdeci">BoundNodesTreeBuilder Nodes</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8cpp_source.html#l00083">ASTMatchFinder.cpp:83</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceRange_html"><div class="ttname"><a href="classclang_1_1SourceRange.html">clang::SourceRange</a></div><div class="ttdoc">A trivial tuple used to represent a source range.</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00210">SourceLocation.h:210</a></div></div>
<div class="ttc" id="alib_2Tooling_2CMakeLists_8txt_html_af86de1f06488914e30d948a42f397df5"><div class="ttname"><a href="lib_2Tooling_2CMakeLists_8txt.html#af86de1f06488914e30d948a42f397df5">string</a></div><div class="ttdeci">string(SUBSTRING ${CMAKE_CURRENT_BINARY_DIR} 0 ${PATH_LIB_START} PATH_HEAD) string(SUBSTRING $</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Tooling_2CMakeLists_8txt_source.html#l00023">CMakeLists.txt:23</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a0e4bc071c0823385f333bf16e21b4a74"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a0e4bc071c0823385f333bf16e21b4a74">hasArrayType</a></div><div class="ttdeci">static auto hasArrayType()</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00157">UnsafeBufferUsage.cpp:157</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ade2304887c9dd0e9fad2e0ff35320739"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ade2304887c9dd0e9fad2e0ff35320739">clang::ast_matchers::stmt</a></div><div class="ttdeci">const internal::VariadicAllOfMatcher&lt; Stmt &gt; stmt</div><div class="ttdoc">Matches statements.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00811">ASTMatchersInternal.cpp:811</a></div></div>
<div class="ttc" id="aclassclang_1_1VarDecl_html_a41b791be900d5c37eea9fd8ead366308"><div class="ttname"><a href="classclang_1_1VarDecl.html#a41b791be900d5c37eea9fd8ead366308">clang::VarDecl::getCanonicalDecl</a></div><div class="ttdeci">VarDecl * getCanonicalDecl() override</div><div class="ttdoc">Retrieves the &quot;canonical&quot; declaration of the given declaration.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8cpp_source.html#l02186">Decl.cpp:2186</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ae56a1974283c9a2cb2410008e32fe3f1"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ae56a1974283c9a2cb2410008e32fe3f1">clang::ast_matchers::anyOf</a></div><div class="ttdeci">const internal::VariadicOperatorMatcherFunc&lt; 2, std::numeric_limits&lt; unsigned &gt;::max()&gt; anyOf</div><div class="ttdoc">Matches if any of the given matchers matches.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00991">ASTMatchersInternal.cpp:991</a></div></div>
<div class="ttc" id="alib_2DirectoryWatcher_2CMakeLists_8txt_html_ac5a22097d514692a50f9f31ff3cd503a"><div class="ttname"><a href="lib_2DirectoryWatcher_2CMakeLists_8txt.html#ac5a22097d514692a50f9f31ff3cd503a">include</a></div><div class="ttdeci">include(CheckIncludeFiles) set(LLVM_LINK_COMPONENTS support) set(DIRECTORY_WATCHER_SOURCES DirectoryScanner.cpp) set(DIRECTORY_WATCHER_LINK_LIBS &quot;&quot;) if(APPLE) check_include_files(&quot;CoreServices/CoreServices.h&quot; HAVE_CORESERVICES) if(HAVE_CORESERVICES) list(APPEND DIRECTORY_WATCHER_SOURCES mac/DirectoryWatcher-mac.cpp) set(DIRECTORY_WATCHER_LINK_LIBS &quot;-framework CoreServices&quot;) endif() elseif(CMAKE_SYSTEM_NAME MATCHES &quot;Linux&quot;) check_include_files(&quot;sys/inotify.h&quot; HAVE_INOTIFY) if(HAVE_INOTIFY) list(APPEND DIRECTORY_WATCHER_SOURCES linux/DirectoryWatcher-linux.cpp) find_package(Threads REQUIRED) endif() elseif(CMAKE_SYSTEM_NAME MATCHES &quot;Windows&quot;) list(APPEND DIRECTORY_WATCHER_SOURCES windows/DirectoryWatcher-windows.cpp) else() list(APPEND DIRECTORY_WATCHER_SOURCES default/DirectoryWatcher-not-implemented.cpp) endif() add_clang_library(clangDirectoryWatcher $</div><div class="ttdef"><b>Definition:</b> <a href="lib_2DirectoryWatcher_2CMakeLists_8txt_source.html#l00001">CMakeLists.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="LLVM_8h_source.html#l00035">LLVM.h:35</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceLocation_html"><div class="ttname"><a href="classclang_1_1SourceLocation.html">clang::SourceLocation</a></div><div class="ttdoc">Encodes a location in the source.</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00086">SourceLocation.h:86</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchFinder_html"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchFinder.html">clang::ast_matchers::MatchFinder</a></div><div class="ttdoc">A class to allow finding matches over the Clang AST.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8h_source.html#l00069">ASTMatchFinder.h:69</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_ab3370ff4edb3561c9578000fc13895cc"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#ab3370ff4edb3561c9578000fc13895cc">getNaiveStrategy</a></div><div class="ttdeci">static Strategy getNaiveStrategy(const llvm::SmallVectorImpl&lt; const VarDecl * &gt; &amp;UnsafeVars)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l01002">UnsafeBufferUsage.cpp:1002</a></div></div>
<div class="ttc" id="anamespaceclang_html_acdf88ec6c845aa781824469fcb0af66cac41a31890959544c6523af684561abe5"><div class="ttname"><a href="namespaceclang.html#acdf88ec6c845aa781824469fcb0af66cac41a31890959544c6523af684561abe5">clang::MultiVersionKind::Target</a></div><div class="ttdeci">@ Target</div></div>
<div class="ttc" id="aASTMatchersMacros_8h_html_ae9c7f3955d5fdd516853af78dea0ac9c"><div class="ttname"><a href="ASTMatchersMacros_8h.html#ae9c7f3955d5fdd516853af78dea0ac9c">AST_MATCHER_P</a></div><div class="ttdeci">#define AST_MATCHER_P(Type, DefineMatcher, ParamType, Param)</div><div class="ttdoc">AST_MATCHER_P(Type, DefineMatcher, ParamType, Param) { ...</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersMacros_8h_source.html#l00128">ASTMatchersMacros.h:128</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a7969107fde82a4eebf050dacbdc6ba1e"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a7969107fde82a4eebf050dacbdc6ba1e">fixVariable</a></div><div class="ttdeci">static FixItList fixVariable(const VarDecl *VD, Strategy::Kind K, const DeclUseTracker &amp;Tracker, const ASTContext &amp;Ctx, UnsafeBufferUsageHandler &amp;Handler)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00924">UnsafeBufferUsage.cpp:924</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html"><div class="ttname"><a href="classclang_1_1QualType.html">clang::QualType</a></div><div class="ttdoc">A (possibly-)qualified type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00736">Type.h:736</a></div></div>
<div class="ttc" id="anamespaceclang_1_1transformer_html_a921e8ddbba8c309497d048a702b819e9"><div class="ttname"><a href="namespaceclang_1_1transformer.html#a921e8ddbba8c309497d048a702b819e9">clang::transformer::run</a></div><div class="ttdeci">Stencil run(MatchConsumer&lt; std::string &gt; C)</div><div class="ttdoc">Wraps a MatchConsumer in a Stencil, so that it can be used in a Stencil.</div><div class="ttdef"><b>Definition:</b> <a href="Stencil_8cpp_source.html#l00484">Stencil.cpp:484</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ab7f7f0b785ca07327256931286ebc99f"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ab7f7f0b785ca07327256931286ebc99f">clang::ast_matchers::allOf</a></div><div class="ttdeci">const internal::VariadicOperatorMatcherFunc&lt; 2, std::numeric_limits&lt; unsigned &gt;::max()&gt; allOf</div><div class="ttdoc">Matches if all given matchers match.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00994">ASTMatchersInternal.cpp:994</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_ab36462d5ee9aa0a96656a59871c9af47"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#ab36462d5ee9aa0a96656a59871c9af47">overlapWithMacro</a></div><div class="ttdeci">static bool overlapWithMacro(const FixItList &amp;FixIts)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00946">UnsafeBufferUsage.cpp:946</a></div></div>
<div class="ttc" id="aclassclang_1_1UnaryOperator_html"><div class="ttname"><a href="classclang_1_1UnaryOperator.html">clang::UnaryOperator</a></div><div class="ttdoc">UnaryOperator - This represents the unary-expression's (except sizeof and alignof),...</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02175">Expr.h:2175</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html_ae248b51eebdb65da5c48bfd8694c7e51"><div class="ttname"><a href="classclang_1_1QualType.html#ae248b51eebdb65da5c48bfd8694c7e51">clang::QualType::getAsString</a></div><div class="ttdeci">static std::string getAsString(SplitQualType split, const PrintingPolicy &amp;Policy)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l01089">Type.h:1089</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8h_html"><div class="ttname"><a href="UnsafeBufferUsage_8h.html">UnsafeBufferUsage.h</a></div></div>
<div class="ttc" id="aASTMatchFinder_8h_html"><div class="ttname"><a href="ASTMatchFinder_8h.html">ASTMatchFinder.h</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a091e2575135f7f9f1aeb25ba0090bfde"><div class="ttname"><a href="classclang_1_1ASTContext.html#a091e2575135f7f9f1aeb25ba0090bfde">clang::ASTContext::getSourceManager</a></div><div class="ttdeci">SourceManager &amp; getSourceManager()</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00692">ASTContext.h:692</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_aec80fc903341a34de9858cc705228730"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#aec80fc903341a34de9858cc705228730">clang::ast_matchers::MatchDescendantVisitor::TraverseStmt</a></div><div class="ttdeci">bool TraverseStmt(Stmt *Node, DataRecursionQueue *Queue=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00071">UnsafeBufferUsage.cpp:71</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_ae1bca80e04c5ab998b43400a97d54260"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#ae1bca80e04c5ab998b43400a97d54260">populateInitializerFixItWithSpan</a></div><div class="ttdeci">static FixItList populateInitializerFixItWithSpan(const Expr *Init, const ASTContext &amp;Ctx, const StringRef UserFillPlaceHolder)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00809">UnsafeBufferUsage.cpp:809</a></div></div>
<div class="ttc" id="aclassclang_1_1SourceManager_html"><div class="ttname"><a href="classclang_1_1SourceManager.html">clang::SourceManager</a></div><div class="ttdoc">This class handles loading and caching of source files into memory.</div><div class="ttdef"><b>Definition:</b> <a href="SourceManager_8h_source.html#l00638">SourceManager.h:638</a></div></div>
<div class="ttc" id="aPreprocessor_8h_html"><div class="ttname"><a href="Preprocessor_8h.html">Preprocessor.h</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a1ac3fce44c27e1806333d5fc90472252"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a1ac3fce44c27e1806333d5fc90472252">fixVariableWithSpan</a></div><div class="ttdeci">static FixItList fixVariableWithSpan(const VarDecl *VD, const DeclUseTracker &amp;Tracker, const ASTContext &amp;Ctx, UnsafeBufferUsageHandler &amp;Handler)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00905">UnsafeBufferUsage.cpp:905</a></div></div>
<div class="ttc" id="aclassclang_1_1FixItHint_html"><div class="ttname"><a href="classclang_1_1FixItHint.html">clang::FixItHint</a></div><div class="ttdoc">Annotates a diagnostic with some code that should be inserted, removed, or replaced to fix the proble...</div><div class="ttdef"><b>Definition:</b> <a href="Basic_2Diagnostic_8h_source.html#l00071">Diagnostic.h:71</a></div></div>
<div class="ttc" id="astructWarningGadgetSets_html"><div class="ttname"><a href="structWarningGadgetSets.html">WarningGadgetSets</a></div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00655">UnsafeBufferUsage.cpp:655</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_ae8d3398374a3efe38a50eb6b5e3620f0"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#ae8d3398374a3efe38a50eb6b5e3620f0">getEndCharLoc</a></div><div class="ttdeci">static SourceLocation getEndCharLoc(const NodeTy *Node, const SourceManager &amp;SM, const LangOptions &amp;LangOpts)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00774">UnsafeBufferUsage.cpp:774</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_adfc0ccd398780d345e2c541cc716cc66"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#adfc0ccd398780d345e2c541cc716cc66">clang::ast_matchers::expr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, Expr &gt; expr</div><div class="ttdoc">Matches expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00891">ASTMatchersInternal.cpp:891</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html">clang::ast_matchers</a></div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchers_8h_source.html#l00099">ASTMatchers.h:99</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_aec3710e80b9e0e975de929c9152c2639"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#aec3710e80b9e0e975de929c9152c2639">getFixIts</a></div><div class="ttdeci">static std::map&lt; const VarDecl *, FixItList &gt; getFixIts(FixableGadgetSets &amp;FixablesForUnsafeVars, const Strategy &amp;S, const DeclUseTracker &amp;Tracker, const ASTContext &amp;Ctx, UnsafeBufferUsageHandler &amp;Handler)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00959">UnsafeBufferUsage.cpp:959</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a54d2386e12cd16689dd812d63b85560f"><div class="ttname"><a href="classclang_1_1ASTContext.html#a54d2386e12cd16689dd812d63b85560f">clang::ASTContext::getAsConstantArrayType</a></div><div class="ttdeci">const ConstantArrayType * getAsConstantArrayType(QualType T) const</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l02698">ASTContext.h:2698</a></div></div>
<div class="ttc" id="aASTMatchFinder_8cpp_html_a32ca2adfad3611927e87efc253e7b7b1"><div class="ttname"><a href="ASTMatchFinder_8cpp.html#a32ca2adfad3611927e87efc253e7b7b1">Node</a></div><div class="ttdeci">DynTypedNode Node</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8cpp_source.html#l00068">ASTMatchFinder.cpp:68</a></div></div>
<div class="ttc" id="aclassclang_1_1BinaryOperator_html"><div class="ttname"><a href="classclang_1_1BinaryOperator.html">clang::BinaryOperator</a></div><div class="ttdoc">A builtin binary operation expression such as &quot;x + y&quot; or &quot;x &lt;= y&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l03815">Expr.h:3815</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_a00e1dc910659e678ad0dc0f59609b43f"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a00e1dc910659e678ad0dc0f59609b43f">clang::ast_matchers::MatchDescendantVisitor::findMatch</a></div><div class="ttdeci">bool findMatch(const DynTypedNode &amp;DynNode)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00042">UnsafeBufferUsage.cpp:42</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html"><div class="ttname"><a href="classclang_1_1ASTContext.html">clang::ASTContext</a></div><div class="ttdoc">Holds long-lived AST nodes (such as types and decls) that can be referred to throughout the semantic ...</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00182">ASTContext.h:182</a></div></div>
<div class="ttc" id="astructWarningGadgetSets_html_a4357142dcb3c8e994c75a4903f1b890d"><div class="ttname"><a href="structWarningGadgetSets.html#a4357142dcb3c8e994c75a4903f1b890d">WarningGadgetSets::noVar</a></div><div class="ttdeci">llvm::SmallVector&lt; std::unique_ptr&lt; WarningGadget &gt;, 16 &gt; noVar</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00658">UnsafeBufferUsage.cpp:658</a></div></div>
<div class="ttc" id="aclassclang_1_1RecursiveASTVisitor_html"><div class="ttname"><a href="classclang_1_1RecursiveASTVisitor.html">clang::RecursiveASTVisitor</a></div><div class="ttdoc">A class that does preorder or postorder depth-first traversal on the entire Clang AST and visits each...</div><div class="ttdef"><b>Definition:</b> <a href="RecursiveASTVisitor_8h_source.html#l00152">RecursiveASTVisitor.h:152</a></div></div>
<div class="ttc" id="astructFixableGadgetSets_html"><div class="ttname"><a href="structFixableGadgetSets.html">FixableGadgetSets</a></div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00685">UnsafeBufferUsage.cpp:685</a></div></div>
<div class="ttc" id="alib_2Analysis_2plugins_2CheckerDependencyHandling_2CMakeLists_8txt_html_a683a3174a12f54668fcda805c841439b"><div class="ttname"><a href="lib_2Analysis_2plugins_2CheckerDependencyHandling_2CMakeLists_8txt.html#a683a3174a12f54668fcda805c841439b">set</a></div><div class="ttdeci">set(LLVM_LINK_COMPONENTS Support) set(LLVM_EXPORTED_SYMBOL_FILE $</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Analysis_2plugins_2CheckerDependencyHandling_2CMakeLists_8txt_source.html#l00001">CMakeLists.txt:1</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclRefExpr_html_a22eec021070f5d0733e90b6c5c127a25"><div class="ttname"><a href="classclang_1_1DeclRefExpr.html#a22eec021070f5d0733e90b6c5c127a25">clang::DeclRefExpr::getDecl</a></div><div class="ttdeci">ValueDecl * getDecl()</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l01307">Expr.h:1307</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html"><div class="ttname"><a href="classllvm_1_1SmallString.html">llvm::SmallString&lt; 32 &gt;</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a497f598be79aeb12a5efe58d2157edd0"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a497f598be79aeb12a5efe58d2157edd0">clang::ast_matchers::isInUnspecifiedLvalueContext</a></div><div class="ttdeci">static internal::Matcher&lt; Stmt &gt; isInUnspecifiedLvalueContext(internal::Matcher&lt; Expr &gt; innerMatcher)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00133">UnsafeBufferUsage.cpp:133</a></div></div>
<div class="ttc" id="aclassclang_1_1VarDecl_html"><div class="ttname"><a href="classclang_1_1VarDecl.html">clang::VarDecl</a></div><div class="ttdoc">Represents a variable declaration or definition.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00915">Decl.h:915</a></div></div>
<div class="ttc" id="aclassclang_1_1Type_html_a56c474868f4027b847f181f99b226f47"><div class="ttname"><a href="classclang_1_1Type.html#a56c474868f4027b847f181f99b226f47">clang::Type::getPointeeType</a></div><div class="ttdeci">QualType getPointeeType() const</div><div class="ttdoc">If this is a pointer, ObjC object pointer, or block pointer, this returns the respective pointee.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00629">Type.cpp:629</a></div></div>
<div class="ttc" id="aParentMap_8cpp_html_a9678f6646317beaaf39f5b01eba500a4"><div class="ttname"><a href="ParentMap_8cpp.html#a9678f6646317beaaf39f5b01eba500a4">MapTy</a></div><div class="ttdeci">llvm::DenseMap&lt; Stmt *, Stmt * &gt; MapTy</div><div class="ttdef"><b>Definition:</b> <a href="ParentMap_8cpp_source.html#l00022">ParentMap.cpp:22</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a92d236ec1064f604664b1e9123249e01"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a92d236ec1064f604664b1e9123249e01">clang::ast_matchers::binaryOperator</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, BinaryOperator &gt; binaryOperator</div><div class="ttdoc">Matches binary operator expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00949">ASTMatchersInternal.cpp:949</a></div></div>
<div class="ttc" id="aclassclang_1_1VarDecl_html_ad734ca1c27c30a24888eaa14c33bd3e0"><div class="ttname"><a href="classclang_1_1VarDecl.html#ad734ca1c27c30a24888eaa14c33bd3e0">clang::VarDecl::isLocalVarDecl</a></div><div class="ttdeci">bool isLocalVarDecl() const</div><div class="ttdoc">Returns true for local variable declarations other than parameters.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l01212">Decl.h:1212</a></div></div>
<div class="ttc" id="aclassclang_1_1UnsafeBufferUsageHandler_html_a0af3be049655676899fa150863a99de1"><div class="ttname"><a href="classclang_1_1UnsafeBufferUsageHandler.html#a0af3be049655676899fa150863a99de1">clang::UnsafeBufferUsageHandler::getUserFillPlaceHolder</a></div><div class="ttdeci">virtual std::string getUserFillPlaceHolder(StringRef HintTextToUser=&quot;placeholder&quot;)</div><div class="ttdoc">Returns the text indicating that the user needs to provide input there:</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8h_source.html#l00046">UnsafeBufferUsage.h:46</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_a284d389fa91819abb5e37d4f5f45c16a"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a284d389fa91819abb5e37d4f5f45c16a">clang::ast_matchers::MatchDescendantVisitor::TraverseDecl</a></div><div class="ttdeci">bool TraverseDecl(Decl *Node)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00059">UnsafeBufferUsage.cpp:59</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a183ba07d4205e38e5d960a99062722dc"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a183ba07d4205e38e5d960a99062722dc">clang::ast_matchers::unless</a></div><div class="ttdeci">const internal::VariadicOperatorMatcherFunc&lt; 1, 1 &gt; unless</div><div class="ttdoc">Matches if the provided matcher does not match.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l01027">ASTMatchersInternal.cpp:1027</a></div></div>
<div class="ttc" id="aDeclBase_8cpp_html_a37d13911f1772d0ed90b6b2e89cf3c60"><div class="ttname"><a href="DeclBase_8cpp.html#a37d13911f1772d0ed90b6b2e89cf3c60">getKind</a></div><div class="ttdeci">static Decl::Kind getKind(const Decl *D)</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8cpp_source.html#l01025">DeclBase.cpp:1025</a></div></div>
<div class="ttc" id="aCodeGen_2README_8txt_html_a2f5467b833926827f4292d3ba7fea003"><div class="ttname"><a href="CodeGen_2README_8txt.html#a2f5467b833926827f4292d3ba7fea003">x</a></div><div class="ttdeci">IRgen optimization opportunities The common pattern of short x</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2README_8txt_source.html#l00007">README.txt:7</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchFinder_html_a8b5a0b1b4d21c32009ad9e75ef8d5502"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchFinder.html#a8b5a0b1b4d21c32009ad9e75ef8d5502">clang::ast_matchers::MatchFinder::match</a></div><div class="ttdeci">void match(const T &amp;Node, ASTContext &amp;Context)</div><div class="ttdoc">Calls the registered callbacks on all matches on the given Node.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8h_source.html#l00194">ASTMatchFinder.h:194</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a6733c0e2dab3236688140fb7e73db035"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a6733c0e2dab3236688140fb7e73db035">clang::ast_matchers::arrayType</a></div><div class="ttdeci">const AstTypeMatcher&lt; ArrayType &gt; arrayType</div><div class="ttdoc">Matches all kinds of arrays.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l01036">ASTMatchersInternal.cpp:1036</a></div></div>
<div class="ttc" id="anamespaceclang_1_1RISCV_html_a1612a397775abd89925c4d75ffd8ff6ba57dea6f5039281b7fee517fc43bf3110"><div class="ttname"><a href="namespaceclang_1_1RISCV.html#a1612a397775abd89925c4d75ffd8ff6ba57dea6f5039281b7fee517fc43bf3110">clang::RISCV::BaseTypeModifier::Vector</a></div><div class="ttdeci">@ Vector</div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_aec92c5c52f7659f98d048d72e32d70ba"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#aec92c5c52f7659f98d048d72e32d70ba">groupFixablesByVar</a></div><div class="ttdeci">static FixableGadgetSets groupFixablesByVar(FixableGadgetList &amp;&amp;AllFixableOperations)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00690">UnsafeBufferUsage.cpp:690</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a211f1a537c20983d8d02bf96ef475c2e"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a211f1a537c20983d8d02bf96ef475c2e">fixVarDeclWithSpan</a></div><div class="ttdeci">static FixItList fixVarDeclWithSpan(const VarDecl *D, const ASTContext &amp;Ctx, const StringRef UserFillPlaceHolder)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00872">UnsafeBufferUsage.cpp:872</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ab0c3c535f34a336b4e966342d44a631d"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ab0c3c535f34a336b4e966342d44a631d">clang::ast_matchers::eachOf</a></div><div class="ttdeci">const internal::VariadicOperatorMatcherFunc&lt; 2, std::numeric_limits&lt; unsigned &gt;::max()&gt; eachOf</div><div class="ttdoc">Matches if any of the given matchers matches.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00988">ASTMatchersInternal.cpp:988</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclStmt_html_a2a861b27beb9a32ef27be89e0853f038"><div class="ttname"><a href="classclang_1_1DeclStmt.html#a2a861b27beb9a32ef27be89e0853f038">clang::DeclStmt::isSingleDecl</a></div><div class="ttdeci">bool isSingleDecl() const</div><div class="ttdoc">isSingleDecl - This method returns true if this DeclStmt refers to a single Decl.</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8h_source.html#l01324">Stmt.h:1324</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a71ac1ea4304cca5a3d773782c45e3a9d"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a71ac1ea4304cca5a3d773782c45e3a9d">clang::ast_matchers::unaryOperator</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, UnaryOperator &gt; unaryOperator</div><div class="ttdoc">Matches unary operator expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00954">ASTMatchersInternal.cpp:954</a></div></div>
<div class="ttc" id="anamespaceclang_1_1serialized__diags_html_afb25f8afb2155dc94a6885bca5cb2213"><div class="ttname"><a href="namespaceclang_1_1serialized__diags.html#afb25f8afb2155dc94a6885bca5cb2213">clang::serialized_diags::create</a></div><div class="ttdeci">std::unique_ptr&lt; DiagnosticConsumer &gt; create(StringRef OutputFile, DiagnosticOptions *Diags, bool MergeChildRecords=false)</div><div class="ttdoc">Returns a DiagnosticConsumer that serializes diagnostics to a bitcode file.</div><div class="ttdef"><b>Definition:</b> <a href="SerializedDiagnosticPrinter_8cpp_source.html#l00301">SerializedDiagnosticPrinter.cpp:301</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchFinder_html_a5db879ac2c5df2b4e124946e0c5995e9"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchFinder.html#a5db879ac2c5df2b4e124946e0c5995e9">clang::ast_matchers::MatchFinder::addMatcher</a></div><div class="ttdeci">void addMatcher(const DeclarationMatcher &amp;NodeMatch, MatchCallback *Action)</div><div class="ttdoc">Adds a matcher to execute when running over the AST.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8cpp_source.html#l01563">ASTMatchFinder.cpp:1563</a></div></div>
<div class="ttc" id="aclassclang_1_1Type_html_a3688f77a02d79959b912ca2f28cc4bb9"><div class="ttname"><a href="classclang_1_1Type.html#a3688f77a02d79959b912ca2f28cc4bb9">clang::Type::isPointerType</a></div><div class="ttdeci">bool isPointerType() const</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l06896">Type.h:6896</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a8297f008a299509c494ee2152be49cf6"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a8297f008a299509c494ee2152be49cf6">WARNING_GADGET</a></div><div class="ttdeci">#define WARNING_GADGET(name)</div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_acd683bba36f6481a7058b3a031545e23"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#acd683bba36f6481a7058b3a031545e23">getPastLoc</a></div><div class="ttdeci">static SourceLocation getPastLoc(const NodeTy *Node, const SourceManager &amp;SM, const LangOptions &amp;LangOpts)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00781">UnsafeBufferUsage.cpp:781</a></div></div>
<div class="ttc" id="astdbool_8h_html_a65e9886d74aaee76545e83dd09011727"><div class="ttname"><a href="stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a></div><div class="ttdeci">#define false</div><div class="ttdef"><b>Definition:</b> <a href="stdbool_8h_source.html#l00022">stdbool.h:22</a></div></div>
<div class="ttc" id="aIndexingContext_8cpp_html_a35cbf522872a806ddf6a0b69a764bb33"><div class="ttname"><a href="IndexingContext_8cpp.html#a35cbf522872a806ddf6a0b69a764bb33">getCanonicalDecl</a></div><div class="ttdeci">static const Decl * getCanonicalDecl(const Decl *D)</div><div class="ttdef"><b>Definition:</b> <a href="IndexingContext_8cpp_source.html#l00297">IndexingContext.cpp:297</a></div></div>
<div class="ttc" id="anamespaceclang_1_1internal_html_aa470c7cd6c3664bdd468857c8a43ff5b"><div class="ttname"><a href="namespaceclang_1_1internal.html#aa470c7cd6c3664bdd468857c8a43ff5b">clang::internal::anyConflict</a></div><div class="ttdeci">bool anyConflict(const llvm::SmallVectorImpl&lt; FixItHint &gt; &amp;FixIts, const SourceManager &amp;SM)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00704">UnsafeBufferUsage.cpp:704</a></div></div>
<div class="ttc" id="aclassclang_1_1QualType_html_a54127635d2ca4754e91ee96b594eff74"><div class="ttname"><a href="classclang_1_1QualType.html#a54127635d2ca4754e91ee96b594eff74">clang::QualType::isNull</a></div><div class="ttdeci">bool isNull() const</div><div class="ttdoc">Return true if this QualType doesn't point to a type yet.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00803">Type.h:803</a></div></div>
<div class="ttc" id="aLexer_8h_html"><div class="ttname"><a href="Lexer_8h.html">Lexer.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html"><div class="ttname"><a href="classclang_1_1Decl.html">clang::Decl</a></div><div class="ttdoc">Decl - This represents one declaration (or definition), e.g.</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l00083">DeclBase.h:83</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html_a54036c75e73ecdf081729210fa53e582"><div class="ttname"><a href="classclang_1_1Expr.html#a54036c75e73ecdf081729210fa53e582">clang::Expr::IgnoreParenImpCasts</a></div><div class="ttdeci">Expr * IgnoreParenImpCasts() LLVM_READONLY</div><div class="ttdoc">Skip past any parentheses and implicit casts which might surround this expression until reaching a fi...</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8cpp_source.html#l03036">Expr.cpp:3036</a></div></div>
<div class="ttc" id="aclassclang_1_1ArraySubscriptExpr_html"><div class="ttname"><a href="classclang_1_1ArraySubscriptExpr.html">clang::ArraySubscriptExpr</a></div><div class="ttdoc">ArraySubscriptExpr - [C99 6.5.2.1] Array Subscripting.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02657">Expr.h:2657</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a63ae729f58bcaa164d079f52f60ff8e8"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a63ae729f58bcaa164d079f52f60ff8e8">FIXABLE_GADGET</a></div><div class="ttdeci">#define FIXABLE_GADGET(name)</div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_a1de5b1e597ef9c8598a3923e785c9499"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a1de5b1e597ef9c8598a3923e785c9499">clang::ast_matchers::MatchDescendantVisitor::shouldVisitImplicitCode</a></div><div class="ttdeci">bool shouldVisitImplicitCode() const</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00083">UnsafeBufferUsage.cpp:83</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a770b1eeabaf13b5ab1547634f8fef742"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a770b1eeabaf13b5ab1547634f8fef742">clang::ast_matchers::arraySubscriptExpr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, ArraySubscriptExpr &gt; arraySubscriptExpr</div><div class="ttdoc">Matches array subscript expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00884">ASTMatchersInternal.cpp:884</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_a9d3ab53f09416772b1cdaee6cc34b181"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a9d3ab53f09416772b1cdaee6cc34b181">clang::ast_matchers::MatchDescendantVisitor::MatchDescendantVisitor</a></div><div class="ttdeci">MatchDescendantVisitor(const internal::DynTypedMatcher *Matcher, internal::ASTMatchFinder *Finder, internal::BoundNodesTreeBuilder *Builder, internal::ASTMatchFinder::BindKind Bind)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00033">UnsafeBufferUsage.cpp:33</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_aed4bd58dbb8c51de9f6e744054ea1fb9"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#aed4bd58dbb8c51de9f6e744054ea1fb9">getAPIntText</a></div><div class="ttdeci">static std::string getAPIntText(APInt Val)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00764">UnsafeBufferUsage.cpp:764</a></div></div>
<div class="ttc" id="aclassclang_1_1CharSourceRange_html_a7f0959555c02fe4f43bbc325c33238e4"><div class="ttname"><a href="classclang_1_1CharSourceRange.html#a7f0959555c02fe4f43bbc325c33238e4">clang::CharSourceRange::getEnd</a></div><div class="ttdeci">SourceLocation getEnd() const</div><div class="ttdef"><b>Definition:</b> <a href="SourceLocation_8h_source.html#l00284">SourceLocation.h:284</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a460801cda670b9a3ccc3d42f51f3bd5c"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a460801cda670b9a3ccc3d42f51f3bd5c">clang::ast_matchers::callExpr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, CallExpr &gt; callExpr</div><div class="ttdoc">Matches call expressions.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00818">ASTMatchersInternal.cpp:818</a></div></div>
<div class="ttc" id="aclassclang_1_1VarDecl_html_ad8df9632390e9a81716f89a7beb65131"><div class="ttname"><a href="classclang_1_1VarDecl.html#ad8df9632390e9a81716f89a7beb65131">clang::VarDecl::getInit</a></div><div class="ttdeci">const Expr * getInit() const</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l01327">Decl.h:1327</a></div></div>
<div class="ttc" id="astructclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult_html"><div class="ttname"><a href="structclang_1_1ast__matchers_1_1MatchFinder_1_1MatchResult.html">clang::ast_matchers::MatchFinder::MatchResult</a></div><div class="ttdoc">Contains all information for a given match.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8h_source.html#l00075">ASTMatchFinder.h:75</a></div></div>
<div class="ttc" id="aclassclang_1_1LangOptions_html"><div class="ttname"><a href="classclang_1_1LangOptions.html">clang::LangOptions</a></div><div class="ttdoc">Keeps track of the various options that can be enabled, which controls the dialect of C or C++ that i...</div><div class="ttdef"><b>Definition:</b> <a href="LangOptions_8h_source.html#l00082">LangOptions.h:82</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ObjCPropertyAttribute_html_a5cee046f95725089d626e8e3c42bf60c"><div class="ttname"><a href="namespaceclang_1_1ObjCPropertyAttribute.html#a5cee046f95725089d626e8e3c42bf60c">clang::ObjCPropertyAttribute::Kind</a></div><div class="ttdeci">Kind</div><div class="ttdef"><b>Definition:</b> <a href="DeclObjCCommon_8h_source.html#l00022">DeclObjCCommon.h:22</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclStmt_html"><div class="ttname"><a href="classclang_1_1DeclStmt.html">clang::DeclStmt</a></div><div class="ttdoc">DeclStmt - Adaptor class for mixing declarations with statements and expressions.</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8h_source.html#l01311">Stmt.h:1311</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ab95624c30888b0c7688e3a6171ed49cc"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ab95624c30888b0c7688e3a6171ed49cc">clang::ast_matchers::functionDecl</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Decl, FunctionDecl &gt; functionDecl</div><div class="ttdoc">Matches function declarations.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00807">ASTMatchersInternal.cpp:807</a></div></div>
<div class="ttc" id="aclassclang_1_1Decl_html_a3fea7c6b02a9f1f5ef8b9a2f16f02342"><div class="ttname"><a href="classclang_1_1Decl.html#a3fea7c6b02a9f1f5ef8b9a2f16f02342">clang::Decl::getBody</a></div><div class="ttdeci">virtual Stmt * getBody() const</div><div class="ttdoc">getBody - If this Decl represents a declaration for a body of code, such as a function or method defi...</div><div class="ttdef"><b>Definition:</b> <a href="DeclBase_8h_source.html#l01052">DeclBase.h:1052</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a0781cbe6d50bd620cb6f8f0627378be6"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a0781cbe6d50bd620cb6f8f0627378be6">clang::ast_matchers::declRefExpr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, DeclRefExpr &gt; declRefExpr</div><div class="ttdoc">Matches expressions that refer to declarations.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00892">ASTMatchersInternal.cpp:892</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a34b0467fd444a7daa8a8aa79ec045765"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a34b0467fd444a7daa8a8aa79ec045765">clang::ast_matchers::pointerType</a></div><div class="ttdeci">const AstTypeMatcher&lt; PointerType &gt; pointerType</div><div class="ttdoc">Matches pointer types, but does not match Objective-C object pointer types.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l01052">ASTMatchersInternal.cpp:1052</a></div></div>
<div class="ttc" id="aclassclang_1_1UnaryOperator_html_a804929b99cee522ce0fe5b33fa544e77"><div class="ttname"><a href="classclang_1_1UnaryOperator.html#a804929b99cee522ce0fe5b33fa544e77">clang::UnaryOperator::getSubExpr</a></div><div class="ttdeci">Expr * getSubExpr() const</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02222">Expr.h:2222</a></div></div>
<div class="ttc" id="anamespaceclang_html"><div class="ttname"><a href="namespaceclang.html">clang</a></div><div class="ttdef"><b>Definition:</b> <a href="CalledOnceCheck_8h_source.html#l00017">CalledOnceCheck.h:17</a></div></div>
<div class="ttc" id="aRecursiveASTVisitor_8h_html"><div class="ttname"><a href="RecursiveASTVisitor_8h.html">RecursiveASTVisitor.h</a></div></div>
<div class="ttc" id="aclassclang_1_1Stmt_html"><div class="ttname"><a href="classclang_1_1Stmt.html">clang::Stmt</a></div><div class="ttdoc">Stmt - This represents one statement.</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8h_source.html#l00072">Stmt.h:72</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a58409ce605d979d1d1e0a600ec417a0a"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a58409ce605d979d1d1e0a600ec417a0a">clang::ast_matchers::match</a></div><div class="ttdeci">SmallVector&lt; BoundNodes, 1 &gt; match(MatcherT Matcher, const NodeT &amp;Node, ASTContext &amp;Context)</div><div class="ttdoc">Returns the results of matching Matcher on Node.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8h_source.html#l00313">ASTMatchFinder.h:313</a></div></div>
<div class="ttc" id="aclassclang_1_1UnsafeBufferUsageHandler_html_aec1af70d2635ed66eead94f1a3a5e149"><div class="ttname"><a href="classclang_1_1UnsafeBufferUsageHandler.html#aec1af70d2635ed66eead94f1a3a5e149">clang::UnsafeBufferUsageHandler::handleFixableVariable</a></div><div class="ttdeci">virtual void handleFixableVariable(const VarDecl *Variable, FixItList &amp;&amp;List)=0</div><div class="ttdoc">Invoked when a fix is suggested against a variable.</div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_ad607f8e868c26e106740f5cb7f19f240"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#ad607f8e868c26e106740f5cb7f19f240">clang::ast_matchers::MatchDescendantVisitor::shouldVisitTemplateInstantiations</a></div><div class="ttdeci">bool shouldVisitTemplateInstantiations() const</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00082">UnsafeBufferUsage.cpp:82</a></div></div>
<div class="ttc" id="astructFixableGadgetSets_html_ac48230c990a717aae7bf48e53af534bb"><div class="ttname"><a href="structFixableGadgetSets.html#ac48230c990a717aae7bf48e53af534bb">FixableGadgetSets::byVar</a></div><div class="ttdeci">std::map&lt; const VarDecl *, std::set&lt; std::unique_ptr&lt; FixableGadget &gt; &gt; &gt; byVar</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00686">UnsafeBufferUsage.cpp:686</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclStmt_html_a7cec819a5719da508935ab626d02ddc1"><div class="ttname"><a href="classclang_1_1DeclStmt.html#a7cec819a5719da508935ab626d02ddc1">clang::DeclStmt::decls</a></div><div class="ttdeci">decl_range decls()</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8h_source.html#l01359">Stmt.h:1359</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a2be29dbf95b4a2c822f307a5b8141184"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a2be29dbf95b4a2c822f307a5b8141184">NEXT</a></div><div class="ttdeci">#define NEXT</div></div>
<div class="ttc" id="aclassclang_1_1Stmt_html_ae1bc6287562ce48c56562a69e7f637de"><div class="ttname"><a href="classclang_1_1Stmt.html#ae1bc6287562ce48c56562a69e7f637de">clang::Stmt::getBeginLoc</a></div><div class="ttdeci">SourceLocation getBeginLoc() const LLVM_READONLY</div><div class="ttdef"><b>Definition:</b> <a href="Stmt_8cpp_source.html#l00337">Stmt.cpp:337</a></div></div>
<div class="ttc" id="aclassclang_1_1DynTypedNode_html_a41a5256f73db43cca950c049e5cbcb65"><div class="ttname"><a href="classclang_1_1DynTypedNode.html#a41a5256f73db43cca950c049e5cbcb65">clang::DynTypedNode::get</a></div><div class="ttdeci">const T * get() const</div><div class="ttdoc">Retrieve the stored node as type T.</div><div class="ttdef"><b>Definition:</b> <a href="ASTTypeTraits_8h_source.html#l00268">ASTTypeTraits.h:268</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_ac8762f4d953c676db02e3f6ff5db1a13"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#ac8762f4d953c676db02e3f6ff5db1a13">findGadgets</a></div><div class="ttdeci">static std::tuple&lt; FixableGadgetList, WarningGadgetList, DeclUseTracker &gt; findGadgets(const Decl *D, const UnsafeBufferUsageHandler &amp;Handler)</div><div class="ttdoc">Scan the function and return a list of gadgets found with provided kits.</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00558">UnsafeBufferUsage.cpp:558</a></div></div>
<div class="ttc" id="aclassclang_1_1ArraySubscriptExpr_html_ad303686acb8af8aa3d7169ba7e15f9fd"><div class="ttname"><a href="classclang_1_1ArraySubscriptExpr.html#ad303686acb8af8aa3d7169ba7e15f9fd">clang::ArraySubscriptExpr::getBase</a></div><div class="ttdeci">Expr * getBase()</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02694">Expr.h:2694</a></div></div>
<div class="ttc" id="aUnsafeBufferUsage_8cpp_html_a5eedcfd9f44c186fca93b0fb695e0d6a"><div class="ttname"><a href="UnsafeBufferUsage_8cpp.html#a5eedcfd9f44c186fca93b0fb695e0d6a">getExprText</a></div><div class="ttdeci">static StringRef getExprText(const Expr *E, const SourceManager &amp;SM, const LangOptions &amp;LangOpts)</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00787">UnsafeBufferUsage.cpp:787</a></div></div>
<div class="ttc" id="aclassclang_1_1DynTypedNode_html"><div class="ttname"><a href="classclang_1_1DynTypedNode.html">clang::DynTypedNode</a></div><div class="ttdoc">A dynamically typed AST node container.</div><div class="ttdef"><b>Definition:</b> <a href="ASTTypeTraits_8h_source.html#l00248">ASTTypeTraits.h:248</a></div></div>
<div class="ttc" id="aclassclang_1_1FixItHint_html_a5f7f3e68c26742c35764ebd1b0e94abb"><div class="ttname"><a href="classclang_1_1FixItHint.html#a5f7f3e68c26742c35764ebd1b0e94abb">clang::FixItHint::RemoveRange</a></div><div class="ttdeci">CharSourceRange RemoveRange</div><div class="ttdoc">Code that should be replaced to correct the error.</div><div class="ttdef"><b>Definition:</b> <a href="Basic_2Diagnostic_8h_source.html#l00075">Diagnostic.h:75</a></div></div>
<div class="ttc" id="astructWarningGadgetSets_html_a360b732aeba1e4908d415af11a8718ef"><div class="ttname"><a href="structWarningGadgetSets.html#a360b732aeba1e4908d415af11a8718ef">WarningGadgetSets::byVar</a></div><div class="ttdeci">std::map&lt; const VarDecl *, std::set&lt; std::unique_ptr&lt; WarningGadget &gt; &gt; &gt; byVar</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00656">UnsafeBufferUsage.cpp:656</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="Randstruct_8h_source.html#l00018">Randstruct.h:18</a></div></div>
<div class="ttc" id="aclassclang_1_1ValueDecl_html_a673ae4e2fab42426820de8df166fef5d"><div class="ttname"><a href="classclang_1_1ValueDecl.html#a673ae4e2fab42426820de8df166fef5d">clang::ValueDecl::getType</a></div><div class="ttdeci">QualType getType() const</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00714">Decl.h:714</a></div></div>
<div class="ttc" id="aclassclang_1_1Expr_html"><div class="ttname"><a href="classclang_1_1Expr.html">clang::Expr</a></div><div class="ttdoc">This represents one expression.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l00111">Expr.h:111</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_ad2109e16a4a151dc8f6416a66a750eac"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#ad2109e16a4a151dc8f6416a66a750eac">clang::ast_matchers::integerLiteral</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, IntegerLiteral &gt; integerLiteral</div><div class="ttdoc">Matches integer literals of all sizes / encodings, e.g.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00925">ASTMatchersInternal.cpp:925</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a1182014746912db21f315121c2ed6098"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a1182014746912db21f315121c2ed6098">clang::ast_matchers::enumType</a></div><div class="ttdeci">const AstTypeMatcher&lt; EnumType &gt; enumType</div><div class="ttdoc">Matches enum types.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l01058">ASTMatchersInternal.cpp:1058</a></div></div>
<div class="ttc" id="aBasic_2Cuda_8cpp_html_ab6882f8bbaa96cde60db40335e62eb2e"><div class="ttname"><a href="Basic_2Cuda_8cpp.html#ab6882f8bbaa96cde60db40335e62eb2e">SM</a></div><div class="ttdeci">#define SM(sm)</div><div class="ttdef"><b>Definition:</b> <a href="Basic_2Cuda_8cpp_source.html#l00078">Cuda.cpp:78</a></div></div>
<div class="ttc" id="aclassclang_1_1UnsafeBufferUsageHandler_html_a02ca7bb25b2f284eaa3b603fbd427291"><div class="ttname"><a href="classclang_1_1UnsafeBufferUsageHandler.html#a02ca7bb25b2f284eaa3b603fbd427291">clang::UnsafeBufferUsageHandler::handleUnsafeOperation</a></div><div class="ttdeci">virtual void handleUnsafeOperation(const Stmt *Operation, bool IsRelatedToDecl)=0</div><div class="ttdoc">Invoked when an unsafe operation over raw pointers is found.</div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a056e81429237736b6458df18bb538c82"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a056e81429237736b6458df18bb538c82">clang::ast_matchers::varDecl</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Decl, VarDecl &gt; varDecl</div><div class="ttdoc">Matches variable declarations.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00803">ASTMatchersInternal.cpp:803</a></div></div>
<div class="ttc" id="aclassclang_1_1CastExpr_html"><div class="ttname"><a href="classclang_1_1CastExpr.html">clang::CastExpr</a></div><div class="ttdoc">CastExpr - Base class for type casts, including both implicit casts (ImplicitCastExpr) and explicit c...</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l03483">Expr.h:3483</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_a28b1bdd70cca95686345d5a96d97071a"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#a28b1bdd70cca95686345d5a96d97071a">clang::ast_matchers::implicitCastExpr</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, ImplicitCastExpr &gt; implicitCastExpr</div><div class="ttdoc">Matches the implicit cast nodes of Clang's AST.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00976">ASTMatchersInternal.cpp:976</a></div></div>
<div class="ttc" id="anamespaceclang_1_1ast__matchers_html_adc3d4ad0df1926038d75178efe06dcd8"><div class="ttname"><a href="namespaceclang_1_1ast__matchers.html#adc3d4ad0df1926038d75178efe06dcd8">clang::ast_matchers::declStmt</a></div><div class="ttdeci">const internal::VariadicDynCastAllOfMatcher&lt; Stmt, DeclStmt &gt; declStmt</div><div class="ttdoc">Matches declaration statements.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchersInternal_8cpp_source.html#l00812">ASTMatchersInternal.cpp:812</a></div></div>
<div class="ttc" id="aclassclang_1_1DeclRefExpr_html"><div class="ttname"><a href="classclang_1_1DeclRefExpr.html">clang::DeclRefExpr</a></div><div class="ttdoc">A reference to a declared variable, function, enum, etc.</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l01235">Expr.h:1235</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchFinder_1_1MatchCallback_html"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchFinder_1_1MatchCallback.html">clang::ast_matchers::MatchFinder::MatchCallback</a></div><div class="ttdoc">Called when the Match registered for it was successfully found in the AST.</div><div class="ttdef"><b>Definition:</b> <a href="ASTMatchFinder_8h_source.html#l00092">ASTMatchFinder.h:92</a></div></div>
<div class="ttc" id="aclassclang_1_1CallExpr_html"><div class="ttname"><a href="classclang_1_1CallExpr.html">clang::CallExpr</a></div><div class="ttdoc">CallExpr - Represents a function call (C99 6.5.2.2, C++ [expr.call]).</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8h_source.html#l02813">Expr.h:2813</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html">clang::ast_matchers::MatchDescendantVisitor</a></div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00025">UnsafeBufferUsage.cpp:25</a></div></div>
<div class="ttc" id="aclassclang_1_1ASTContext_html_a5d08520048c29a58b06a07f1bfb69b77"><div class="ttname"><a href="classclang_1_1ASTContext.html#a5d08520048c29a58b06a07f1bfb69b77">clang::ASTContext::getLangOpts</a></div><div class="ttdeci">const LangOptions &amp; getLangOpts() const</div><div class="ttdef"><b>Definition:</b> <a href="ASTContext_8h_source.html#l00762">ASTContext.h:762</a></div></div>
<div class="ttc" id="aclassclang_1_1ast__matchers_1_1MatchDescendantVisitor_html_a56b323dc7ad2e66076b5a8cd9bd2618f"><div class="ttname"><a href="classclang_1_1ast__matchers_1_1MatchDescendantVisitor.html#a56b323dc7ad2e66076b5a8cd9bd2618f">clang::ast_matchers::MatchDescendantVisitor::VisitorBase</a></div><div class="ttdeci">RecursiveASTVisitor&lt; MatchDescendantVisitor &gt; VisitorBase</div><div class="ttdef"><b>Definition:</b> <a href="UnsafeBufferUsage_8cpp_source.html#l00028">UnsafeBufferUsage.cpp:28</a></div></div>
<div class="ttc" id="aclassclang_1_1NamedDecl_html_a350fd0415d5f387716d5a970b9de4c29"><div class="ttname"><a href="classclang_1_1NamedDecl.html#a350fd0415d5f387716d5a970b9de4c29">clang::NamedDecl::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Get the name of identifier for this declaration as a StringRef.</div><div class="ttdef"><b>Definition:</b> <a href="Decl_8h_source.html#l00274">Decl.h:274</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 13:47:09 for clang by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
